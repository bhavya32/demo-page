(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var namespace=require("shared/namespace"),games={webgl:{"0_trajectory_mapping":require("./0_trajectory_mapping/main-webgl"),"1_uav_search":require("./1_uav_search/main-webgl"),"2_clear_path":require("./2_clear_path/main-webgl"),"3_field_medicine":require("./3_field_medicine/main-webgl"),"4_intel_sweep":require("./4_intel_sweep/main-webgl"),"5_security_bypass":require("./5_security_bypass/main-webgl"),"6_access_intel":require("./6_access_intel/main-webgl")}};namespace.games=games,module.exports={error:"games are assigned to namespace.games. Please reference it there."};
},{"./0_trajectory_mapping/main-webgl":30,"./1_uav_search/main-webgl":34,"./2_clear_path/main-webgl":39,"./3_field_medicine/main-webgl":68,"./4_intel_sweep/main-webgl":80,"./5_security_bypass/main-webgl":90,"./6_access_intel/main-webgl":121,"shared/namespace":175}],2:[function(require,module,exports){
(function (global){
!function(t,e){"use strict";var i=t.GreenSockGlobals=t.GreenSockGlobals||t;if(!i.TweenLite){var s,r,n,a,o,l=function(t){var e,s=t.split("."),r=i;for(e=0;e<s.length;e++)r[s[e]]=r=r[s[e]]||{};return r},h=l("com.greensock"),_=1e-10,u=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},m=function(){},f=function(){var t=Object.prototype.toString,e=t.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&t.call(i)===e)}}(),c={},p=function(s,r,n,a){this.sc=c[s]?c[s].sc:[],c[s]=this,this.gsClass=null,this.func=n;var o=[];this.check=function(h){for(var _,u,m,f,d=r.length,v=d;--d>-1;)(_=c[r[d]]||new p(r[d],[])).gsClass?(o[d]=_.gsClass,v--):h&&_.sc.push(this);if(0===v&&n)for(u=("com.greensock."+s).split("."),m=u.pop(),f=l(u.join("."))[m]=this.gsClass=n.apply(n,o),a&&(i[m]=f,"function"==typeof define&&define.amd?define((t.GreenSockAMDPath?t.GreenSockAMDPath+"/":"")+s.split(".").pop(),[],function(){return f}):s===e&&"undefined"!=typeof module&&module.exports&&(module.exports=f)),d=0;d<this.sc.length;d++)this.sc[d].check()},this.check(!0)},d=t._gsDefine=function(t,e,i,s){return new p(t,e,i,s)},v=h._class=function(t,e,i){return e=e||function(){},d(t,[],function(){return e},i),e};d.globals=i;var g=[0,0,1,1],T=[],y=v("easing.Ease",function(t,e,i,s){this._func=t,this._type=i||0,this._power=s||0,this._params=e?g.concat(e):g},!0),w=y.map={},P=y.register=function(t,e,i,s){for(var r,n,a,o,l=e.split(","),_=l.length,u=(i||"easeIn,easeOut,easeInOut").split(",");--_>-1;)for(n=l[_],r=s?v("easing."+n,null,!0):h.easing[n]||{},a=u.length;--a>-1;)o=u[a],w[n+"."+o]=w[o+n]=r[o]=t.getRatio?t:t[o]||new t};for(n=y.prototype,n._calcEnd=!1,n.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var e=this._type,i=this._power,s=1===e?1-t:2===e?t:.5>t?2*t:2*(1-t);return 1===i?s*=s:2===i?s*=s*s:3===i?s*=s*s*s:4===i&&(s*=s*s*s*s),1===e?1-s:2===e?s:.5>t?s/2:1-s/2},s=["Linear","Quad","Cubic","Quart","Quint,Strong"],r=s.length;--r>-1;)n=s[r]+",Power"+r,P(new y(null,null,1,r),n,"easeOut",!0),P(new y(null,null,2,r),n,"easeIn"+(0===r?",easeNone":"")),P(new y(null,null,3,r),n,"easeInOut");w.linear=h.easing.Linear.easeIn,w.swing=h.easing.Quad.easeInOut;var b=v("events.EventDispatcher",function(t){this._listeners={},this._eventTarget=t||this});n=b.prototype,n.addEventListener=function(t,e,i,s,r){r=r||0;var n,l,h=this._listeners[t],_=0;for(null==h&&(this._listeners[t]=h=[]),l=h.length;--l>-1;)n=h[l],n.c===e&&n.s===i?h.splice(l,1):0===_&&n.pr<r&&(_=l+1);h.splice(_,0,{c:e,s:i,up:s,pr:r}),this!==a||o||a.wake()},n.removeEventListener=function(t,e){var i,s=this._listeners[t];if(s)for(i=s.length;--i>-1;)if(s[i].c===e)return void s.splice(i,1)},n.dispatchEvent=function(t){var e,i,s,r=this._listeners[t];if(r)for(e=r.length,i=this._eventTarget;--e>-1;)s=r[e],s&&(s.up?s.c.call(s.s||i,{type:t,target:i}):s.c.call(s.s||i))};var k=t.requestAnimationFrame,A=t.cancelAnimationFrame,S=Date.now||function(){return(new Date).getTime()},x=S();for(s=["ms","moz","webkit","o"],r=s.length;--r>-1&&!k;)k=t[s[r]+"RequestAnimationFrame"],A=t[s[r]+"CancelAnimationFrame"]||t[s[r]+"CancelRequestAnimationFrame"];v("Ticker",function(t,e){var i,s,r,n,l,h=this,u=S(),f=e!==!1&&k,c=500,p=33,d="tick",v=function(t){var e,a,o=S()-x;o>c&&(u+=o-p),x+=o,h.time=(x-u)/1e3,e=h.time-l,(!i||e>0||t===!0)&&(h.frame++,l+=e+(e>=n?.004:n-e),a=!0),t!==!0&&(r=s(v)),a&&h.dispatchEvent(d)};b.call(h),h.time=h.frame=0,h.tick=function(){v(!0)},h.lagSmoothing=function(t,e){c=t||1/_,p=Math.min(e,c,0)},h.sleep=function(){null!=r&&(f&&A?A(r):clearTimeout(r),s=m,r=null,h===a&&(o=!1))},h.wake=function(){null!==r?h.sleep():h.frame>10&&(x=S()-c+5),s=0===i?m:f&&k?k:function(t){return setTimeout(t,1e3*(l-h.time)+1|0)},h===a&&(o=!0),v(2)},h.fps=function(t){return arguments.length?(i=t,n=1/(i||60),l=this.time+n,void h.wake()):i},h.useRAF=function(t){return arguments.length?(h.sleep(),f=t,void h.fps(i)):f},h.fps(t),setTimeout(function(){f&&h.frame<5&&h.useRAF(!1)},1500)}),n=h.Ticker.prototype=new h.events.EventDispatcher,n.constructor=h.Ticker;var R=v("core.Animation",function(t,e){if(this.vars=e=e||{},this._duration=this._totalDuration=t||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=e.immediateRender===!0,this.data=e.data,this._reversed=e.reversed===!0,B){o||a.wake();var i=this.vars.useFrames?q:B;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});a=R.ticker=new h.Ticker,n=R.prototype,n._dirty=n._gc=n._initted=n._paused=!1,n._totalTime=n._time=0,n._rawPrevTime=-1,n._next=n._last=n._onUpdate=n._timeline=n.timeline=null,n._paused=!1;var C=function(){o&&S()-x>2e3&&a.wake(),setTimeout(C,2e3)};C(),n.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},n.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},n.resume=function(t,e){return null!=t&&this.seek(t,e),this.paused(!1)},n.seek=function(t,e){return this.totalTime(Number(t),e!==!1)},n.restart=function(t,e){return this.reversed(!1).paused(!1).totalTime(t?-this._delay:0,e!==!1,!0)},n.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},n.render=function(t,e,i){},n.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},n.isActive=function(){var t,e=this._timeline,i=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime())>=i&&t<i+this.totalDuration()/this._timeScale},n._enabled=function(t,e){return o||a.wake(),this._gc=!t,this._active=this.isActive(),e!==!0&&(t&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!t&&this.timeline&&this._timeline._remove(this,!0)),!1},n._kill=function(t,e){return this._enabled(!1,!1)},n.kill=function(t,e){return this._kill(t,e),this},n._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},n._swapSelfInParams=function(t){for(var e=t.length,i=t.concat();--e>-1;)"{self}"===t[e]&&(i[e]=this);return i},n._callback=function(t){var e=this.vars;e[t].apply(e[t+"Scope"]||e.callbackScope||this,e[t+"Params"]||T)},n.eventCallback=function(t,e,i,s){if("on"===(t||"").substr(0,2)){var r=this.vars;if(1===arguments.length)return r[t];null==e?delete r[t]:(r[t]=e,r[t+"Params"]=f(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,r[t+"Scope"]=s),"onUpdate"===t&&(this._onUpdate=e)}return this},n.delay=function(t){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+t-this._delay),this._delay=t,this):this._delay},n.duration=function(t){return arguments.length?(this._duration=this._totalDuration=t,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==t&&this.totalTime(this._totalTime*(t/this._duration),!0),this):(this._dirty=!1,this._duration)},n.totalDuration=function(t){return this._dirty=!1,arguments.length?this.duration(t):this._totalDuration},n.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(t>this._duration?this._duration:t,e)):this._time},n.totalTime=function(t,e,i){if(o||a.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>t&&!i&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var s=this._totalDuration,r=this._timeline;if(t>s&&!i&&(t=s),this._startTime=(this._paused?this._pauseTime:r._time)-(this._reversed?s-t:t)/this._timeScale,r._dirty||this._uncache(!1),r._timeline)for(;r._timeline;)r._timeline._time!==(r._startTime+r._totalTime)/r._timeScale&&r.totalTime(r._totalTime,!0),r=r._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==t||0===this._duration)&&(this.render(t,e,!1),z.length&&$())}return this},n.progress=n.totalProgress=function(t,e){return arguments.length?this.totalTime(this.duration()*t,e):this._time/this.duration()},n.startTime=function(t){return arguments.length?(t!==this._startTime&&(this._startTime=t,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,t-this._delay)),this):this._startTime},n.endTime=function(t){return this._startTime+(0!=t?this.totalDuration():this.duration())/this._timeScale},n.timeScale=function(t){if(!arguments.length)return this._timeScale;if(t=t||_,this._timeline&&this._timeline.smoothChildTiming){var e=this._pauseTime,i=e||0===e?e:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/t}return this._timeScale=t,this._uncache(!1)},n.reversed=function(t){return arguments.length?(t!=this._reversed&&(this._reversed=t,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},n.paused=function(t){if(!arguments.length)return this._paused;var e,i,s=this._timeline;return t!=this._paused&&s&&(o||t||a.wake(),e=s.rawTime(),i=e-this._pauseTime,!t&&s.smoothChildTiming&&(this._startTime+=i,this._uncache(!1)),this._pauseTime=t?e:null,this._paused=t,this._active=this.isActive(),!t&&0!==i&&this._initted&&this.duration()&&this.render(s.smoothChildTiming?this._totalTime:(e-this._startTime)/this._timeScale,!0,!0)),this._gc&&!t&&this._enabled(!0,!1),this};var D=v("core.SimpleTimeline",function(t){R.call(this,0,t),this.autoRemoveChildren=this.smoothChildTiming=!0});n=D.prototype=new R,n.constructor=D,n.kill()._gc=!1,n._first=n._last=n._recent=null,n._sortChildren=!1,n.add=n.insert=function(t,e,i,s){var r,n;if(t._startTime=Number(e||0)+t._delay,t._paused&&this!==t._timeline&&(t._pauseTime=t._startTime+(this.rawTime()-t._startTime)/t._timeScale),t.timeline&&t.timeline._remove(t,!0),t.timeline=t._timeline=this,t._gc&&t._enabled(!0,!0),r=this._last,this._sortChildren)for(n=t._startTime;r&&r._startTime>n;)r=r._prev;return r?(t._next=r._next,r._next=t):(t._next=this._first,this._first=t),t._next?t._next._prev=t:this._last=t,t._prev=r,this._recent=t,this._timeline&&this._uncache(!0),this},n._remove=function(t,e){return t.timeline===this&&(e||t._enabled(!1,!0),t._prev?t._prev._next=t._next:this._first===t&&(this._first=t._next),t._next?t._next._prev=t._prev:this._last===t&&(this._last=t._prev),t._next=t._prev=t.timeline=null,t===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},n.render=function(t,e,i){var s,r=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;r;)s=r._next,(r._active||t>=r._startTime&&!r._paused)&&(r._reversed?r.render((r._dirty?r.totalDuration():r._totalDuration)-(t-r._startTime)*r._timeScale,e,i):r.render((t-r._startTime)*r._timeScale,e,i)),r=s},n.rawTime=function(){return o||a.wake(),this._totalTime};var I=v("TweenLite",function(e,i,s){if(R.call(this,i,s),this.render=I.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:I.selector(e)||e;var r,n,a,o=e.jquery||e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType),l=this.vars.overwrite;if(this._overwrite=l=null==l?Q[I.defaultOverwrite]:"number"==typeof l?l>>0:Q[l],(o||e instanceof Array||e.push&&f(e))&&"number"!=typeof e[0])for(this._targets=a=u(e),this._propLookup=[],this._siblings=[],r=0;r<a.length;r++)n=a[r],n?"string"!=typeof n?n.length&&n!==t&&n[0]&&(n[0]===t||n[0].nodeType&&n[0].style&&!n.nodeType)?(a.splice(r--,1),this._targets=a=a.concat(u(n))):(this._siblings[r]=K(n,this,!1),1===l&&this._siblings[r].length>1&&J(n,this,null,1,this._siblings[r])):(n=a[r--]=I.selector(n),"string"==typeof n&&a.splice(r+1,1)):a.splice(r--,1);else this._propLookup={},this._siblings=K(e,this,!1),1===l&&this._siblings.length>1&&J(e,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-_,this.render(-this._delay))},!0),E=function(e){return e&&e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType)},O=function(t,e){var i,s={};for(i in t)G[i]||i in e&&"transform"!==i&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!F[i]||F[i]&&F[i]._autoCSS)||(s[i]=t[i],delete t[i]);t.css=s};n=I.prototype=new R,n.constructor=I,n.kill()._gc=!1,n.ratio=0,n._firstPT=n._targets=n._overwrittenProps=n._startAt=null,n._notifyPluginsOfEnabled=n._lazy=!1,I.version="1.17.0",I.defaultEase=n._ease=new y(null,null,1,1),I.defaultOverwrite="auto",I.ticker=a,I.autoSleep=120,I.lagSmoothing=function(t,e){a.lagSmoothing(t,e)},I.selector=t.$||t.jQuery||function(e){var i=t.$||t.jQuery;return i?(I.selector=i,i(e)):"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e)};var z=[],N={},L=I._internals={isArray:f,isSelector:E,lazyTweens:z},F=I._plugins={},U=L.tweenLookup={},j=0,G=L.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1},Q={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},q=R._rootFramesTimeline=new D,B=R._rootTimeline=new D,M=30,$=L.lazyRender=function(){var t,e=z.length;for(N={};--e>-1;)t=z[e],t&&t._lazy!==!1&&(t.render(t._lazy[0],t._lazy[1],!0),t._lazy=!1);z.length=0};B._startTime=a.time,q._startTime=a.frame,B._active=q._active=!0,setTimeout($,1),R._updateRoot=I.render=function(){var t,e,i;if(z.length&&$(),B.render((a.time-B._startTime)*B._timeScale,!1,!1),q.render((a.frame-q._startTime)*q._timeScale,!1,!1),z.length&&$(),a.frame>=M){M=a.frame+(parseInt(I.autoSleep,10)||120);for(i in U){for(e=U[i].tweens,t=e.length;--t>-1;)e[t]._gc&&e.splice(t,1);0===e.length&&delete U[i]}if(i=B._first,(!i||i._paused)&&I.autoSleep&&!q._first&&1===a._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||a.sleep()}}},a.addEventListener("tick",R._updateRoot);var K=function(t,e,i){var s,r,n=t._gsTweenID;if(U[n||(t._gsTweenID=n="t"+j++)]||(U[n]={target:t,tweens:[]}),e&&(s=U[n].tweens,s[r=s.length]=e,i))for(;--r>-1;)s[r]===e&&s.splice(r,1);return U[n].tweens},H=function(t,e,i,s){var r,n,a=t.vars.onOverwrite;return a&&(r=a(t,e,i,s)),a=I.onOverwrite,a&&(n=a(t,e,i,s)),r!==!1&&n!==!1},J=function(t,e,i,s,r){var n,a,o,l;if(1===s||s>=4){for(l=r.length,n=0;l>n;n++)if((o=r[n])!==e)o._gc||o._kill(null,t,e)&&(a=!0);else if(5===s)break;return a}var h,u=e._startTime+_,m=[],f=0,c=0===e._duration;for(n=r.length;--n>-1;)(o=r[n])===e||o._gc||o._paused||(o._timeline!==e._timeline?(h=h||V(e,0,c),0===V(o,h,c)&&(m[f++]=o)):o._startTime<=u&&o._startTime+o.totalDuration()/o._timeScale>u&&((c||!o._initted)&&u-o._startTime<=2e-10||(m[f++]=o)));for(n=f;--n>-1;)if(o=m[n],2===s&&o._kill(i,t,e)&&(a=!0),2!==s||!o._firstPT&&o._initted){if(2!==s&&!H(o,e))continue;o._enabled(!1,!1)&&(a=!0)}return a},V=function(t,e,i){for(var s=t._timeline,r=s._timeScale,n=t._startTime;s._timeline;){if(n+=s._startTime,r*=s._timeScale,s._paused)return-100;s=s._timeline}return n/=r,n>e?n-e:i&&n===e||!t._initted&&2*_>n-e?_:(n+=t.totalDuration()/t._timeScale/r)>e+_?0:n-e-_};n._init=function(){var t,e,i,s,r,n=this.vars,a=this._overwrittenProps,o=this._duration,l=!!n.immediateRender,h=n.ease;if(n.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),r={};for(s in n.startAt)r[s]=n.startAt[s];if(r.overwrite=!1,r.immediateRender=!0,r.lazy=l&&n.lazy!==!1,r.startAt=r.delay=null,this._startAt=I.to(this.target,0,r),l)if(this._time>0)this._startAt=null;else if(0!==o)return}else if(n.runBackwards&&0!==o)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(l=!1),i={};for(s in n)G[s]&&"autoCSS"!==s||(i[s]=n[s]);if(i.overwrite=0,i.data="isFromStart",i.lazy=l&&n.lazy!==!1,i.immediateRender=l,this._startAt=I.to(this.target,0,i),l){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=h=h?h instanceof y?h:"function"==typeof h?new y(h,n.easeParams):w[h]||I.defaultEase:I.defaultEase,n.easeParams instanceof Array&&h.config&&(this._ease=h.config.apply(h,n.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(t=this._targets.length;--t>-1;)this._initProps(this._targets[t],this._propLookup[t]={},this._siblings[t],a?a[t]:null)&&(e=!0);else e=this._initProps(this.target,this._propLookup,this._siblings,a);if(e&&I._onPluginEvent("_onInitAllProps",this),a&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),n.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=n.onUpdate,this._initted=!0},n._initProps=function(e,i,s,r){var n,a,o,l,h,_;if(null==e)return!1;N[e._gsTweenID]&&$(),this.vars.css||e.style&&e!==t&&e.nodeType&&F.css&&this.vars.autoCSS!==!1&&O(this.vars,e);for(n in this.vars){if(_=this.vars[n],G[n])_&&(_ instanceof Array||_.push&&f(_))&&-1!==_.join("").indexOf("{self}")&&(this.vars[n]=_=this._swapSelfInParams(_,this));else if(F[n]&&(l=new F[n])._onInitTween(e,this.vars[n],this)){for(this._firstPT=h={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:!0,n:n,pg:!0,pr:l._priority},a=l._overwriteProps.length;--a>-1;)i[l._overwriteProps[a]]=this._firstPT;(l._priority||l._onInitAllProps)&&(o=!0),(l._onDisable||l._onEnable)&&(this._notifyPluginsOfEnabled=!0)}else this._firstPT=i[n]=h={_next:this._firstPT,t:e,p:n,f:"function"==typeof e[n],n:n,pg:!1,pr:0},h.s=h.f?e[n.indexOf("set")||"function"!=typeof e["get"+n.substr(3)]?n:"get"+n.substr(3)]():parseFloat(e[n]),h.c="string"==typeof _&&"="===_.charAt(1)?parseInt(_.charAt(0)+"1",10)*Number(_.substr(2)):Number(_)-h.s||0;h&&h._next&&(h._next._prev=h)}return r&&this._kill(r,e)?this._initProps(e,i,s,r):this._overwrite>1&&this._firstPT&&s.length>1&&J(e,this,i,this._overwrite,s)?(this._kill(i,e),this._initProps(e,i,s,r)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(N[e._gsTweenID]=!0),o)},n.render=function(t,e,i){var s,r,n,a,o=this._time,l=this._duration,h=this._rawPrevTime;if(t>=l)this._totalTime=this._time=l,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(s=!0,r="onComplete",i=i||this._timeline.autoRemoveChildren),0===l&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(0===t||0>h||h===_&&"isPause"!==this.data)&&h!==t&&(i=!0,h>_&&(r="onReverseComplete")),this._rawPrevTime=a=!e||t||h===t?t:_);else if(1e-7>t)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==o||0===l&&h>0)&&(r="onReverseComplete",s=this._reversed),0>t&&(this._active=!1,0===l&&(this._initted||!this.vars.lazy||i)&&(h>=0&&(h!==_||"isPause"!==this.data)&&(i=!0),this._rawPrevTime=a=!e||t||h===t?t:_)),this._initted||(i=!0);else if(this._totalTime=this._time=t,this._easeType){var u=t/l,m=this._easeType,f=this._easePower;(1===m||3===m&&u>=.5)&&(u=1-u),3===m&&(u*=2),1===f?u*=u:2===f?u*=u*u:3===f?u*=u*u*u:4===f&&(u*=u*u*u*u),1===m?this.ratio=1-u:2===m?this.ratio=u:.5>t/l?this.ratio=u/2:this.ratio=1-u/2}else this.ratio=this._ease.getRatio(t/l);if(this._time!==o||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=o,this._rawPrevTime=h,z.push(this),void(this._lazy=[t,e]);this._time&&!s?this.ratio=this._ease.getRatio(this._time/l):s&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==o&&t>=0&&(this._active=!0),0===o&&(this._startAt&&(t>=0?this._startAt.render(t,e,i):r||(r="_dummyGS")),this.vars.onStart&&(0!==this._time||0===l)&&(e||this._callback("onStart"))),n=this._firstPT;n;)n.f?n.t[n.p](n.c*this.ratio+n.s):n.t[n.p]=n.c*this.ratio+n.s,n=n._next;this._onUpdate&&(0>t&&this._startAt&&t!==-1e-4&&this._startAt.render(t,e,i),e||(this._time!==o||s)&&this._callback("onUpdate")),r&&(!this._gc||i)&&(0>t&&this._startAt&&!this._onUpdate&&t!==-1e-4&&this._startAt.render(t,e,i),s&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[r]&&this._callback(r),0===l&&this._rawPrevTime===_&&a!==_&&(this._rawPrevTime=0))}},n._kill=function(t,e,i){if("all"===t&&(t=null),null==t&&(null==e||e===this.target))return this._lazy=!1,this._enabled(!1,!1);e="string"!=typeof e?e||this._targets||this.target:I.selector(e)||e;var s,r,n,a,o,l,h,_,u,m=i&&this._time&&i._startTime===this._startTime&&this._timeline===i._timeline;if((f(e)||E(e))&&"number"!=typeof e[0])for(s=e.length;--s>-1;)this._kill(t,e[s],i)&&(l=!0);else{if(this._targets){for(s=this._targets.length;--s>-1;)if(e===this._targets[s]){o=this._propLookup[s]||{},this._overwrittenProps=this._overwrittenProps||[],r=this._overwrittenProps[s]=t?this._overwrittenProps[s]||{}:"all";break}}else{if(e!==this.target)return!1;o=this._propLookup,r=this._overwrittenProps=t?this._overwrittenProps||{}:"all"}if(o){if(h=t||o,_=t!==r&&"all"!==r&&t!==o&&("object"!=typeof t||!t._tempKill),i&&(I.onOverwrite||this.vars.onOverwrite)){for(n in h)o[n]&&(u||(u=[]),u.push(n));if((u||!t)&&!H(this,i,e,u))return!1}for(n in h)(a=o[n])&&(m&&(a.f?a.t[a.p](a.s):a.t[a.p]=a.s,l=!0),a.pg&&a.t._kill(h)&&(l=!0),a.pg&&0!==a.t._overwriteProps.length||(a._prev?a._prev._next=a._next:a===this._firstPT&&(this._firstPT=a._next),a._next&&(a._next._prev=a._prev),a._next=a._prev=null),delete o[n]),_&&(r[n]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return l},n.invalidate=function(){return this._notifyPluginsOfEnabled&&I._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],R.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-_,this.render(-this._delay)),this},n._enabled=function(t,e){if(o||a.wake(),t&&this._gc){var i,s=this._targets;if(s)for(i=s.length;--i>-1;)this._siblings[i]=K(s[i],this,!0);else this._siblings=K(this.target,this,!0)}return R.prototype._enabled.call(this,t,e),this._notifyPluginsOfEnabled&&this._firstPT?I._onPluginEvent(t?"_onEnable":"_onDisable",this):!1},I.to=function(t,e,i){return new I(t,e,i)},I.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new I(t,e,i)},I.fromTo=function(t,e,i,s){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,new I(t,e,s)},I.delayedCall=function(t,e,i,s,r){return new I(e,0,{delay:t,onComplete:e,onCompleteParams:i,callbackScope:s,onReverseComplete:e,onReverseCompleteParams:i,immediateRender:!1,lazy:!1,useFrames:r,overwrite:0})},I.set=function(t,e){return new I(t,0,e)},I.getTweensOf=function(t,e){if(null==t)return[];t="string"!=typeof t?t:I.selector(t)||t;var i,s,r,n;if((f(t)||E(t))&&"number"!=typeof t[0]){for(i=t.length,s=[];--i>-1;)s=s.concat(I.getTweensOf(t[i],e));for(i=s.length;--i>-1;)for(n=s[i],r=i;--r>-1;)n===s[r]&&s.splice(i,1)}else for(s=K(t).concat(),i=s.length;--i>-1;)(s[i]._gc||e&&!s[i].isActive())&&s.splice(i,1);return s},I.killTweensOf=I.killDelayedCallsTo=function(t,e,i){"object"==typeof e&&(i=e,e=!1);for(var s=I.getTweensOf(t,e),r=s.length;--r>-1;)s[r]._kill(i,t)};var W=v("plugins.TweenPlugin",function(t,e){this._overwriteProps=(t||"").split(","),this._propName=this._overwriteProps[0],this._priority=e||0,this._super=W.prototype},!0);if(n=W.prototype,W.version="1.10.1",W.API=2,n._firstPT=null,n._addTween=function(t,e,i,s,r,n){var a,o;return null!=s&&(a="number"==typeof s||"="!==s.charAt(1)?Number(s)-Number(i):parseInt(s.charAt(0)+"1",10)*Number(s.substr(2)))?(this._firstPT=o={_next:this._firstPT,t:t,p:e,s:i,c:a,f:"function"==typeof t[e],n:r||e,r:n},o._next&&(o._next._prev=o),o):void 0},n.setRatio=function(t){for(var e,i=this._firstPT,s=1e-6;i;)e=i.c*t+i.s,i.r?e=Math.round(e):s>e&&e>-s&&(e=0),i.f?i.t[i.p](e):i.t[i.p]=e,i=i._next},n._kill=function(t){var e,i=this._overwriteProps,s=this._firstPT;if(null!=t[this._propName])this._overwriteProps=[];else for(e=i.length;--e>-1;)null!=t[i[e]]&&i.splice(e,1);for(;s;)null!=t[s.n]&&(s._next&&(s._next._prev=s._prev),s._prev?(s._prev._next=s._next,s._prev=null):this._firstPT===s&&(this._firstPT=s._next)),s=s._next;return!1},n._roundProps=function(t,e){for(var i=this._firstPT;i;)(t[this._propName]||null!=i.n&&t[i.n.split(this._propName+"_").join("")])&&(i.r=e),i=i._next},I._onPluginEvent=function(t,e){var i,s,r,n,a,o=e._firstPT;if("_onInitAllProps"===t){for(;o;){for(a=o._next,s=r;s&&s.pr>o.pr;)s=s._next;(o._prev=s?s._prev:n)?o._prev._next=o:r=o,(o._next=s)?s._prev=o:n=o,o=a}o=e._firstPT=r}for(;o;)o.pg&&"function"==typeof o.t[t]&&o.t[t]()&&(i=!0),o=o._next;return i},W.activate=function(t){for(var e=t.length;--e>-1;)t[e].API===W.API&&(F[(new t[e])._propName]=t[e]);return!0},d.plugin=function(t){if(!(t&&t.propName&&t.init&&t.API))throw"illegal plugin definition.";var e,i=t.propName,s=t.priority||0,r=t.overwriteProps,n={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},a=v("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){W.call(this,i,s),this._overwriteProps=r||[]},t.global===!0),o=a.prototype=new W(i);o.constructor=a,a.API=t.API;for(e in n)"function"==typeof t[e]&&(o[n[e]]=t[e]);return a.version=t.version,W.activate([a]),a},s=t._gsQueue){for(r=0;r<s.length;r++)s[r]();for(n in c)c[n].func||t.console.log("GSAP encountered missing dependency: com.greensock."+n)}o=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenLite");
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],3:[function(require,module,exports){
(function (global){
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(t,e,i){var s=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},r=function(t,e,s){i.call(this,t,e,s),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=r.prototype.render},n=1e-10,a=i._internals,o=a.isSelector,h=a.isArray,l=r.prototype=i.to({},.1,{}),_=[];r.version="1.17.0",l.constructor=r,l.kill()._gc=!1,r.killTweensOf=r.killDelayedCallsTo=i.killTweensOf,r.getTweensOf=i.getTweensOf,r.lagSmoothing=i.lagSmoothing,r.ticker=i.ticker,r.render=i.render,l.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),i.prototype.invalidate.call(this)},l.updateTo=function(t,e){var s,r=this.ratio,n=this.vars.immediateRender||t.immediateRender;e&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(s in t)this.vars[s]=t[s];if(this._initted||n)if(e)this._initted=!1,n&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&i._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var a=this._time;this.render(0,!0,!1),this._initted=!1,this.render(a,!0,!1)}else if(this._time>0||n){this._initted=!1,this._init();for(var o,h=1/(1-r),l=this._firstPT;l;)o=l.s+l.c,l.c*=h,l.s=o-l.c,l=l._next}return this},l.render=function(t,e,i){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var s,r,o,h,l,_,u,c,f=this._dirty?this.totalDuration():this._totalDuration,p=this._time,m=this._totalTime,d=this._cycle,g=this._duration,v=this._rawPrevTime;if(t>=f?(this._totalTime=f,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=g,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(s=!0,r="onComplete",i=i||this._timeline.autoRemoveChildren),0===g&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(0===t||0>v||v===n)&&v!==t&&(i=!0,v>n&&(r="onReverseComplete")),this._rawPrevTime=c=!e||t||v===t?t:n)):1e-7>t?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==m||0===g&&v>0)&&(r="onReverseComplete",s=this._reversed),0>t&&(this._active=!1,0===g&&(this._initted||!this.vars.lazy||i)&&(v>=0&&(i=!0),this._rawPrevTime=c=!e||t||v===t?t:n)),this._initted||(i=!0)):(this._totalTime=this._time=t,0!==this._repeat&&(h=g+this._repeatDelay,this._cycle=this._totalTime/h>>0,0!==this._cycle&&this._cycle===this._totalTime/h&&this._cycle--,this._time=this._totalTime-this._cycle*h,this._yoyo&&0!==(1&this._cycle)&&(this._time=g-this._time),this._time>g?this._time=g:this._time<0&&(this._time=0)),this._easeType?(l=this._time/g,_=this._easeType,u=this._easePower,(1===_||3===_&&l>=.5)&&(l=1-l),3===_&&(l*=2),1===u?l*=l:2===u?l*=l*l:3===u?l*=l*l*l:4===u&&(l*=l*l*l*l),1===_?this.ratio=1-l:2===_?this.ratio=l:this._time/g<.5?this.ratio=l/2:this.ratio=1-l/2):this.ratio=this._ease.getRatio(this._time/g)),p===this._time&&!i&&d===this._cycle)return void(m!==this._totalTime&&this._onUpdate&&(e||this._callback("onUpdate")));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=p,this._totalTime=m,this._rawPrevTime=v,this._cycle=d,a.lazyTweens.push(this),void(this._lazy=[t,e]);this._time&&!s?this.ratio=this._ease.getRatio(this._time/g):s&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==p&&t>=0&&(this._active=!0),0===m&&(2===this._initted&&t>0&&this._init(),this._startAt&&(t>=0?this._startAt.render(t,e,i):r||(r="_dummyGS")),this.vars.onStart&&(0!==this._totalTime||0===g)&&(e||this._callback("onStart"))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(0>t&&this._startAt&&this._startTime&&this._startAt.render(t,e,i),e||(this._totalTime!==m||s)&&this._callback("onUpdate")),this._cycle!==d&&(e||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),r&&(!this._gc||i)&&(0>t&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(t,e,i),s&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[r]&&this._callback(r),0===g&&this._rawPrevTime===n&&c!==n&&(this._rawPrevTime=0))},r.to=function(t,e,i){return new r(t,e,i)},r.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new r(t,e,i)},r.fromTo=function(t,e,i,s){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,new r(t,e,s)},r.staggerTo=r.allTo=function(t,e,n,a,l,u,c){a=a||0;var f,p,m,d,g=n.delay||0,v=[],y=function(){n.onComplete&&n.onComplete.apply(n.onCompleteScope||this,arguments),l.apply(c||n.callbackScope||this,u||_)};for(h(t)||("string"==typeof t&&(t=i.selector(t)||t),o(t)&&(t=s(t))),t=t||[],0>a&&(t=s(t),t.reverse(),a*=-1),f=t.length-1,m=0;f>=m;m++){p={};for(d in n)p[d]=n[d];p.delay=g,m===f&&l&&(p.onComplete=y),v[m]=new r(t[m],e,p),g+=a}return v},r.staggerFrom=r.allFrom=function(t,e,i,s,n,a,o){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,r.staggerTo(t,e,i,s,n,a,o)},r.staggerFromTo=r.allFromTo=function(t,e,i,s,n,a,o,h){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,r.staggerTo(t,e,s,n,a,o,h)},r.delayedCall=function(t,e,i,s,n){return new r(e,0,{delay:t,onComplete:e,onCompleteParams:i,callbackScope:s,onReverseComplete:e,onReverseCompleteParams:i,immediateRender:!1,useFrames:n,overwrite:0})},r.set=function(t,e){return new r(t,0,e)},r.isTweening=function(t){return i.getTweensOf(t,!0).length>0};var u=function(t,e){for(var s=[],r=0,n=t._first;n;)n instanceof i?s[r++]=n:(e&&(s[r++]=n),s=s.concat(u(n,e)),r=s.length),n=n._next;return s},c=r.getAllTweens=function(e){return u(t._rootTimeline,e).concat(u(t._rootFramesTimeline,e))};r.killAll=function(t,i,s,r){null==i&&(i=!0),null==s&&(s=!0);var n,a,o,h=c(0!=r),l=h.length,_=i&&s&&r;for(o=0;l>o;o++)a=h[o],(_||a instanceof e||(n=a.target===a.vars.onComplete)&&s||i&&!n)&&(t?a.totalTime(a._reversed?0:a.totalDuration()):a._enabled(!1,!1))},r.killChildTweensOf=function(t,e){if(null!=t){var n,l,_,u,c,f=a.tweenLookup;if("string"==typeof t&&(t=i.selector(t)||t),o(t)&&(t=s(t)),h(t))for(u=t.length;--u>-1;)r.killChildTweensOf(t[u],e);else{n=[];for(_ in f)for(l=f[_].target.parentNode;l;)l===t&&(n=n.concat(f[_].tweens)),l=l.parentNode;for(c=n.length,u=0;c>u;u++)e&&n[u].totalTime(n[u].totalDuration()),n[u]._enabled(!1,!1)}}};var f=function(t,i,s,r){i=i!==!1,s=s!==!1,r=r!==!1;for(var n,a,o=c(r),h=i&&s&&r,l=o.length;--l>-1;)a=o[l],(h||a instanceof e||(n=a.target===a.vars.onComplete)&&s||i&&!n)&&a.paused(t)};return r.pauseAll=function(t,e,i){f(!0,t,e,i)},r.resumeAll=function(t,e,i){f(!1,t,e,i)},r.globalTimeScale=function(e){var s=t._rootTimeline,r=i.ticker.time;return arguments.length?(e=e||n,s._startTime=r-(r-s._startTime)*s._timeScale/e,s=t._rootFramesTimeline,r=i.ticker.frame,s._startTime=r-(r-s._startTime)*s._timeScale/e,s._timeScale=t._rootTimeline._timeScale=e,e):s._timeScale},l.progress=function(t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-t:t)+this._cycle*(this._duration+this._repeatDelay),!1):this._time/this.duration()},l.totalProgress=function(t){return arguments.length?this.totalTime(this.totalDuration()*t,!1):this._totalTime/this.totalDuration()},l.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),t>this._duration&&(t=this._duration),this._yoyo&&0!==(1&this._cycle)?t=this._duration-t+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(t+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(t,e)):this._time},l.duration=function(e){return arguments.length?t.prototype.duration.call(this,e):this._duration},l.totalDuration=function(t){return arguments.length?-1===this._repeat?this:this.duration((t-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},l.repeat=function(t){return arguments.length?(this._repeat=t,this._uncache(!0)):this._repeat},l.repeatDelay=function(t){return arguments.length?(this._repeatDelay=t,this._uncache(!0)):this._repeatDelay},l.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},r},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(t,e,i){var s=function(t){e.call(this,t),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var i,s,r=this.vars;for(s in r)i=r[s],h(i)&&-1!==i.join("").indexOf("{self}")&&(r[s]=this._swapSelfInParams(i));h(r.tweens)&&this.add(r.tweens,0,r.align,r.stagger)},r=1e-10,n=i._internals,a=s._internals={},o=n.isSelector,h=n.isArray,l=n.lazyTweens,_=n.lazyRender,u=[],c=_gsScope._gsDefine.globals,f=function(t){var e,i={};for(e in t)i[e]=t[e];return i},p=a.pauseCallback=function(t,e,i,s){var n,a=t._timeline,o=a._totalTime,h=t._startTime,l=t._rawPrevTime<0||0===t._rawPrevTime&&a._reversed,_=l?0:r,c=l?r:0;if(e||!this._forcingPlayhead){for(a.pause(h),n=t._prev;n&&n._startTime===h;)n._rawPrevTime=c,n=n._prev;for(n=t._next;n&&n._startTime===h;)n._rawPrevTime=_,n=n._next;e&&e.apply(s||a.vars.callbackScope||a,i||u),(this._forcingPlayhead||!a._paused)&&a.seek(o)}},m=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},d=s.prototype=new e;return s.version="1.17.0",d.constructor=s,d.kill()._gc=d._forcingPlayhead=!1,d.to=function(t,e,s,r){var n=s.repeat&&c.TweenMax||i;return e?this.add(new n(t,e,s),r):this.set(t,s,r)},d.from=function(t,e,s,r){return this.add((s.repeat&&c.TweenMax||i).from(t,e,s),r)},d.fromTo=function(t,e,s,r,n){var a=r.repeat&&c.TweenMax||i;return e?this.add(a.fromTo(t,e,s,r),n):this.set(t,r,n)},d.staggerTo=function(t,e,r,n,a,h,l,_){var u,c=new s({onComplete:h,onCompleteParams:l,callbackScope:_,smoothChildTiming:this.smoothChildTiming});for("string"==typeof t&&(t=i.selector(t)||t),t=t||[],o(t)&&(t=m(t)),n=n||0,0>n&&(t=m(t),t.reverse(),n*=-1),u=0;u<t.length;u++)r.startAt&&(r.startAt=f(r.startAt)),c.to(t[u],e,f(r),u*n);return this.add(c,a)},d.staggerFrom=function(t,e,i,s,r,n,a,o){return i.immediateRender=0!=i.immediateRender,i.runBackwards=!0,this.staggerTo(t,e,i,s,r,n,a,o)},d.staggerFromTo=function(t,e,i,s,r,n,a,o,h){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,this.staggerTo(t,e,s,r,n,a,o,h)},d.call=function(t,e,s,r){return this.add(i.delayedCall(0,t,e,s),r)},d.set=function(t,e,s){return s=this._parseTimeOrLabel(s,0,!0),null==e.immediateRender&&(e.immediateRender=s===this._time&&!this._paused),this.add(new i(t,0,e),s)},s.exportRoot=function(t,e){t=t||{},null==t.smoothChildTiming&&(t.smoothChildTiming=!0);var r,n,a=new s(t),o=a._timeline;for(null==e&&(e=!0),o._remove(a,!0),a._startTime=0,a._rawPrevTime=a._time=a._totalTime=o._time,r=o._first;r;)n=r._next,e&&r instanceof i&&r.target===r.vars.onComplete||a.add(r,r._startTime-r._delay),r=n;return o.add(a,0),a},d.add=function(r,n,a,o){var l,_,u,c,f,p;if("number"!=typeof n&&(n=this._parseTimeOrLabel(n,0,!0,r)),!(r instanceof t)){if(r instanceof Array||r&&r.push&&h(r)){for(a=a||"normal",o=o||0,l=n,_=r.length,u=0;_>u;u++)h(c=r[u])&&(c=new s({tweens:c})),this.add(c,l),"string"!=typeof c&&"function"!=typeof c&&("sequence"===a?l=c._startTime+c.totalDuration()/c._timeScale:"start"===a&&(c._startTime-=c.delay())),l+=o;return this._uncache(!0)}if("string"==typeof r)return this.addLabel(r,n);if("function"!=typeof r)throw"Cannot add "+r+" into the timeline; it is not a tween, timeline, function, or string.";r=i.delayedCall(0,r)}if(e.prototype.add.call(this,r,n),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(f=this,p=f.rawTime()>r._startTime;f._timeline;)p&&f._timeline.smoothChildTiming?f.totalTime(f._totalTime,!0):f._gc&&f._enabled(!0,!1),f=f._timeline;return this},d.remove=function(e){if(e instanceof t)return this._remove(e,!1);if(e instanceof Array||e&&e.push&&h(e)){for(var i=e.length;--i>-1;)this.remove(e[i]);return this}return"string"==typeof e?this.removeLabel(e):this.kill(null,e)},d._remove=function(t,i){e.prototype._remove.call(this,t,i);var s=this._last;return s?this._time>s._startTime+s._totalDuration/s._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},d.append=function(t,e){return this.add(t,this._parseTimeOrLabel(null,e,!0,t))},d.insert=d.insertMultiple=function(t,e,i,s){return this.add(t,e||0,i,s)},d.appendMultiple=function(t,e,i,s){return this.add(t,this._parseTimeOrLabel(null,e,!0,t),i,s)},d.addLabel=function(t,e){return this._labels[t]=this._parseTimeOrLabel(e),this},d.addPause=function(t,e,s,r){var n=i.delayedCall(0,p,["{self}",e,s,r],this);return n.data="isPause",this.add(n,t)},d.removeLabel=function(t){return delete this._labels[t],this},d.getLabelTime=function(t){return null!=this._labels[t]?this._labels[t]:-1},d._parseTimeOrLabel=function(e,i,s,r){var n;if(r instanceof t&&r.timeline===this)this.remove(r);else if(r&&(r instanceof Array||r.push&&h(r)))for(n=r.length;--n>-1;)r[n]instanceof t&&r[n].timeline===this&&this.remove(r[n]);if("string"==typeof i)return this._parseTimeOrLabel(i,s&&"number"==typeof e&&null==this._labels[i]?e-this.duration():0,s);if(i=i||0,"string"!=typeof e||!isNaN(e)&&null==this._labels[e])null==e&&(e=this.duration());else{if(n=e.indexOf("="),-1===n)return null==this._labels[e]?s?this._labels[e]=this.duration()+i:i:this._labels[e]+i;i=parseInt(e.charAt(n-1)+"1",10)*Number(e.substr(n+1)),e=n>1?this._parseTimeOrLabel(e.substr(0,n-1),0,s):this.duration()}return Number(e)+i},d.seek=function(t,e){return this.totalTime("number"==typeof t?t:this._parseTimeOrLabel(t),e!==!1)},d.stop=function(){return this.paused(!0)},d.gotoAndPlay=function(t,e){return this.play(t,e)},d.gotoAndStop=function(t,e){return this.pause(t,e)},d.render=function(t,e,i){this._gc&&this._enabled(!0,!1);var s,n,a,o,h,u=this._dirty?this.totalDuration():this._totalDuration,c=this._time,f=this._startTime,p=this._timeScale,m=this._paused;if(t>=u)this._totalTime=this._time=u,this._reversed||this._hasPausedChild()||(n=!0,o="onComplete",h=!!this._timeline.autoRemoveChildren,0===this._duration&&(0===t||this._rawPrevTime<0||this._rawPrevTime===r)&&this._rawPrevTime!==t&&this._first&&(h=!0,this._rawPrevTime>r&&(o="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,t=u+1e-4;else if(1e-7>t)if(this._totalTime=this._time=0,(0!==c||0===this._duration&&this._rawPrevTime!==r&&(this._rawPrevTime>0||0>t&&this._rawPrevTime>=0))&&(o="onReverseComplete",n=this._reversed),0>t)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(h=n=!0,o="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(h=!0),this._rawPrevTime=t;else{if(this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,0===t&&n)for(s=this._first;s&&0===s._startTime;)s._duration||(n=!1),s=s._next;t=0,this._initted||(h=!0)}else this._totalTime=this._time=this._rawPrevTime=t;if(this._time!==c&&this._first||i||h){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==c&&t>0&&(this._active=!0),0===c&&this.vars.onStart&&0!==this._time&&(e||this._callback("onStart")),this._time>=c)for(s=this._first;s&&(a=s._next,!this._paused||m);)(s._active||s._startTime<=this._time&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=a;else for(s=this._last;s&&(a=s._prev,!this._paused||m);)(s._active||s._startTime<=c&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=a;this._onUpdate&&(e||(l.length&&_(),this._callback("onUpdate"))),o&&(this._gc||(f===this._startTime||p!==this._timeScale)&&(0===this._time||u>=this.totalDuration())&&(n&&(l.length&&_(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[o]&&this._callback(o)))}},d._hasPausedChild=function(){for(var t=this._first;t;){if(t._paused||t instanceof s&&t._hasPausedChild())return!0;t=t._next}return!1},d.getChildren=function(t,e,s,r){r=r||-9999999999;for(var n=[],a=this._first,o=0;a;)a._startTime<r||(a instanceof i?e!==!1&&(n[o++]=a):(s!==!1&&(n[o++]=a),t!==!1&&(n=n.concat(a.getChildren(!0,e,s)),o=n.length))),a=a._next;return n},d.getTweensOf=function(t,e){var s,r,n=this._gc,a=[],o=0;for(n&&this._enabled(!0,!0),s=i.getTweensOf(t),r=s.length;--r>-1;)(s[r].timeline===this||e&&this._contains(s[r]))&&(a[o++]=s[r]);return n&&this._enabled(!1,!0),a},d.recent=function(){return this._recent},d._contains=function(t){for(var e=t.timeline;e;){if(e===this)return!0;e=e.timeline}return!1},d.shiftChildren=function(t,e,i){i=i||0;for(var s,r=this._first,n=this._labels;r;)r._startTime>=i&&(r._startTime+=t),r=r._next;if(e)for(s in n)n[s]>=i&&(n[s]+=t);return this._uncache(!0)},d._kill=function(t,e){if(!t&&!e)return this._enabled(!1,!1);for(var i=e?this.getTweensOf(e):this.getChildren(!0,!0,!1),s=i.length,r=!1;--s>-1;)i[s]._kill(t,e)&&(r=!0);return r},d.clear=function(t){var e=this.getChildren(!1,!0,!0),i=e.length;for(this._time=this._totalTime=0;--i>-1;)e[i]._enabled(!1,!1);return t!==!1&&(this._labels={}),this._uncache(!0)},d.invalidate=function(){for(var e=this._first;e;)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},d._enabled=function(t,i){if(t===this._gc)for(var s=this._first;s;)s._enabled(t,!0),s=s._next;return e.prototype._enabled.call(this,t,i)},d.totalTime=function(e,i,s){this._forcingPlayhead=!0;var r=t.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,r},d.duration=function(t){return arguments.length?(0!==this.duration()&&0!==t&&this.timeScale(this._duration/t),this):(this._dirty&&this.totalDuration(),this._duration)},d.totalDuration=function(t){if(!arguments.length){if(this._dirty){for(var e,i,s=0,r=this._last,n=999999999999;r;)e=r._prev,r._dirty&&r.totalDuration(),r._startTime>n&&this._sortChildren&&!r._paused?this.add(r,r._startTime-r._delay):n=r._startTime,r._startTime<0&&!r._paused&&(s-=r._startTime,this._timeline.smoothChildTiming&&(this._startTime+=r._startTime/this._timeScale),this.shiftChildren(-r._startTime,!1,-9999999999),n=0),i=r._startTime+r._totalDuration/r._timeScale,i>s&&(s=i),r=e;this._duration=this._totalDuration=s,this._dirty=!1}return this._totalDuration}return 0!==this.totalDuration()&&0!==t&&this.timeScale(this._totalDuration/t),this},d.paused=function(e){if(!e)for(var i=this._first,s=this._time;i;)i._startTime===s&&"isPause"===i.data&&(i._rawPrevTime=0),i=i._next;return t.prototype.paused.apply(this,arguments)},d.usesFrames=function(){for(var e=this._timeline;e._timeline;)e=e._timeline;return e===t._rootFramesTimeline},d.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},s},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(t,e,i){var s=function(e){t.call(this,e),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},r=1e-10,n=e._internals,a=n.lazyTweens,o=n.lazyRender,h=new i(null,null,1,0),l=s.prototype=new t;return l.constructor=s,l.kill()._gc=!1,s.version="1.17.0",l.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),t.prototype.invalidate.call(this)},l.addCallback=function(t,i,s,r){return this.add(e.delayedCall(0,t,s,r),i)},l.removeCallback=function(t,e){if(t)if(null==e)this._kill(null,t);else for(var i=this.getTweensOf(t,!1),s=i.length,r=this._parseTimeOrLabel(e);--s>-1;)i[s]._startTime===r&&i[s]._enabled(!1,!1);return this},l.removePause=function(e){return this.removeCallback(t._internals.pauseCallback,e)},l.tweenTo=function(t,i){i=i||{};var s,r,n,a={ease:h,useFrames:this.usesFrames(),immediateRender:!1};for(r in i)a[r]=i[r];return a.time=this._parseTimeOrLabel(t),s=Math.abs(Number(a.time)-this._time)/this._timeScale||.001,n=new e(this,s,a),a.onStart=function(){n.target.paused(!0),n.vars.time!==n.target.time()&&s===n.duration()&&n.duration(Math.abs(n.vars.time-n.target.time())/n.target._timeScale),i.onStart&&n._callback("onStart")},n},l.tweenFromTo=function(t,e,i){i=i||{},t=this._parseTimeOrLabel(t),i.startAt={onComplete:this.seek,onCompleteParams:[t],callbackScope:this},i.immediateRender=i.immediateRender!==!1;var s=this.tweenTo(e,i);return s.duration(Math.abs(s.vars.time-t)/this._timeScale||.001)},l.render=function(t,e,i){this._gc&&this._enabled(!0,!1);var s,n,h,l,_,u,c=this._dirty?this.totalDuration():this._totalDuration,f=this._duration,p=this._time,m=this._totalTime,d=this._startTime,g=this._timeScale,v=this._rawPrevTime,y=this._paused,T=this._cycle;if(t>=c)this._locked||(this._totalTime=c,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(n=!0,l="onComplete",_=!!this._timeline.autoRemoveChildren,0===this._duration&&(0===t||0>v||v===r)&&v!==t&&this._first&&(_=!0,v>r&&(l="onReverseComplete"))),this._rawPrevTime=this._duration||!e||t||this._rawPrevTime===t?t:r,this._yoyo&&0!==(1&this._cycle)?this._time=t=0:(this._time=f,t=f+1e-4);else if(1e-7>t)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==p||0===f&&v!==r&&(v>0||0>t&&v>=0)&&!this._locked)&&(l="onReverseComplete",n=this._reversed),0>t)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(_=n=!0,l="onReverseComplete"):v>=0&&this._first&&(_=!0),this._rawPrevTime=t;else{if(this._rawPrevTime=f||!e||t||this._rawPrevTime===t?t:r,0===t&&n)for(s=this._first;s&&0===s._startTime;)s._duration||(n=!1),s=s._next;t=0,this._initted||(_=!0)}else 0===f&&0>v&&(_=!0),this._time=this._rawPrevTime=t,this._locked||(this._totalTime=t,0!==this._repeat&&(u=f+this._repeatDelay,this._cycle=this._totalTime/u>>0,0!==this._cycle&&this._cycle===this._totalTime/u&&this._cycle--,this._time=this._totalTime-this._cycle*u,this._yoyo&&0!==(1&this._cycle)&&(this._time=f-this._time),this._time>f?(this._time=f,t=f+1e-4):this._time<0?this._time=t=0:t=this._time));if(this._cycle!==T&&!this._locked){var x=this._yoyo&&0!==(1&T),w=x===(this._yoyo&&0!==(1&this._cycle)),b=this._totalTime,P=this._cycle,k=this._rawPrevTime,O=this._time;if(this._totalTime=T*f,this._cycle<T?x=!x:this._totalTime+=f,this._time=p,this._rawPrevTime=0===f?v-1e-4:v,this._cycle=T,this._locked=!0,p=x?0:f,this.render(p,e,0===f),e||this._gc||this.vars.onRepeat&&this._callback("onRepeat"),w&&(p=x?f+1e-4:-1e-4,this.render(p,!0,!1)),this._locked=!1,this._paused&&!y)return;this._time=O,this._totalTime=b,this._cycle=P,this._rawPrevTime=k}if(!(this._time!==p&&this._first||i||_))return void(m!==this._totalTime&&this._onUpdate&&(e||this._callback("onUpdate")));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==m&&t>0&&(this._active=!0),0===m&&this.vars.onStart&&0!==this._totalTime&&(e||this._callback("onStart")),this._time>=p)for(s=this._first;s&&(h=s._next,!this._paused||y);)(s._active||s._startTime<=this._time&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=h;else for(s=this._last;s&&(h=s._prev,!this._paused||y);)(s._active||s._startTime<=p&&!s._paused&&!s._gc)&&(s._reversed?s.render((s._dirty?s.totalDuration():s._totalDuration)-(t-s._startTime)*s._timeScale,e,i):s.render((t-s._startTime)*s._timeScale,e,i)),s=h;this._onUpdate&&(e||(a.length&&o(),this._callback("onUpdate"))),l&&(this._locked||this._gc||(d===this._startTime||g!==this._timeScale)&&(0===this._time||c>=this.totalDuration())&&(n&&(a.length&&o(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[l]&&this._callback(l)))},l.getActive=function(t,e,i){null==t&&(t=!0),null==e&&(e=!0),null==i&&(i=!1);var s,r,n=[],a=this.getChildren(t,e,i),o=0,h=a.length;for(s=0;h>s;s++)r=a[s],r.isActive()&&(n[o++]=r);return n},l.getLabelAfter=function(t){t||0!==t&&(t=this._time);var e,i=this.getLabelsArray(),s=i.length;for(e=0;s>e;e++)if(i[e].time>t)return i[e].name;return null},l.getLabelBefore=function(t){null==t&&(t=this._time);for(var e=this.getLabelsArray(),i=e.length;--i>-1;)if(e[i].time<t)return e[i].name;return null},l.getLabelsArray=function(){var t,e=[],i=0;for(t in this._labels)e[i++]={time:this._labels[t],name:t};return e.sort(function(t,e){return t.time-e.time}),e},l.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-t:t)+this._cycle*(this._duration+this._repeatDelay),e):this._time/this.duration()},l.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this._totalTime/this.totalDuration()},l.totalDuration=function(e){return arguments.length?-1===this._repeat?this:this.duration((e-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(t.prototype.totalDuration.call(this),this._totalDuration=-1===this._repeat?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},l.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),t>this._duration&&(t=this._duration),this._yoyo&&0!==(1&this._cycle)?t=this._duration-t+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(t+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(t,e)):this._time},l.repeat=function(t){return arguments.length?(this._repeat=t,this._uncache(!0)):this._repeat},l.repeatDelay=function(t){return arguments.length?(this._repeatDelay=t,this._uncache(!0)):this._repeatDelay},l.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},l.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.getLabelBefore(this._time+1e-8)},s},!0),function(){var t=180/Math.PI,e=[],i=[],s=[],r={},n=_gsScope._gsDefine.globals,a=function(t,e,i,s){this.a=t,this.b=e,this.c=i,this.d=s,this.da=s-t,this.ca=i-t,this.ba=e-t},o=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",h=function(t,e,i,s){var r={a:t},n={},a={},o={c:s},h=(t+e)/2,l=(e+i)/2,_=(i+s)/2,u=(h+l)/2,c=(l+_)/2,f=(c-u)/8;return r.b=h+(t-h)/4,n.b=u+f,r.c=n.a=(r.b+n.b)/2,n.c=a.a=(u+c)/2,a.b=c-f,o.b=_+(s-_)/4,a.c=o.a=(a.b+o.b)/2,[r,n,a,o]},l=function(t,r,n,a,o){var l,_,u,c,f,p,m,d,g,v,y,T,x,w=t.length-1,b=0,P=t[0].a;for(l=0;w>l;l++)f=t[b],_=f.a,u=f.d,c=t[b+1].d,o?(y=e[l],T=i[l],x=(T+y)*r*.25/(a?.5:s[l]||.5),p=u-(u-_)*(a?.5*r:0!==y?x/y:0),m=u+(c-u)*(a?.5*r:0!==T?x/T:0),d=u-(p+((m-p)*(3*y/(y+T)+.5)/4||0))):(p=u-(u-_)*r*.5,m=u+(c-u)*r*.5,d=u-(p+m)/2),p+=d,m+=d,f.c=g=p,0!==l?f.b=P:f.b=P=f.a+.6*(f.c-f.a),f.da=u-_,f.ca=g-_,f.ba=P-_,n?(v=h(_,P,g,u),t.splice(b,1,v[0],v[1],v[2],v[3]),b+=4):b++,P=m;f=t[b],f.b=P,f.c=P+.4*(f.d-P),f.da=f.d-f.a,f.ca=f.c-f.a,f.ba=P-f.a,n&&(v=h(f.a,P,f.c,f.d),t.splice(b,1,v[0],v[1],v[2],v[3]))},_=function(t,s,r,n){var o,h,l,_,u,c,f=[];if(n)for(t=[n].concat(t),h=t.length;--h>-1;)"string"==typeof(c=t[h][s])&&"="===c.charAt(1)&&(t[h][s]=n[s]+Number(c.charAt(0)+c.substr(2)));if(o=t.length-2,0>o)return f[0]=new a(t[0][s],0,0,t[-1>o?0:1][s]),f;for(h=0;o>h;h++)l=t[h][s],_=t[h+1][s],f[h]=new a(l,0,0,_),r&&(u=t[h+2][s],e[h]=(e[h]||0)+(_-l)*(_-l),i[h]=(i[h]||0)+(u-_)*(u-_));return f[h]=new a(t[h][s],0,0,t[h+1][s]),f},u=function(t,n,a,h,u,c){var f,p,m,d,g,v,y,T,x={},w=[],b=c||t[0];u="string"==typeof u?","+u+",":o,null==n&&(n=1);for(p in t[0])w.push(p);if(t.length>1){for(T=t[t.length-1],y=!0,f=w.length;--f>-1;)if(p=w[f],Math.abs(b[p]-T[p])>.05){y=!1;break}y&&(t=t.concat(),c&&t.unshift(c),t.push(t[1]),c=t[t.length-3])}for(e.length=i.length=s.length=0,f=w.length;--f>-1;)p=w[f],r[p]=-1!==u.indexOf(","+p+","),x[p]=_(t,p,r[p],c);for(f=e.length;--f>-1;)e[f]=Math.sqrt(e[f]),i[f]=Math.sqrt(i[f]);if(!h){for(f=w.length;--f>-1;)if(r[p])for(m=x[w[f]],v=m.length-1,d=0;v>d;d++)g=m[d+1].da/i[d]+m[d].da/e[d],s[d]=(s[d]||0)+g*g;for(f=s.length;--f>-1;)s[f]=Math.sqrt(s[f])}for(f=w.length,d=a?4:1;--f>-1;)p=w[f],m=x[p],l(m,n,a,h,r[p]),y&&(m.splice(0,d),m.splice(m.length-d,d));return x},c=function(t,e,i){e=e||"soft";var s,r,n,o,h,l,_,u,c,f,p,m={},d="cubic"===e?3:2,g="soft"===e,v=[];if(g&&i&&(t=[i].concat(t)),null==t||t.length<d+1)throw"invalid Bezier data";for(c in t[0])v.push(c);for(l=v.length;--l>-1;){for(c=v[l],m[c]=h=[],f=0,u=t.length,_=0;u>_;_++)s=null==i?t[_][c]:"string"==typeof(p=t[_][c])&&"="===p.charAt(1)?i[c]+Number(p.charAt(0)+p.substr(2)):Number(p),g&&_>1&&u-1>_&&(h[f++]=(s+h[f-2])/2),h[f++]=s;for(u=f-d+1,f=0,_=0;u>_;_+=d)s=h[_],r=h[_+1],n=h[_+2],o=2===d?0:h[_+3],h[f++]=p=3===d?new a(s,r,n,o):new a(s,(2*r+s)/3,(2*r+n)/3,n);h.length=f}return m},f=function(t,e,i){for(var s,r,n,a,o,h,l,_,u,c,f,p=1/i,m=t.length;--m>-1;)for(c=t[m],n=c.a,a=c.d-n,o=c.c-n,h=c.b-n,s=r=0,_=1;i>=_;_++)l=p*_,u=1-l,s=r-(r=(l*l*a+3*u*(l*o+u*h))*l),f=m*i+_-1,e[f]=(e[f]||0)+s*s},p=function(t,e){e=e>>0||6;var i,s,r,n,a=[],o=[],h=0,l=0,_=e-1,u=[],c=[];for(i in t)f(t[i],a,e);for(r=a.length,s=0;r>s;s++)h+=Math.sqrt(a[s]),n=s%e,c[n]=h,n===_&&(l+=h,n=s/e>>0,u[n]=c,o[n]=l,h=0,c=[]);return{length:l,lengths:o,segments:u}},m=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.4",API:2,global:!0,init:function(t,e,i){this._target=t,e instanceof Array&&(e={values:e}),this._func={},this._round={},this._props=[],this._timeRes=null==e.timeResolution?6:parseInt(e.timeResolution,10);var s,r,n,a,o,h=e.values||[],l={},_=h[0],f=e.autoRotate||i.vars.orientToBezier;this._autoRotate=f?f instanceof Array?f:[["x","y","rotation",f===!0?0:Number(f)||0]]:null;for(s in _)this._props.push(s);for(n=this._props.length;--n>-1;)s=this._props[n],this._overwriteProps.push(s),r=this._func[s]="function"==typeof t[s],l[s]=r?t[s.indexOf("set")||"function"!=typeof t["get"+s.substr(3)]?s:"get"+s.substr(3)]():parseFloat(t[s]),o||l[s]!==h[0][s]&&(o=l);if(this._beziers="cubic"!==e.type&&"quadratic"!==e.type&&"soft"!==e.type?u(h,isNaN(e.curviness)?1:e.curviness,!1,"thruBasic"===e.type,e.correlate,o):c(h,e.type,l),this._segCount=this._beziers[s].length,this._timeRes){var m=p(this._beziers,this._timeRes);this._length=m.length,this._lengths=m.lengths,this._segments=m.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(f=this._autoRotate)for(this._initialRotations=[],f[0]instanceof Array||(this._autoRotate=f=[f]),n=f.length;--n>-1;){for(a=0;3>a;a++)s=f[n][a],this._func[s]="function"==typeof t[s]?t[s.indexOf("set")||"function"!=typeof t["get"+s.substr(3)]?s:"get"+s.substr(3)]:!1;s=f[n][2],this._initialRotations[n]=this._func[s]?this._func[s].call(this._target):this._target[s]}return this._startRatio=i.vars.runBackwards?1:0,!0},set:function(e){var i,s,r,n,a,o,h,l,_,u,c=this._segCount,f=this._func,p=this._target,m=e!==this._startRatio;if(this._timeRes){if(_=this._lengths,u=this._curSeg,e*=this._length,r=this._li,e>this._l2&&c-1>r){for(l=c-1;l>r&&(this._l2=_[++r])<=e;);this._l1=_[r-1],this._li=r,this._curSeg=u=this._segments[r],this._s2=u[this._s1=this._si=0];
}else if(e<this._l1&&r>0){for(;r>0&&(this._l1=_[--r])>=e;);0===r&&e<this._l1?this._l1=0:r++,this._l2=_[r],this._li=r,this._curSeg=u=this._segments[r],this._s1=u[(this._si=u.length-1)-1]||0,this._s2=u[this._si]}if(i=r,e-=this._l1,r=this._si,e>this._s2&&r<u.length-1){for(l=u.length-1;l>r&&(this._s2=u[++r])<=e;);this._s1=u[r-1],this._si=r}else if(e<this._s1&&r>0){for(;r>0&&(this._s1=u[--r])>=e;);0===r&&e<this._s1?this._s1=0:r++,this._s2=u[r],this._si=r}o=(r+(e-this._s1)/(this._s2-this._s1))*this._prec}else i=0>e?0:e>=1?c-1:c*e>>0,o=(e-i*(1/c))*c;for(s=1-o,r=this._props.length;--r>-1;)n=this._props[r],a=this._beziers[n][i],h=(o*o*a.da+3*s*(o*a.ca+s*a.ba))*o+a.a,this._round[n]&&(h=Math.round(h)),f[n]?p[n](h):p[n]=h;if(this._autoRotate){var d,g,v,y,T,x,w,b=this._autoRotate;for(r=b.length;--r>-1;)n=b[r][2],x=b[r][3]||0,w=b[r][4]===!0?1:t,a=this._beziers[b[r][0]],d=this._beziers[b[r][1]],a&&d&&(a=a[i],d=d[i],g=a.a+(a.b-a.a)*o,y=a.b+(a.c-a.b)*o,g+=(y-g)*o,y+=(a.c+(a.d-a.c)*o-y)*o,v=d.a+(d.b-d.a)*o,T=d.b+(d.c-d.b)*o,v+=(T-v)*o,T+=(d.c+(d.d-d.c)*o-T)*o,h=m?Math.atan2(T-v,y-g)*w+x:this._initialRotations[r],f[n]?p[n](h):p[n]=h)}}}),d=m.prototype;m.bezierThrough=u,m.cubicToQuadratic=h,m._autoCSS=!0,m.quadraticToCubic=function(t,e,i){return new a(t,(2*e+t)/3,(2*e+i)/3,i)},m._cssRegister=function(){var t=n.CSSPlugin;if(t){var e=t._internals,i=e._parseToProxy,s=e._setPluginRatio,r=e.CSSPropTween;e._registerComplexSpecialProp("bezier",{parser:function(t,e,n,a,o,h){e instanceof Array&&(e={values:e}),h=new m;var l,_,u,c=e.values,f=c.length-1,p=[],d={};if(0>f)return o;for(l=0;f>=l;l++)u=i(t,c[l],a,o,h,f!==l),p[l]=u.end;for(_ in e)d[_]=e[_];return d.values=p,o=new r(t,"bezier",0,0,u.pt,2),o.data=u,o.plugin=h,o.setRatio=s,0===d.autoRotate&&(d.autoRotate=!0),!d.autoRotate||d.autoRotate instanceof Array||(l=d.autoRotate===!0?0:Number(d.autoRotate),d.autoRotate=null!=u.end.left?[["left","top","rotation",l,!1]]:null!=u.end.x?[["x","y","rotation",l,!1]]:!1),d.autoRotate&&(a._transform||a._enableTransforms(!1),u.autoRotate=a._target._gsTransform),h._onInitTween(u.proxy,d,a._tween),o}})}},d._roundProps=function(t,e){for(var i=this._overwriteProps,s=i.length;--s>-1;)(t[i[s]]||t.bezier||t.bezierThrough)&&(this._round[i[s]]=e)},d._kill=function(t){var e,i,s=this._props;for(e in this._beziers)if(e in t)for(delete this._beziers[e],delete this._func[e],i=s.length;--i>-1;)s[i]===e&&s.splice(i,1);return this._super._kill.call(this,t)}}(),_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(t,e){var i,s,r,n,a=function(){t.call(this,"css"),this._overwriteProps.length=0,this.setRatio=a.prototype.setRatio},o=_gsScope._gsDefine.globals,h={},l=a.prototype=new t("css");l.constructor=a,a.version="1.17.0",a.API=2,a.defaultTransformPerspective=0,a.defaultSkewType="compensated",a.defaultSmoothOrigin=!0,l="px",a.suffixMap={top:l,right:l,bottom:l,left:l,width:l,height:l,fontSize:l,padding:l,margin:l,perspective:l,lineHeight:""};var _,u,c,f,p,m,d=/(?:\d|\-\d|\.\d|\-\.\d)+/g,g=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,v=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,y=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,T=/(?:\d|\-|\+|=|#|\.)*/g,x=/opacity *= *([^)]*)/i,w=/opacity:([^;]*)/i,b=/alpha\(opacity *=.+?\)/i,P=/^(rgb|hsl)/,k=/([A-Z])/g,O=/-([a-z])/gi,S=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,R=function(t,e){return e.toUpperCase()},A=/(?:Left|Right|Width)/i,C=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,D=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,M=/,(?=[^\)]*(?:\(|$))/gi,z=Math.PI/180,F=180/Math.PI,I={},N=document,X=function(t){return N.createElementNS?N.createElementNS("http://www.w3.org/1999/xhtml",t):N.createElement(t)},L=X("div"),E=X("img"),Y=a._internals={_specialProps:h},B=navigator.userAgent,j=function(){var t=B.indexOf("Android"),e=X("a");return c=-1!==B.indexOf("Safari")&&-1===B.indexOf("Chrome")&&(-1===t||Number(B.substr(t+8,1))>3),p=c&&Number(B.substr(B.indexOf("Version/")+8,1))<6,f=-1!==B.indexOf("Firefox"),(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(B)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(B))&&(m=parseFloat(RegExp.$1)),e?(e.style.cssText="top:1px;opacity:.55;",/^0.55/.test(e.style.opacity)):!1}(),U=function(t){return x.test("string"==typeof t?t:(t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100:1},V=function(t){window.console&&console.log(t)},q="",W="",Z=function(t,e){e=e||L;var i,s,r=e.style;if(void 0!==r[t])return t;for(t=t.charAt(0).toUpperCase()+t.substr(1),i=["O","Moz","ms","Ms","Webkit"],s=5;--s>-1&&void 0===r[i[s]+t];);return s>=0?(W=3===s?"ms":i[s],q="-"+W.toLowerCase()+"-",W+t):null},G=N.defaultView?N.defaultView.getComputedStyle:function(){},$=a.getStyle=function(t,e,i,s,r){var n;return j||"opacity"!==e?(!s&&t.style[e]?n=t.style[e]:(i=i||G(t))?n=i[e]||i.getPropertyValue(e)||i.getPropertyValue(e.replace(k,"-$1").toLowerCase()):t.currentStyle&&(n=t.currentStyle[e]),null==r||n&&"none"!==n&&"auto"!==n&&"auto auto"!==n?n:r):U(t)},Q=Y.convertToPixels=function(t,i,s,r,n){if("px"===r||!r)return s;if("auto"===r||!s)return 0;var o,h,l,_=A.test(i),u=t,c=L.style,f=0>s;if(f&&(s=-s),"%"===r&&-1!==i.indexOf("border"))o=s/100*(_?t.clientWidth:t.clientHeight);else{if(c.cssText="border:0 solid red;position:"+$(t,"position")+";line-height:0;","%"!==r&&u.appendChild)c[_?"borderLeftWidth":"borderTopWidth"]=s+r;else{if(u=t.parentNode||N.body,h=u._gsCache,l=e.ticker.frame,h&&_&&h.time===l)return h.width*s/100;c[_?"width":"height"]=s+r}u.appendChild(L),o=parseFloat(L[_?"offsetWidth":"offsetHeight"]),u.removeChild(L),_&&"%"===r&&a.cacheWidths!==!1&&(h=u._gsCache=u._gsCache||{},h.time=l,h.width=o/s*100),0!==o||n||(o=Q(t,i,s,r,!0))}return f?-o:o},H=Y.calculateOffset=function(t,e,i){if("absolute"!==$(t,"position",i))return 0;var s="left"===e?"Left":"Top",r=$(t,"margin"+s,i);return t["offset"+s]-(Q(t,e,parseFloat(r),r.replace(T,""))||0)},K=function(t,e){var i,s,r,n={};if(e=e||G(t,null))if(i=e.length)for(;--i>-1;)r=e[i],(-1===r.indexOf("-transform")||Pt===r)&&(n[r.replace(O,R)]=e.getPropertyValue(r));else for(i in e)(-1===i.indexOf("Transform")||bt===i)&&(n[i]=e[i]);else if(e=t.currentStyle||t.style)for(i in e)"string"==typeof i&&void 0===n[i]&&(n[i.replace(O,R)]=e[i]);return j||(n.opacity=U(t)),s=Nt(t,e,!1),n.rotation=s.rotation,n.skewX=s.skewX,n.scaleX=s.scaleX,n.scaleY=s.scaleY,n.x=s.x,n.y=s.y,Ot&&(n.z=s.z,n.rotationX=s.rotationX,n.rotationY=s.rotationY,n.scaleZ=s.scaleZ),n.filters&&delete n.filters,n},J=function(t,e,i,s,r){var n,a,o,h={},l=t.style;for(a in i)"cssText"!==a&&"length"!==a&&isNaN(a)&&(e[a]!==(n=i[a])||r&&r[a])&&-1===a.indexOf("Origin")&&("number"==typeof n||"string"==typeof n)&&(h[a]="auto"!==n||"left"!==a&&"top"!==a?""!==n&&"auto"!==n&&"none"!==n||"string"!=typeof e[a]||""===e[a].replace(y,"")?n:0:H(t,a),void 0!==l[a]&&(o=new ft(l,a,l[a],o)));if(s)for(a in s)"className"!==a&&(h[a]=s[a]);return{difs:h,firstMPT:o}},tt={width:["Left","Right"],height:["Top","Bottom"]},et=["marginLeft","marginRight","marginTop","marginBottom"],it=function(t,e,i){var s=parseFloat("width"===e?t.offsetWidth:t.offsetHeight),r=tt[e],n=r.length;for(i=i||G(t,null);--n>-1;)s-=parseFloat($(t,"padding"+r[n],i,!0))||0,s-=parseFloat($(t,"border"+r[n]+"Width",i,!0))||0;return s},st=function(t,e){(null==t||""===t||"auto"===t||"auto auto"===t)&&(t="0 0");var i=t.split(" "),s=-1!==t.indexOf("left")?"0%":-1!==t.indexOf("right")?"100%":i[0],r=-1!==t.indexOf("top")?"0%":-1!==t.indexOf("bottom")?"100%":i[1];return null==r?r="center"===s?"50%":"0":"center"===r&&(r="50%"),("center"===s||isNaN(parseFloat(s))&&-1===(s+"").indexOf("="))&&(s="50%"),t=s+" "+r+(i.length>2?" "+i[2]:""),e&&(e.oxp=-1!==s.indexOf("%"),e.oyp=-1!==r.indexOf("%"),e.oxr="="===s.charAt(1),e.oyr="="===r.charAt(1),e.ox=parseFloat(s.replace(y,"")),e.oy=parseFloat(r.replace(y,"")),e.v=t),e||t},rt=function(t,e){return"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2)):parseFloat(t)-parseFloat(e)},nt=function(t,e){return null==t?e:"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2))+e:parseFloat(t)},at=function(t,e,i,s){var r,n,a,o,h,l=1e-6;return null==t?o=e:"number"==typeof t?o=t:(r=360,n=t.split("_"),h="="===t.charAt(1),a=(h?parseInt(t.charAt(0)+"1",10)*parseFloat(n[0].substr(2)):parseFloat(n[0]))*(-1===t.indexOf("rad")?1:F)-(h?0:e),n.length&&(s&&(s[i]=e+a),-1!==t.indexOf("short")&&(a%=r,a!==a%(r/2)&&(a=0>a?a+r:a-r)),-1!==t.indexOf("_cw")&&0>a?a=(a+9999999999*r)%r-(a/r|0)*r:-1!==t.indexOf("ccw")&&a>0&&(a=(a-9999999999*r)%r-(a/r|0)*r)),o=e+a),l>o&&o>-l&&(o=0),o},ot={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},ht=function(t,e,i){return t=0>t?t+1:t>1?t-1:t,255*(1>6*t?e+(i-e)*t*6:.5>t?i:2>3*t?e+(i-e)*(2/3-t)*6:e)+.5|0},lt=a.parseColor=function(t){var e,i,s,r,n,a;return t&&""!==t?"number"==typeof t?[t>>16,t>>8&255,255&t]:(","===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),ot[t]?ot[t]:"#"===t.charAt(0)?(4===t.length&&(e=t.charAt(1),i=t.charAt(2),s=t.charAt(3),t="#"+e+e+i+i+s+s),t=parseInt(t.substr(1),16),[t>>16,t>>8&255,255&t]):"hsl"===t.substr(0,3)?(t=t.match(d),r=Number(t[0])%360/360,n=Number(t[1])/100,a=Number(t[2])/100,i=.5>=a?a*(n+1):a+n-a*n,e=2*a-i,t.length>3&&(t[3]=Number(t[3])),t[0]=ht(r+1/3,e,i),t[1]=ht(r,e,i),t[2]=ht(r-1/3,e,i),t):(t=t.match(d)||ot.transparent,t[0]=Number(t[0]),t[1]=Number(t[1]),t[2]=Number(t[2]),t.length>3&&(t[3]=Number(t[3])),t)):ot.black},_t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(l in ot)_t+="|"+l+"\\b";_t=new RegExp(_t+")","gi");var ut=function(t,e,i,s){if(null==t)return function(t){return t};var r,n=e?(t.match(_t)||[""])[0]:"",a=t.split(n).join("").match(v)||[],o=t.substr(0,t.indexOf(a[0])),h=")"===t.charAt(t.length-1)?")":"",l=-1!==t.indexOf(" ")?" ":",",_=a.length,u=_>0?a[0].replace(d,""):"";return _?r=e?function(t){var e,c,f,p;if("number"==typeof t)t+=u;else if(s&&M.test(t)){for(p=t.replace(M,"|").split("|"),f=0;f<p.length;f++)p[f]=r(p[f]);return p.join(",")}if(e=(t.match(_t)||[n])[0],c=t.split(e).join("").match(v)||[],f=c.length,_>f--)for(;++f<_;)c[f]=i?c[(f-1)/2|0]:a[f];return o+c.join(l)+l+e+h+(-1!==t.indexOf("inset")?" inset":"")}:function(t){var e,n,c;if("number"==typeof t)t+=u;else if(s&&M.test(t)){for(n=t.replace(M,"|").split("|"),c=0;c<n.length;c++)n[c]=r(n[c]);return n.join(",")}if(e=t.match(v)||[],c=e.length,_>c--)for(;++c<_;)e[c]=i?e[(c-1)/2|0]:a[c];return o+e.join(l)+h}:function(t){return t}},ct=function(t){return t=t.split(","),function(e,i,s,r,n,a,o){var h,l=(i+"").split(" ");for(o={},h=0;4>h;h++)o[t[h]]=l[h]=l[h]||l[(h-1)/2>>0];return r.parse(e,o,n,a)}},ft=(Y._setPluginRatio=function(t){this.plugin.setRatio(t);for(var e,i,s,r,n=this.data,a=n.proxy,o=n.firstMPT,h=1e-6;o;)e=a[o.v],o.r?e=Math.round(e):h>e&&e>-h&&(e=0),o.t[o.p]=e,o=o._next;if(n.autoRotate&&(n.autoRotate.rotation=a.rotation),1===t)for(o=n.firstMPT;o;){if(i=o.t,i.type){if(1===i.type){for(r=i.xs0+i.s+i.xs1,s=1;s<i.l;s++)r+=i["xn"+s]+i["xs"+(s+1)];i.e=r}}else i.e=i.s+i.xs0;o=o._next}},function(t,e,i,s,r){this.t=t,this.p=e,this.v=i,this.r=r,s&&(s._prev=this,this._next=s)}),pt=(Y._parseToProxy=function(t,e,i,s,r,n){var a,o,h,l,_,u=s,c={},f={},p=i._transform,m=I;for(i._transform=null,I=e,s=_=i.parse(t,e,s,r),I=m,n&&(i._transform=p,u&&(u._prev=null,u._prev&&(u._prev._next=null)));s&&s!==u;){if(s.type<=1&&(o=s.p,f[o]=s.s+s.c,c[o]=s.s,n||(l=new ft(s,"s",o,l,s.r),s.c=0),1===s.type))for(a=s.l;--a>0;)h="xn"+a,o=s.p+"_"+h,f[o]=s.data[h],c[o]=s[h],n||(l=new ft(s,h,o,l,s.rxp[h]));s=s._next}return{proxy:c,end:f,firstMPT:l,pt:_}},Y.CSSPropTween=function(t,e,s,r,a,o,h,l,_,u,c){this.t=t,this.p=e,this.s=s,this.c=r,this.n=h||e,t instanceof pt||n.push(this.n),this.r=l,this.type=o||0,_&&(this.pr=_,i=!0),this.b=void 0===u?s:u,this.e=void 0===c?s+r:c,a&&(this._next=a,a._prev=this)}),mt=function(t,e,i,s,r,n){var a=new pt(t,e,i,s-i,r,-1,n);return a.b=i,a.e=a.xs0=s,a},dt=a.parseComplex=function(t,e,i,s,r,n,a,o,h,l){i=i||n||"",a=new pt(t,e,0,0,a,l?2:1,null,!1,o,i,s),s+="";var u,c,f,p,m,v,y,T,x,w,b,k,O=i.split(", ").join(",").split(" "),S=s.split(", ").join(",").split(" "),R=O.length,A=_!==!1;for((-1!==s.indexOf(",")||-1!==i.indexOf(","))&&(O=O.join(" ").replace(M,", ").split(" "),S=S.join(" ").replace(M,", ").split(" "),R=O.length),R!==S.length&&(O=(n||"").split(" "),R=O.length),a.plugin=h,a.setRatio=l,u=0;R>u;u++)if(p=O[u],m=S[u],T=parseFloat(p),T||0===T)a.appendXtra("",T,rt(m,T),m.replace(g,""),A&&-1!==m.indexOf("px"),!0);else if(r&&("#"===p.charAt(0)||ot[p]||P.test(p)))k=","===m.charAt(m.length-1)?"),":")",p=lt(p),m=lt(m),x=p.length+m.length>6,x&&!j&&0===m[3]?(a["xs"+a.l]+=a.l?" transparent":"transparent",a.e=a.e.split(S[u]).join("transparent")):(j||(x=!1),a.appendXtra(x?"rgba(":"rgb(",p[0],m[0]-p[0],",",!0,!0).appendXtra("",p[1],m[1]-p[1],",",!0).appendXtra("",p[2],m[2]-p[2],x?",":k,!0),x&&(p=p.length<4?1:p[3],a.appendXtra("",p,(m.length<4?1:m[3])-p,k,!1)));else if(v=p.match(d)){if(y=m.match(g),!y||y.length!==v.length)return a;for(f=0,c=0;c<v.length;c++)b=v[c],w=p.indexOf(b,f),a.appendXtra(p.substr(f,w-f),Number(b),rt(y[c],b),"",A&&"px"===p.substr(w+b.length,2),0===c),f=w+b.length;a["xs"+a.l]+=p.substr(f)}else a["xs"+a.l]+=a.l?" "+p:p;if(-1!==s.indexOf("=")&&a.data){for(k=a.xs0+a.data.s,u=1;u<a.l;u++)k+=a["xs"+u]+a.data["xn"+u];a.e=k+a["xs"+u]}return a.l||(a.type=-1,a.xs0=a.e),a.xfirst||a},gt=9;for(l=pt.prototype,l.l=l.pr=0;--gt>0;)l["xn"+gt]=0,l["xs"+gt]="";l.xs0="",l._next=l._prev=l.xfirst=l.data=l.plugin=l.setRatio=l.rxp=null,l.appendXtra=function(t,e,i,s,r,n){var a=this,o=a.l;return a["xs"+o]+=n&&o?" "+t:t||"",i||0===o||a.plugin?(a.l++,a.type=a.setRatio?2:1,a["xs"+a.l]=s||"",o>0?(a.data["xn"+o]=e+i,a.rxp["xn"+o]=r,a["xn"+o]=e,a.plugin||(a.xfirst=new pt(a,"xn"+o,e,i,a.xfirst||a,0,a.n,r,a.pr),a.xfirst.xs0=0),a):(a.data={s:e+i},a.rxp={},a.s=e,a.c=i,a.r=r,a)):(a["xs"+o]+=e+(s||""),a)};var vt=function(t,e){e=e||{},this.p=e.prefix?Z(t)||t:t,h[t]=h[this.p]=this,this.format=e.formatter||ut(e.defaultValue,e.color,e.collapsible,e.multi),e.parser&&(this.parse=e.parser),this.clrs=e.color,this.multi=e.multi,this.keyword=e.keyword,this.dflt=e.defaultValue,this.pr=e.priority||0},yt=Y._registerComplexSpecialProp=function(t,e,i){"object"!=typeof e&&(e={parser:i});var s,r,n=t.split(","),a=e.defaultValue;for(i=i||[a],s=0;s<n.length;s++)e.prefix=0===s&&e.prefix,e.defaultValue=i[s]||a,r=new vt(n[s],e)},Tt=function(t){if(!h[t]){var e=t.charAt(0).toUpperCase()+t.substr(1)+"Plugin";yt(t,{parser:function(t,i,s,r,n,a,l){var _=o.com.greensock.plugins[e];return _?(_._cssRegister(),h[s].parse(t,i,s,r,n,a,l)):(V("Error: "+e+" js file not loaded."),n)}})}};l=vt.prototype,l.parseComplex=function(t,e,i,s,r,n){var a,o,h,l,_,u,c=this.keyword;if(this.multi&&(M.test(i)||M.test(e)?(o=e.replace(M,"|").split("|"),h=i.replace(M,"|").split("|")):c&&(o=[e],h=[i])),h){for(l=h.length>o.length?h.length:o.length,a=0;l>a;a++)e=o[a]=o[a]||this.dflt,i=h[a]=h[a]||this.dflt,c&&(_=e.indexOf(c),u=i.indexOf(c),_!==u&&(-1===u?o[a]=o[a].split(c).join(""):-1===_&&(o[a]+=" "+c)));e=o.join(", "),i=h.join(", ")}return dt(t,this.p,e,i,this.clrs,this.dflt,s,this.pr,r,n)},l.parse=function(t,e,i,s,n,a,o){return this.parseComplex(t.style,this.format($(t,this.p,r,!1,this.dflt)),this.format(e),n,a)},a.registerSpecialProp=function(t,e,i){yt(t,{parser:function(t,s,r,n,a,o,h){var l=new pt(t,r,0,0,a,2,r,!1,i);return l.plugin=o,l.setRatio=e(t,s,n._tween,r),l},priority:i})},a.useSVGTransformAttr=c||f;var xt,wt="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),bt=Z("transform"),Pt=q+"transform",kt=Z("transformOrigin"),Ot=null!==Z("perspective"),St=Y.Transform=function(){this.perspective=parseFloat(a.defaultTransformPerspective)||0,this.force3D=a.defaultForce3D!==!1&&Ot?a.defaultForce3D||"auto":!1},Rt=window.SVGElement,At=function(t,e,i){var s,r=N.createElementNS("http://www.w3.org/2000/svg",t),n=/([a-z])([A-Z])/g;for(s in i)r.setAttributeNS(null,s.replace(n,"$1-$2").toLowerCase(),i[s]);return e.appendChild(r),r},Ct=N.documentElement,Dt=function(){var t,e,i,s=m||/Android/i.test(B)&&!window.chrome;return N.createElementNS&&!s&&(t=At("svg",Ct),e=At("rect",t,{width:100,height:50,x:100}),i=e.getBoundingClientRect().width,e.style[kt]="50% 50%",e.style[bt]="scaleX(0.5)",s=i===e.getBoundingClientRect().width&&!(f&&Ot),Ct.removeChild(t)),s}(),Mt=function(t,e,i,s,r){var n,o,h,l,_,u,c,f,p,m,d,g,v,y,T=t._gsTransform,x=It(t,!0);T&&(v=T.xOrigin,y=T.yOrigin),(!s||(n=s.split(" ")).length<2)&&(c=t.getBBox(),e=st(e).split(" "),n=[(-1!==e[0].indexOf("%")?parseFloat(e[0])/100*c.width:parseFloat(e[0]))+c.x,(-1!==e[1].indexOf("%")?parseFloat(e[1])/100*c.height:parseFloat(e[1]))+c.y]),i.xOrigin=l=parseFloat(n[0]),i.yOrigin=_=parseFloat(n[1]),s&&x!==Ft&&(u=x[0],c=x[1],f=x[2],p=x[3],m=x[4],d=x[5],g=u*p-c*f,o=l*(p/g)+_*(-f/g)+(f*d-p*m)/g,h=l*(-c/g)+_*(u/g)-(u*d-c*m)/g,l=i.xOrigin=n[0]=o,_=i.yOrigin=n[1]=h),T&&(r||r!==!1&&a.defaultSmoothOrigin!==!1?(o=l-v,h=_-y,T.xOffset+=o*x[0]+h*x[2]-o,T.yOffset+=o*x[1]+h*x[3]-h):T.xOffset=T.yOffset=0),t.setAttribute("data-svg-origin",n.join(" "))},zt=function(t){return!!(Rt&&"function"==typeof t.getBBox&&t.getCTM&&(!t.parentNode||t.parentNode.getBBox&&t.parentNode.getCTM))},Ft=[1,0,0,1,0,0],It=function(t,e){var i,s,r,n,a,o=t._gsTransform||new St,h=1e5;if(bt?s=$(t,Pt,null,!0):t.currentStyle&&(s=t.currentStyle.filter.match(C),s=s&&4===s.length?[s[0].substr(4),Number(s[2].substr(4)),Number(s[1].substr(4)),s[3].substr(4),o.x||0,o.y||0].join(","):""),i=!s||"none"===s||"matrix(1, 0, 0, 1, 0, 0)"===s,(o.svg||t.getBBox&&zt(t))&&(i&&-1!==(t.style[bt]+"").indexOf("matrix")&&(s=t.style[bt],i=0),r=t.getAttribute("transform"),i&&r&&(-1!==r.indexOf("matrix")?(s=r,i=0):-1!==r.indexOf("translate")&&(s="matrix(1,0,0,1,"+r.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",")+")",i=0))),i)return Ft;for(r=(s||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],gt=r.length;--gt>-1;)n=Number(r[gt]),r[gt]=(a=n-(n|=0))?(a*h+(0>a?-.5:.5)|0)/h+n:n;return e&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r},Nt=Y.getTransform=function(t,i,s,n){if(t._gsTransform&&s&&!n)return t._gsTransform;var o,h,l,_,u,c,f=s?t._gsTransform||new St:new St,p=f.scaleX<0,m=2e-5,d=1e5,g=Ot?parseFloat($(t,kt,i,!1,"0 0 0").split(" ")[2])||f.zOrigin||0:0,v=parseFloat(a.defaultTransformPerspective)||0;if(f.svg=!(!t.getBBox||!zt(t)),f.svg&&(Mt(t,$(t,kt,r,!1,"50% 50%")+"",f,t.getAttribute("data-svg-origin")),xt=a.useSVGTransformAttr||Dt),o=It(t),o!==Ft){if(16===o.length){var y,T,x,w,b,P=o[0],k=o[1],O=o[2],S=o[3],R=o[4],A=o[5],C=o[6],D=o[7],M=o[8],z=o[9],I=o[10],N=o[12],X=o[13],L=o[14],E=o[11],Y=Math.atan2(C,I);f.zOrigin&&(L=-f.zOrigin,N=M*L-o[12],X=z*L-o[13],L=I*L+f.zOrigin-o[14]),f.rotationX=Y*F,Y&&(w=Math.cos(-Y),b=Math.sin(-Y),y=R*w+M*b,T=A*w+z*b,x=C*w+I*b,M=R*-b+M*w,z=A*-b+z*w,I=C*-b+I*w,E=D*-b+E*w,R=y,A=T,C=x),Y=Math.atan2(M,I),f.rotationY=Y*F,Y&&(w=Math.cos(-Y),b=Math.sin(-Y),y=P*w-M*b,T=k*w-z*b,x=O*w-I*b,z=k*b+z*w,I=O*b+I*w,E=S*b+E*w,P=y,k=T,O=x),Y=Math.atan2(k,P),f.rotation=Y*F,Y&&(w=Math.cos(-Y),b=Math.sin(-Y),P=P*w+R*b,T=k*w+A*b,A=k*-b+A*w,C=O*-b+C*w,k=T),f.rotationX&&Math.abs(f.rotationX)+Math.abs(f.rotation)>359.9&&(f.rotationX=f.rotation=0,f.rotationY+=180),f.scaleX=(Math.sqrt(P*P+k*k)*d+.5|0)/d,f.scaleY=(Math.sqrt(A*A+z*z)*d+.5|0)/d,f.scaleZ=(Math.sqrt(C*C+I*I)*d+.5|0)/d,f.skewX=0,f.perspective=E?1/(0>E?-E:E):0,f.x=N,f.y=X,f.z=L,f.svg&&(f.x-=f.xOrigin-(f.xOrigin*P-f.yOrigin*R),f.y-=f.yOrigin-(f.yOrigin*k-f.xOrigin*A))}else if((!Ot||n||!o.length||f.x!==o[4]||f.y!==o[5]||!f.rotationX&&!f.rotationY)&&(void 0===f.x||"none"!==$(t,"display",i))){var B=o.length>=6,j=B?o[0]:1,U=o[1]||0,V=o[2]||0,q=B?o[3]:1;f.x=o[4]||0,f.y=o[5]||0,l=Math.sqrt(j*j+U*U),_=Math.sqrt(q*q+V*V),u=j||U?Math.atan2(U,j)*F:f.rotation||0,c=V||q?Math.atan2(V,q)*F+u:f.skewX||0,Math.abs(c)>90&&Math.abs(c)<270&&(p?(l*=-1,c+=0>=u?180:-180,u+=0>=u?180:-180):(_*=-1,c+=0>=c?180:-180)),f.scaleX=l,f.scaleY=_,f.rotation=u,f.skewX=c,Ot&&(f.rotationX=f.rotationY=f.z=0,f.perspective=v,f.scaleZ=1),f.svg&&(f.x-=f.xOrigin-(f.xOrigin*j+f.yOrigin*V),f.y-=f.yOrigin-(f.xOrigin*U+f.yOrigin*q))}f.zOrigin=g;for(h in f)f[h]<m&&f[h]>-m&&(f[h]=0)}return s&&(t._gsTransform=f,f.svg&&(xt&&t.style[bt]?e.delayedCall(.001,function(){Yt(t.style,bt)}):!xt&&t.getAttribute("transform")&&e.delayedCall(.001,function(){t.removeAttribute("transform")}))),f},Xt=function(t){var e,i,s=this.data,r=-s.rotation*z,n=r+s.skewX*z,a=1e5,o=(Math.cos(r)*s.scaleX*a|0)/a,h=(Math.sin(r)*s.scaleX*a|0)/a,l=(Math.sin(n)*-s.scaleY*a|0)/a,_=(Math.cos(n)*s.scaleY*a|0)/a,u=this.t.style,c=this.t.currentStyle;if(c){i=h,h=-l,l=-i,e=c.filter,u.filter="";var f,p,d=this.t.offsetWidth,g=this.t.offsetHeight,v="absolute"!==c.position,y="progid:DXImageTransform.Microsoft.Matrix(M11="+o+", M12="+h+", M21="+l+", M22="+_,w=s.x+d*s.xPercent/100,b=s.y+g*s.yPercent/100;if(null!=s.ox&&(f=(s.oxp?d*s.ox*.01:s.ox)-d/2,p=(s.oyp?g*s.oy*.01:s.oy)-g/2,w+=f-(f*o+p*h),b+=p-(f*l+p*_)),v?(f=d/2,p=g/2,y+=", Dx="+(f-(f*o+p*h)+w)+", Dy="+(p-(f*l+p*_)+b)+")"):y+=", sizingMethod='auto expand')",-1!==e.indexOf("DXImageTransform.Microsoft.Matrix(")?u.filter=e.replace(D,y):u.filter=y+" "+e,(0===t||1===t)&&1===o&&0===h&&0===l&&1===_&&(v&&-1===y.indexOf("Dx=0, Dy=0")||x.test(e)&&100!==parseFloat(RegExp.$1)||-1===e.indexOf(e.indexOf("Alpha"))&&u.removeAttribute("filter")),!v){var P,k,O,S=8>m?1:-1;for(f=s.ieOffsetX||0,p=s.ieOffsetY||0,s.ieOffsetX=Math.round((d-((0>o?-o:o)*d+(0>h?-h:h)*g))/2+w),s.ieOffsetY=Math.round((g-((0>_?-_:_)*g+(0>l?-l:l)*d))/2+b),gt=0;4>gt;gt++)k=et[gt],P=c[k],i=-1!==P.indexOf("px")?parseFloat(P):Q(this.t,k,parseFloat(P),P.replace(T,""))||0,O=i!==s[k]?2>gt?-s.ieOffsetX:-s.ieOffsetY:2>gt?f-s.ieOffsetX:p-s.ieOffsetY,u[k]=(s[k]=Math.round(i-O*(0===gt||2===gt?1:S)))+"px"}}},Lt=Y.set3DTransformRatio=Y.setTransformRatio=function(t){var e,i,s,r,n,a,o,h,l,_,u,c,p,m,d,g,v,y,T,x,w,b,P,k=this.data,O=this.t.style,S=k.rotation,R=k.rotationX,A=k.rotationY,C=k.scaleX,D=k.scaleY,M=k.scaleZ,F=k.x,I=k.y,N=k.z,X=k.svg,L=k.perspective,E=k.force3D;if(((1===t||0===t)&&"auto"===E&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!E)&&!N&&!L&&!A&&!R||xt&&X||!Ot)return void(S||k.skewX||X?(S*=z,b=k.skewX*z,P=1e5,e=Math.cos(S)*C,r=Math.sin(S)*C,i=Math.sin(S-b)*-D,n=Math.cos(S-b)*D,b&&"simple"===k.skewType&&(v=Math.tan(b),v=Math.sqrt(1+v*v),i*=v,n*=v,k.skewY&&(e*=v,r*=v)),X&&(F+=k.xOrigin-(k.xOrigin*e+k.yOrigin*i)+k.xOffset,I+=k.yOrigin-(k.xOrigin*r+k.yOrigin*n)+k.yOffset,xt&&(k.xPercent||k.yPercent)&&(m=this.t.getBBox(),F+=.01*k.xPercent*m.width,I+=.01*k.yPercent*m.height),m=1e-6,m>F&&F>-m&&(F=0),m>I&&I>-m&&(I=0)),T=(e*P|0)/P+","+(r*P|0)/P+","+(i*P|0)/P+","+(n*P|0)/P+","+F+","+I+")",X&&xt?this.t.setAttribute("transform","matrix("+T):O[bt]=(k.xPercent||k.yPercent?"translate("+k.xPercent+"%,"+k.yPercent+"%) matrix(":"matrix(")+T):O[bt]=(k.xPercent||k.yPercent?"translate("+k.xPercent+"%,"+k.yPercent+"%) matrix(":"matrix(")+C+",0,0,"+D+","+F+","+I+")");if(f&&(m=1e-4,m>C&&C>-m&&(C=M=2e-5),m>D&&D>-m&&(D=M=2e-5),!L||k.z||k.rotationX||k.rotationY||(L=0)),S||k.skewX)S*=z,d=e=Math.cos(S),g=r=Math.sin(S),k.skewX&&(S-=k.skewX*z,d=Math.cos(S),g=Math.sin(S),"simple"===k.skewType&&(v=Math.tan(k.skewX*z),v=Math.sqrt(1+v*v),d*=v,g*=v,k.skewY&&(e*=v,r*=v))),i=-g,n=d;else{if(!(A||R||1!==M||L||X))return void(O[bt]=(k.xPercent||k.yPercent?"translate("+k.xPercent+"%,"+k.yPercent+"%) translate3d(":"translate3d(")+F+"px,"+I+"px,"+N+"px)"+(1!==C||1!==D?" scale("+C+","+D+")":""));e=n=1,i=r=0}l=1,s=a=o=h=_=u=0,c=L?-1/L:0,p=k.zOrigin,m=1e-6,x=",",w="0",S=A*z,S&&(d=Math.cos(S),g=Math.sin(S),o=-g,_=c*-g,s=e*g,a=r*g,l=d,c*=d,e*=d,r*=d),S=R*z,S&&(d=Math.cos(S),g=Math.sin(S),v=i*d+s*g,y=n*d+a*g,h=l*g,u=c*g,s=i*-g+s*d,a=n*-g+a*d,l*=d,c*=d,i=v,n=y),1!==M&&(s*=M,a*=M,l*=M,c*=M),1!==D&&(i*=D,n*=D,h*=D,u*=D),1!==C&&(e*=C,r*=C,o*=C,_*=C),(p||X)&&(p&&(F+=s*-p,I+=a*-p,N+=l*-p+p),X&&(F+=k.xOrigin-(k.xOrigin*e+k.yOrigin*i)+k.xOffset,I+=k.yOrigin-(k.xOrigin*r+k.yOrigin*n)+k.yOffset),m>F&&F>-m&&(F=w),m>I&&I>-m&&(I=w),m>N&&N>-m&&(N=0)),T=k.xPercent||k.yPercent?"translate("+k.xPercent+"%,"+k.yPercent+"%) matrix3d(":"matrix3d(",T+=(m>e&&e>-m?w:e)+x+(m>r&&r>-m?w:r)+x+(m>o&&o>-m?w:o),T+=x+(m>_&&_>-m?w:_)+x+(m>i&&i>-m?w:i)+x+(m>n&&n>-m?w:n),R||A?(T+=x+(m>h&&h>-m?w:h)+x+(m>u&&u>-m?w:u)+x+(m>s&&s>-m?w:s),T+=x+(m>a&&a>-m?w:a)+x+(m>l&&l>-m?w:l)+x+(m>c&&c>-m?w:c)+x):T+=",0,0,0,0,1,0,",T+=F+x+I+x+N+x+(L?1+-N/L:1)+")",O[bt]=T};l=St.prototype,l.x=l.y=l.z=l.skewX=l.skewY=l.rotation=l.rotationX=l.rotationY=l.zOrigin=l.xPercent=l.yPercent=l.xOffset=l.yOffset=0,l.scaleX=l.scaleY=l.scaleZ=1,yt("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(t,e,i,s,n,o,h){if(s._lastParsedTransform===h)return n;s._lastParsedTransform=h;var l,_,u,c,f,p,m,d,g,v=t._gsTransform,y=s._transform=Nt(t,r,!0,h.parseTransform),T=t.style,x=1e-6,w=wt.length,b=h,P={},k="transformOrigin";if("string"==typeof b.transform&&bt)u=L.style,u[bt]=b.transform,u.display="block",u.position="absolute",N.body.appendChild(L),l=Nt(L,null,!1),N.body.removeChild(L),null!=b.xPercent&&(l.xPercent=nt(b.xPercent,y.xPercent)),null!=b.yPercent&&(l.yPercent=nt(b.yPercent,y.yPercent));else if("object"==typeof b){if(l={scaleX:nt(null!=b.scaleX?b.scaleX:b.scale,y.scaleX),scaleY:nt(null!=b.scaleY?b.scaleY:b.scale,y.scaleY),scaleZ:nt(b.scaleZ,y.scaleZ),x:nt(b.x,y.x),y:nt(b.y,y.y),z:nt(b.z,y.z),xPercent:nt(b.xPercent,y.xPercent),yPercent:nt(b.yPercent,y.yPercent),perspective:nt(b.transformPerspective,y.perspective)},m=b.directionalRotation,null!=m)if("object"==typeof m)for(u in m)b[u]=m[u];else b.rotation=m;"string"==typeof b.x&&-1!==b.x.indexOf("%")&&(l.x=0,l.xPercent=nt(b.x,y.xPercent)),"string"==typeof b.y&&-1!==b.y.indexOf("%")&&(l.y=0,l.yPercent=nt(b.y,y.yPercent)),l.rotation=at("rotation"in b?b.rotation:"shortRotation"in b?b.shortRotation+"_short":"rotationZ"in b?b.rotationZ:y.rotation,y.rotation,"rotation",P),Ot&&(l.rotationX=at("rotationX"in b?b.rotationX:"shortRotationX"in b?b.shortRotationX+"_short":y.rotationX||0,y.rotationX,"rotationX",P),l.rotationY=at("rotationY"in b?b.rotationY:"shortRotationY"in b?b.shortRotationY+"_short":y.rotationY||0,y.rotationY,"rotationY",P)),l.skewX=null==b.skewX?y.skewX:at(b.skewX,y.skewX),l.skewY=null==b.skewY?y.skewY:at(b.skewY,y.skewY),(_=l.skewY-y.skewY)&&(l.skewX+=_,l.rotation+=_)}for(Ot&&null!=b.force3D&&(y.force3D=b.force3D,p=!0),y.skewType=b.skewType||y.skewType||a.defaultSkewType,f=y.force3D||y.z||y.rotationX||y.rotationY||l.z||l.rotationX||l.rotationY||l.perspective,f||null==b.scale||(l.scaleZ=1);--w>-1;)i=wt[w],c=l[i]-y[i],(c>x||-x>c||null!=b[i]||null!=I[i])&&(p=!0,n=new pt(y,i,y[i],c,n),i in P&&(n.e=P[i]),n.xs0=0,n.plugin=o,s._overwriteProps.push(n.n));return c=b.transformOrigin,y.svg&&(c||b.svgOrigin)&&(d=y.xOffset,g=y.yOffset,Mt(t,st(c),l,b.svgOrigin,b.smoothOrigin),n=mt(y,"xOrigin",(v?y:l).xOrigin,l.xOrigin,n,k),n=mt(y,"yOrigin",(v?y:l).yOrigin,l.yOrigin,n,k),(d!==y.xOffset||g!==y.yOffset)&&(n=mt(y,"xOffset",v?d:y.xOffset,y.xOffset,n,k),n=mt(y,"yOffset",v?g:y.yOffset,y.yOffset,n,k)),c=xt?null:"0px 0px"),(c||Ot&&f&&y.zOrigin)&&(bt?(p=!0,i=kt,c=(c||$(t,i,r,!1,"50% 50%"))+"",n=new pt(T,i,0,0,n,-1,k),n.b=T[i],n.plugin=o,Ot?(u=y.zOrigin,c=c.split(" "),y.zOrigin=(c.length>2&&(0===u||"0px"!==c[2])?parseFloat(c[2]):u)||0,n.xs0=n.e=c[0]+" "+(c[1]||"50%")+" 0px",n=new pt(y,"zOrigin",0,0,n,-1,n.n),n.b=u,n.xs0=n.e=y.zOrigin):n.xs0=n.e=c):st(c+"",y)),p&&(s._transformType=y.svg&&xt||!f&&3!==this._transformType?2:3),n},prefix:!0}),yt("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),yt("borderRadius",{defaultValue:"0px",parser:function(t,e,i,n,a,o){e=this.format(e);var h,l,_,u,c,f,p,m,d,g,v,y,T,x,w,b,P=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],k=t.style;for(d=parseFloat(t.offsetWidth),g=parseFloat(t.offsetHeight),h=e.split(" "),l=0;l<P.length;l++)this.p.indexOf("border")&&(P[l]=Z(P[l])),c=u=$(t,P[l],r,!1,"0px"),-1!==c.indexOf(" ")&&(u=c.split(" "),c=u[0],u=u[1]),f=_=h[l],p=parseFloat(c),y=c.substr((p+"").length),T="="===f.charAt(1),T?(m=parseInt(f.charAt(0)+"1",10),f=f.substr(2),m*=parseFloat(f),v=f.substr((m+"").length-(0>m?1:0))||""):(m=parseFloat(f),v=f.substr((m+"").length)),""===v&&(v=s[i]||y),v!==y&&(x=Q(t,"borderLeft",p,y),w=Q(t,"borderTop",p,y),"%"===v?(c=x/d*100+"%",u=w/g*100+"%"):"em"===v?(b=Q(t,"borderLeft",1,"em"),c=x/b+"em",u=w/b+"em"):(c=x+"px",u=w+"px"),T&&(f=parseFloat(c)+m+v,_=parseFloat(u)+m+v)),a=dt(k,P[l],c+" "+u,f+" "+_,!1,"0px",a);return a},prefix:!0,formatter:ut("0px 0px 0px 0px",!1,!0)}),yt("backgroundPosition",{defaultValue:"0 0",parser:function(t,e,i,s,n,a){var o,h,l,_,u,c,f="background-position",p=r||G(t,null),d=this.format((p?m?p.getPropertyValue(f+"-x")+" "+p.getPropertyValue(f+"-y"):p.getPropertyValue(f):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),g=this.format(e);if(-1!==d.indexOf("%")!=(-1!==g.indexOf("%"))&&(c=$(t,"backgroundImage").replace(S,""),c&&"none"!==c)){for(o=d.split(" "),h=g.split(" "),E.setAttribute("src",c),l=2;--l>-1;)d=o[l],_=-1!==d.indexOf("%"),_!==(-1!==h[l].indexOf("%"))&&(u=0===l?t.offsetWidth-E.width:t.offsetHeight-E.height,o[l]=_?parseFloat(d)/100*u+"px":parseFloat(d)/u*100+"%");d=o.join(" ")}return this.parseComplex(t.style,d,g,n,a)},formatter:st}),yt("backgroundSize",{defaultValue:"0 0",formatter:st}),yt("perspective",{defaultValue:"0px",prefix:!0}),yt("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),yt("transformStyle",{prefix:!0}),yt("backfaceVisibility",{prefix:!0}),yt("userSelect",{prefix:!0}),yt("margin",{parser:ct("marginTop,marginRight,marginBottom,marginLeft")}),yt("padding",{parser:ct("paddingTop,paddingRight,paddingBottom,paddingLeft")}),yt("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(t,e,i,s,n,a){var o,h,l;return 9>m?(h=t.currentStyle,l=8>m?" ":",",o="rect("+h.clipTop+l+h.clipRight+l+h.clipBottom+l+h.clipLeft+")",e=this.format(e).split(",").join(l)):(o=this.format($(t,this.p,r,!1,this.dflt)),e=this.format(e)),this.parseComplex(t.style,o,e,n,a)}}),yt("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),yt("autoRound,strictUnits",{parser:function(t,e,i,s,r){return r}}),yt("border",{defaultValue:"0px solid #000",parser:function(t,e,i,s,n,a){return this.parseComplex(t.style,this.format($(t,"borderTopWidth",r,!1,"0px")+" "+$(t,"borderTopStyle",r,!1,"solid")+" "+$(t,"borderTopColor",r,!1,"#000")),this.format(e),n,a)},color:!0,formatter:function(t){var e=t.split(" ");return e[0]+" "+(e[1]||"solid")+" "+(t.match(_t)||["#000"])[0]}}),yt("borderWidth",{parser:ct("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),yt("float,cssFloat,styleFloat",{parser:function(t,e,i,s,r,n){var a=t.style,o="cssFloat"in a?"cssFloat":"styleFloat";return new pt(a,o,0,0,r,-1,i,!1,0,a[o],e)}});var Et=function(t){var e,i=this.t,s=i.filter||$(this.data,"filter")||"",r=this.s+this.c*t|0;100===r&&(-1===s.indexOf("atrix(")&&-1===s.indexOf("radient(")&&-1===s.indexOf("oader(")?(i.removeAttribute("filter"),e=!$(this.data,"filter")):(i.filter=s.replace(b,""),e=!0)),e||(this.xn1&&(i.filter=s=s||"alpha(opacity="+r+")"),-1===s.indexOf("pacity")?0===r&&this.xn1||(i.filter=s+" alpha(opacity="+r+")"):i.filter=s.replace(x,"opacity="+r))};yt("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(t,e,i,s,n,a){var o=parseFloat($(t,"opacity",r,!1,"1")),h=t.style,l="autoAlpha"===i;return"string"==typeof e&&"="===e.charAt(1)&&(e=("-"===e.charAt(0)?-1:1)*parseFloat(e.substr(2))+o),l&&1===o&&"hidden"===$(t,"visibility",r)&&0!==e&&(o=0),
j?n=new pt(h,"opacity",o,e-o,n):(n=new pt(h,"opacity",100*o,100*(e-o),n),n.xn1=l?1:0,h.zoom=1,n.type=2,n.b="alpha(opacity="+n.s+")",n.e="alpha(opacity="+(n.s+n.c)+")",n.data=t,n.plugin=a,n.setRatio=Et),l&&(n=new pt(h,"visibility",0,0,n,-1,null,!1,0,0!==o?"inherit":"hidden",0===e?"hidden":"inherit"),n.xs0="inherit",s._overwriteProps.push(n.n),s._overwriteProps.push(i)),n}});var Yt=function(t,e){e&&(t.removeProperty?(("ms"===e.substr(0,2)||"webkit"===e.substr(0,6))&&(e="-"+e),t.removeProperty(e.replace(k,"-$1").toLowerCase())):t.removeAttribute(e))},Bt=function(t){if(this.t._gsClassPT=this,1===t||0===t){this.t.setAttribute("class",0===t?this.b:this.e);for(var e=this.data,i=this.t.style;e;)e.v?i[e.p]=e.v:Yt(i,e.p),e=e._next;1===t&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};yt("className",{parser:function(t,e,s,n,a,o,h){var l,_,u,c,f,p=t.getAttribute("class")||"",m=t.style.cssText;if(a=n._classNamePT=new pt(t,s,0,0,a,2),a.setRatio=Bt,a.pr=-11,i=!0,a.b=p,_=K(t,r),u=t._gsClassPT){for(c={},f=u.data;f;)c[f.p]=1,f=f._next;u.setRatio(1)}return t._gsClassPT=a,a.e="="!==e.charAt(1)?e:p.replace(new RegExp("\\s*\\b"+e.substr(2)+"\\b"),"")+("+"===e.charAt(0)?" "+e.substr(2):""),t.setAttribute("class",a.e),l=J(t,_,K(t),h,c),t.setAttribute("class",p),a.data=l.firstMPT,t.style.cssText=m,a=a.xfirst=n.parse(t,l.difs,a,o)}});var jt=function(t){if((1===t||0===t)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var e,i,s,r,n,a=this.t.style,o=h.transform.parse;if("all"===this.e)a.cssText="",r=!0;else for(e=this.e.split(" ").join("").split(","),s=e.length;--s>-1;)i=e[s],h[i]&&(h[i].parse===o?r=!0:i="transformOrigin"===i?kt:h[i].p),Yt(a,i);r&&(Yt(a,bt),n=this.t._gsTransform,n&&(n.svg&&this.t.removeAttribute("data-svg-origin"),delete this.t._gsTransform))}};for(yt("clearProps",{parser:function(t,e,s,r,n){return n=new pt(t,s,0,0,n,2),n.setRatio=jt,n.e=e,n.pr=-10,n.data=r._tween,i=!0,n}}),l="bezier,throwProps,physicsProps,physics2D".split(","),gt=l.length;gt--;)Tt(l[gt]);l=a.prototype,l._firstPT=l._lastParsedTransform=l._transform=null,l._onInitTween=function(t,e,o){if(!t.nodeType)return!1;this._target=t,this._tween=o,this._vars=e,_=e.autoRound,i=!1,s=e.suffixMap||a.suffixMap,r=G(t,""),n=this._overwriteProps;var l,f,m,d,g,v,y,T,x,b=t.style;if(u&&""===b.zIndex&&(l=$(t,"zIndex",r),("auto"===l||""===l)&&this._addLazySet(b,"zIndex",0)),"string"==typeof e&&(d=b.cssText,l=K(t,r),b.cssText=d+";"+e,l=J(t,l,K(t)).difs,!j&&w.test(e)&&(l.opacity=parseFloat(RegExp.$1)),e=l,b.cssText=d),e.className?this._firstPT=f=h.className.parse(t,e.className,"className",this,null,null,e):this._firstPT=f=this.parse(t,e,null),this._transformType){for(x=3===this._transformType,bt?c&&(u=!0,""===b.zIndex&&(y=$(t,"zIndex",r),("auto"===y||""===y)&&this._addLazySet(b,"zIndex",0)),p&&this._addLazySet(b,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(x?"visible":"hidden"))):b.zoom=1,m=f;m&&m._next;)m=m._next;T=new pt(t,"transform",0,0,null,2),this._linkCSSP(T,null,m),T.setRatio=bt?Lt:Xt,T.data=this._transform||Nt(t,r,!0),T.tween=o,T.pr=-1,n.pop()}if(i){for(;f;){for(v=f._next,m=d;m&&m.pr>f.pr;)m=m._next;(f._prev=m?m._prev:g)?f._prev._next=f:d=f,(f._next=m)?m._prev=f:g=f,f=v}this._firstPT=d}return!0},l.parse=function(t,e,i,n){var a,o,l,u,c,f,p,m,d,g,v=t.style;for(a in e)f=e[a],o=h[a],o?i=o.parse(t,f,a,this,i,n,e):(c=$(t,a,r)+"",d="string"==typeof f,"color"===a||"fill"===a||"stroke"===a||-1!==a.indexOf("Color")||d&&P.test(f)?(d||(f=lt(f),f=(f.length>3?"rgba(":"rgb(")+f.join(",")+")"),i=dt(v,a,c,f,!0,"transparent",i,0,n)):!d||-1===f.indexOf(" ")&&-1===f.indexOf(",")?(l=parseFloat(c),p=l||0===l?c.substr((l+"").length):"",(""===c||"auto"===c)&&("width"===a||"height"===a?(l=it(t,a,r),p="px"):"left"===a||"top"===a?(l=H(t,a,r),p="px"):(l="opacity"!==a?0:1,p="")),g=d&&"="===f.charAt(1),g?(u=parseInt(f.charAt(0)+"1",10),f=f.substr(2),u*=parseFloat(f),m=f.replace(T,"")):(u=parseFloat(f),m=d?f.replace(T,""):""),""===m&&(m=a in s?s[a]:p),f=u||0===u?(g?u+l:u)+m:e[a],p!==m&&""!==m&&(u||0===u)&&l&&(l=Q(t,a,l,p),"%"===m?(l/=Q(t,a,100,"%")/100,e.strictUnits!==!0&&(c=l+"%")):"em"===m?l/=Q(t,a,1,"em"):"px"!==m&&(u=Q(t,a,u,m),m="px"),g&&(u||0===u)&&(f=u+l+m)),g&&(u+=l),!l&&0!==l||!u&&0!==u?void 0!==v[a]&&(f||f+""!="NaN"&&null!=f)?(i=new pt(v,a,u||l||0,0,i,-1,a,!1,0,c,f),i.xs0="none"!==f||"display"!==a&&-1===a.indexOf("Style")?f:c):V("invalid "+a+" tween value: "+e[a]):(i=new pt(v,a,l,u-l,i,0,a,_!==!1&&("px"===m||"zIndex"===a),0,c,f),i.xs0=m)):i=dt(v,a,c,f,!0,null,i,0,n)),n&&i&&!i.plugin&&(i.plugin=n);return i},l.setRatio=function(t){var e,i,s,r=this._firstPT,n=1e-6;if(1!==t||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(t||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;r;){if(e=r.c*t+r.s,r.r?e=Math.round(e):n>e&&e>-n&&(e=0),r.type)if(1===r.type)if(s=r.l,2===s)r.t[r.p]=r.xs0+e+r.xs1+r.xn1+r.xs2;else if(3===s)r.t[r.p]=r.xs0+e+r.xs1+r.xn1+r.xs2+r.xn2+r.xs3;else if(4===s)r.t[r.p]=r.xs0+e+r.xs1+r.xn1+r.xs2+r.xn2+r.xs3+r.xn3+r.xs4;else if(5===s)r.t[r.p]=r.xs0+e+r.xs1+r.xn1+r.xs2+r.xn2+r.xs3+r.xn3+r.xs4+r.xn4+r.xs5;else{for(i=r.xs0+e+r.xs1,s=1;s<r.l;s++)i+=r["xn"+s]+r["xs"+(s+1)];r.t[r.p]=i}else-1===r.type?r.t[r.p]=r.xs0:r.setRatio&&r.setRatio(t);else r.t[r.p]=e+r.xs0;r=r._next}else for(;r;)2!==r.type?r.t[r.p]=r.b:r.setRatio(t),r=r._next;else for(;r;){if(2!==r.type)if(r.r&&-1!==r.type)if(e=Math.round(r.s+r.c),r.type){if(1===r.type){for(s=r.l,i=r.xs0+e+r.xs1,s=1;s<r.l;s++)i+=r["xn"+s]+r["xs"+(s+1)];r.t[r.p]=i}}else r.t[r.p]=e+r.xs0;else r.t[r.p]=r.e;else r.setRatio(t);r=r._next}},l._enableTransforms=function(t){this._transform=this._transform||Nt(this._target,r,!0),this._transformType=this._transform.svg&&xt||!t&&3!==this._transformType?2:3};var Ut=function(t){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};l._addLazySet=function(t,e,i){var s=this._firstPT=new pt(t,e,0,0,this._firstPT,2);s.e=i,s.setRatio=Ut,s.data=this},l._linkCSSP=function(t,e,i,s){return t&&(e&&(e._prev=t),t._next&&(t._next._prev=t._prev),t._prev?t._prev._next=t._next:this._firstPT===t&&(this._firstPT=t._next,s=!0),i?i._next=t:s||null!==this._firstPT||(this._firstPT=t),t._next=e,t._prev=i),t},l._kill=function(e){var i,s,r,n=e;if(e.autoAlpha||e.alpha){n={};for(s in e)n[s]=e[s];n.opacity=1,n.autoAlpha&&(n.visibility=1)}return e.className&&(i=this._classNamePT)&&(r=i.xfirst,r&&r._prev?this._linkCSSP(r._prev,i._next,r._prev._prev):r===this._firstPT&&(this._firstPT=i._next),i._next&&this._linkCSSP(i._next,i._next._next,r._prev),this._classNamePT=null),t.prototype._kill.call(this,n)};var Vt=function(t,e,i){var s,r,n,a;if(t.slice)for(r=t.length;--r>-1;)Vt(t[r],e,i);else for(s=t.childNodes,r=s.length;--r>-1;)n=s[r],a=n.type,n.style&&(e.push(K(n)),i&&i.push(n)),1!==a&&9!==a&&11!==a||!n.childNodes.length||Vt(n,e,i)};return a.cascadeTo=function(t,i,s){var r,n,a,o,h=e.to(t,i,s),l=[h],_=[],u=[],c=[],f=e._internals.reservedProps;for(t=h._targets||h.target,Vt(t,_,c),h.render(i,!0,!0),Vt(t,u),h.render(0,!0,!0),h._enabled(!0),r=c.length;--r>-1;)if(n=J(c[r],_[r],u[r]),n.firstMPT){n=n.difs;for(a in s)f[a]&&(n[a]=s[a]);o={};for(a in n)o[a]=_[r][a];l.push(e.fromTo(c[r],i,o,n))}return l},t.activate([a]),a},!0),function(){var t=_gsScope._gsDefine.plugin({propName:"roundProps",priority:-1,API:2,init:function(t,e,i){return this._tween=i,!0}}),e=t.prototype;e._onInitAllProps=function(){for(var t,e,i,s=this._tween,r=s.vars.roundProps instanceof Array?s.vars.roundProps:s.vars.roundProps.split(","),n=r.length,a={},o=s._propLookup.roundProps;--n>-1;)a[r[n]]=1;for(n=r.length;--n>-1;)for(t=r[n],e=s._firstPT;e;)i=e._next,e.pg?e.t._roundProps(a,!0):e.n===t&&(this._add(e.t,t,e.s,e.c),i&&(i._prev=e._prev),e._prev?e._prev._next=i:s._firstPT===e&&(s._firstPT=i),e._next=e._prev=null,s._propLookup[t]=o),e=i;return!1},e._add=function(t,e,i,s){this._addTween(t,e,i,i+s,e,!0),this._overwriteProps.push(e)}}(),function(){var t=/(?:\d|\-|\+|=|#|\.)*/g,e=/[A-Za-z%]/g;_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.4.0",init:function(i,s,r){var n,a,o,h,l;if("function"!=typeof i.setAttribute)return!1;this._target=i,this._proxy={},this._start={},this._end={},this._suffix={};for(n in s)this._start[n]=this._proxy[n]=a=i.getAttribute(n)+"",this._end[n]=o=s[n]+"",this._suffix[n]=h=e.test(o)?o.replace(t,""):e.test(a)?a.replace(t,""):"",h&&(l=o.indexOf(h),-1!==l&&(o=o.substr(0,l))),this._addTween(this._proxy,n,parseFloat(a),o,n)||(this._suffix[n]=""),"="===o.charAt(1)&&(this._end[n]=this._firstPT.s+this._firstPT.c+h),this._overwriteProps.push(n);return!0},set:function(t){this._super.setRatio.call(this,t);for(var e,i=this._overwriteProps,s=i.length,r=1===t?this._end:t?this._proxy:this._start,n=r===this._proxy;--s>-1;)e=i[s],this._target.setAttribute(e,r[e]+(n?this._suffix[e]:""))}})}(),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.2.1",API:2,init:function(t,e,i){"object"!=typeof e&&(e={rotation:e}),this.finals={};var s,r,n,a,o,h,l=e.useRadians===!0?2*Math.PI:360,_=1e-6;for(s in e)"useRadians"!==s&&(h=(e[s]+"").split("_"),r=h[0],n=parseFloat("function"!=typeof t[s]?t[s]:t[s.indexOf("set")||"function"!=typeof t["get"+s.substr(3)]?s:"get"+s.substr(3)]()),a=this.finals[s]="string"==typeof r&&"="===r.charAt(1)?n+parseInt(r.charAt(0)+"1",10)*Number(r.substr(2)):Number(r)||0,o=a-n,h.length&&(r=h.join("_"),-1!==r.indexOf("short")&&(o%=l,o!==o%(l/2)&&(o=0>o?o+l:o-l)),-1!==r.indexOf("_cw")&&0>o?o=(o+9999999999*l)%l-(o/l|0)*l:-1!==r.indexOf("ccw")&&o>0&&(o=(o-9999999999*l)%l-(o/l|0)*l)),(o>_||-_>o)&&(this._addTween(t,s,n,n+o,s),this._overwriteProps.push(s)));return!0},set:function(t){var e;if(1!==t)this._super.setRatio.call(this,t);else for(e=this._firstPT;e;)e.f?e.t[e.p](this.finals[e.p]):e.t[e.p]=this.finals[e.p],e=e._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(t){var e,i,s,r=_gsScope.GreenSockGlobals||_gsScope,n=r.com.greensock,a=2*Math.PI,o=Math.PI/2,h=n._class,l=function(e,i){var s=h("easing."+e,function(){},!0),r=s.prototype=new t;return r.constructor=s,r.getRatio=i,s},_=t.register||function(){},u=function(t,e,i,s,r){var n=h("easing."+t,{easeOut:new e,easeIn:new i,easeInOut:new s},!0);return _(n,t),n},c=function(t,e,i){this.t=t,this.v=e,i&&(this.next=i,i.prev=this,this.c=i.v-e,this.gap=i.t-t)},f=function(e,i){var s=h("easing."+e,function(t){this._p1=t||0===t?t:1.70158,this._p2=1.525*this._p1},!0),r=s.prototype=new t;return r.constructor=s,r.getRatio=i,r.config=function(t){return new s(t)},s},p=u("Back",f("BackOut",function(t){return(t-=1)*t*((this._p1+1)*t+this._p1)+1}),f("BackIn",function(t){return t*t*((this._p1+1)*t-this._p1)}),f("BackInOut",function(t){return(t*=2)<1?.5*t*t*((this._p2+1)*t-this._p2):.5*((t-=2)*t*((this._p2+1)*t+this._p2)+2)})),m=h("easing.SlowMo",function(t,e,i){e=e||0===e?e:.7,null==t?t=.7:t>1&&(t=1),this._p=1!==t?e:0,this._p1=(1-t)/2,this._p2=t,this._p3=this._p1+this._p2,this._calcEnd=i===!0},!0),d=m.prototype=new t;return d.constructor=m,d.getRatio=function(t){var e=t+(.5-t)*this._p;return t<this._p1?this._calcEnd?1-(t=1-t/this._p1)*t:e-(t=1-t/this._p1)*t*t*t*e:t>this._p3?this._calcEnd?1-(t=(t-this._p3)/this._p1)*t:e+(t-e)*(t=(t-this._p3)/this._p1)*t*t*t:this._calcEnd?1:e},m.ease=new m(.7,.7),d.config=m.config=function(t,e,i){return new m(t,e,i)},e=h("easing.SteppedEase",function(t){t=t||1,this._p1=1/t,this._p2=t+1},!0),d=e.prototype=new t,d.constructor=e,d.getRatio=function(t){return 0>t?t=0:t>=1&&(t=.999999999),(this._p2*t>>0)*this._p1},d.config=e.config=function(t){return new e(t)},i=h("easing.RoughEase",function(e){e=e||{};for(var i,s,r,n,a,o,h=e.taper||"none",l=[],_=0,u=0|(e.points||20),f=u,p=e.randomize!==!1,m=e.clamp===!0,d=e.template instanceof t?e.template:null,g="number"==typeof e.strength?.4*e.strength:.4;--f>-1;)i=p?Math.random():1/u*f,s=d?d.getRatio(i):i,"none"===h?r=g:"out"===h?(n=1-i,r=n*n*g):"in"===h?r=i*i*g:.5>i?(n=2*i,r=n*n*.5*g):(n=2*(1-i),r=n*n*.5*g),p?s+=Math.random()*r-.5*r:f%2?s+=.5*r:s-=.5*r,m&&(s>1?s=1:0>s&&(s=0)),l[_++]={x:i,y:s};for(l.sort(function(t,e){return t.x-e.x}),o=new c(1,1,null),f=u;--f>-1;)a=l[f],o=new c(a.x,a.y,o);this._prev=new c(0,0,0!==o.t?o:o.next)},!0),d=i.prototype=new t,d.constructor=i,d.getRatio=function(t){var e=this._prev;if(t>e.t){for(;e.next&&t>=e.t;)e=e.next;e=e.prev}else for(;e.prev&&t<=e.t;)e=e.prev;return this._prev=e,e.v+(t-e.t)/e.gap*e.c},d.config=function(t){return new i(t)},i.ease=new i,u("Bounce",l("BounceOut",function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),l("BounceIn",function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:2/2.75>t?1-(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),l("BounceInOut",function(t){var e=.5>t;return t=e?1-2*t:2*t-1,t=1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})),u("Circ",l("CircOut",function(t){return Math.sqrt(1-(t-=1)*t)}),l("CircIn",function(t){return-(Math.sqrt(1-t*t)-1)}),l("CircInOut",function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})),s=function(e,i,s){var r=h("easing."+e,function(t,e){this._p1=t>=1?t:1,this._p2=(e||s)/(1>t?t:1),this._p3=this._p2/a*(Math.asin(1/this._p1)||0),this._p2=a/this._p2},!0),n=r.prototype=new t;return n.constructor=r,n.getRatio=i,n.config=function(t,e){return new r(t,e)},r},u("Elastic",s("ElasticOut",function(t){return this._p1*Math.pow(2,-10*t)*Math.sin((t-this._p3)*this._p2)+1},.3),s("ElasticIn",function(t){return-(this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*this._p2))},.3),s("ElasticInOut",function(t){return(t*=2)<1?-.5*(this._p1*Math.pow(2,10*(t-=1))*Math.sin((t-this._p3)*this._p2)):this._p1*Math.pow(2,-10*(t-=1))*Math.sin((t-this._p3)*this._p2)*.5+1},.45)),u("Expo",l("ExpoOut",function(t){return 1-Math.pow(2,-10*t)}),l("ExpoIn",function(t){return Math.pow(2,10*(t-1))-.001}),l("ExpoInOut",function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})),u("Sine",l("SineOut",function(t){return Math.sin(t*o)}),l("SineIn",function(t){return-Math.cos(t*o)+1}),l("SineInOut",function(t){return-.5*(Math.cos(Math.PI*t)-1)})),h("easing.EaseLookup",{find:function(e){return t.map[e]}},!0),_(r.SlowMo,"SlowMo","ease,"),_(i,"RoughEase","ease,"),_(e,"SteppedEase","ease,"),p},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(t,e){"use strict";var i=t.GreenSockGlobals=t.GreenSockGlobals||t;if(!i.TweenLite){var s,r,n,a,o,h=function(t){var e,s=t.split("."),r=i;for(e=0;e<s.length;e++)r[s[e]]=r=r[s[e]]||{};return r},l=h("com.greensock"),_=1e-10,u=function(t){var e,i=[],s=t.length;for(e=0;e!==s;i.push(t[e++]));return i},c=function(){},f=function(){var t=Object.prototype.toString,e=t.call([]);return function(i){return null!=i&&(i instanceof Array||"object"==typeof i&&!!i.push&&t.call(i)===e)}}(),p={},m=function(s,r,n,a){this.sc=p[s]?p[s].sc:[],p[s]=this,this.gsClass=null,this.func=n;var o=[];this.check=function(l){for(var _,u,c,f,d=r.length,g=d;--d>-1;)(_=p[r[d]]||new m(r[d],[])).gsClass?(o[d]=_.gsClass,g--):l&&_.sc.push(this);if(0===g&&n)for(u=("com.greensock."+s).split("."),c=u.pop(),f=h(u.join("."))[c]=this.gsClass=n.apply(n,o),a&&(i[c]=f,"function"==typeof define&&define.amd?define((t.GreenSockAMDPath?t.GreenSockAMDPath+"/":"")+s.split(".").pop(),[],function(){return f}):s===e&&"undefined"!=typeof module&&module.exports&&(module.exports=f)),d=0;d<this.sc.length;d++)this.sc[d].check()},this.check(!0)},d=t._gsDefine=function(t,e,i,s){return new m(t,e,i,s)},g=l._class=function(t,e,i){return e=e||function(){},d(t,[],function(){return e},i),e};d.globals=i;var v=[0,0,1,1],y=[],T=g("easing.Ease",function(t,e,i,s){this._func=t,this._type=i||0,this._power=s||0,this._params=e?v.concat(e):v},!0),x=T.map={},w=T.register=function(t,e,i,s){for(var r,n,a,o,h=e.split(","),_=h.length,u=(i||"easeIn,easeOut,easeInOut").split(",");--_>-1;)for(n=h[_],r=s?g("easing."+n,null,!0):l.easing[n]||{},a=u.length;--a>-1;)o=u[a],x[n+"."+o]=x[o+n]=r[o]=t.getRatio?t:t[o]||new t};for(n=T.prototype,n._calcEnd=!1,n.getRatio=function(t){if(this._func)return this._params[0]=t,this._func.apply(null,this._params);var e=this._type,i=this._power,s=1===e?1-t:2===e?t:.5>t?2*t:2*(1-t);return 1===i?s*=s:2===i?s*=s*s:3===i?s*=s*s*s:4===i&&(s*=s*s*s*s),1===e?1-s:2===e?s:.5>t?s/2:1-s/2},s=["Linear","Quad","Cubic","Quart","Quint,Strong"],r=s.length;--r>-1;)n=s[r]+",Power"+r,w(new T(null,null,1,r),n,"easeOut",!0),w(new T(null,null,2,r),n,"easeIn"+(0===r?",easeNone":"")),w(new T(null,null,3,r),n,"easeInOut");x.linear=l.easing.Linear.easeIn,x.swing=l.easing.Quad.easeInOut;var b=g("events.EventDispatcher",function(t){this._listeners={},this._eventTarget=t||this});n=b.prototype,n.addEventListener=function(t,e,i,s,r){r=r||0;var n,h,l=this._listeners[t],_=0;for(null==l&&(this._listeners[t]=l=[]),h=l.length;--h>-1;)n=l[h],n.c===e&&n.s===i?l.splice(h,1):0===_&&n.pr<r&&(_=h+1);l.splice(_,0,{c:e,s:i,up:s,pr:r}),this!==a||o||a.wake()},n.removeEventListener=function(t,e){var i,s=this._listeners[t];if(s)for(i=s.length;--i>-1;)if(s[i].c===e)return void s.splice(i,1)},n.dispatchEvent=function(t){var e,i,s,r=this._listeners[t];if(r)for(e=r.length,i=this._eventTarget;--e>-1;)s=r[e],s&&(s.up?s.c.call(s.s||i,{type:t,target:i}):s.c.call(s.s||i))};var P=t.requestAnimationFrame,k=t.cancelAnimationFrame,O=Date.now||function(){return(new Date).getTime()},S=O();for(s=["ms","moz","webkit","o"],r=s.length;--r>-1&&!P;)P=t[s[r]+"RequestAnimationFrame"],k=t[s[r]+"CancelAnimationFrame"]||t[s[r]+"CancelRequestAnimationFrame"];g("Ticker",function(t,e){var i,s,r,n,h,l=this,u=O(),f=e!==!1&&P,p=500,m=33,d="tick",g=function(t){var e,a,o=O()-S;o>p&&(u+=o-m),S+=o,l.time=(S-u)/1e3,e=l.time-h,(!i||e>0||t===!0)&&(l.frame++,h+=e+(e>=n?.004:n-e),a=!0),t!==!0&&(r=s(g)),a&&l.dispatchEvent(d)};b.call(l),l.time=l.frame=0,l.tick=function(){g(!0)},l.lagSmoothing=function(t,e){p=t||1/_,m=Math.min(e,p,0)},l.sleep=function(){null!=r&&(f&&k?k(r):clearTimeout(r),s=c,r=null,l===a&&(o=!1))},l.wake=function(){null!==r?l.sleep():l.frame>10&&(S=O()-p+5),s=0===i?c:f&&P?P:function(t){return setTimeout(t,1e3*(h-l.time)+1|0)},l===a&&(o=!0),g(2)},l.fps=function(t){return arguments.length?(i=t,n=1/(i||60),h=this.time+n,void l.wake()):i},l.useRAF=function(t){return arguments.length?(l.sleep(),f=t,void l.fps(i)):f},l.fps(t),setTimeout(function(){f&&l.frame<5&&l.useRAF(!1)},1500)}),n=l.Ticker.prototype=new l.events.EventDispatcher,n.constructor=l.Ticker;var R=g("core.Animation",function(t,e){if(this.vars=e=e||{},this._duration=this._totalDuration=t||0,this._delay=Number(e.delay)||0,this._timeScale=1,this._active=e.immediateRender===!0,this.data=e.data,this._reversed=e.reversed===!0,U){o||a.wake();var i=this.vars.useFrames?j:U;i.add(this,i._time),this.vars.paused&&this.paused(!0)}});a=R.ticker=new l.Ticker,n=R.prototype,n._dirty=n._gc=n._initted=n._paused=!1,n._totalTime=n._time=0,n._rawPrevTime=-1,n._next=n._last=n._onUpdate=n._timeline=n.timeline=null,n._paused=!1;var A=function(){o&&O()-S>2e3&&a.wake(),setTimeout(A,2e3)};A(),n.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},n.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},n.resume=function(t,e){return null!=t&&this.seek(t,e),this.paused(!1)},n.seek=function(t,e){return this.totalTime(Number(t),e!==!1)},n.restart=function(t,e){return this.reversed(!1).paused(!1).totalTime(t?-this._delay:0,e!==!1,!0)},n.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},n.render=function(t,e,i){},n.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},n.isActive=function(){var t,e=this._timeline,i=this._startTime;return!e||!this._gc&&!this._paused&&e.isActive()&&(t=e.rawTime())>=i&&t<i+this.totalDuration()/this._timeScale},n._enabled=function(t,e){return o||a.wake(),this._gc=!t,this._active=this.isActive(),e!==!0&&(t&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!t&&this.timeline&&this._timeline._remove(this,!0)),!1},n._kill=function(t,e){return this._enabled(!1,!1)},n.kill=function(t,e){return this._kill(t,e),this},n._uncache=function(t){for(var e=t?this:this.timeline;e;)e._dirty=!0,e=e.timeline;return this},n._swapSelfInParams=function(t){for(var e=t.length,i=t.concat();--e>-1;)"{self}"===t[e]&&(i[e]=this);return i},n._callback=function(t){var e=this.vars;e[t].apply(e[t+"Scope"]||e.callbackScope||this,e[t+"Params"]||y)},n.eventCallback=function(t,e,i,s){if("on"===(t||"").substr(0,2)){var r=this.vars;if(1===arguments.length)return r[t];null==e?delete r[t]:(r[t]=e,r[t+"Params"]=f(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,r[t+"Scope"]=s),"onUpdate"===t&&(this._onUpdate=e)}return this},n.delay=function(t){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+t-this._delay),this._delay=t,this):this._delay},n.duration=function(t){return arguments.length?(this._duration=this._totalDuration=t,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==t&&this.totalTime(this._totalTime*(t/this._duration),!0),this):(this._dirty=!1,this._duration)},n.totalDuration=function(t){return this._dirty=!1,arguments.length?this.duration(t):this._totalDuration},n.time=function(t,e){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(t>this._duration?this._duration:t,e)):this._time},n.totalTime=function(t,e,i){if(o||a.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(0>t&&!i&&(t+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var s=this._totalDuration,r=this._timeline;if(t>s&&!i&&(t=s),this._startTime=(this._paused?this._pauseTime:r._time)-(this._reversed?s-t:t)/this._timeScale,r._dirty||this._uncache(!1),r._timeline)for(;r._timeline;)r._timeline._time!==(r._startTime+r._totalTime)/r._timeScale&&r.totalTime(r._totalTime,!0),r=r._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==t||0===this._duration)&&(this.render(t,e,!1),F.length&&q())}return this},n.progress=n.totalProgress=function(t,e){return arguments.length?this.totalTime(this.duration()*t,e):this._time/this.duration()},n.startTime=function(t){return arguments.length?(t!==this._startTime&&(this._startTime=t,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,t-this._delay)),this):this._startTime},n.endTime=function(t){return this._startTime+(0!=t?this.totalDuration():this.duration())/this._timeScale},n.timeScale=function(t){if(!arguments.length)return this._timeScale;if(t=t||_,this._timeline&&this._timeline.smoothChildTiming){var e=this._pauseTime,i=e||0===e?e:this._timeline.totalTime();this._startTime=i-(i-this._startTime)*this._timeScale/t}return this._timeScale=t,this._uncache(!1)},n.reversed=function(t){return arguments.length?(t!=this._reversed&&(this._reversed=t,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},n.paused=function(t){if(!arguments.length)return this._paused;var e,i,s=this._timeline;return t!=this._paused&&s&&(o||t||a.wake(),e=s.rawTime(),i=e-this._pauseTime,!t&&s.smoothChildTiming&&(this._startTime+=i,this._uncache(!1)),this._pauseTime=t?e:null,this._paused=t,this._active=this.isActive(),!t&&0!==i&&this._initted&&this.duration()&&this.render(s.smoothChildTiming?this._totalTime:(e-this._startTime)/this._timeScale,!0,!0)),this._gc&&!t&&this._enabled(!0,!1),this};var C=g("core.SimpleTimeline",function(t){R.call(this,0,t),this.autoRemoveChildren=this.smoothChildTiming=!0});n=C.prototype=new R,n.constructor=C,n.kill()._gc=!1,n._first=n._last=n._recent=null,n._sortChildren=!1,n.add=n.insert=function(t,e,i,s){var r,n;if(t._startTime=Number(e||0)+t._delay,t._paused&&this!==t._timeline&&(t._pauseTime=t._startTime+(this.rawTime()-t._startTime)/t._timeScale),t.timeline&&t.timeline._remove(t,!0),t.timeline=t._timeline=this,t._gc&&t._enabled(!0,!0),r=this._last,this._sortChildren)for(n=t._startTime;r&&r._startTime>n;)r=r._prev;return r?(t._next=r._next,r._next=t):(t._next=this._first,this._first=t),t._next?t._next._prev=t:this._last=t,t._prev=r,this._recent=t,this._timeline&&this._uncache(!0),this},n._remove=function(t,e){return t.timeline===this&&(e||t._enabled(!1,!0),t._prev?t._prev._next=t._next:this._first===t&&(this._first=t._next),t._next?t._next._prev=t._prev:this._last===t&&(this._last=t._prev),t._next=t._prev=t.timeline=null,t===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},n.render=function(t,e,i){var s,r=this._first;for(this._totalTime=this._time=this._rawPrevTime=t;r;)s=r._next,(r._active||t>=r._startTime&&!r._paused)&&(r._reversed?r.render((r._dirty?r.totalDuration():r._totalDuration)-(t-r._startTime)*r._timeScale,e,i):r.render((t-r._startTime)*r._timeScale,e,i)),r=s},n.rawTime=function(){return o||a.wake(),this._totalTime};var D=g("TweenLite",function(e,i,s){if(R.call(this,i,s),this.render=D.prototype.render,null==e)throw"Cannot tween a null target.";this.target=e="string"!=typeof e?e:D.selector(e)||e;var r,n,a,o=e.jquery||e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType),h=this.vars.overwrite;if(this._overwrite=h=null==h?B[D.defaultOverwrite]:"number"==typeof h?h>>0:B[h],(o||e instanceof Array||e.push&&f(e))&&"number"!=typeof e[0])for(this._targets=a=u(e),this._propLookup=[],this._siblings=[],r=0;r<a.length;r++)n=a[r],n?"string"!=typeof n?n.length&&n!==t&&n[0]&&(n[0]===t||n[0].nodeType&&n[0].style&&!n.nodeType)?(a.splice(r--,1),this._targets=a=a.concat(u(n))):(this._siblings[r]=W(n,this,!1),1===h&&this._siblings[r].length>1&&G(n,this,null,1,this._siblings[r])):(n=a[r--]=D.selector(n),"string"==typeof n&&a.splice(r+1,1)):a.splice(r--,1);else this._propLookup={},this._siblings=W(e,this,!1),1===h&&this._siblings.length>1&&G(e,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-_,this.render(-this._delay))},!0),M=function(e){return e&&e.length&&e!==t&&e[0]&&(e[0]===t||e[0].nodeType&&e[0].style&&!e.nodeType)},z=function(t,e){var i,s={};for(i in t)Y[i]||i in e&&"transform"!==i&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!X[i]||X[i]&&X[i]._autoCSS)||(s[i]=t[i],delete t[i]);t.css=s};n=D.prototype=new R,n.constructor=D,n.kill()._gc=!1,n.ratio=0,n._firstPT=n._targets=n._overwrittenProps=n._startAt=null,n._notifyPluginsOfEnabled=n._lazy=!1,D.version="1.17.0",D.defaultEase=n._ease=new T(null,null,1,1),D.defaultOverwrite="auto",D.ticker=a,D.autoSleep=120,D.lagSmoothing=function(t,e){a.lagSmoothing(t,e)},D.selector=t.$||t.jQuery||function(e){var i=t.$||t.jQuery;return i?(D.selector=i,i(e)):"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e)};var F=[],I={},N=D._internals={isArray:f,isSelector:M,lazyTweens:F},X=D._plugins={},L=N.tweenLookup={},E=0,Y=N.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1},B={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},j=R._rootFramesTimeline=new C,U=R._rootTimeline=new C,V=30,q=N.lazyRender=function(){var t,e=F.length;for(I={};--e>-1;)t=F[e],t&&t._lazy!==!1&&(t.render(t._lazy[0],t._lazy[1],!0),t._lazy=!1);F.length=0};U._startTime=a.time,j._startTime=a.frame,U._active=j._active=!0,setTimeout(q,1),R._updateRoot=D.render=function(){var t,e,i;if(F.length&&q(),U.render((a.time-U._startTime)*U._timeScale,!1,!1),j.render((a.frame-j._startTime)*j._timeScale,!1,!1),F.length&&q(),a.frame>=V){V=a.frame+(parseInt(D.autoSleep,10)||120);for(i in L){for(e=L[i].tweens,t=e.length;--t>-1;)e[t]._gc&&e.splice(t,1);0===e.length&&delete L[i]}if(i=U._first,(!i||i._paused)&&D.autoSleep&&!j._first&&1===a._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||a.sleep()}}},a.addEventListener("tick",R._updateRoot);var W=function(t,e,i){var s,r,n=t._gsTweenID;if(L[n||(t._gsTweenID=n="t"+E++)]||(L[n]={target:t,tweens:[]}),e&&(s=L[n].tweens,s[r=s.length]=e,i))for(;--r>-1;)s[r]===e&&s.splice(r,1);return L[n].tweens},Z=function(t,e,i,s){var r,n,a=t.vars.onOverwrite;return a&&(r=a(t,e,i,s)),a=D.onOverwrite,a&&(n=a(t,e,i,s)),r!==!1&&n!==!1},G=function(t,e,i,s,r){var n,a,o,h;if(1===s||s>=4){for(h=r.length,n=0;h>n;n++)if((o=r[n])!==e)o._gc||o._kill(null,t,e)&&(a=!0);else if(5===s)break;return a}var l,u=e._startTime+_,c=[],f=0,p=0===e._duration;for(n=r.length;--n>-1;)(o=r[n])===e||o._gc||o._paused||(o._timeline!==e._timeline?(l=l||$(e,0,p),0===$(o,l,p)&&(c[f++]=o)):o._startTime<=u&&o._startTime+o.totalDuration()/o._timeScale>u&&((p||!o._initted)&&u-o._startTime<=2e-10||(c[f++]=o)));for(n=f;--n>-1;)if(o=c[n],2===s&&o._kill(i,t,e)&&(a=!0),2!==s||!o._firstPT&&o._initted){if(2!==s&&!Z(o,e))continue;o._enabled(!1,!1)&&(a=!0)}return a},$=function(t,e,i){for(var s=t._timeline,r=s._timeScale,n=t._startTime;s._timeline;){if(n+=s._startTime,r*=s._timeScale,s._paused)return-100;s=s._timeline}return n/=r,n>e?n-e:i&&n===e||!t._initted&&2*_>n-e?_:(n+=t.totalDuration()/t._timeScale/r)>e+_?0:n-e-_};n._init=function(){var t,e,i,s,r,n=this.vars,a=this._overwrittenProps,o=this._duration,h=!!n.immediateRender,l=n.ease;if(n.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),r={};for(s in n.startAt)r[s]=n.startAt[s];if(r.overwrite=!1,r.immediateRender=!0,r.lazy=h&&n.lazy!==!1,r.startAt=r.delay=null,this._startAt=D.to(this.target,0,r),h)if(this._time>0)this._startAt=null;else if(0!==o)return}else if(n.runBackwards&&0!==o)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(h=!1),i={};for(s in n)Y[s]&&"autoCSS"!==s||(i[s]=n[s]);if(i.overwrite=0,i.data="isFromStart",i.lazy=h&&n.lazy!==!1,i.immediateRender=h,this._startAt=D.to(this.target,0,i),h){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=l=l?l instanceof T?l:"function"==typeof l?new T(l,n.easeParams):x[l]||D.defaultEase:D.defaultEase,n.easeParams instanceof Array&&l.config&&(this._ease=l.config.apply(l,n.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(t=this._targets.length;--t>-1;)this._initProps(this._targets[t],this._propLookup[t]={},this._siblings[t],a?a[t]:null)&&(e=!0);else e=this._initProps(this.target,this._propLookup,this._siblings,a);if(e&&D._onPluginEvent("_onInitAllProps",this),a&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),n.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=n.onUpdate,this._initted=!0},n._initProps=function(e,i,s,r){var n,a,o,h,l,_;if(null==e)return!1;I[e._gsTweenID]&&q(),this.vars.css||e.style&&e!==t&&e.nodeType&&X.css&&this.vars.autoCSS!==!1&&z(this.vars,e);for(n in this.vars){if(_=this.vars[n],Y[n])_&&(_ instanceof Array||_.push&&f(_))&&-1!==_.join("").indexOf("{self}")&&(this.vars[n]=_=this._swapSelfInParams(_,this));else if(X[n]&&(h=new X[n])._onInitTween(e,this.vars[n],this)){for(this._firstPT=l={_next:this._firstPT,t:h,p:"setRatio",s:0,c:1,f:!0,n:n,pg:!0,pr:h._priority},a=h._overwriteProps.length;--a>-1;)i[h._overwriteProps[a]]=this._firstPT;(h._priority||h._onInitAllProps)&&(o=!0),(h._onDisable||h._onEnable)&&(this._notifyPluginsOfEnabled=!0);
}else this._firstPT=i[n]=l={_next:this._firstPT,t:e,p:n,f:"function"==typeof e[n],n:n,pg:!1,pr:0},l.s=l.f?e[n.indexOf("set")||"function"!=typeof e["get"+n.substr(3)]?n:"get"+n.substr(3)]():parseFloat(e[n]),l.c="string"==typeof _&&"="===_.charAt(1)?parseInt(_.charAt(0)+"1",10)*Number(_.substr(2)):Number(_)-l.s||0;l&&l._next&&(l._next._prev=l)}return r&&this._kill(r,e)?this._initProps(e,i,s,r):this._overwrite>1&&this._firstPT&&s.length>1&&G(e,this,i,this._overwrite,s)?(this._kill(i,e),this._initProps(e,i,s,r)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(I[e._gsTweenID]=!0),o)},n.render=function(t,e,i){var s,r,n,a,o=this._time,h=this._duration,l=this._rawPrevTime;if(t>=h)this._totalTime=this._time=h,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(s=!0,r="onComplete",i=i||this._timeline.autoRemoveChildren),0===h&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(t=0),(0===t||0>l||l===_&&"isPause"!==this.data)&&l!==t&&(i=!0,l>_&&(r="onReverseComplete")),this._rawPrevTime=a=!e||t||l===t?t:_);else if(1e-7>t)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==o||0===h&&l>0)&&(r="onReverseComplete",s=this._reversed),0>t&&(this._active=!1,0===h&&(this._initted||!this.vars.lazy||i)&&(l>=0&&(l!==_||"isPause"!==this.data)&&(i=!0),this._rawPrevTime=a=!e||t||l===t?t:_)),this._initted||(i=!0);else if(this._totalTime=this._time=t,this._easeType){var u=t/h,c=this._easeType,f=this._easePower;(1===c||3===c&&u>=.5)&&(u=1-u),3===c&&(u*=2),1===f?u*=u:2===f?u*=u*u:3===f?u*=u*u*u:4===f&&(u*=u*u*u*u),1===c?this.ratio=1-u:2===c?this.ratio=u:.5>t/h?this.ratio=u/2:this.ratio=1-u/2}else this.ratio=this._ease.getRatio(t/h);if(this._time!==o||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=o,this._rawPrevTime=l,F.push(this),void(this._lazy=[t,e]);this._time&&!s?this.ratio=this._ease.getRatio(this._time/h):s&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==o&&t>=0&&(this._active=!0),0===o&&(this._startAt&&(t>=0?this._startAt.render(t,e,i):r||(r="_dummyGS")),this.vars.onStart&&(0!==this._time||0===h)&&(e||this._callback("onStart"))),n=this._firstPT;n;)n.f?n.t[n.p](n.c*this.ratio+n.s):n.t[n.p]=n.c*this.ratio+n.s,n=n._next;this._onUpdate&&(0>t&&this._startAt&&t!==-1e-4&&this._startAt.render(t,e,i),e||(this._time!==o||s)&&this._callback("onUpdate")),r&&(!this._gc||i)&&(0>t&&this._startAt&&!this._onUpdate&&t!==-1e-4&&this._startAt.render(t,e,i),s&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!e&&this.vars[r]&&this._callback(r),0===h&&this._rawPrevTime===_&&a!==_&&(this._rawPrevTime=0))}},n._kill=function(t,e,i){if("all"===t&&(t=null),null==t&&(null==e||e===this.target))return this._lazy=!1,this._enabled(!1,!1);e="string"!=typeof e?e||this._targets||this.target:D.selector(e)||e;var s,r,n,a,o,h,l,_,u,c=i&&this._time&&i._startTime===this._startTime&&this._timeline===i._timeline;if((f(e)||M(e))&&"number"!=typeof e[0])for(s=e.length;--s>-1;)this._kill(t,e[s],i)&&(h=!0);else{if(this._targets){for(s=this._targets.length;--s>-1;)if(e===this._targets[s]){o=this._propLookup[s]||{},this._overwrittenProps=this._overwrittenProps||[],r=this._overwrittenProps[s]=t?this._overwrittenProps[s]||{}:"all";break}}else{if(e!==this.target)return!1;o=this._propLookup,r=this._overwrittenProps=t?this._overwrittenProps||{}:"all"}if(o){if(l=t||o,_=t!==r&&"all"!==r&&t!==o&&("object"!=typeof t||!t._tempKill),i&&(D.onOverwrite||this.vars.onOverwrite)){for(n in l)o[n]&&(u||(u=[]),u.push(n));if((u||!t)&&!Z(this,i,e,u))return!1}for(n in l)(a=o[n])&&(c&&(a.f?a.t[a.p](a.s):a.t[a.p]=a.s,h=!0),a.pg&&a.t._kill(l)&&(h=!0),a.pg&&0!==a.t._overwriteProps.length||(a._prev?a._prev._next=a._next:a===this._firstPT&&(this._firstPT=a._next),a._next&&(a._next._prev=a._prev),a._next=a._prev=null),delete o[n]),_&&(r[n]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return h},n.invalidate=function(){return this._notifyPluginsOfEnabled&&D._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],R.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-_,this.render(-this._delay)),this},n._enabled=function(t,e){if(o||a.wake(),t&&this._gc){var i,s=this._targets;if(s)for(i=s.length;--i>-1;)this._siblings[i]=W(s[i],this,!0);else this._siblings=W(this.target,this,!0)}return R.prototype._enabled.call(this,t,e),this._notifyPluginsOfEnabled&&this._firstPT?D._onPluginEvent(t?"_onEnable":"_onDisable",this):!1},D.to=function(t,e,i){return new D(t,e,i)},D.from=function(t,e,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new D(t,e,i)},D.fromTo=function(t,e,i,s){return s.startAt=i,s.immediateRender=0!=s.immediateRender&&0!=i.immediateRender,new D(t,e,s)},D.delayedCall=function(t,e,i,s,r){return new D(e,0,{delay:t,onComplete:e,onCompleteParams:i,callbackScope:s,onReverseComplete:e,onReverseCompleteParams:i,immediateRender:!1,lazy:!1,useFrames:r,overwrite:0})},D.set=function(t,e){return new D(t,0,e)},D.getTweensOf=function(t,e){if(null==t)return[];t="string"!=typeof t?t:D.selector(t)||t;var i,s,r,n;if((f(t)||M(t))&&"number"!=typeof t[0]){for(i=t.length,s=[];--i>-1;)s=s.concat(D.getTweensOf(t[i],e));for(i=s.length;--i>-1;)for(n=s[i],r=i;--r>-1;)n===s[r]&&s.splice(i,1)}else for(s=W(t).concat(),i=s.length;--i>-1;)(s[i]._gc||e&&!s[i].isActive())&&s.splice(i,1);return s},D.killTweensOf=D.killDelayedCallsTo=function(t,e,i){"object"==typeof e&&(i=e,e=!1);for(var s=D.getTweensOf(t,e),r=s.length;--r>-1;)s[r]._kill(i,t)};var Q=g("plugins.TweenPlugin",function(t,e){this._overwriteProps=(t||"").split(","),this._propName=this._overwriteProps[0],this._priority=e||0,this._super=Q.prototype},!0);if(n=Q.prototype,Q.version="1.10.1",Q.API=2,n._firstPT=null,n._addTween=function(t,e,i,s,r,n){var a,o;return null!=s&&(a="number"==typeof s||"="!==s.charAt(1)?Number(s)-Number(i):parseInt(s.charAt(0)+"1",10)*Number(s.substr(2)))?(this._firstPT=o={_next:this._firstPT,t:t,p:e,s:i,c:a,f:"function"==typeof t[e],n:r||e,r:n},o._next&&(o._next._prev=o),o):void 0},n.setRatio=function(t){for(var e,i=this._firstPT,s=1e-6;i;)e=i.c*t+i.s,i.r?e=Math.round(e):s>e&&e>-s&&(e=0),i.f?i.t[i.p](e):i.t[i.p]=e,i=i._next},n._kill=function(t){var e,i=this._overwriteProps,s=this._firstPT;if(null!=t[this._propName])this._overwriteProps=[];else for(e=i.length;--e>-1;)null!=t[i[e]]&&i.splice(e,1);for(;s;)null!=t[s.n]&&(s._next&&(s._next._prev=s._prev),s._prev?(s._prev._next=s._next,s._prev=null):this._firstPT===s&&(this._firstPT=s._next)),s=s._next;return!1},n._roundProps=function(t,e){for(var i=this._firstPT;i;)(t[this._propName]||null!=i.n&&t[i.n.split(this._propName+"_").join("")])&&(i.r=e),i=i._next},D._onPluginEvent=function(t,e){var i,s,r,n,a,o=e._firstPT;if("_onInitAllProps"===t){for(;o;){for(a=o._next,s=r;s&&s.pr>o.pr;)s=s._next;(o._prev=s?s._prev:n)?o._prev._next=o:r=o,(o._next=s)?s._prev=o:n=o,o=a}o=e._firstPT=r}for(;o;)o.pg&&"function"==typeof o.t[t]&&o.t[t]()&&(i=!0),o=o._next;return i},Q.activate=function(t){for(var e=t.length;--e>-1;)t[e].API===Q.API&&(X[(new t[e])._propName]=t[e]);return!0},d.plugin=function(t){if(!(t&&t.propName&&t.init&&t.API))throw"illegal plugin definition.";var e,i=t.propName,s=t.priority||0,r=t.overwriteProps,n={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_roundProps",initAll:"_onInitAllProps"},a=g("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",function(){Q.call(this,i,s),this._overwriteProps=r||[]},t.global===!0),o=a.prototype=new Q(i);o.constructor=a,a.API=t.API;for(e in n)"function"==typeof t[e]&&(o[n[e]]=t[e]);return a.version=t.version,Q.activate([a]),a},s=t._gsQueue){for(r=0;r<s.length;r++)s[r]();for(n in p)p[n].func||t.console.log("GSAP encountered missing dependency: com.greensock."+n)}o=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax");
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],4:[function(require,module,exports){
(function (global){
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(t,e){var r,i,s,n,a=function(){t.call(this,"css"),this._overwriteProps.length=0,this.setRatio=a.prototype.setRatio},o=_gsScope._gsDefine.globals,l={},f=a.prototype=new t("css");f.constructor=a,a.version="1.17.0",a.API=2,a.defaultTransformPerspective=0,a.defaultSkewType="compensated",a.defaultSmoothOrigin=!0,f="px",a.suffixMap={top:f,right:f,bottom:f,left:f,width:f,height:f,fontSize:f,padding:f,margin:f,perspective:f,lineHeight:""};var p,c,h,u,x,d,g=/(?:\d|\-\d|\.\d|\-\.\d)+/g,y=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,m=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,_=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,v=/(?:\d|\-|\+|=|#|\.)*/g,b=/opacity *= *([^)]*)/i,O=/opacity:([^;]*)/i,w=/alpha\(opacity *=.+?\)/i,P=/^(rgb|hsl)/,T=/([A-Z])/g,M=/-([a-z])/gi,X=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,k=function(t,e){return e.toUpperCase()},S=/(?:Left|Right|Width)/i,R=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,A=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,F=/,(?=[^\)]*(?:\(|$))/gi,Y=Math.PI/180,C=180/Math.PI,z={},N=document,V=function(t){return N.createElementNS?N.createElementNS("http://www.w3.org/1999/xhtml",t):N.createElement(t)},j=V("div"),B=V("img"),L=a._internals={_specialProps:l},D=navigator.userAgent,I=function(){var t=D.indexOf("Android"),e=V("a");return h=-1!==D.indexOf("Safari")&&-1===D.indexOf("Chrome")&&(-1===t||Number(D.substr(t+8,1))>3),x=h&&Number(D.substr(D.indexOf("Version/")+8,1))<6,u=-1!==D.indexOf("Firefox"),(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(D)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(D))&&(d=parseFloat(RegExp.$1)),e?(e.style.cssText="top:1px;opacity:.55;",/^0.55/.test(e.style.opacity)):!1}(),W=function(t){return b.test("string"==typeof t?t:(t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?parseFloat(RegExp.$1)/100:1},Z=function(t){window.console&&console.log(t)},E="",$="",q=function(t,e){e=e||j;var r,i,s=e.style;if(void 0!==s[t])return t;for(t=t.charAt(0).toUpperCase()+t.substr(1),r=["O","Moz","ms","Ms","Webkit"],i=5;--i>-1&&void 0===s[r[i]+t];);return i>=0?($=3===i?"ms":r[i],E="-"+$.toLowerCase()+"-",$+t):null},H=N.defaultView?N.defaultView.getComputedStyle:function(){},G=a.getStyle=function(t,e,r,i,s){var n;return I||"opacity"!==e?(!i&&t.style[e]?n=t.style[e]:(r=r||H(t))?n=r[e]||r.getPropertyValue(e)||r.getPropertyValue(e.replace(T,"-$1").toLowerCase()):t.currentStyle&&(n=t.currentStyle[e]),null==s||n&&"none"!==n&&"auto"!==n&&"auto auto"!==n?n:s):W(t)},U=L.convertToPixels=function(t,r,i,s,n){if("px"===s||!s)return i;if("auto"===s||!i)return 0;var o,l,f,p=S.test(r),c=t,h=j.style,u=0>i;if(u&&(i=-i),"%"===s&&-1!==r.indexOf("border"))o=i/100*(p?t.clientWidth:t.clientHeight);else{if(h.cssText="border:0 solid red;position:"+G(t,"position")+";line-height:0;","%"!==s&&c.appendChild)h[p?"borderLeftWidth":"borderTopWidth"]=i+s;else{if(c=t.parentNode||N.body,l=c._gsCache,f=e.ticker.frame,l&&p&&l.time===f)return l.width*i/100;h[p?"width":"height"]=i+s}c.appendChild(j),o=parseFloat(j[p?"offsetWidth":"offsetHeight"]),c.removeChild(j),p&&"%"===s&&a.cacheWidths!==!1&&(l=c._gsCache=c._gsCache||{},l.time=f,l.width=o/i*100),0!==o||n||(o=U(t,r,i,s,!0))}return u?-o:o},Q=L.calculateOffset=function(t,e,r){if("absolute"!==G(t,"position",r))return 0;var i="left"===e?"Left":"Top",s=G(t,"margin"+i,r);return t["offset"+i]-(U(t,e,parseFloat(s),s.replace(v,""))||0)},J=function(t,e){var r,i,s,n={};if(e=e||H(t,null))if(r=e.length)for(;--r>-1;)s=e[r],(-1===s.indexOf("-transform")||Pt===s)&&(n[s.replace(M,k)]=e.getPropertyValue(s));else for(r in e)(-1===r.indexOf("Transform")||wt===r)&&(n[r]=e[r]);else if(e=t.currentStyle||t.style)for(r in e)"string"==typeof r&&void 0===n[r]&&(n[r.replace(M,k)]=e[r]);return I||(n.opacity=W(t)),i=Nt(t,e,!1),n.rotation=i.rotation,n.skewX=i.skewX,n.scaleX=i.scaleX,n.scaleY=i.scaleY,n.x=i.x,n.y=i.y,Mt&&(n.z=i.z,n.rotationX=i.rotationX,n.rotationY=i.rotationY,n.scaleZ=i.scaleZ),n.filters&&delete n.filters,n},K=function(t,e,r,i,s){var n,a,o,l={},f=t.style;for(a in r)"cssText"!==a&&"length"!==a&&isNaN(a)&&(e[a]!==(n=r[a])||s&&s[a])&&-1===a.indexOf("Origin")&&("number"==typeof n||"string"==typeof n)&&(l[a]="auto"!==n||"left"!==a&&"top"!==a?""!==n&&"auto"!==n&&"none"!==n||"string"!=typeof e[a]||""===e[a].replace(_,"")?n:0:Q(t,a),void 0!==f[a]&&(o=new ut(f,a,f[a],o)));if(i)for(a in i)"className"!==a&&(l[a]=i[a]);return{difs:l,firstMPT:o}},tt={width:["Left","Right"],height:["Top","Bottom"]},et=["marginLeft","marginRight","marginTop","marginBottom"],rt=function(t,e,r){var i=parseFloat("width"===e?t.offsetWidth:t.offsetHeight),s=tt[e],n=s.length;for(r=r||H(t,null);--n>-1;)i-=parseFloat(G(t,"padding"+s[n],r,!0))||0,i-=parseFloat(G(t,"border"+s[n]+"Width",r,!0))||0;return i},it=function(t,e){(null==t||""===t||"auto"===t||"auto auto"===t)&&(t="0 0");var r=t.split(" "),i=-1!==t.indexOf("left")?"0%":-1!==t.indexOf("right")?"100%":r[0],s=-1!==t.indexOf("top")?"0%":-1!==t.indexOf("bottom")?"100%":r[1];return null==s?s="center"===i?"50%":"0":"center"===s&&(s="50%"),("center"===i||isNaN(parseFloat(i))&&-1===(i+"").indexOf("="))&&(i="50%"),t=i+" "+s+(r.length>2?" "+r[2]:""),e&&(e.oxp=-1!==i.indexOf("%"),e.oyp=-1!==s.indexOf("%"),e.oxr="="===i.charAt(1),e.oyr="="===s.charAt(1),e.ox=parseFloat(i.replace(_,"")),e.oy=parseFloat(s.replace(_,"")),e.v=t),e||t},st=function(t,e){return"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2)):parseFloat(t)-parseFloat(e)},nt=function(t,e){return null==t?e:"string"==typeof t&&"="===t.charAt(1)?parseInt(t.charAt(0)+"1",10)*parseFloat(t.substr(2))+e:parseFloat(t)},at=function(t,e,r,i){var s,n,a,o,l,f=1e-6;return null==t?o=e:"number"==typeof t?o=t:(s=360,n=t.split("_"),l="="===t.charAt(1),a=(l?parseInt(t.charAt(0)+"1",10)*parseFloat(n[0].substr(2)):parseFloat(n[0]))*(-1===t.indexOf("rad")?1:C)-(l?0:e),n.length&&(i&&(i[r]=e+a),-1!==t.indexOf("short")&&(a%=s,a!==a%(s/2)&&(a=0>a?a+s:a-s)),-1!==t.indexOf("_cw")&&0>a?a=(a+9999999999*s)%s-(a/s|0)*s:-1!==t.indexOf("ccw")&&a>0&&(a=(a-9999999999*s)%s-(a/s|0)*s)),o=e+a),f>o&&o>-f&&(o=0),o},ot={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},lt=function(t,e,r){return t=0>t?t+1:t>1?t-1:t,255*(1>6*t?e+(r-e)*t*6:.5>t?r:2>3*t?e+(r-e)*(2/3-t)*6:e)+.5|0},ft=a.parseColor=function(t){var e,r,i,s,n,a;return t&&""!==t?"number"==typeof t?[t>>16,t>>8&255,255&t]:(","===t.charAt(t.length-1)&&(t=t.substr(0,t.length-1)),ot[t]?ot[t]:"#"===t.charAt(0)?(4===t.length&&(e=t.charAt(1),r=t.charAt(2),i=t.charAt(3),t="#"+e+e+r+r+i+i),t=parseInt(t.substr(1),16),[t>>16,t>>8&255,255&t]):"hsl"===t.substr(0,3)?(t=t.match(g),s=Number(t[0])%360/360,n=Number(t[1])/100,a=Number(t[2])/100,r=.5>=a?a*(n+1):a+n-a*n,e=2*a-r,t.length>3&&(t[3]=Number(t[3])),t[0]=lt(s+1/3,e,r),t[1]=lt(s,e,r),t[2]=lt(s-1/3,e,r),t):(t=t.match(g)||ot.transparent,t[0]=Number(t[0]),t[1]=Number(t[1]),t[2]=Number(t[2]),t.length>3&&(t[3]=Number(t[3])),t)):ot.black},pt="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#.+?\\b";for(f in ot)pt+="|"+f+"\\b";pt=new RegExp(pt+")","gi");var ct=function(t,e,r,i){if(null==t)return function(t){return t};var s,n=e?(t.match(pt)||[""])[0]:"",a=t.split(n).join("").match(m)||[],o=t.substr(0,t.indexOf(a[0])),l=")"===t.charAt(t.length-1)?")":"",f=-1!==t.indexOf(" ")?" ":",",p=a.length,c=p>0?a[0].replace(g,""):"";return p?s=e?function(t){var e,h,u,x;if("number"==typeof t)t+=c;else if(i&&F.test(t)){for(x=t.replace(F,"|").split("|"),u=0;u<x.length;u++)x[u]=s(x[u]);return x.join(",")}if(e=(t.match(pt)||[n])[0],h=t.split(e).join("").match(m)||[],u=h.length,p>u--)for(;++u<p;)h[u]=r?h[(u-1)/2|0]:a[u];return o+h.join(f)+f+e+l+(-1!==t.indexOf("inset")?" inset":"")}:function(t){var e,n,h;if("number"==typeof t)t+=c;else if(i&&F.test(t)){for(n=t.replace(F,"|").split("|"),h=0;h<n.length;h++)n[h]=s(n[h]);return n.join(",")}if(e=t.match(m)||[],h=e.length,p>h--)for(;++h<p;)e[h]=r?e[(h-1)/2|0]:a[h];return o+e.join(f)+l}:function(t){return t}},ht=function(t){return t=t.split(","),function(e,r,i,s,n,a,o){var l,f=(r+"").split(" ");for(o={},l=0;4>l;l++)o[t[l]]=f[l]=f[l]||f[(l-1)/2>>0];return s.parse(e,o,n,a)}},ut=(L._setPluginRatio=function(t){this.plugin.setRatio(t);for(var e,r,i,s,n=this.data,a=n.proxy,o=n.firstMPT,l=1e-6;o;)e=a[o.v],o.r?e=Math.round(e):l>e&&e>-l&&(e=0),o.t[o.p]=e,o=o._next;if(n.autoRotate&&(n.autoRotate.rotation=a.rotation),1===t)for(o=n.firstMPT;o;){if(r=o.t,r.type){if(1===r.type){for(s=r.xs0+r.s+r.xs1,i=1;i<r.l;i++)s+=r["xn"+i]+r["xs"+(i+1)];r.e=s}}else r.e=r.s+r.xs0;o=o._next}},function(t,e,r,i,s){this.t=t,this.p=e,this.v=r,this.r=s,i&&(i._prev=this,this._next=i)}),xt=(L._parseToProxy=function(t,e,r,i,s,n){var a,o,l,f,p,c=i,h={},u={},x=r._transform,d=z;for(r._transform=null,z=e,i=p=r.parse(t,e,i,s),z=d,n&&(r._transform=x,c&&(c._prev=null,c._prev&&(c._prev._next=null)));i&&i!==c;){if(i.type<=1&&(o=i.p,u[o]=i.s+i.c,h[o]=i.s,n||(f=new ut(i,"s",o,f,i.r),i.c=0),1===i.type))for(a=i.l;--a>0;)l="xn"+a,o=i.p+"_"+l,u[o]=i.data[l],h[o]=i[l],n||(f=new ut(i,l,o,f,i.rxp[l]));i=i._next}return{proxy:h,end:u,firstMPT:f,pt:p}},L.CSSPropTween=function(t,e,i,s,a,o,l,f,p,c,h){this.t=t,this.p=e,this.s=i,this.c=s,this.n=l||e,t instanceof xt||n.push(this.n),this.r=f,this.type=o||0,p&&(this.pr=p,r=!0),this.b=void 0===c?i:c,this.e=void 0===h?i+s:h,a&&(this._next=a,a._prev=this)}),dt=function(t,e,r,i,s,n){var a=new xt(t,e,r,i-r,s,-1,n);return a.b=r,a.e=a.xs0=i,a},gt=a.parseComplex=function(t,e,r,i,s,n,a,o,l,f){r=r||n||"",a=new xt(t,e,0,0,a,f?2:1,null,!1,o,r,i),i+="";var c,h,u,x,d,m,_,v,b,O,w,T,M=r.split(", ").join(",").split(" "),X=i.split(", ").join(",").split(" "),k=M.length,S=p!==!1;for((-1!==i.indexOf(",")||-1!==r.indexOf(","))&&(M=M.join(" ").replace(F,", ").split(" "),X=X.join(" ").replace(F,", ").split(" "),k=M.length),k!==X.length&&(M=(n||"").split(" "),k=M.length),a.plugin=l,a.setRatio=f,c=0;k>c;c++)if(x=M[c],d=X[c],v=parseFloat(x),v||0===v)a.appendXtra("",v,st(d,v),d.replace(y,""),S&&-1!==d.indexOf("px"),!0);else if(s&&("#"===x.charAt(0)||ot[x]||P.test(x)))T=","===d.charAt(d.length-1)?"),":")",x=ft(x),d=ft(d),b=x.length+d.length>6,b&&!I&&0===d[3]?(a["xs"+a.l]+=a.l?" transparent":"transparent",a.e=a.e.split(X[c]).join("transparent")):(I||(b=!1),a.appendXtra(b?"rgba(":"rgb(",x[0],d[0]-x[0],",",!0,!0).appendXtra("",x[1],d[1]-x[1],",",!0).appendXtra("",x[2],d[2]-x[2],b?",":T,!0),b&&(x=x.length<4?1:x[3],a.appendXtra("",x,(d.length<4?1:d[3])-x,T,!1)));else if(m=x.match(g)){if(_=d.match(y),!_||_.length!==m.length)return a;for(u=0,h=0;h<m.length;h++)w=m[h],O=x.indexOf(w,u),a.appendXtra(x.substr(u,O-u),Number(w),st(_[h],w),"",S&&"px"===x.substr(O+w.length,2),0===h),u=O+w.length;a["xs"+a.l]+=x.substr(u)}else a["xs"+a.l]+=a.l?" "+x:x;if(-1!==i.indexOf("=")&&a.data){for(T=a.xs0+a.data.s,c=1;c<a.l;c++)T+=a["xs"+c]+a.data["xn"+c];a.e=T+a["xs"+c]}return a.l||(a.type=-1,a.xs0=a.e),a.xfirst||a},yt=9;for(f=xt.prototype,f.l=f.pr=0;--yt>0;)f["xn"+yt]=0,f["xs"+yt]="";f.xs0="",f._next=f._prev=f.xfirst=f.data=f.plugin=f.setRatio=f.rxp=null,f.appendXtra=function(t,e,r,i,s,n){var a=this,o=a.l;return a["xs"+o]+=n&&o?" "+t:t||"",r||0===o||a.plugin?(a.l++,a.type=a.setRatio?2:1,a["xs"+a.l]=i||"",o>0?(a.data["xn"+o]=e+r,a.rxp["xn"+o]=s,a["xn"+o]=e,a.plugin||(a.xfirst=new xt(a,"xn"+o,e,r,a.xfirst||a,0,a.n,s,a.pr),a.xfirst.xs0=0),a):(a.data={s:e+r},a.rxp={},a.s=e,a.c=r,a.r=s,a)):(a["xs"+o]+=e+(i||""),a)};var mt=function(t,e){e=e||{},this.p=e.prefix?q(t)||t:t,l[t]=l[this.p]=this,this.format=e.formatter||ct(e.defaultValue,e.color,e.collapsible,e.multi),e.parser&&(this.parse=e.parser),this.clrs=e.color,this.multi=e.multi,this.keyword=e.keyword,this.dflt=e.defaultValue,this.pr=e.priority||0},_t=L._registerComplexSpecialProp=function(t,e,r){"object"!=typeof e&&(e={parser:r});var i,s,n=t.split(","),a=e.defaultValue;for(r=r||[a],i=0;i<n.length;i++)e.prefix=0===i&&e.prefix,e.defaultValue=r[i]||a,s=new mt(n[i],e)},vt=function(t){if(!l[t]){var e=t.charAt(0).toUpperCase()+t.substr(1)+"Plugin";_t(t,{parser:function(t,r,i,s,n,a,f){var p=o.com.greensock.plugins[e];return p?(p._cssRegister(),l[i].parse(t,r,i,s,n,a,f)):(Z("Error: "+e+" js file not loaded."),n)}})}};f=mt.prototype,f.parseComplex=function(t,e,r,i,s,n){var a,o,l,f,p,c,h=this.keyword;if(this.multi&&(F.test(r)||F.test(e)?(o=e.replace(F,"|").split("|"),l=r.replace(F,"|").split("|")):h&&(o=[e],l=[r])),l){for(f=l.length>o.length?l.length:o.length,a=0;f>a;a++)e=o[a]=o[a]||this.dflt,r=l[a]=l[a]||this.dflt,h&&(p=e.indexOf(h),c=r.indexOf(h),p!==c&&(-1===c?o[a]=o[a].split(h).join(""):-1===p&&(o[a]+=" "+h)));e=o.join(", "),r=l.join(", ")}return gt(t,this.p,e,r,this.clrs,this.dflt,i,this.pr,s,n)},f.parse=function(t,e,r,i,n,a,o){return this.parseComplex(t.style,this.format(G(t,this.p,s,!1,this.dflt)),this.format(e),n,a)},a.registerSpecialProp=function(t,e,r){_t(t,{parser:function(t,i,s,n,a,o,l){var f=new xt(t,s,0,0,a,2,s,!1,r);return f.plugin=o,f.setRatio=e(t,i,n._tween,s),f},priority:r})},a.useSVGTransformAttr=h||u;var bt,Ot="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),wt=q("transform"),Pt=E+"transform",Tt=q("transformOrigin"),Mt=null!==q("perspective"),Xt=L.Transform=function(){this.perspective=parseFloat(a.defaultTransformPerspective)||0,this.force3D=a.defaultForce3D!==!1&&Mt?a.defaultForce3D||"auto":!1},kt=window.SVGElement,St=function(t,e,r){var i,s=N.createElementNS("http://www.w3.org/2000/svg",t),n=/([a-z])([A-Z])/g;for(i in r)s.setAttributeNS(null,i.replace(n,"$1-$2").toLowerCase(),r[i]);return e.appendChild(s),s},Rt=N.documentElement,At=function(){var t,e,r,i=d||/Android/i.test(D)&&!window.chrome;return N.createElementNS&&!i&&(t=St("svg",Rt),e=St("rect",t,{width:100,height:50,x:100}),r=e.getBoundingClientRect().width,e.style[Tt]="50% 50%",e.style[wt]="scaleX(0.5)",i=r===e.getBoundingClientRect().width&&!(u&&Mt),Rt.removeChild(t)),i}(),Ft=function(t,e,r,i,s){var n,o,l,f,p,c,h,u,x,d,g,y,m,_,v=t._gsTransform,b=zt(t,!0);v&&(m=v.xOrigin,_=v.yOrigin),(!i||(n=i.split(" ")).length<2)&&(h=t.getBBox(),e=it(e).split(" "),n=[(-1!==e[0].indexOf("%")?parseFloat(e[0])/100*h.width:parseFloat(e[0]))+h.x,(-1!==e[1].indexOf("%")?parseFloat(e[1])/100*h.height:parseFloat(e[1]))+h.y]),r.xOrigin=f=parseFloat(n[0]),r.yOrigin=p=parseFloat(n[1]),i&&b!==Ct&&(c=b[0],h=b[1],u=b[2],x=b[3],d=b[4],g=b[5],y=c*x-h*u,o=f*(x/y)+p*(-u/y)+(u*g-x*d)/y,l=f*(-h/y)+p*(c/y)-(c*g-h*d)/y,f=r.xOrigin=n[0]=o,p=r.yOrigin=n[1]=l),v&&(s||s!==!1&&a.defaultSmoothOrigin!==!1?(o=f-m,l=p-_,v.xOffset+=o*b[0]+l*b[2]-o,v.yOffset+=o*b[1]+l*b[3]-l):v.xOffset=v.yOffset=0),t.setAttribute("data-svg-origin",n.join(" "))},Yt=function(t){return!!(kt&&"function"==typeof t.getBBox&&t.getCTM&&(!t.parentNode||t.parentNode.getBBox&&t.parentNode.getCTM))},Ct=[1,0,0,1,0,0],zt=function(t,e){var r,i,s,n,a,o=t._gsTransform||new Xt,l=1e5;if(wt?i=G(t,Pt,null,!0):t.currentStyle&&(i=t.currentStyle.filter.match(R),i=i&&4===i.length?[i[0].substr(4),Number(i[2].substr(4)),Number(i[1].substr(4)),i[3].substr(4),o.x||0,o.y||0].join(","):""),r=!i||"none"===i||"matrix(1, 0, 0, 1, 0, 0)"===i,(o.svg||t.getBBox&&Yt(t))&&(r&&-1!==(t.style[wt]+"").indexOf("matrix")&&(i=t.style[wt],r=0),s=t.getAttribute("transform"),r&&s&&(-1!==s.indexOf("matrix")?(i=s,r=0):-1!==s.indexOf("translate")&&(i="matrix(1,0,0,1,"+s.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",")+")",r=0))),r)return Ct;for(s=(i||"").match(/(?:\-|\b)[\d\-\.e]+\b/gi)||[],yt=s.length;--yt>-1;)n=Number(s[yt]),s[yt]=(a=n-(n|=0))?(a*l+(0>a?-.5:.5)|0)/l+n:n;return e&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s},Nt=L.getTransform=function(t,r,i,n){if(t._gsTransform&&i&&!n)return t._gsTransform;var o,l,f,p,c,h,u=i?t._gsTransform||new Xt:new Xt,x=u.scaleX<0,d=2e-5,g=1e5,y=Mt?parseFloat(G(t,Tt,r,!1,"0 0 0").split(" ")[2])||u.zOrigin||0:0,m=parseFloat(a.defaultTransformPerspective)||0;if(u.svg=!(!t.getBBox||!Yt(t)),u.svg&&(Ft(t,G(t,Tt,s,!1,"50% 50%")+"",u,t.getAttribute("data-svg-origin")),bt=a.useSVGTransformAttr||At),o=zt(t),o!==Ct){if(16===o.length){var _,v,b,O,w,P=o[0],T=o[1],M=o[2],X=o[3],k=o[4],S=o[5],R=o[6],A=o[7],F=o[8],Y=o[9],z=o[10],N=o[12],V=o[13],j=o[14],B=o[11],L=Math.atan2(R,z);u.zOrigin&&(j=-u.zOrigin,N=F*j-o[12],V=Y*j-o[13],j=z*j+u.zOrigin-o[14]),u.rotationX=L*C,L&&(O=Math.cos(-L),w=Math.sin(-L),_=k*O+F*w,v=S*O+Y*w,b=R*O+z*w,F=k*-w+F*O,Y=S*-w+Y*O,z=R*-w+z*O,B=A*-w+B*O,k=_,S=v,R=b),L=Math.atan2(F,z),u.rotationY=L*C,L&&(O=Math.cos(-L),w=Math.sin(-L),_=P*O-F*w,v=T*O-Y*w,b=M*O-z*w,Y=T*w+Y*O,z=M*w+z*O,B=X*w+B*O,P=_,T=v,M=b),L=Math.atan2(T,P),u.rotation=L*C,L&&(O=Math.cos(-L),w=Math.sin(-L),P=P*O+k*w,v=T*O+S*w,S=T*-w+S*O,R=M*-w+R*O,T=v),u.rotationX&&Math.abs(u.rotationX)+Math.abs(u.rotation)>359.9&&(u.rotationX=u.rotation=0,u.rotationY+=180),u.scaleX=(Math.sqrt(P*P+T*T)*g+.5|0)/g,u.scaleY=(Math.sqrt(S*S+Y*Y)*g+.5|0)/g,u.scaleZ=(Math.sqrt(R*R+z*z)*g+.5|0)/g,u.skewX=0,u.perspective=B?1/(0>B?-B:B):0,u.x=N,u.y=V,u.z=j,u.svg&&(u.x-=u.xOrigin-(u.xOrigin*P-u.yOrigin*k),u.y-=u.yOrigin-(u.yOrigin*T-u.xOrigin*S))}else if((!Mt||n||!o.length||u.x!==o[4]||u.y!==o[5]||!u.rotationX&&!u.rotationY)&&(void 0===u.x||"none"!==G(t,"display",r))){var D=o.length>=6,I=D?o[0]:1,W=o[1]||0,Z=o[2]||0,E=D?o[3]:1;u.x=o[4]||0,u.y=o[5]||0,f=Math.sqrt(I*I+W*W),p=Math.sqrt(E*E+Z*Z),c=I||W?Math.atan2(W,I)*C:u.rotation||0,h=Z||E?Math.atan2(Z,E)*C+c:u.skewX||0,Math.abs(h)>90&&Math.abs(h)<270&&(x?(f*=-1,h+=0>=c?180:-180,c+=0>=c?180:-180):(p*=-1,h+=0>=h?180:-180)),u.scaleX=f,u.scaleY=p,u.rotation=c,u.skewX=h,Mt&&(u.rotationX=u.rotationY=u.z=0,u.perspective=m,u.scaleZ=1),u.svg&&(u.x-=u.xOrigin-(u.xOrigin*I+u.yOrigin*Z),u.y-=u.yOrigin-(u.xOrigin*W+u.yOrigin*E))}u.zOrigin=y;for(l in u)u[l]<d&&u[l]>-d&&(u[l]=0)}return i&&(t._gsTransform=u,u.svg&&(bt&&t.style[wt]?e.delayedCall(.001,function(){Lt(t.style,wt)}):!bt&&t.getAttribute("transform")&&e.delayedCall(.001,function(){t.removeAttribute("transform")}))),u},Vt=function(t){var e,r,i=this.data,s=-i.rotation*Y,n=s+i.skewX*Y,a=1e5,o=(Math.cos(s)*i.scaleX*a|0)/a,l=(Math.sin(s)*i.scaleX*a|0)/a,f=(Math.sin(n)*-i.scaleY*a|0)/a,p=(Math.cos(n)*i.scaleY*a|0)/a,c=this.t.style,h=this.t.currentStyle;if(h){r=l,l=-f,f=-r,e=h.filter,c.filter="";var u,x,g=this.t.offsetWidth,y=this.t.offsetHeight,m="absolute"!==h.position,_="progid:DXImageTransform.Microsoft.Matrix(M11="+o+", M12="+l+", M21="+f+", M22="+p,O=i.x+g*i.xPercent/100,w=i.y+y*i.yPercent/100;if(null!=i.ox&&(u=(i.oxp?g*i.ox*.01:i.ox)-g/2,x=(i.oyp?y*i.oy*.01:i.oy)-y/2,O+=u-(u*o+x*l),w+=x-(u*f+x*p)),m?(u=g/2,x=y/2,_+=", Dx="+(u-(u*o+x*l)+O)+", Dy="+(x-(u*f+x*p)+w)+")"):_+=", sizingMethod='auto expand')",-1!==e.indexOf("DXImageTransform.Microsoft.Matrix(")?c.filter=e.replace(A,_):c.filter=_+" "+e,(0===t||1===t)&&1===o&&0===l&&0===f&&1===p&&(m&&-1===_.indexOf("Dx=0, Dy=0")||b.test(e)&&100!==parseFloat(RegExp.$1)||-1===e.indexOf(e.indexOf("Alpha"))&&c.removeAttribute("filter")),!m){var P,T,M,X=8>d?1:-1;for(u=i.ieOffsetX||0,x=i.ieOffsetY||0,i.ieOffsetX=Math.round((g-((0>o?-o:o)*g+(0>l?-l:l)*y))/2+O),i.ieOffsetY=Math.round((y-((0>p?-p:p)*y+(0>f?-f:f)*g))/2+w),yt=0;4>yt;yt++)T=et[yt],P=h[T],r=-1!==P.indexOf("px")?parseFloat(P):U(this.t,T,parseFloat(P),P.replace(v,""))||0,M=r!==i[T]?2>yt?-i.ieOffsetX:-i.ieOffsetY:2>yt?u-i.ieOffsetX:x-i.ieOffsetY,c[T]=(i[T]=Math.round(r-M*(0===yt||2===yt?1:X)))+"px"}}},jt=L.set3DTransformRatio=L.setTransformRatio=function(t){var e,r,i,s,n,a,o,l,f,p,c,h,x,d,g,y,m,_,v,b,O,w,P,T=this.data,M=this.t.style,X=T.rotation,k=T.rotationX,S=T.rotationY,R=T.scaleX,A=T.scaleY,F=T.scaleZ,C=T.x,z=T.y,N=T.z,V=T.svg,j=T.perspective,B=T.force3D;if(((1===t||0===t)&&"auto"===B&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!B)&&!N&&!j&&!S&&!k||bt&&V||!Mt)return void(X||T.skewX||V?(X*=Y,w=T.skewX*Y,P=1e5,e=Math.cos(X)*R,s=Math.sin(X)*R,r=Math.sin(X-w)*-A,n=Math.cos(X-w)*A,w&&"simple"===T.skewType&&(m=Math.tan(w),m=Math.sqrt(1+m*m),r*=m,n*=m,T.skewY&&(e*=m,s*=m)),V&&(C+=T.xOrigin-(T.xOrigin*e+T.yOrigin*r)+T.xOffset,z+=T.yOrigin-(T.xOrigin*s+T.yOrigin*n)+T.yOffset,bt&&(T.xPercent||T.yPercent)&&(d=this.t.getBBox(),C+=.01*T.xPercent*d.width,z+=.01*T.yPercent*d.height),d=1e-6,d>C&&C>-d&&(C=0),d>z&&z>-d&&(z=0)),v=(e*P|0)/P+","+(s*P|0)/P+","+(r*P|0)/P+","+(n*P|0)/P+","+C+","+z+")",V&&bt?this.t.setAttribute("transform","matrix("+v):M[wt]=(T.xPercent||T.yPercent?"translate("+T.xPercent+"%,"+T.yPercent+"%) matrix(":"matrix(")+v):M[wt]=(T.xPercent||T.yPercent?"translate("+T.xPercent+"%,"+T.yPercent+"%) matrix(":"matrix(")+R+",0,0,"+A+","+C+","+z+")");if(u&&(d=1e-4,d>R&&R>-d&&(R=F=2e-5),d>A&&A>-d&&(A=F=2e-5),!j||T.z||T.rotationX||T.rotationY||(j=0)),X||T.skewX)X*=Y,g=e=Math.cos(X),y=s=Math.sin(X),T.skewX&&(X-=T.skewX*Y,g=Math.cos(X),y=Math.sin(X),"simple"===T.skewType&&(m=Math.tan(T.skewX*Y),m=Math.sqrt(1+m*m),g*=m,y*=m,T.skewY&&(e*=m,s*=m))),r=-y,n=g;else{if(!(S||k||1!==F||j||V))return void(M[wt]=(T.xPercent||T.yPercent?"translate("+T.xPercent+"%,"+T.yPercent+"%) translate3d(":"translate3d(")+C+"px,"+z+"px,"+N+"px)"+(1!==R||1!==A?" scale("+R+","+A+")":""));e=n=1,r=s=0}f=1,i=a=o=l=p=c=0,h=j?-1/j:0,x=T.zOrigin,d=1e-6,b=",",O="0",X=S*Y,X&&(g=Math.cos(X),y=Math.sin(X),o=-y,p=h*-y,i=e*y,a=s*y,f=g,h*=g,e*=g,s*=g),X=k*Y,X&&(g=Math.cos(X),y=Math.sin(X),m=r*g+i*y,_=n*g+a*y,l=f*y,c=h*y,i=r*-y+i*g,a=n*-y+a*g,f*=g,h*=g,r=m,n=_),1!==F&&(i*=F,a*=F,f*=F,h*=F),1!==A&&(r*=A,n*=A,l*=A,c*=A),1!==R&&(e*=R,s*=R,o*=R,p*=R),(x||V)&&(x&&(C+=i*-x,z+=a*-x,N+=f*-x+x),V&&(C+=T.xOrigin-(T.xOrigin*e+T.yOrigin*r)+T.xOffset,z+=T.yOrigin-(T.xOrigin*s+T.yOrigin*n)+T.yOffset),d>C&&C>-d&&(C=O),d>z&&z>-d&&(z=O),d>N&&N>-d&&(N=0)),v=T.xPercent||T.yPercent?"translate("+T.xPercent+"%,"+T.yPercent+"%) matrix3d(":"matrix3d(",v+=(d>e&&e>-d?O:e)+b+(d>s&&s>-d?O:s)+b+(d>o&&o>-d?O:o),v+=b+(d>p&&p>-d?O:p)+b+(d>r&&r>-d?O:r)+b+(d>n&&n>-d?O:n),k||S?(v+=b+(d>l&&l>-d?O:l)+b+(d>c&&c>-d?O:c)+b+(d>i&&i>-d?O:i),v+=b+(d>a&&a>-d?O:a)+b+(d>f&&f>-d?O:f)+b+(d>h&&h>-d?O:h)+b):v+=",0,0,0,0,1,0,",v+=C+b+z+b+N+b+(j?1+-N/j:1)+")",M[wt]=v};f=Xt.prototype,f.x=f.y=f.z=f.skewX=f.skewY=f.rotation=f.rotationX=f.rotationY=f.zOrigin=f.xPercent=f.yPercent=f.xOffset=f.yOffset=0,f.scaleX=f.scaleY=f.scaleZ=1,_t("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(t,e,r,i,n,o,l){if(i._lastParsedTransform===l)return n;i._lastParsedTransform=l;var f,p,c,h,u,x,d,g,y,m=t._gsTransform,_=i._transform=Nt(t,s,!0,l.parseTransform),v=t.style,b=1e-6,O=Ot.length,w=l,P={},T="transformOrigin";if("string"==typeof w.transform&&wt)c=j.style,c[wt]=w.transform,c.display="block",c.position="absolute",N.body.appendChild(j),f=Nt(j,null,!1),N.body.removeChild(j),null!=w.xPercent&&(f.xPercent=nt(w.xPercent,_.xPercent)),null!=w.yPercent&&(f.yPercent=nt(w.yPercent,_.yPercent));else if("object"==typeof w){if(f={scaleX:nt(null!=w.scaleX?w.scaleX:w.scale,_.scaleX),scaleY:nt(null!=w.scaleY?w.scaleY:w.scale,_.scaleY),scaleZ:nt(w.scaleZ,_.scaleZ),x:nt(w.x,_.x),y:nt(w.y,_.y),z:nt(w.z,_.z),xPercent:nt(w.xPercent,_.xPercent),yPercent:nt(w.yPercent,_.yPercent),perspective:nt(w.transformPerspective,_.perspective)},d=w.directionalRotation,null!=d)if("object"==typeof d)for(c in d)w[c]=d[c];else w.rotation=d;"string"==typeof w.x&&-1!==w.x.indexOf("%")&&(f.x=0,f.xPercent=nt(w.x,_.xPercent)),"string"==typeof w.y&&-1!==w.y.indexOf("%")&&(f.y=0,f.yPercent=nt(w.y,_.yPercent)),f.rotation=at("rotation"in w?w.rotation:"shortRotation"in w?w.shortRotation+"_short":"rotationZ"in w?w.rotationZ:_.rotation,_.rotation,"rotation",P),Mt&&(f.rotationX=at("rotationX"in w?w.rotationX:"shortRotationX"in w?w.shortRotationX+"_short":_.rotationX||0,_.rotationX,"rotationX",P),f.rotationY=at("rotationY"in w?w.rotationY:"shortRotationY"in w?w.shortRotationY+"_short":_.rotationY||0,_.rotationY,"rotationY",P)),f.skewX=null==w.skewX?_.skewX:at(w.skewX,_.skewX),f.skewY=null==w.skewY?_.skewY:at(w.skewY,_.skewY),(p=f.skewY-_.skewY)&&(f.skewX+=p,f.rotation+=p)}for(Mt&&null!=w.force3D&&(_.force3D=w.force3D,x=!0),_.skewType=w.skewType||_.skewType||a.defaultSkewType,u=_.force3D||_.z||_.rotationX||_.rotationY||f.z||f.rotationX||f.rotationY||f.perspective,u||null==w.scale||(f.scaleZ=1);--O>-1;)r=Ot[O],h=f[r]-_[r],(h>b||-b>h||null!=w[r]||null!=z[r])&&(x=!0,n=new xt(_,r,_[r],h,n),r in P&&(n.e=P[r]),n.xs0=0,n.plugin=o,i._overwriteProps.push(n.n));return h=w.transformOrigin,_.svg&&(h||w.svgOrigin)&&(g=_.xOffset,y=_.yOffset,Ft(t,it(h),f,w.svgOrigin,w.smoothOrigin),n=dt(_,"xOrigin",(m?_:f).xOrigin,f.xOrigin,n,T),n=dt(_,"yOrigin",(m?_:f).yOrigin,f.yOrigin,n,T),(g!==_.xOffset||y!==_.yOffset)&&(n=dt(_,"xOffset",m?g:_.xOffset,_.xOffset,n,T),n=dt(_,"yOffset",m?y:_.yOffset,_.yOffset,n,T)),h=bt?null:"0px 0px"),(h||Mt&&u&&_.zOrigin)&&(wt?(x=!0,r=Tt,h=(h||G(t,r,s,!1,"50% 50%"))+"",n=new xt(v,r,0,0,n,-1,T),n.b=v[r],n.plugin=o,Mt?(c=_.zOrigin,h=h.split(" "),_.zOrigin=(h.length>2&&(0===c||"0px"!==h[2])?parseFloat(h[2]):c)||0,n.xs0=n.e=h[0]+" "+(h[1]||"50%")+" 0px",n=new xt(_,"zOrigin",0,0,n,-1,n.n),n.b=c,n.xs0=n.e=_.zOrigin):n.xs0=n.e=h):it(h+"",_)),x&&(i._transformType=_.svg&&bt||!u&&3!==this._transformType?2:3),n},prefix:!0}),_t("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),_t("borderRadius",{defaultValue:"0px",parser:function(t,e,r,n,a,o){e=this.format(e);var l,f,p,c,h,u,x,d,g,y,m,_,v,b,O,w,P=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],T=t.style;for(g=parseFloat(t.offsetWidth),y=parseFloat(t.offsetHeight),l=e.split(" "),f=0;f<P.length;f++)this.p.indexOf("border")&&(P[f]=q(P[f])),h=c=G(t,P[f],s,!1,"0px"),-1!==h.indexOf(" ")&&(c=h.split(" "),h=c[0],c=c[1]),u=p=l[f],x=parseFloat(h),_=h.substr((x+"").length),v="="===u.charAt(1),v?(d=parseInt(u.charAt(0)+"1",10),u=u.substr(2),d*=parseFloat(u),m=u.substr((d+"").length-(0>d?1:0))||""):(d=parseFloat(u),m=u.substr((d+"").length)),""===m&&(m=i[r]||_),m!==_&&(b=U(t,"borderLeft",x,_),O=U(t,"borderTop",x,_),"%"===m?(h=b/g*100+"%",c=O/y*100+"%"):"em"===m?(w=U(t,"borderLeft",1,"em"),h=b/w+"em",c=O/w+"em"):(h=b+"px",c=O+"px"),v&&(u=parseFloat(h)+d+m,p=parseFloat(c)+d+m)),a=gt(T,P[f],h+" "+c,u+" "+p,!1,"0px",a);return a},prefix:!0,formatter:ct("0px 0px 0px 0px",!1,!0)}),_t("backgroundPosition",{defaultValue:"0 0",parser:function(t,e,r,i,n,a){var o,l,f,p,c,h,u="background-position",x=s||H(t,null),g=this.format((x?d?x.getPropertyValue(u+"-x")+" "+x.getPropertyValue(u+"-y"):x.getPropertyValue(u):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),y=this.format(e);if(-1!==g.indexOf("%")!=(-1!==y.indexOf("%"))&&(h=G(t,"backgroundImage").replace(X,""),h&&"none"!==h)){for(o=g.split(" "),l=y.split(" "),B.setAttribute("src",h),f=2;--f>-1;)g=o[f],p=-1!==g.indexOf("%"),p!==(-1!==l[f].indexOf("%"))&&(c=0===f?t.offsetWidth-B.width:t.offsetHeight-B.height,o[f]=p?parseFloat(g)/100*c+"px":parseFloat(g)/c*100+"%");g=o.join(" ")}return this.parseComplex(t.style,g,y,n,a)},formatter:it}),_t("backgroundSize",{defaultValue:"0 0",formatter:it}),_t("perspective",{defaultValue:"0px",prefix:!0}),_t("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),_t("transformStyle",{prefix:!0}),_t("backfaceVisibility",{prefix:!0}),_t("userSelect",{prefix:!0}),_t("margin",{parser:ht("marginTop,marginRight,marginBottom,marginLeft")}),_t("padding",{parser:ht("paddingTop,paddingRight,paddingBottom,paddingLeft")}),_t("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(t,e,r,i,n,a){var o,l,f;return 9>d?(l=t.currentStyle,f=8>d?" ":",",o="rect("+l.clipTop+f+l.clipRight+f+l.clipBottom+f+l.clipLeft+")",e=this.format(e).split(",").join(f)):(o=this.format(G(t,this.p,s,!1,this.dflt)),e=this.format(e)),this.parseComplex(t.style,o,e,n,a)}}),_t("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),_t("autoRound,strictUnits",{parser:function(t,e,r,i,s){return s}}),_t("border",{defaultValue:"0px solid #000",parser:function(t,e,r,i,n,a){return this.parseComplex(t.style,this.format(G(t,"borderTopWidth",s,!1,"0px")+" "+G(t,"borderTopStyle",s,!1,"solid")+" "+G(t,"borderTopColor",s,!1,"#000")),this.format(e),n,a)},color:!0,formatter:function(t){var e=t.split(" ");return e[0]+" "+(e[1]||"solid")+" "+(t.match(pt)||["#000"])[0]}}),_t("borderWidth",{parser:ht("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),_t("float,cssFloat,styleFloat",{parser:function(t,e,r,i,s,n){var a=t.style,o="cssFloat"in a?"cssFloat":"styleFloat";return new xt(a,o,0,0,s,-1,r,!1,0,a[o],e)}});var Bt=function(t){var e,r=this.t,i=r.filter||G(this.data,"filter")||"",s=this.s+this.c*t|0;100===s&&(-1===i.indexOf("atrix(")&&-1===i.indexOf("radient(")&&-1===i.indexOf("oader(")?(r.removeAttribute("filter"),e=!G(this.data,"filter")):(r.filter=i.replace(w,""),e=!0)),e||(this.xn1&&(r.filter=i=i||"alpha(opacity="+s+")"),-1===i.indexOf("pacity")?0===s&&this.xn1||(r.filter=i+" alpha(opacity="+s+")"):r.filter=i.replace(b,"opacity="+s))};_t("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(t,e,r,i,n,a){var o=parseFloat(G(t,"opacity",s,!1,"1")),l=t.style,f="autoAlpha"===r;return"string"==typeof e&&"="===e.charAt(1)&&(e=("-"===e.charAt(0)?-1:1)*parseFloat(e.substr(2))+o),f&&1===o&&"hidden"===G(t,"visibility",s)&&0!==e&&(o=0),I?n=new xt(l,"opacity",o,e-o,n):(n=new xt(l,"opacity",100*o,100*(e-o),n),n.xn1=f?1:0,l.zoom=1,n.type=2,n.b="alpha(opacity="+n.s+")",n.e="alpha(opacity="+(n.s+n.c)+")",n.data=t,n.plugin=a,n.setRatio=Bt),f&&(n=new xt(l,"visibility",0,0,n,-1,null,!1,0,0!==o?"inherit":"hidden",0===e?"hidden":"inherit"),n.xs0="inherit",i._overwriteProps.push(n.n),i._overwriteProps.push(r)),n}});var Lt=function(t,e){e&&(t.removeProperty?(("ms"===e.substr(0,2)||"webkit"===e.substr(0,6))&&(e="-"+e),t.removeProperty(e.replace(T,"-$1").toLowerCase())):t.removeAttribute(e))},Dt=function(t){if(this.t._gsClassPT=this,1===t||0===t){this.t.setAttribute("class",0===t?this.b:this.e);for(var e=this.data,r=this.t.style;e;)e.v?r[e.p]=e.v:Lt(r,e.p),e=e._next;1===t&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};_t("className",{parser:function(t,e,i,n,a,o,l){var f,p,c,h,u,x=t.getAttribute("class")||"",d=t.style.cssText;if(a=n._classNamePT=new xt(t,i,0,0,a,2),a.setRatio=Dt,a.pr=-11,r=!0,a.b=x,p=J(t,s),c=t._gsClassPT){for(h={},u=c.data;u;)h[u.p]=1,u=u._next;c.setRatio(1)}return t._gsClassPT=a,a.e="="!==e.charAt(1)?e:x.replace(new RegExp("\\s*\\b"+e.substr(2)+"\\b"),"")+("+"===e.charAt(0)?" "+e.substr(2):""),t.setAttribute("class",a.e),f=K(t,p,J(t),l,h),t.setAttribute("class",x),a.data=f.firstMPT,t.style.cssText=d,a=a.xfirst=n.parse(t,f.difs,a,o)}});var It=function(t){if((1===t||0===t)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var e,r,i,s,n,a=this.t.style,o=l.transform.parse;if("all"===this.e)a.cssText="",s=!0;else for(e=this.e.split(" ").join("").split(","),i=e.length;--i>-1;)r=e[i],l[r]&&(l[r].parse===o?s=!0:r="transformOrigin"===r?Tt:l[r].p),Lt(a,r);s&&(Lt(a,wt),n=this.t._gsTransform,n&&(n.svg&&this.t.removeAttribute("data-svg-origin"),delete this.t._gsTransform))}};for(_t("clearProps",{parser:function(t,e,i,s,n){return n=new xt(t,i,0,0,n,2),n.setRatio=It,n.e=e,n.pr=-10,n.data=s._tween,r=!0,n}}),f="bezier,throwProps,physicsProps,physics2D".split(","),yt=f.length;yt--;)vt(f[yt]);f=a.prototype,f._firstPT=f._lastParsedTransform=f._transform=null,f._onInitTween=function(t,e,o){if(!t.nodeType)return!1;this._target=t,this._tween=o,this._vars=e,p=e.autoRound,
r=!1,i=e.suffixMap||a.suffixMap,s=H(t,""),n=this._overwriteProps;var f,u,d,g,y,m,_,v,b,w=t.style;if(c&&""===w.zIndex&&(f=G(t,"zIndex",s),("auto"===f||""===f)&&this._addLazySet(w,"zIndex",0)),"string"==typeof e&&(g=w.cssText,f=J(t,s),w.cssText=g+";"+e,f=K(t,f,J(t)).difs,!I&&O.test(e)&&(f.opacity=parseFloat(RegExp.$1)),e=f,w.cssText=g),e.className?this._firstPT=u=l.className.parse(t,e.className,"className",this,null,null,e):this._firstPT=u=this.parse(t,e,null),this._transformType){for(b=3===this._transformType,wt?h&&(c=!0,""===w.zIndex&&(_=G(t,"zIndex",s),("auto"===_||""===_)&&this._addLazySet(w,"zIndex",0)),x&&this._addLazySet(w,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(b?"visible":"hidden"))):w.zoom=1,d=u;d&&d._next;)d=d._next;v=new xt(t,"transform",0,0,null,2),this._linkCSSP(v,null,d),v.setRatio=wt?jt:Vt,v.data=this._transform||Nt(t,s,!0),v.tween=o,v.pr=-1,n.pop()}if(r){for(;u;){for(m=u._next,d=g;d&&d.pr>u.pr;)d=d._next;(u._prev=d?d._prev:y)?u._prev._next=u:g=u,(u._next=d)?d._prev=u:y=u,u=m}this._firstPT=g}return!0},f.parse=function(t,e,r,n){var a,o,f,c,h,u,x,d,g,y,m=t.style;for(a in e)u=e[a],o=l[a],o?r=o.parse(t,u,a,this,r,n,e):(h=G(t,a,s)+"",g="string"==typeof u,"color"===a||"fill"===a||"stroke"===a||-1!==a.indexOf("Color")||g&&P.test(u)?(g||(u=ft(u),u=(u.length>3?"rgba(":"rgb(")+u.join(",")+")"),r=gt(m,a,h,u,!0,"transparent",r,0,n)):!g||-1===u.indexOf(" ")&&-1===u.indexOf(",")?(f=parseFloat(h),x=f||0===f?h.substr((f+"").length):"",(""===h||"auto"===h)&&("width"===a||"height"===a?(f=rt(t,a,s),x="px"):"left"===a||"top"===a?(f=Q(t,a,s),x="px"):(f="opacity"!==a?0:1,x="")),y=g&&"="===u.charAt(1),y?(c=parseInt(u.charAt(0)+"1",10),u=u.substr(2),c*=parseFloat(u),d=u.replace(v,"")):(c=parseFloat(u),d=g?u.replace(v,""):""),""===d&&(d=a in i?i[a]:x),u=c||0===c?(y?c+f:c)+d:e[a],x!==d&&""!==d&&(c||0===c)&&f&&(f=U(t,a,f,x),"%"===d?(f/=U(t,a,100,"%")/100,e.strictUnits!==!0&&(h=f+"%")):"em"===d?f/=U(t,a,1,"em"):"px"!==d&&(c=U(t,a,c,d),d="px"),y&&(c||0===c)&&(u=c+f+d)),y&&(c+=f),!f&&0!==f||!c&&0!==c?void 0!==m[a]&&(u||u+""!="NaN"&&null!=u)?(r=new xt(m,a,c||f||0,0,r,-1,a,!1,0,h,u),r.xs0="none"!==u||"display"!==a&&-1===a.indexOf("Style")?u:h):Z("invalid "+a+" tween value: "+e[a]):(r=new xt(m,a,f,c-f,r,0,a,p!==!1&&("px"===d||"zIndex"===a),0,h,u),r.xs0=d)):r=gt(m,a,h,u,!0,null,r,0,n)),n&&r&&!r.plugin&&(r.plugin=n);return r},f.setRatio=function(t){var e,r,i,s=this._firstPT,n=1e-6;if(1!==t||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(t||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;s;){if(e=s.c*t+s.s,s.r?e=Math.round(e):n>e&&e>-n&&(e=0),s.type)if(1===s.type)if(i=s.l,2===i)s.t[s.p]=s.xs0+e+s.xs1+s.xn1+s.xs2;else if(3===i)s.t[s.p]=s.xs0+e+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3;else if(4===i)s.t[s.p]=s.xs0+e+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3+s.xn3+s.xs4;else if(5===i)s.t[s.p]=s.xs0+e+s.xs1+s.xn1+s.xs2+s.xn2+s.xs3+s.xn3+s.xs4+s.xn4+s.xs5;else{for(r=s.xs0+e+s.xs1,i=1;i<s.l;i++)r+=s["xn"+i]+s["xs"+(i+1)];s.t[s.p]=r}else-1===s.type?s.t[s.p]=s.xs0:s.setRatio&&s.setRatio(t);else s.t[s.p]=e+s.xs0;s=s._next}else for(;s;)2!==s.type?s.t[s.p]=s.b:s.setRatio(t),s=s._next;else for(;s;){if(2!==s.type)if(s.r&&-1!==s.type)if(e=Math.round(s.s+s.c),s.type){if(1===s.type){for(i=s.l,r=s.xs0+e+s.xs1,i=1;i<s.l;i++)r+=s["xn"+i]+s["xs"+(i+1)];s.t[s.p]=r}}else s.t[s.p]=e+s.xs0;else s.t[s.p]=s.e;else s.setRatio(t);s=s._next}},f._enableTransforms=function(t){this._transform=this._transform||Nt(this._target,s,!0),this._transformType=this._transform.svg&&bt||!t&&3!==this._transformType?2:3};var Wt=function(t){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};f._addLazySet=function(t,e,r){var i=this._firstPT=new xt(t,e,0,0,this._firstPT,2);i.e=r,i.setRatio=Wt,i.data=this},f._linkCSSP=function(t,e,r,i){return t&&(e&&(e._prev=t),t._next&&(t._next._prev=t._prev),t._prev?t._prev._next=t._next:this._firstPT===t&&(this._firstPT=t._next,i=!0),r?r._next=t:i||null!==this._firstPT||(this._firstPT=t),t._next=e,t._prev=r),t},f._kill=function(e){var r,i,s,n=e;if(e.autoAlpha||e.alpha){n={};for(i in e)n[i]=e[i];n.opacity=1,n.autoAlpha&&(n.visibility=1)}return e.className&&(r=this._classNamePT)&&(s=r.xfirst,s&&s._prev?this._linkCSSP(s._prev,r._next,s._prev._prev):s===this._firstPT&&(this._firstPT=r._next),r._next&&this._linkCSSP(r._next,r._next._next,s._prev),this._classNamePT=null),t.prototype._kill.call(this,n)};var Zt=function(t,e,r){var i,s,n,a;if(t.slice)for(s=t.length;--s>-1;)Zt(t[s],e,r);else for(i=t.childNodes,s=i.length;--s>-1;)n=i[s],a=n.type,n.style&&(e.push(J(n)),r&&r.push(n)),1!==a&&9!==a&&11!==a||!n.childNodes.length||Zt(n,e,r)};return a.cascadeTo=function(t,r,i){var s,n,a,o,l=e.to(t,r,i),f=[l],p=[],c=[],h=[],u=e._internals.reservedProps;for(t=l._targets||l.target,Zt(t,p,h),l.render(r,!0,!0),Zt(t,c),l.render(0,!0,!0),l._enabled(!0),s=h.length;--s>-1;)if(n=K(h[s],p[s],c[s]),n.firstMPT){n=n.difs;for(a in i)u[a]&&(n[a]=i[a]);o={};for(a in n)o[a]=p[s][a];f.push(e.fromTo(h[s],r,o,n))}return f},t.activate([a]),a},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(t){"use strict";var e=function(){return(_gsScope.GreenSockGlobals||_gsScope)[t]};"function"==typeof define&&define.amd?define(["TweenLite"],e):"undefined"!=typeof module&&module.exports&&(require("../TweenLite.js"),module.exports=e())}("CSSPlugin");
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../TweenLite.js":2}],5:[function(require,module,exports){
(function (global){
var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("utils.Draggable",["events.EventDispatcher","TweenLite","plugins.CSSPlugin"],function(e,t,o){var n,r,i,a,s,l,c,f,d={css:{}},p={css:{}},h={css:{}},u={css:{}},g=_gsScope._gsDefine.globals,x={},m=document,v=m.documentElement||{},y=function(e){return m.createElementNS?m.createElementNS("http://www.w3.org/1999/xhtml",e):m.createElement(e)},w=y("div"),b=[],T=function(){return!1},S=180/Math.PI,L=999999999999999,N=Date.now||function(){return(new Date).getTime()},C=!(m.addEventListener||!m.all),M=m.createElement("div"),D=[],_={},k=0,P=/^(?:a|input|textarea|button|select)$/i,X=0,Y=-1!==navigator.userAgent.toLowerCase().indexOf("android"),B=0,O={},R={},E=function(e){if("string"==typeof e&&(e=t.selector(e)),!e||e.nodeType)return[e];var o,n=[],r=e.length;for(o=0;o!==r;n.push(e[o++]));return n},W=function(){for(var e=D.length;--e>-1;)D[e]()},A=function(e){D.push(e),1===D.length&&t.ticker.addEventListener("tick",W,this,!1,1)},F=function(e){for(var o=D.length;--o>-1;)D[o]===e&&D.splice(o,1);t.to(H,0,{overwrite:"all",delay:15,onComplete:H})},H=function(){D.length||t.ticker.removeEventListener("tick",W)},V=function(e,t){var o;for(o in t)void 0===e[o]&&(e[o]=t[o]);return e},I=function(){return null!=window.pageYOffset?window.pageYOffset:null!=m.scrollTop?m.scrollTop:v.scrollTop||m.body.scrollTop||0},G=function(){return null!=window.pageXOffset?window.pageXOffset:null!=m.scrollLeft?m.scrollLeft:v.scrollLeft||m.body.scrollLeft||0},z=function(e,t){Xe(e,"scroll",t),$(e.parentNode)||z(e.parentNode,t)},U=function(e,t){Ye(e,"scroll",t),$(e.parentNode)||U(e.parentNode,t)},$=function(e){return!(e&&e!==v&&e!==m&&e!==m.body&&e!==window&&e.nodeType&&e.parentNode)},K=function(e,t){var o="x"===t?"Width":"Height",n="scroll"+o,r="client"+o,i=m.body;return Math.max(0,$(e)?Math.max(v[n],i[n])-(window["inner"+o]||v[r]||i[r]):e[n]-e[r])},Z=function(e){var t=$(e),o=K(e,"x"),n=K(e,"y");t?e=R:Z(e.parentNode),e._gsMaxScrollX=o,e._gsMaxScrollY=n,e._gsScrollX=e.scrollLeft||0,e._gsScrollY=e.scrollTop||0},j=function(e,t){return e=e||window.event,x.pageX=e.clientX+m.body.scrollLeft+v.scrollLeft,x.pageY=e.clientY+m.body.scrollTop+v.scrollTop,t&&(e.returnValue=!1),x},q=function(e){return e?("string"==typeof e&&(e=t.selector(e)),e.length&&e!==window&&e[0]&&e[0].style&&!e.nodeType&&(e=e[0]),e===window||e.nodeType&&e.style?e:null):e},Q=function(e,t){var o,r,i,a=e.style;if(void 0===a[t]){for(i=["O","Moz","ms","Ms","Webkit"],r=5,o=t.charAt(0).toUpperCase()+t.substr(1);--r>-1&&void 0===a[i[r]+o];);if(0>r)return"";n=3===r?"ms":i[r],t=n+o}return t},J=function(e,t,o){var n=e.style;n&&(void 0===n[t]&&(t=Q(e,t)),null==o?n.removeProperty?n.removeProperty(t.replace(/([A-Z])/g,"-$1").toLowerCase()):n.removeAttribute(t):void 0!==n[t]&&(n[t]=o))},ee=m.defaultView?m.defaultView.getComputedStyle:T,te=/(?:Left|Right|Width)/i,oe=/(?:\d|\-|\+|=|#|\.)*/g,ne=function(e,t,o,n,r){if("px"===n||!n)return o;if("auto"===n||!o)return 0;var i,a=te.test(t),s=e,l=w.style,c=0>o;return c&&(o=-o),"%"===n&&-1!==t.indexOf("border")?i=o/100*(a?e.clientWidth:e.clientHeight):(l.cssText="border:0 solid red;position:"+ie(e,"position",!0)+";line-height:0;","%"!==n&&s.appendChild?l[a?"borderLeftWidth":"borderTopWidth"]=o+n:(s=e.parentNode||m.body,l[a?"width":"height"]=o+n),s.appendChild(w),i=parseFloat(w[a?"offsetWidth":"offsetHeight"]),s.removeChild(w),0!==i||r||(i=ne(e,t,o,n,!0))),c?-i:i},re=function(e,t){if("absolute"!==ie(e,"position",!0))return 0;var o="left"===t?"Left":"Top",n=ie(e,"margin"+o,!0);return e["offset"+o]-(ne(e,t,parseFloat(n),(n+"").replace(oe,""))||0)},ie=function(e,t,o){var n,r=(e._gsTransform||{})[t];return r||0===r?r:(e.style[t]?r=e.style[t]:(n=ee(e))?(r=n.getPropertyValue(t.replace(/([A-Z])/g,"-$1").toLowerCase()),r=r||n.length?r:n[t]):e.currentStyle&&(r=e.currentStyle[t]),"auto"!==r||"top"!==t&&"left"!==t||(r=re(e,t)),o?r:parseFloat(r)||0)},ae=function(e,t,o){var n=e.vars,r=n[o],i=e._listeners[t];"function"==typeof r&&r.apply(n[o+"Scope"]||n.callbackScope||e,n[o+"Params"]||[e.pointerEvent]),i&&e.dispatchEvent(t)},se=function(e,t){var o,n,r,i=q(e);return i?Me(i,t):void 0!==e.left?(r=be(t),{left:e.left-r.x,top:e.top-r.y,width:e.width,height:e.height}):(n=e.min||e.minX||e.minRotation||0,o=e.min||e.minY||0,{left:n,top:o,width:(e.max||e.maxX||e.maxRotation||0)-n,height:(e.max||e.maxY||0)-o})},le=function(){if(!m.createElementNS)return a=0,void(s=!1);var e,t,o,n,r=y("div"),i=m.createElementNS("http://www.w3.org/2000/svg","svg"),f=y("div"),d=r.style,p=m.body||v;m.body&&de&&(d.position=f.style.position="absolute",p.appendChild(f),f.appendChild(r),d.height="10px",n=r.offsetTop,f.style.border="5px solid red",c=n!==r.offsetTop,p.removeChild(f)),d=i.style,i.setAttributeNS(null,"width","400px"),i.setAttributeNS(null,"height","400px"),i.setAttributeNS(null,"viewBox","0 0 400 400"),d.display="block",d.boxSizing="border-box",d.border="0px solid red",d.transform="none",r.style.cssText="width:100px;height:100px;overflow:scroll",p.appendChild(r),r.appendChild(i),o=i.createSVGPoint().matrixTransform(i.getScreenCTM()),t=o.y,r.scrollTop=100,o.x=o.y=0,o=o.matrixTransform(i.getScreenCTM()),l=t-o.y<100.1?0:t-o.y-150,r.removeChild(i),p.removeChild(r),p.appendChild(i),e=i.getScreenCTM(),t=e.e,d.border="50px solid red",e=i.getScreenCTM(),0===t&&0===e.e&&0===e.f&&1===e.a?(a=1,s=!0):(a=t!==e.e?1:0,s=1!==e.a),p.removeChild(i)},ce=""!==Q(w,"perspective"),fe=Q(w,"transformOrigin").replace(/^ms/g,"Ms").replace(/([A-Z])/g,"-$1").toLowerCase(),de=Q(w,"transform"),pe=de.replace(/^ms/g,"Ms").replace(/([A-Z])/g,"-$1").toLowerCase(),he={},ue={},ge=window.SVGElement,xe=function(e){return!!(ge&&"function"==typeof e.getBBox&&e.getCTM&&(!e.parentNode||e.parentNode.getBBox&&e.parentNode.getCTM))},me=(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(navigator.userAgent)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(navigator.userAgent))&&parseFloat(RegExp.$1)<11,ve=[],ye=[],we=function(e){if(!e.getBoundingClientRect||!e.parentNode||!de)return{offsetTop:0,offsetLeft:0,scaleX:1,scaleY:1,offsetParent:v};if(Ve.cacheSVGData!==!1&&e._gsCache&&e._gsCache.lastUpdate===t.ticker.frame)return e._gsCache;var o,n,r,i,c,f,d,p,h,u,g,x,y=e,w=Te(e);if(w.lastUpdate=t.ticker.frame,e.getBBox&&!w.isSVGRoot){for(y=e.parentNode,o=e.getBBox();y&&"svg"!==(y.nodeName+"").toLowerCase();)y=y.parentNode;return i=we(y),w.offsetTop=o.y*i.scaleY,w.offsetLeft=o.x*i.scaleX,w.scaleX=i.scaleX,w.scaleY=i.scaleY,w.offsetParent=y||v,w}for(r=w.offsetParent,r===m.body&&(r=v),ye.length=ve.length=0;y&&(c=ie(y,de,!0),"matrix(1, 0, 0, 1, 0, 0)"!==c&&"none"!==c&&"translate3d(0px, 0px, 0px)"!==c&&(ye.push(y),ve.push(y.style[de]),y.style[de]="none"),y!==r);)y=y.parentNode;for(n=r.getBoundingClientRect(),c=e.getScreenCTM(),p=e.createSVGPoint(),d=p.matrixTransform(c),p.x=p.y=10,p=p.matrixTransform(c),w.scaleX=(p.x-d.x)/10,w.scaleY=(p.y-d.y)/10,void 0===a&&le(),w.borderBox&&!s&&e.getAttribute("width")&&(i=ee(e)||{},h=parseFloat(i.borderLeftWidth)+parseFloat(i.borderRightWidth)||0,u=parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth)||0,g=parseFloat(i.width)||0,x=parseFloat(i.height)||0,w.scaleX*=(g-h)/g,w.scaleY*=(x-u)/x),l?(o=e.getBoundingClientRect(),w.offsetLeft=o.left-n.left,w.offsetTop=o.top-n.top):(w.offsetLeft=d.x-n.left,w.offsetTop=d.y-n.top),w.offsetParent=r,f=ye.length;--f>-1;)ye[f].style[de]=ve[f];return w},be=function(e,o){if(o=o||{},!e||e===v||!e.parentNode||e===window)return{x:0,y:0};var n=ee(e),r=fe&&n?n.getPropertyValue(fe):"50% 50%",i=r.split(" "),a=-1!==r.indexOf("left")?"0%":-1!==r.indexOf("right")?"100%":i[0],s=-1!==r.indexOf("top")?"0%":-1!==r.indexOf("bottom")?"100%":i[1];return("center"===s||null==s)&&(s="50%"),("center"===a||isNaN(parseFloat(a)))&&(a="50%"),e.getBBox&&xe(e)?(e._gsTransform||(t.set(e,{x:"+=0",overwrite:!1}),void 0===e._gsTransform.xOrigin&&console.log("Draggable requires at least GSAP 1.17.0")),r=e.getBBox(),o.x=e._gsTransform.xOrigin-r.x,o.y=e._gsTransform.yOrigin-r.y):(e.getBBox&&!e.offsetWidth&&-1!==(a+s).indexOf("%")&&(e=e.getBBox(),e={offsetWidth:e.width,offsetHeight:e.height}),o.x=-1!==a.indexOf("%")?e.offsetWidth*parseFloat(a)/100:parseFloat(a),o.y=-1!==s.indexOf("%")?e.offsetHeight*parseFloat(s)/100:parseFloat(s)),o},Te=function(e){if(Ve.cacheSVGData!==!1&&e._gsCache&&e._gsCache.lastUpdate===t.ticker.frame)return e._gsCache;var o,n=e._gsCache=e._gsCache||{},r=ee(e),i=e.getBBox&&xe(e),a="svg"===(e.nodeName+"").toLowerCase();if(n.isSVG=i,n.isSVGRoot=a,n.borderBox="border-box"===r.boxSizing,n.computedStyle=r,a)(n.offsetParent=e.offsetParent)||(e.parentNode.insertBefore(w,e),n.offsetParent=w.offsetParent,e.parentNode.removeChild(w));else if(i){for(o=e.parentNode;o&&"svg"!==(o.nodeName+"").toLowerCase();)o=o.parentNode;n.offsetParent=o}return n},Se=function(e,t,o,n){if(e===window||!e||!e.style||!e.parentNode)return[1,0,0,1,0,0];var r,i,s,l,f,d,p,h,u,g,x,y,w,b,T=e._gsCache||Te(e),S=e.parentNode,L=S._gsCache||Te(S),N=T.computedStyle,C=T.isSVG?L.offsetParent:S.offsetParent;return r=T.isSVG&&-1!==(e.style[de]+"").indexOf("matrix")?e.style[de]:N?N.getPropertyValue(pe):e.currentStyle?e.currentStyle[de]:"1,0,0,1,0,0",e.getBBox&&-1!==(e.getAttribute("transform")+"").indexOf("matrix")&&(r=e.getAttribute("transform")),r=(r+"").match(/(?:\-|\b)[\d\-\.e]+\b/g)||[1,0,0,1,0,0],r.length>6&&(r=[r[0],r[1],r[4],r[5],r[12],r[13]]),n?r[4]=r[5]=0:T.isSVG&&(f=e._gsTransform)&&(f.xOrigin||f.yOrigin)&&(r[0]=parseFloat(r[0]),r[1]=parseFloat(r[1]),r[2]=parseFloat(r[2]),r[3]=parseFloat(r[3]),r[4]=parseFloat(r[4])-(f.xOrigin-(f.xOrigin*r[0]+f.yOrigin*r[2])),r[5]=parseFloat(r[5])-(f.yOrigin-(f.xOrigin*r[1]+f.yOrigin*r[3]))),t&&(void 0===a&&le(),s=T.isSVG||T.isSVGRoot?we(e):e,T.isSVG?(l=e.getBBox(),g=L.isSVGRoot?{x:0,y:0}:S.getBBox(),s={offsetLeft:l.x-g.x,offsetTop:l.y-g.y,offsetParent:T.offsetParent}):T.isSVGRoot?(x=parseInt(N.borderTopWidth,10)||0,y=parseInt(N.borderLeftWidth,10)||0,w=(r[0]-a)*y+r[2]*x,b=r[1]*y+(r[3]-a)*x,d=t.x,p=t.y,h=d-(d*r[0]+p*r[2]),u=p-(d*r[1]+p*r[3]),r[4]=parseFloat(r[4])+h,r[5]=parseFloat(r[5])+u,t.x-=h,t.y-=u,d=s.scaleX,p=s.scaleY,t.x*=d,t.y*=p,r[0]*=d,r[1]*=p,r[2]*=d,r[3]*=p,me||(t.x+=w,t.y+=b)):!c&&e.offsetParent&&(t.x+=parseInt(ie(e.offsetParent,"borderLeftWidth"),10)||0,t.y+=parseInt(ie(e.offsetParent,"borderTopWidth"),10)||0),i=S===v||S===m.body,r[4]=Number(r[4])+t.x+(s.offsetLeft||0)-o.x-(i?0:S.scrollLeft||0),r[5]=Number(r[5])+t.y+(s.offsetTop||0)-o.y-(i?0:S.scrollTop||0),S&&"fixed"===ie(e,"position",N)&&(r[4]+=G(),r[5]+=I()),S&&S!==v&&C===s.offsetParent&&(r[4]-=S.offsetLeft||0,r[5]-=S.offsetTop||0,c||!S.offsetParent||T.isSVG||T.isSVGRoot||(r[4]-=parseInt(ie(S.offsetParent,"borderLeftWidth"),10)||0,r[5]-=parseInt(ie(S.offsetParent,"borderTopWidth"),10)||0))),r},Le=function(e,t){if(!e||e===window||!e.parentNode)return[1,0,0,1,0,0];for(var o,n,r,i,a,s,l,c,f=be(e,he),d=be(e.parentNode,ue),p=Se(e,f,d);(e=e.parentNode)&&e.parentNode&&e!==v;)f=d,d=be(e.parentNode,f===he?ue:he),l=Se(e,f,d),o=p[0],n=p[1],r=p[2],i=p[3],a=p[4],s=p[5],p[0]=o*l[0]+n*l[2],p[1]=o*l[1]+n*l[3],p[2]=r*l[0]+i*l[2],p[3]=r*l[1]+i*l[3],p[4]=a*l[0]+s*l[2]+l[4],p[5]=a*l[1]+s*l[3]+l[5];return t&&(o=p[0],n=p[1],r=p[2],i=p[3],a=p[4],s=p[5],c=o*i-n*r,p[0]=i/c,p[1]=-n/c,p[2]=-r/c,p[3]=o/c,p[4]=(r*s-i*a)/c,p[5]=-(o*s-n*a)/c),p},Ne=function(e,t,o,n,r){e=q(e);var i=Le(e,!1,r),a=t.x,s=t.y;return o&&(be(e,t),a-=t.x,s-=t.y),n=n===!0?t:n||{},n.x=a*i[0]+s*i[2]+i[4],n.y=a*i[1]+s*i[3]+i[5],n},Ce=function(e,t,o){var n=e.x*t[0]+e.y*t[2]+t[4],r=e.x*t[1]+e.y*t[3]+t[5];return e.x=n*o[0]+r*o[2]+o[4],e.y=n*o[1]+r*o[3]+o[5],e},Me=function(e,t,o){if(!(e=q(e)))return null;t=q(t);var n,r,i,a,s,l,c,f,d,p,h,u,g,x,y,w,b,T,S,L,N,M,D=e.getBBox&&xe(e);if(e===window)a=I(),r=G(),i=r+(v.clientWidth||e.innerWidth||m.body.clientWidth||0),s=a+((e.innerHeight||0)-20<v.clientHeight?v.clientHeight:e.innerHeight||m.body.clientHeight||0);else{if(void 0===t||t===window)return e.getBoundingClientRect();n=be(e),r=-n.x,a=-n.y,D?(u=e.getBBox(),g=u.width,x=u.height):e.offsetWidth?(g=e.offsetWidth,x=e.offsetHeight):(N=ee(e),g=parseFloat(N.width),x=parseFloat(N.height)),i=r+g,s=a+x,"svg"!==e.nodeName.toLowerCase()||C||(y=we(e),M=y.computedStyle||{},T=(e.getAttribute("viewBox")||"0 0").split(" "),S=parseFloat(T[0]),L=parseFloat(T[1]),w=parseFloat(M.borderLeftWidth)||0,b=parseFloat(M.borderTopWidth)||0,i-=g-(g-w)/y.scaleX-S,s-=x-(x-b)/y.scaleY-L,r-=w/y.scaleX-S,a-=b/y.scaleY-L,N&&(i+=(parseFloat(M.borderRightWidth)+w)/y.scaleX,s+=(b+parseFloat(M.borderBottomWidth))/y.scaleY))}return e===t?{left:r,top:a,width:i-r,height:s-a}:(l=Le(e),c=Le(t,!0),f=Ce({x:r,y:a},l,c),d=Ce({x:i,y:a},l,c),p=Ce({x:i,y:s},l,c),h=Ce({x:r,y:s},l,c),r=Math.min(f.x,d.x,p.x,h.x),a=Math.min(f.y,d.y,p.y,h.y),O.x=O.y=0,o&&be(t,O),{left:r+O.x,top:a+O.y,width:Math.max(f.x,d.x,p.x,h.x)-r,height:Math.max(f.y,d.y,p.y,h.y)-a})},De=function(e){return e.length&&e[0]&&(e[0].nodeType&&e[0].style&&!e.nodeType||e[0].length&&e[0][0])?!0:!1},_e=function(e){var t,o,n,r=[],i=e.length;for(t=0;i>t;t++)if(o=e[t],De(o))for(n=o.length,n=0;n<o.length;n++)r.push(o[n]);else r.push(o);return r},ke="ontouchstart"in v&&"orientation"in window,Pe=function(e){for(var t=e.split(","),o=(void 0!==w.onpointerdown?"pointerdown,pointermove,pointerup,pointercancel":void 0!==w.onmspointerdown?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":e).split(","),n={},r=8;--r>-1;)n[t[r]]=o[r],n[o[r]]=t[r];return n}("touchstart,touchmove,touchend,touchcancel"),Xe=function(e,t,o,n){e.addEventListener?e.addEventListener(Pe[t]||t,o,n):e.attachEvent&&e.attachEvent("on"+t,o)},Ye=function(e,t,o){e.removeEventListener?e.removeEventListener(Pe[t]||t,o):e.detachEvent&&e.detachEvent("on"+t,o)},Be=function(e,t){for(var o=e.length;--o>-1;)if(e[o].identifier===t)return!0;return!1},Oe=function(e){r=e.touches&&X<e.touches.length,Ye(e.target,"touchend",Oe)},Re=function(e){r=e.touches&&X<e.touches.length,Xe(e.target,"touchend",Oe)},Ee=function(e,t,o,n,r,i){var a,s,l,c={};if(t)if(1!==r&&t instanceof Array){for(c.end=a=[],l=t.length,s=0;l>s;s++)a[s]=t[s]*r;o+=1.1,n-=1.1}else"function"==typeof t?c.end=function(o){return t.call(e,o)*r}:c.end=t;return(o||0===o)&&(c.max=o),(n||0===n)&&(c.min=n),i&&(c.velocity=0),c},We=function(e){var t;return e&&e.getAttribute&&"BODY"!==e.nodeName?"true"===(t=e.getAttribute("data-clickable"))||"false"!==t&&(e.onclick||P.test(e.nodeName+"")||"true"===e.getAttribute("contentEditable"))?!0:We(e.parentNode):!1},Ae=function(e,t){for(var o,n=e.length;--n>-1;)o=e[n],o.ondragstart=o.onselectstart=t?null:T,J(o,"userSelect",t?"text":"none")},Fe=function(){var e,t=m.createElement("div"),o=m.createElement("div"),n=o.style,r=m.body||w;return n.display="inline-block",n.position="relative",t.style.cssText=o.innerHTML="width:90px; height:40px; padding:10px; overflow:auto; visibility: hidden",t.appendChild(o),r.appendChild(t),f=o.offsetHeight+18>t.scrollHeight,n.width="100%",de||(n.paddingRight="500px",e=t.scrollLeft=t.scrollWidth-t.clientWidth,n.left="-90px",e=e!==t.scrollLeft),r.removeChild(t),e}(),He=function(e,o){e=q(e),o=o||{};var n,r,i,a,s,l,c=m.createElement("div"),d=c.style,p=e.firstChild,h=0,u=0,g=e.scrollTop,x=e.scrollLeft,v=e.scrollWidth,y=e.scrollHeight,w=0,b=0,T=0;ce&&o.force3D!==!1?(s="translate3d(",l="px,0px)"):de&&(s="translate(",l="px)"),this.scrollTop=function(e,t){return arguments.length?void this.top(-e,t):-this.top()},this.scrollLeft=function(e,t){return arguments.length?void this.left(-e,t):-this.left()},this.left=function(n,r){if(!arguments.length)return-(e.scrollLeft+u);var i=e.scrollLeft-x,a=u;return(i>2||-2>i)&&!r?(x=e.scrollLeft,t.killTweensOf(this,!0,{left:1,scrollLeft:1}),this.left(-x),void(o.onKill&&o.onKill())):(n=-n,0>n?(u=n-.5|0,n=0):n>b?(u=n-b|0,n=b):u=0,(u||a)&&(s?this._suspendTransforms||(d[de]=s+-u+"px,"+-h+l):d.left=-u+"px",Fe&&u+w>=0&&(d.paddingRight=u+w+"px")),e.scrollLeft=0|n,void(x=e.scrollLeft))},this.top=function(n,r){if(!arguments.length)return-(e.scrollTop+h);var i=e.scrollTop-g,a=h;return(i>2||-2>i)&&!r?(g=e.scrollTop,t.killTweensOf(this,!0,{top:1,scrollTop:1}),this.top(-g),void(o.onKill&&o.onKill())):(n=-n,0>n?(h=n-.5|0,n=0):n>T?(h=n-T|0,n=T):h=0,(h||a)&&(s?this._suspendTransforms||(d[de]=s+-u+"px,"+-h+l):d.top=-h+"px"),e.scrollTop=0|n,void(g=e.scrollTop))},this.maxScrollTop=function(){return T},this.maxScrollLeft=function(){return b},this.disable=function(){for(p=c.firstChild;p;)a=p.nextSibling,e.appendChild(p),p=a;e===c.parentNode&&e.removeChild(c)},this.enable=function(){if(p=e.firstChild,p!==c){for(;p;)a=p.nextSibling,c.appendChild(p),p=a;e.appendChild(c),this.calibrate()}},this.calibrate=function(t){var o,a,s=e.clientWidth===n;g=e.scrollTop,x=e.scrollLeft,(!s||e.clientHeight!==r||c.offsetHeight!==i||v!==e.scrollWidth||y!==e.scrollHeight||t)&&((h||u)&&(o=this.left(),a=this.top(),this.left(-e.scrollLeft),this.top(-e.scrollTop)),(!s||t)&&(d.display="block",d.width="auto",d.paddingRight="0px",w=Math.max(0,e.scrollWidth-e.clientWidth),w&&(w+=ie(e,"paddingLeft")+(f?ie(e,"paddingRight"):0))),d.display="inline-block",d.position="relative",d.overflow="visible",d.verticalAlign="top",d.width="100%",d.paddingRight=w+"px",f&&(d.paddingBottom=ie(e,"paddingBottom",!0)),C&&(d.zoom="1"),n=e.clientWidth,r=e.clientHeight,v=e.scrollWidth,y=e.scrollHeight,b=e.scrollWidth-n,T=e.scrollHeight-r,i=c.offsetHeight,d.display="block",(o||a)&&(this.left(o),this.top(a)))},this.content=c,this.element=e,this._suspendTransforms=!1,this.enable()},Ve=function(n,a){e.call(this,n),n=q(n),i||(i=g.com.greensock.plugins.ThrowPropsPlugin),this.vars=a=a||{},this.target=n,this.x=this.y=this.rotation=0,this.dragResistance=parseFloat(a.dragResistance)||0,this.edgeResistance=isNaN(a.edgeResistance)?1:parseFloat(a.edgeResistance)||0,this.lockAxis=a.lockAxis,this.autoScroll=a.autoScroll||0,this.lockedAxis=null,this.allowEventDefault=!!a.allowEventDefault;var s,l,c,f,x,y,w,T,D,P,O,W,H,I,G,K,Q,ee,te,oe,ne,re,le,ce,fe,de,pe,he,ue,ge,xe,me=(a.type||(C?"top,left":"x,y")).toLowerCase(),ve=-1!==me.indexOf("x")||-1!==me.indexOf("y"),ye=-1!==me.indexOf("rotation"),we=ye?"rotation":ve?"x":"left",be=ve?"y":"top",Te=-1!==me.indexOf("x")||-1!==me.indexOf("left")||"scroll"===me,Se=-1!==me.indexOf("y")||-1!==me.indexOf("top")||"scroll"===me,Ce=a.minimumMovement||2,Me=this,De=E(a.trigger||a.handle||n),_e={},Oe=0,Fe=!1,Ie=a.clickableTest||We,Ge=function(e){if(Me.autoScroll&&Me.isDragging&&(ee||Fe)){var t,o,r,i,a,s,c,f,d=n,p=15*Me.autoScroll;for(Fe=!1,R.scrollTop=null!=window.pageYOffset?window.pageYOffset:null!=v.scrollTop?v.scrollTop:m.body.scrollTop,R.scrollLeft=null!=window.pageXOffset?window.pageXOffset:null!=v.scrollLeft?v.scrollLeft:m.body.scrollLeft,i=Me.pointerX-R.scrollLeft,a=Me.pointerY-R.scrollTop;d&&!o;)o=$(d.parentNode),t=o?R:d.parentNode,r=o?{bottom:Math.max(v.clientHeight,window.innerHeight||0),right:Math.max(v.clientWidth,window.innerWidth||0),left:0,top:0}:t.getBoundingClientRect(),s=c=0,Se&&(a>r.bottom-40&&(f=t._gsMaxScrollY-t.scrollTop)?(Fe=!0,c=Math.min(f,p*(1-Math.max(0,r.bottom-a)/40)|0)):a<r.top+40&&t.scrollTop&&(Fe=!0,c=-Math.min(t.scrollTop,p*(1-Math.max(0,a-r.top)/40)|0)),c&&(t.scrollTop+=c)),Te&&(i>r.right-40&&(f=t._gsMaxScrollX-t.scrollLeft)?(Fe=!0,s=Math.min(f,p*(1-Math.max(0,r.right-i)/40)|0)):i<r.left+40&&t.scrollLeft&&(Fe=!0,s=-Math.min(t.scrollLeft,p*(1-Math.max(0,i-r.left)/40)|0)),s&&(t.scrollLeft+=s)),o&&(s||c)&&(window.scrollTo(t.scrollLeft,t.scrollTop),nt(Me.pointerX+s,Me.pointerY+c)),d=t}if(ee){var h=Me.x,u=Me.y,g=1e-6;g>h&&h>-g&&(h=0),g>u&&u>-g&&(u=0),ye?(ue.data.rotation=Me.rotation=h,ue.setRatio(1)):l?(Se&&l.top(u),Te&&l.left(h)):ve?(Se&&(ue.data.y=u),Te&&(ue.data.x=h),ue.setRatio(1)):(Se&&(n.style.top=u+"px"),Te&&(n.style.left=h+"px")),T&&!e&&ae(Me,"drag","onDrag")}ee=!1},Ue=function(e,o){var r;n._gsTransform||!ve&&!ye||t.set(n,{x:"+=0",overwrite:!1}),ve?(Me.y=n._gsTransform.y,Me.x=n._gsTransform.x):ye?Me.x=Me.rotation=n._gsTransform.rotation:l?(Me.y=l.top(),Me.x=l.left()):(Me.y=parseInt(n.style.top,10)||0,Me.x=parseInt(n.style.left,10)||0),!oe&&!ne||o||(oe&&(r=oe(Me.x),r!==Me.x&&(Me.x=r,ye&&(Me.rotation=r),ee=!0)),ne&&(r=ne(Me.y),r!==Me.y&&(Me.y=r,ee=!0)),ee&&Ge(!0)),e||ae(Me,"throwupdate","onThrowUpdate")},$e=function(){var e,t,o,r;w=!1,l?(l.calibrate(),Me.minX=P=-l.maxScrollLeft(),Me.minY=W=-l.maxScrollTop(),Me.maxX=D=Me.maxY=O=0,w=!0):a.bounds&&(e=se(a.bounds,n.parentNode),ye?(Me.minX=P=e.left,Me.maxX=D=e.left+e.width,Me.minY=W=Me.maxY=O=0):void 0!==a.bounds.maxX||void 0!==a.bounds.maxY?(e=a.bounds,Me.minX=P=e.minX,Me.minY=W=e.minY,Me.maxX=D=e.maxX,Me.maxY=O=e.maxY):(t=se(n,n.parentNode),Me.minX=P=ie(n,we)+e.left-t.left,Me.minY=W=ie(n,be)+e.top-t.top,Me.maxX=D=P+(e.width-t.width),Me.maxY=O=W+(e.height-t.height)),P>D&&(Me.minX=D,Me.maxX=D=P,P=Me.minX),W>O&&(Me.minY=O,Me.maxY=O=W,W=Me.minY),ye&&(Me.minRotation=P,Me.maxRotation=D),w=!0),a.liveSnap&&(o=a.liveSnap===!0?a.snap||{}:a.liveSnap,r=o instanceof Array||"function"==typeof o,ye?(oe=et(r?o:o.rotation,P,D,1),ne=null):(Te&&(oe=et(r?o:o.x||o.left||o.scrollLeft,P,D,l?-1:1)),Se&&(ne=et(r?o:o.y||o.top||o.scrollTop,W,O,l?-1:1))))},Ke=function(){Me.isThrowing=!1,ae(Me,"throwcomplete","onThrowComplete")},Ze=function(){Me.isThrowing=!1},je=function(e,t){var o,r,s,c;e&&i?(e===!0&&(o=a.snap||{},r=o instanceof Array||"function"==typeof o,e={resistance:(a.throwResistance||a.resistance||1e3)/(ye?10:1)},ye?e.rotation=Ee(Me,r?o:o.rotation,D,P,1,t):(Te&&(e[we]=Ee(Me,r?o:o.x||o.left||o.scrollLeft,D,P,l?-1:1,t||"x"===Me.lockedAxis)),Se&&(e[be]=Ee(Me,r?o:o.y||o.top||o.scrollTop,O,W,l?-1:1,t||"y"===Me.lockedAxis)))),Me.isThrowing=!0,c=isNaN(a.overshootTolerance)?1===a.edgeResistance?0:1-Me.edgeResistance+.2:a.overshootTolerance,Me.tween=s=i.to(l||n,{throwProps:e,ease:a.ease||g.Power3.easeOut,onComplete:Ke,onOverwrite:Ze,onUpdate:a.fastMode?ae:Ue,onUpdateParams:a.fastMode?[Me,"onthrowupdate","onThrowUpdate"]:b},isNaN(a.maxDuration)?2:a.maxDuration,isNaN(a.minDuration)?0===c?0:.5:a.minDuration,c),a.fastMode||(l&&(l._suspendTransforms=!0),s.render(s.duration(),!0,!0),Ue(!0,!0),Me.endX=Me.x,Me.endY=Me.y,ye&&(Me.endRotation=Me.x),s.play(0),Ue(!0,!0),l&&(l._suspendTransforms=!1))):w&&Me.applyBounds()},qe=function(){ce=Le(n.parentNode,!0),ce[1]||ce[2]||1!=ce[0]||1!=ce[3]||0!=ce[4]||0!=ce[5]||(ce=null)},Qe=function(){var e=1-Me.edgeResistance;qe(),l?($e(),y=l.top(),x=l.left()):(Je()?(Ue(!0,!0),$e()):Me.applyBounds(),ye?(Q=Ne(n,{x:0,y:0}),Ue(!0,!0),x=Me.x,y=Me.y=Math.atan2(Q.y-f,c-Q.x)*S):(pe=n.parentNode?n.parentNode.scrollTop||0:0,he=n.parentNode?n.parentNode.scrollLeft||0:0,y=ie(n,be),x=ie(n,we))),w&&e&&(x>D?x=D+(x-D)/e:P>x&&(x=P-(P-x)/e),ye||(y>O?y=O+(y-O)/e:W>y&&(y=W-(W-y)/e)))},Je=function(){return Me.tween&&Me.tween.isActive()},et=function(e,t,o,n){return"function"==typeof e?function(r){var i=Me.isPressed?1-Me.edgeResistance:1;return e.call(Me,r>o?o+(r-o)*i:t>r?t+(r-t)*i:r)*n}:e instanceof Array?function(n){for(var r,i,a=e.length,s=0,l=L;--a>-1;)r=e[a],i=r-n,0>i&&(i=-i),l>i&&r>=t&&o>=r&&(s=a,l=i);return e[s]}:isNaN(e)?function(e){return e}:function(){return e*n}},tt=function(e){var o,r;if(s&&!Me.isPressed&&e&&!("mousedown"===e.type&&N()-de<30&&Pe[Me.pointerEvent.type])){if(fe=Je(),Me.pointerEvent=e,Pe[e.type]?(le=-1!==e.type.indexOf("touch")?e.currentTarget:m,Xe(le,"touchend",rt),Xe(le,"touchmove",ot),Xe(le,"touchcancel",rt),Xe(m,"touchstart",Re)):(le=null,Xe(m,"mousemove",ot)),xe=null,Xe(m,"mouseup",rt),e&&e.target&&Xe(e.target,"mouseup",rt),re=Ie.call(Me,e.target)&&!a.dragClickables)return Xe(e.target,"change",rt),ae(Me,"press","onPress"),void Ae(De,!0);if(ge=!le||Te===Se||l||Me.vars.allowNativeTouchScrolling===!1?!1:Te?"y":"x",C?e=j(e,!0):ge||Me.allowEventDefault||(e.preventDefault(),e.preventManipulation&&e.preventManipulation()),e.changedTouches?(e=G=e.changedTouches[0],K=e.identifier):e.pointerId?K=e.pointerId:G=K=null,X++,A(Ge),f=Me.pointerY=e.pageY,c=Me.pointerX=e.pageX,(ge||Me.autoScroll)&&Z(n.parentNode),!Me.autoScroll||ye||l||!n.parentNode||n.getBBox||!n.parentNode._gsMaxScrollX||M.parentNode||(M.style.width=n.parentNode.scrollWidth+"px",n.parentNode.appendChild(M)),Qe(),ce&&(o=c*ce[0]+f*ce[2]+ce[4],f=c*ce[1]+f*ce[3]+ce[5],c=o),Me.tween&&Me.tween.kill(),Me.isThrowing=!1,t.killTweensOf(l||n,!0,_e),l&&t.killTweensOf(n,!0,{scrollTo:1}),Me.tween=Me.lockedAxis=null,(a.zIndexBoost||!ye&&!l&&a.zIndexBoost!==!1)&&(n.style.zIndex=Ve.zIndex++),Me.isPressed=!0,T=!(!a.onDrag&&!Me._listeners.drag),!ye)for(r=De.length;--r>-1;)J(De[r],"cursor",a.cursor||"move");ae(Me,"press","onPress")}},ot=function(e){var t,o,n,i,a=e;if(s&&!r&&Me.isPressed&&e){if(Me.pointerEvent=e,t=e.changedTouches){if(e=t[0],e!==G&&e.identifier!==K){for(i=t.length;--i>-1&&(e=t[i]).identifier!==K;);if(0>i)return}}else if(e.pointerId&&K&&e.pointerId!==K)return;if(C)e=j(e,!0);else{if(le&&ge&&!xe&&(o=e.pageX,n=e.pageY,ce&&(i=o*ce[0]+n*ce[2]+ce[4],n=o*ce[1]+n*ce[3]+ce[5],o=i),xe=Math.abs(o-c)>Math.abs(n-f)&&Te?"x":"y",Me.vars.lockAxisOnTouchScroll!==!1&&(Me.lockedAxis="x"===xe?"y":"x","function"==typeof Me.vars.onLockAxis&&Me.vars.onLockAxis.call(Me,a)),Y&&ge===xe))return void rt(a);Me.allowEventDefault||ge&&(!xe||ge===xe)||a.cancelable===!1||(a.preventDefault(),a.preventManipulation&&a.preventManipulation())}Me.autoScroll&&(Fe=!0),nt(e.pageX,e.pageY)}},nt=function(e,t){var o,n,r,i,a,s,l=1-Me.dragResistance,d=1-Me.edgeResistance;Me.pointerX=e,Me.pointerY=t,ye?(i=Math.atan2(Q.y-t,e-Q.x)*S,a=Me.y-i,Me.y=i,a>180?y-=360:-180>a&&(y+=360),r=x+(y-i)*l):(ce&&(s=e*ce[0]+t*ce[2]+ce[4],t=e*ce[1]+t*ce[3]+ce[5],e=s),n=t-f,o=e-c,Ce>n&&n>-Ce&&(n=0),Ce>o&&o>-Ce&&(o=0),(Me.lockAxis||Me.lockedAxis)&&(o||n)&&(s=Me.lockedAxis,s||(Me.lockedAxis=s=Te&&Math.abs(o)>Math.abs(n)?"y":Se?"x":null,s&&"function"==typeof Me.vars.onLockAxis&&Me.vars.onLockAxis.call(Me,Me.pointerEvent)),"y"===s?n=0:"x"===s&&(o=0)),r=x+o*l,i=y+n*l),oe||ne?(oe&&(r=oe(r)),ne&&(i=ne(i))):w&&(r>D?r=D+(r-D)*d:P>r&&(r=P+(r-P)*d),ye||(i>O?i=O+(i-O)*d:W>i&&(i=W+(i-W)*d))),ye||(r=Math.round(r),i=Math.round(i)),(Me.x!==r||Me.y!==i&&!ye)&&(ye?Me.endRotation=Me.x=Me.endX=r:(Se&&(Me.y=Me.endY=i),Te&&(Me.x=Me.endX=r)),ee=!0,Me.isDragging||(Me.isDragging=!0,ae(Me,"dragstart","onDragStart")))},rt=function(e,t){if(s&&Me.isPressed&&(!e||null==K||t||!(e.pointerId&&e.pointerId!==K||e.changedTouches&&!Be(e.changedTouches,K)))){Me.isPressed=!1;var o,r,i,l,c=e,f=Me.isDragging;if(le?(Ye(le,"touchend",rt),Ye(le,"touchmove",ot),Ye(le,"touchcancel",rt),Ye(m,"touchstart",Re)):Ye(m,"mousemove",ot),Ye(m,"mouseup",rt),e&&e.target&&Ye(e.target,"mouseup",rt),ee=!1,M.parentNode&&M.parentNode.removeChild(M),re)return e&&Ye(e.target,"change",rt),Ae(De,!1),ae(Me,"release","onRelease"),ae(Me,"click","onClick"),void(re=!1);if(F(Ge),!ye)for(r=De.length;--r>-1;)J(De[r],"cursor",a.cursor||"move");if(f&&(Oe=B=N(),Me.isDragging=!1),X--,e){if(C&&(e=j(e,!1)),o=e.changedTouches,o&&(e=o[0],e!==G&&e.identifier!==K)){for(r=o.length;--r>-1&&(e=o[r]).identifier!==K;);if(0>r)return}Me.pointerEvent=c,Me.pointerX=e.pageX,Me.pointerY=e.pageY}return c&&!f?(fe&&(a.snap||a.bounds)&&je(a.throwProps),ae(Me,"release","onRelease"),Y&&"touchmove"===c.type||(ae(Me,"click","onClick"),l=c.target||c.srcElement||n,l.click?l.click():m.createEvent&&(i=m.createEvent("MouseEvents"),i.initEvent("click",!0,!0),l.dispatchEvent(i)),de=N())):(je(a.throwProps),C||Me.allowEventDefault||!c||!a.dragClickables&&Ie.call(Me,c.target)||!f||ge&&(!xe||ge!==xe)||c.cancelable===!1||(c.preventDefault(),c.preventManipulation&&c.preventManipulation()),ae(Me,"release","onRelease")),f&&ae(Me,"dragend","onDragEnd"),!0}},it=function(e){if(e&&Me.isDragging){var t=e.target||e.srcElement||n.parentNode,o=t.scrollLeft-t._gsScrollX,r=t.scrollTop-t._gsScrollY;(o||r)&&(c-=o,f-=r,t._gsScrollX+=o,t._gsScrollY+=r,nt(Me.pointerX,Me.pointerY))}},at=function(e){var t=N(),o=40>t-de,n=40>t-Oe;(Me.isPressed||n||o)&&(e.preventDefault?(e.preventDefault(),(o||n&&Me.vars.suppressClickOnDrag!==!1)&&e.stopImmediatePropagation()):e.returnValue=!1,e.preventManipulation&&e.preventManipulation())};te=Ve.get(this.target),te&&te.kill(),this.startDrag=function(e){tt(e),Me.isDragging||(Me.isDragging=!0,ae(Me,"dragstart","onDragStart"))},this.drag=ot,this.endDrag=function(e){rt(e,!0)},this.timeSinceDrag=function(){return Me.isDragging?0:(N()-Oe)/1e3},this.hitTest=function(e,t){return Ve.hitTest(Me.target,e,t)},this.getDirection=function(e,t){var o,n,r,a,s,l,c="velocity"===e&&i?e:"object"!=typeof e||ye?"start":"element";return"element"===c&&(s=ze(Me.target),l=ze(e)),o="start"===c?Me.x-x:"velocity"===c?i.getVelocity(this.target,we):s.left+s.width/2-(l.left+l.width/2),ye?0>o?"counter-clockwise":"clockwise":(t=t||2,n="start"===c?Me.y-y:"velocity"===c?i.getVelocity(this.target,be):s.top+s.height/2-(l.top+l.height/2),r=Math.abs(o/n),a=1/t>r?"":0>o?"left":"right",t>r&&(""!==a&&(a+="-"),a+=0>n?"up":"down"),a)},this.applyBounds=function(e){var t,o;return e&&a.bounds!==e?(a.bounds=e,Me.update(!0)):(Ue(!0),$e(),w&&(t=Me.x,o=Me.y,w&&(t>D?t=D:P>t&&(t=P),o>O?o=O:W>o&&(o=W)),(Me.x!==t||Me.y!==o)&&(Me.x=Me.endX=t,ye?Me.endRotation=t:Me.y=Me.endY=o,ee=!0,Ge())),Me)},this.update=function(e){var t=Me.x,o=Me.y;return qe(),e?Me.applyBounds():(ee&&Ge(),Ue(!0)),Me.isPressed&&(Te&&Math.abs(t-Me.x)>.01||Se&&Math.abs(o-Me.y)>.01&&!ye)&&Qe(),Me},this.enable=function(e){var r,c,f;if("soft"!==e){for(c=De.length;--c>-1;)f=De[c],Xe(f,"mousedown",tt),Xe(f,"touchstart",tt),Xe(f,"click",at,!0),ye||J(f,"cursor",a.cursor||"move"),J(f,"touchCallout","none"),J(f,"touchAction",Te===Se||l?"none":Te?"pan-y":"pan-x");Ae(De,!1)}return z(Me.target,it),s=!0,i&&"soft"!==e&&i.track(l||n,ve?"x,y":ye?"rotation":"top,left"),l&&l.enable(),n._gsDragID=r="d"+k++,_[r]=this,l&&(l.element._gsDragID=r),t.set(n,{x:"+=0",overwrite:!1}),ue={t:n,data:C?I:n._gsTransform,tween:{},setRatio:C?function(){t.set(n,H)}:o._internals.setTransformRatio||o._internals.set3DTransformRatio},this.update(!0),Me},this.disable=function(e){var t,o,r=this.isDragging;if(!ye)for(t=De.length;--t>-1;)J(De[t],"cursor",null);if("soft"!==e){for(t=De.length;--t>-1;)o=De[t],J(o,"touchCallout",null),J(o,"touchAction",null),Ye(o,"mousedown",tt),Ye(o,"touchstart",tt),Ye(o,"click",at);Ae(De,!0),le&&(Ye(le,"touchcancel",rt),Ye(le,"touchend",rt),Ye(le,"touchmove",ot)),Ye(m,"mouseup",rt),Ye(m,"mousemove",ot)}return U(n,it),s=!1,i&&"soft"!==e&&i.untrack(l||n,ve?"x,y":ye?"rotation":"top,left"),l&&l.disable(),F(Ge),this.isDragging=this.isPressed=re=!1,r&&ae(this,"dragend","onDragEnd"),Me},this.enabled=function(e,t){return arguments.length?e?this.enable(t):this.disable(t):s},this.kill=function(){return Me.isThrowing=!1,t.killTweensOf(l||n,!0,_e),Me.disable(),delete _[n._gsDragID],Me},-1!==me.indexOf("scroll")&&(l=this.scrollProxy=new He(n,V({onKill:function(){Me.isPressed&&rt(null)}},a)),n.style.overflowY=Se&&!ke?"auto":"hidden",n.style.overflowX=Te&&!ke?"auto":"hidden",n=l.content),a.force3D!==!1&&t.set(n,{force3D:!0}),ye?_e.rotation=1:(Te&&(_e[we]=1),Se&&(_e[be]=1)),ye?(H=u,I=H.css,H.overwrite=!1):ve&&(H=Te&&Se?d:Te?p:h,I=H.css,H.overwrite=!1),this.enable()},Ie=Ve.prototype=new e;Ie.constructor=Ve,Ie.pointerX=Ie.pointerY=0,Ie.isDragging=Ie.isPressed=!1,Ve.version="0.14.0",Ve.zIndex=1e3,Xe(m,"touchcancel",function(){}),Xe(m,"contextmenu",function(e){var t;for(t in _)_[t].isPressed&&_[t].endDrag()}),Ve.create=function(e,o){"string"==typeof e&&(e=t.selector(e));for(var n=De(e)?_e(e):[e],r=n.length;--r>-1;)n[r]=new Ve(n[r],o);return n},Ve.get=function(e){return _[(q(e)||{})._gsDragID]},Ve.timeSinceDrag=function(){return(N()-B)/1e3};var Ge={},ze=function(e,t){if(e===window)return Ge.left=Ge.top=0,Ge.width=Ge.right=v.clientWidth||e.innerWidth||m.body.clientWidth||0,Ge.height=Ge.bottom=(e.innerHeight||0)-20<v.clientHeight?v.clientHeight:e.innerHeight||m.body.clientHeight||0,Ge;var o=e.pageX!==t?{left:e.pageX,top:e.pageY,right:e.pageX+1,bottom:e.pageY+1}:e.nodeType||e.left===t||e.top===t?q(e).getBoundingClientRect():e;return o.right===t&&o.width!==t?(o.right=o.left+o.width,o.bottom=o.top+o.height):o.width===t&&(o={width:o.right-o.left,height:o.bottom-o.top,
right:o.right,left:o.left,bottom:o.bottom,top:o.top}),o};return Ve.hitTest=function(e,t,o){if(e===t)return!1;var n,r,i,a=ze(e),s=ze(t),l=s.left>a.right||s.right<a.left||s.top>a.bottom||s.bottom<a.top;return l||!o?!l:(i=-1!==(o+"").indexOf("%"),o=parseFloat(o)||0,n={left:Math.max(a.left,s.left),top:Math.max(a.top,s.top)},n.width=Math.min(a.right,s.right)-n.left,n.height=Math.min(a.bottom,s.bottom)-n.top,n.width<0||n.height<0?!1:i?(o*=.01,r=n.width*n.height,r>=a.width*a.height*o||r>=s.width*s.height*o):n.width>o&&n.height>o)},M.style.cssText="visibility:hidden;height:1px;top:-1px;pointer-events:none;position:relative;clear:both;",Ve},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(e){"use strict";var t=function(){return(_gsScope.GreenSockGlobals||_gsScope)[e]};"function"==typeof define&&define.amd?define(["TweenLite"],t):"undefined"!=typeof module&&module.exports&&(require("../TweenLite.js"),require("../plugins/CSSPlugin.js"),module.exports=t())}("Draggable");
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../TweenLite.js":2,"../plugins/CSSPlugin.js":4}],6:[function(require,module,exports){
!function(t,e,i,n){"use strict";function r(t,e,i){return setTimeout(c(t,i),e)}function s(t,e,i){return Array.isArray(t)?(o(t,i[e],i),!0):!1}function o(t,e,i){var r;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==n)for(r=0;r<t.length;)e.call(i,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(i,t[r],r,t)}function a(t,e,i){for(var r=Object.keys(e),s=0;s<r.length;)(!i||i&&t[r[s]]===n)&&(t[r[s]]=e[r[s]]),s++;return t}function h(t,e){return a(t,e,!0)}function u(t,e,i){var n,r=e.prototype;n=t.prototype=Object.create(r),n.constructor=t,n._super=r,i&&a(n,i)}function c(t,e){return function(){return t.apply(e,arguments)}}function l(t,e){return typeof t==ct?t.apply(e?e[0]||n:n,e):t}function p(t,e){return t===n?e:t}function f(t,e,i){o(g(e),function(e){t.addEventListener(e,i,!1)})}function d(t,e,i){o(g(e),function(e){t.removeEventListener(e,i,!1)})}function v(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function m(t,e){return t.indexOf(e)>-1}function g(t){return t.trim().split(/\s+/g)}function T(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function y(t){return Array.prototype.slice.call(t,0)}function E(t,e,i){for(var n=[],r=[],s=0;s<t.length;){var o=e?t[s][e]:t[s];T(r,o)<0&&n.push(t[s]),r[s]=o,s++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function I(t,e){for(var i,r,s=e[0].toUpperCase()+e.slice(1),o=0;o<ht.length;){if(i=ht[o],r=i?i+s:e,r in t)return r;o++}return n}function A(){return dt++}function _(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}function D(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){l(t.options.enable,[t])&&i.handler(e)},this.init()}function S(t){var e,i=t.options.inputClass;return new(e=i?i:gt?W:Tt?H:mt?U:F)(t,w)}function w(t,e,i){var n=i.pointers.length,r=i.changedPointers.length,s=e&Dt&&n-r===0,o=e&(wt|bt)&&n-r===0;i.isFirst=!!s,i.isFinal=!!o,s&&(t.session={}),i.eventType=e,b(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function b(t,e){var i=t.session,n=e.pointers,r=n.length;i.firstInput||(i.firstInput=z(e)),r>1&&!i.firstMultiple?i.firstMultiple=z(e):1===r&&(i.firstMultiple=!1);var s=i.firstInput,o=i.firstMultiple,a=o?o.center:s.center,h=e.center=N(n);e.timeStamp=ft(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=x(a,h),e.distance=O(a,h),C(i,e),e.offsetDirection=M(e.deltaX,e.deltaY),e.scale=o?Y(o.pointers,n):1,e.rotation=o?X(o.pointers,n):0,R(i,e);var u=t.element;v(e.srcEvent.target,u)&&(u=e.srcEvent.target),e.target=u}function C(t,e){var i=e.center,n=t.offsetDelta||{},r=t.prevDelta||{},s=t.prevInput||{};(e.eventType===Dt||s.eventType===wt)&&(r=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=r.x+(i.x-n.x),e.deltaY=r.y+(i.y-n.y)}function R(t,e){var i,r,s,o,a=t.lastInterval||e,h=e.timeStamp-a.timeStamp;if(e.eventType!=bt&&(h>_t||a.velocity===n)){var u=a.deltaX-e.deltaX,c=a.deltaY-e.deltaY,l=P(h,u,c);r=l.x,s=l.y,i=pt(l.x)>pt(l.y)?l.x:l.y,o=M(u,c),t.lastInterval=e}else i=a.velocity,r=a.velocityX,s=a.velocityY,o=a.direction;e.velocity=i,e.velocityX=r,e.velocityY=s,e.direction=o}function z(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:lt(t.pointers[i].clientX),clientY:lt(t.pointers[i].clientY)},i++;return{timeStamp:ft(),pointers:e,center:N(e),deltaX:t.deltaX,deltaY:t.deltaY}}function N(t){var e=t.length;if(1===e)return{x:lt(t[0].clientX),y:lt(t[0].clientY)};for(var i=0,n=0,r=0;e>r;)i+=t[r].clientX,n+=t[r].clientY,r++;return{x:lt(i/e),y:lt(n/e)}}function P(t,e,i){return{x:e/t||0,y:i/t||0}}function M(t,e){return t===e?Ct:pt(t)>=pt(e)?t>0?Rt:zt:e>0?Nt:Pt}function O(t,e,i){i||(i=Xt);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return Math.sqrt(n*n+r*r)}function x(t,e,i){i||(i=Xt);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return 180*Math.atan2(r,n)/Math.PI}function X(t,e){return x(e[1],e[0],Yt)-x(t[1],t[0],Yt)}function Y(t,e){return O(e[0],e[1],Yt)/O(t[0],t[1],Yt)}function F(){this.evEl=Wt,this.evWin=qt,this.allow=!0,this.pressed=!1,D.apply(this,arguments)}function W(){this.evEl=kt,this.evWin=Ut,D.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function q(){this.evTarget=Vt,this.evWin=jt,this.started=!1,D.apply(this,arguments)}function L(t,e){var i=y(t.touches),n=y(t.changedTouches);return e&(wt|bt)&&(i=E(i.concat(n),"identifier",!0)),[i,n]}function H(){this.evTarget=Bt,this.targetIds={},D.apply(this,arguments)}function k(t,e){var i=y(t.touches),n=this.targetIds;if(e&(Dt|St)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,s,o=y(t.changedTouches),a=[],h=this.target;if(s=i.filter(function(t){return v(t.target,h)}),e===Dt)for(r=0;r<s.length;)n[s[r].identifier]=!0,r++;for(r=0;r<o.length;)n[o[r].identifier]&&a.push(o[r]),e&(wt|bt)&&delete n[o[r].identifier],r++;return a.length?[E(s.concat(a),"identifier",!0),a]:void 0}function U(){D.apply(this,arguments);var t=c(this.handler,this);this.touch=new H(this.manager,t),this.mouse=new F(this.manager,t)}function G(t,e){this.manager=t,this.set(e)}function V(t){if(m(t,ee))return ee;var e=m(t,ie),i=m(t,ne);return e&&i?ie+" "+ne:e||i?e?ie:ne:m(t,te)?te:$t}function j(t){this.id=A(),this.manager=null,this.options=h(t||{},this.defaults),this.options.enable=p(this.options.enable,!0),this.state=re,this.simultaneous={},this.requireFail=[]}function Z(t){return t&ue?"cancel":t&ae?"end":t&oe?"move":t&se?"start":""}function B(t){return t==Pt?"down":t==Nt?"up":t==Rt?"left":t==zt?"right":""}function J(t,e){var i=e.manager;return i?i.get(t):t}function K(){j.apply(this,arguments)}function Q(){K.apply(this,arguments),this.pX=null,this.pY=null}function $(){K.apply(this,arguments)}function tt(){j.apply(this,arguments),this._timer=null,this._input=null}function et(){K.apply(this,arguments)}function it(){K.apply(this,arguments)}function nt(){j.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function rt(t,e){return e=e||{},e.recognizers=p(e.recognizers,rt.defaults.preset),new st(t,e)}function st(t,e){e=e||{},this.options=h(e,rt.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=S(this),this.touchAction=new G(this,this.options.touchAction),ot(this,!0),o(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ot(t,e){var i=t.element;o(t.options.cssProps,function(t,n){i.style[I(i.style,n)]=e?t:""})}function at(t,i){var n=e.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var ht=["","webkit","moz","MS","ms","o"],ut=e.createElement("div"),ct="function",lt=Math.round,pt=Math.abs,ft=Date.now,dt=1,vt=/mobile|tablet|ip(ad|hone|od)|android/i,mt="ontouchstart"in t,gt=I(t,"PointerEvent")!==n,Tt=mt&&vt.test(navigator.userAgent),yt="touch",Et="pen",It="mouse",At="kinect",_t=25,Dt=1,St=2,wt=4,bt=8,Ct=1,Rt=2,zt=4,Nt=8,Pt=16,Mt=Rt|zt,Ot=Nt|Pt,xt=Mt|Ot,Xt=["x","y"],Yt=["clientX","clientY"];D.prototype={handler:function(){},init:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(_(this.element),this.evWin,this.domHandler)}};var Ft={mousedown:Dt,mousemove:St,mouseup:wt},Wt="mousedown",qt="mousemove mouseup";u(F,D,{handler:function(t){var e=Ft[t.type];e&Dt&&0===t.button&&(this.pressed=!0),e&St&&1!==t.which&&(e=wt),this.pressed&&this.allow&&(e&wt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:It,srcEvent:t}))}});var Lt={pointerdown:Dt,pointermove:St,pointerup:wt,pointercancel:bt,pointerout:bt},Ht={2:yt,3:Et,4:It,5:At},kt="pointerdown",Ut="pointermove pointerup pointercancel";t.MSPointerEvent&&(kt="MSPointerDown",Ut="MSPointerMove MSPointerUp MSPointerCancel"),u(W,D,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),r=Lt[n],s=Ht[t.pointerType]||t.pointerType,o=s==yt,a=T(e,t.pointerId,"pointerId");r&Dt&&(0===t.button||o)?0>a&&(e.push(t),a=e.length-1):r&(wt|bt)&&(i=!0),0>a||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),i&&e.splice(a,1))}});var Gt={touchstart:Dt,touchmove:St,touchend:wt,touchcancel:bt},Vt="touchstart",jt="touchstart touchmove touchend touchcancel";u(q,D,{handler:function(t){var e=Gt[t.type];if(e===Dt&&(this.started=!0),this.started){var i=L.call(this,t,e);e&(wt|bt)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:yt,srcEvent:t})}}});var Zt={touchstart:Dt,touchmove:St,touchend:wt,touchcancel:bt},Bt="touchstart touchmove touchend touchcancel";u(H,D,{handler:function(t){var e=Zt[t.type],i=k.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:yt,srcEvent:t})}}),u(U,D,{handler:function(t,e,i){var n=i.pointerType==yt,r=i.pointerType==It;if(n)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;e&(wt|bt)&&(this.mouse.allow=!0),this.callback(t,e,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Jt=I(ut.style,"touchAction"),Kt=Jt!==n,Qt="compute",$t="auto",te="manipulation",ee="none",ie="pan-x",ne="pan-y";G.prototype={set:function(t){t==Qt&&(t=this.compute()),Kt&&(this.manager.element.style[Jt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return o(this.manager.recognizers,function(e){l(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),V(t.join(" "))},preventDefaults:function(t){if(!Kt){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var n=this.actions,r=m(n,ee),s=m(n,ne),o=m(n,ie);return r||s&&i&Mt||o&&i&Ot?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var re=1,se=2,oe=4,ae=8,he=ae,ue=16,ce=32;j.prototype={defaults:{},set:function(t){return a(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(s(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=J(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return s(t,"dropRecognizeWith",this)?this:(t=J(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(s(t,"requireFailure",this))return this;var e=this.requireFail;return t=J(t,this),-1===T(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(s(t,"dropRequireFailure",this))return this;t=J(t,this);var e=T(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){i.manager.emit(i.options.event+(e?Z(n):""),t)}var i=this,n=this.state;ae>n&&e(!0),e(),n>=ae&&e(!0)},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=ce)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(ce|re)))return!1;t++}return!0},recognize:function(t){var e=a({},t);return l(this.options.enable,[this,e])?(this.state&(he|ue|ce)&&(this.state=re),this.state=this.process(e),void(this.state&(se|oe|ae|ue)&&this.tryEmit(e))):(this.reset(),void(this.state=ce))},process:function(t){},getTouchAction:function(){},reset:function(){}},u(K,j,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(se|oe),r=this.attrTest(t);return n&&(i&bt||!r)?e|ue:n||r?i&wt?e|ae:e&se?e|oe:se:ce}}),u(Q,K,{defaults:{event:"pan",threshold:10,pointers:1,direction:xt},getTouchAction:function(){var t=this.options.direction,e=[];return t&Mt&&e.push(ne),t&Ot&&e.push(ie),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,r=t.direction,s=t.deltaX,o=t.deltaY;return r&e.direction||(e.direction&Mt?(r=0===s?Ct:0>s?Rt:zt,i=s!=this.pX,n=Math.abs(t.deltaX)):(r=0===o?Ct:0>o?Nt:Pt,i=o!=this.pY,n=Math.abs(t.deltaY))),t.direction=r,i&&n>e.threshold&&r&e.direction},attrTest:function(t){return K.prototype.attrTest.call(this,t)&&(this.state&se||!(this.state&se)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=B(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),u($,K,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ee]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&se)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?"in":"out";this.manager.emit(this.options.event+e,t)}}}),u(tt,j,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[$t]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,s=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(wt|bt)&&!s)this.reset();else if(t.eventType&Dt)this.reset(),this._timer=r(function(){this.state=he,this.tryEmit()},e.time,this);else if(t.eventType&wt)return he;return ce},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===he&&(t&&t.eventType&wt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=ft(),this.manager.emit(this.options.event,this._input)))}}),u(et,K,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ee]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&se)}}),u(it,K,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Mt|Ot,pointers:1},getTouchAction:function(){return Q.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(Mt|Ot)?e=t.velocity:i&Mt?e=t.velocityX:i&Ot&&(e=t.velocityY),this._super.attrTest.call(this,t)&&i&t.direction&&t.distance>this.options.threshold&&pt(e)>this.options.velocity&&t.eventType&wt},emit:function(t){var e=B(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),u(nt,j,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[te]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,s=t.deltaTime<e.time;if(this.reset(),t.eventType&Dt&&0===this.count)return this.failTimeout();if(n&&s&&i){if(t.eventType!=wt)return this.failTimeout();var o=this.pTime?t.timeStamp-this.pTime<e.interval:!0,a=!this.pCenter||O(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t;var h=this.count%e.taps;if(0===h)return this.hasRequireFailures()?(this._timer=r(function(){this.state=he,this.tryEmit()},e.interval,this),se):he}return ce},failTimeout:function(){return this._timer=r(function(){this.state=ce},this.options.interval,this),ce},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==he&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),rt.VERSION="2.0.4",rt.defaults={domEvents:!1,touchAction:Qt,enable:!0,inputTarget:null,inputClass:null,preset:[[et,{enable:!1}],[$,{enable:!1},["rotate"]],[it,{direction:Mt}],[Q,{direction:Mt},["swipe"]],[nt],[nt,{event:"doubletap",taps:2},["tap"]],[tt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var le=1,pe=2;st.prototype={set:function(t){return a(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?pe:le},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,n=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&he)&&(r=e.curRecognizer=null);for(var s=0;s<n.length;)i=n[s],e.stopped===pe||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(t),!r&&i.state&(se|oe|ae)&&(r=e.curRecognizer=i),s++}},get:function(t){if(t instanceof j)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(s(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(s(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(T(e,t),1),this.touchAction.update(),this},on:function(t,e){var i=this.handlers;return o(g(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},off:function(t,e){var i=this.handlers;return o(g(t),function(t){e?i[t].splice(T(i[t],e),1):delete i[t]}),this},emit:function(t,e){this.options.domEvents&&at(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&ot(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},a(rt,{INPUT_START:Dt,INPUT_MOVE:St,INPUT_END:wt,INPUT_CANCEL:bt,STATE_POSSIBLE:re,STATE_BEGAN:se,STATE_CHANGED:oe,STATE_ENDED:ae,STATE_RECOGNIZED:he,STATE_CANCELLED:ue,STATE_FAILED:ce,DIRECTION_NONE:Ct,DIRECTION_LEFT:Rt,DIRECTION_RIGHT:zt,DIRECTION_UP:Nt,DIRECTION_DOWN:Pt,DIRECTION_HORIZONTAL:Mt,DIRECTION_VERTICAL:Ot,DIRECTION_ALL:xt,Manager:st,Input:D,TouchAction:G,TouchInput:H,MouseInput:F,PointerEventInput:W,TouchMouseInput:U,SingleTouchInput:q,Recognizer:j,AttrRecognizer:K,Tap:nt,Pan:Q,Swipe:it,Pinch:$,Rotate:et,Press:tt,on:f,off:d,each:o,merge:h,extend:a,inherit:u,bindFn:c,prefixed:I}),typeof define==ct&&define.amd?define(function(){return rt}):"undefined"!=typeof module&&module.exports?module.exports=rt:t[i]=rt}(window,document,"Hammer");
},{}],7:[function(require,module,exports){
"use strict";function INTERNAL(){}module.exports=INTERNAL;
},{}],8:[function(require,module,exports){
"use strict";function all(e){function r(e,r){function i(e){o[r]=e,++l===t&!n&&(n=!0,handlers.resolve(s,o))}resolve(e).then(i,function(e){n||(n=!0,handlers.reject(s,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return resolve([]);for(var o=new Array(t),l=0,i=-1,s=new Promise(INTERNAL);++i<t;)r(e[i],i);return s}var Promise=require("./promise"),reject=require("./reject"),resolve=require("./resolve"),INTERNAL=require("./INTERNAL"),handlers=require("./handlers");module.exports=all;
},{"./INTERNAL":7,"./handlers":9,"./promise":11,"./reject":14,"./resolve":15}],9:[function(require,module,exports){
"use strict";function getThen(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}var tryCatch=require("./tryCatch"),resolveThenable=require("./resolveThenable"),states=require("./states");exports.resolve=function(e,t){var r=tryCatch(getThen,t);if("error"===r.status)return exports.reject(e,r.value);var u=r.value;if(u)resolveThenable.safely(e,u);else{e.state=states.FULFILLED,e.outcome=t;for(var a=-1,s=e.queue.length;++a<s;)e.queue[a].callFulfilled(t)}return e},exports.reject=function(e,t){e.state=states.REJECTED,e.outcome=t;for(var r=-1,u=e.queue.length;++r<u;)e.queue[r].callRejected(t);return e};
},{"./resolveThenable":16,"./states":17,"./tryCatch":18}],10:[function(require,module,exports){
module.exports=exports=require("./promise"),exports.resolve=require("./resolve"),exports.reject=require("./reject"),exports.all=require("./all"),exports.race=require("./race");
},{"./all":8,"./promise":11,"./race":13,"./reject":14,"./resolve":15}],11:[function(require,module,exports){
"use strict";function Promise(e){if(!(this instanceof Promise))return new Promise(e);if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=states.PENDING,this.queue=[],this.outcome=void 0,e!==INTERNAL&&resolveThenable.safely(this,e)}var unwrap=require("./unwrap"),INTERNAL=require("./INTERNAL"),resolveThenable=require("./resolveThenable"),states=require("./states"),QueueItem=require("./queueItem");module.exports=Promise,Promise.prototype["catch"]=function(e){return this.then(null,e)},Promise.prototype.then=function(e,t){if("function"!=typeof e&&this.state===states.FULFILLED||"function"!=typeof t&&this.state===states.REJECTED)return this;var s=new Promise(INTERNAL);if(this.state!==states.PENDING){var r=this.state===states.FULFILLED?e:t;unwrap(s,r,this.outcome)}else this.queue.push(new QueueItem(s,e,t));return s};
},{"./INTERNAL":7,"./queueItem":12,"./resolveThenable":16,"./states":17,"./unwrap":19}],12:[function(require,module,exports){
"use strict";function QueueItem(e,t,l){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof l&&(this.onRejected=l,this.callRejected=this.otherCallRejected)}var handlers=require("./handlers"),unwrap=require("./unwrap");module.exports=QueueItem,QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)};
},{"./handlers":9,"./unwrap":19}],13:[function(require,module,exports){
"use strict";function race(e){function r(e){resolve(e).then(function(e){n||(n=!0,handlers.resolve(i,e))},function(e){n||(n=!0,handlers.reject(i,e))})}if("[object Array]"!==Object.prototype.toString.call(e))return reject(new TypeError("must be an array"));var t=e.length,n=!1;if(!t)return resolve([]);for(var o=-1,i=new Promise(INTERNAL);++o<t;)r(e[o]);return i}var Promise=require("./promise"),reject=require("./reject"),resolve=require("./resolve"),INTERNAL=require("./INTERNAL"),handlers=require("./handlers");module.exports=race;
},{"./INTERNAL":7,"./handlers":9,"./promise":11,"./reject":14,"./resolve":15}],14:[function(require,module,exports){
"use strict";function reject(e){var r=new Promise(INTERNAL);return handlers.reject(r,e)}var Promise=require("./promise"),INTERNAL=require("./INTERNAL"),handlers=require("./handlers");module.exports=reject;
},{"./INTERNAL":7,"./handlers":9,"./promise":11}],15:[function(require,module,exports){
"use strict";function resolve(e){if(e)return e instanceof Promise?e:handlers.resolve(new Promise(INTERNAL),e);var r=typeof e;switch(r){case"boolean":return FALSE;case"undefined":return UNDEFINED;case"object":return NULL;case"number":return ZERO;case"string":return EMPTYSTRING}}var Promise=require("./promise"),INTERNAL=require("./INTERNAL"),handlers=require("./handlers");module.exports=resolve;var FALSE=handlers.resolve(new Promise(INTERNAL),!1),NULL=handlers.resolve(new Promise(INTERNAL),null),UNDEFINED=handlers.resolve(new Promise(INTERNAL),void 0),ZERO=handlers.resolve(new Promise(INTERNAL),0),EMPTYSTRING=handlers.resolve(new Promise(INTERNAL),"");
},{"./INTERNAL":7,"./handlers":9,"./promise":11}],16:[function(require,module,exports){
"use strict";function safelyResolveThenable(e,r){function a(r){n||(n=!0,handlers.reject(e,r))}function t(r){n||(n=!0,handlers.resolve(e,r))}function s(){r(t,a)}var n=!1,l=tryCatch(s);"error"===l.status&&a(l.value)}var handlers=require("./handlers"),tryCatch=require("./tryCatch");exports.safely=safelyResolveThenable;
},{"./handlers":9,"./tryCatch":18}],17:[function(require,module,exports){
exports.REJECTED=["REJECTED"],exports.FULFILLED=["FULFILLED"],exports.PENDING=["PENDING"];
},{}],18:[function(require,module,exports){
"use strict";function tryCatch(t,r){var s={};try{s.value=t(r),s.status="success"}catch(u){s.status="error",s.value=u}return s}module.exports=tryCatch;
},{}],19:[function(require,module,exports){
"use strict";function unwrap(e,r,t){immediate(function(){var n;try{n=r(t)}catch(a){return handlers.reject(e,a)}n===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,n)})}var immediate=require("immediate"),handlers=require("./handlers");module.exports=unwrap;
},{"./handlers":9,"immediate":20}],20:[function(require,module,exports){
(function (global){
"use strict";function nextTick(){draining=!0;for(var e,n,t=queue.length;t;){for(n=queue,queue=[],e=-1;++e<t;)n[e]();t=queue.length}draining=!1}function immediate(e){1!==queue.push(e)||draining||scheduleDrain()}var Mutation=global.MutationObserver||global.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||"undefined"==typeof global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var e=global.document.createElement("script");e.onreadystatechange=function(){nextTick(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var draining,queue=[];module.exports=immediate;
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],21:[function(require,module,exports){
(function (global){
(function(){function n(n,t){if(n!==t){var r=null===n,e=n===b,u=n===n,i=null===t,o=t===b,f=t===t;if(n>t&&!i||!u||r&&!o&&f||e&&f)return 1;if(t>n&&!r||!f||i&&!e&&u||o&&u)return-1}return 0}function t(n,t,r){for(var e=n.length,u=r?e:-1;r?u--:++u<e;)if(t(n[u],u,n))return u;return-1}function r(n,t,r){if(t!==t)return h(n,r);for(var e=r-1,u=n.length;++e<u;)if(n[e]===t)return e;return-1}function e(n){return"function"==typeof n||!1}function u(n){return null==n?"":n+""}function i(n,t){for(var r=-1,e=n.length;++r<e&&t.indexOf(n.charAt(r))>-1;);return r}function o(n,t){for(var r=n.length;r--&&t.indexOf(n.charAt(r))>-1;);return r}function f(t,r){return n(t.criteria,r.criteria)||t.index-r.index}function a(t,r,e){for(var u=-1,i=t.criteria,o=r.criteria,f=i.length,a=e.length;++u<f;){var c=n(i[u],o[u]);if(c){if(u>=a)return c;var l=e[u];return c*("asc"===l||l===!0?1:-1)}}return t.index-r.index}function c(n){return qn[n]}function l(n){return Mn[n]}function s(n,t,r){return t?n=Vn[n]:r&&(n=Yn[n]),"\\"+n}function p(n){return"\\"+Yn[n]}function h(n,t,r){for(var e=n.length,u=t+(r?0:-1);r?u--:++u<e;){var i=n[u];if(i!==i)return u}return-1}function v(n){return!!n&&"object"==typeof n}function _(n){return 160>=n&&n>=9&&13>=n||32==n||160==n||5760==n||6158==n||n>=8192&&(8202>=n||8232==n||8233==n||8239==n||8287==n||12288==n||65279==n)}function g(n,t){for(var r=-1,e=n.length,u=-1,i=[];++r<e;)n[r]===t&&(n[r]=D,i[++u]=r);return i}function y(n,t){for(var r,e=-1,u=n.length,i=-1,o=[];++e<u;){var f=n[e],a=t?t(f,e,n):f;e&&r===a||(r=a,o[++i]=f)}return o}function d(n){for(var t=-1,r=n.length;++t<r&&_(n.charCodeAt(t)););return t}function m(n){for(var t=n.length;t--&&_(n.charCodeAt(t)););return t}function w(n){return Pn[n]}function x(_){function G(n){if(v(n)&&!Cf(n)&&!(n instanceof qn)){if(n instanceof nn)return n;if(no.call(n,"__chain__")&&no.call(n,"__wrapped__"))return he(n)}return new nn(n)}function H(){}function nn(n,t,r){this.__wrapped__=n,this.__actions__=r||[],this.__chain__=!!t}function qn(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Oo,this.__views__=[]}function Mn(){var n=new qn(this.__wrapped__);return n.__actions__=et(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=et(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=et(this.__views__),n}function Pn(){if(this.__filtered__){var n=new qn(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function Kn(){var n=this.__wrapped__.value(),t=this.__dir__,r=Cf(n),e=0>t,u=r?n.length:0,i=Vr(0,u,this.__views__),o=i.start,f=i.end,a=f-o,c=e?f:o-1,l=this.__iteratees__,s=l.length,p=0,h=Ao(a,this.__takeCount__);if(!r||T>u||u==a&&h==a)return er(e&&r?n.reverse():n,this.__actions__);var v=[];n:for(;a--&&h>p;){c+=t;for(var _=-1,g=n[c];++_<s;){var y=l[_],d=y.iteratee,m=y.type,w=d(g);if(m==B)g=w;else if(!w){if(m==L)continue n;break n}}v[p++]=g}return v}function Vn(){this.__data__={}}function Yn(n){return this.has(n)&&delete this.__data__[n]}function Gn(n){return"__proto__"==n?b:this.__data__[n]}function Jn(n){return"__proto__"!=n&&no.call(this.__data__,n)}function Xn(n,t){return"__proto__"!=n&&(this.__data__[n]=t),this}function Zn(n){var t=n?n.length:0;for(this.data={hash:go(null),set:new lo};t--;)this.push(n[t])}function Hn(n,t){var r=n.data,e="string"==typeof t||Wu(t)?r.set.has(t):r.hash[t];return e?0:-1}function Qn(n){var t=this.data;"string"==typeof n||Wu(n)?t.set.add(n):t.hash[n]=!0}function rt(n,t){for(var r=-1,e=n.length,u=-1,i=t.length,o=zi(e+i);++r<e;)o[r]=n[r];for(;++u<i;)o[r++]=t[u];return o}function et(n,t){var r=-1,e=n.length;for(t||(t=zi(e));++r<e;)t[r]=n[r];return t}function ut(n,t){for(var r=-1,e=n.length;++r<e&&t(n[r],r,n)!==!1;);return n}function it(n,t){for(var r=n.length;r--&&t(n[r],r,n)!==!1;);return n}function ot(n,t){for(var r=-1,e=n.length;++r<e;)if(!t(n[r],r,n))return!1;return!0}function ft(n,t,r,e){for(var u=-1,i=n.length,o=e,f=o;++u<i;){var a=n[u],c=+t(a);r(c,o)&&(o=c,f=a)}return f}function at(n,t){for(var r=-1,e=n.length,u=-1,i=[];++r<e;){var o=n[r];t(o,r,n)&&(i[++u]=o)}return i}function ct(n,t){for(var r=-1,e=n.length,u=zi(e);++r<e;)u[r]=t(n[r],r,n);return u}function lt(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function st(n,t,r,e){var u=-1,i=n.length;for(e&&i&&(r=n[++u]);++u<i;)r=t(r,n[u],u,n);return r}function pt(n,t,r,e){var u=n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r}function ht(n,t){for(var r=-1,e=n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}function vt(n,t){for(var r=n.length,e=0;r--;)e+=+t(n[r])||0;return e}function _t(n,t){return n===b?t:n}function gt(n,t,r,e){return n!==b&&no.call(e,r)?n:t}function yt(n,t,r){for(var e=-1,u=Df(t),i=u.length;++e<i;){var o=u[e],f=n[o],a=r(f,t[o],o,n,t);(a===a?a===f:f!==f)&&(f!==b||o in n)||(n[o]=a)}return n}function dt(n,t){return null==t?n:wt(t,Df(t),n)}function mt(n,t){for(var r=-1,e=null==n,u=!e&&Zr(n),i=u?n.length:0,o=t.length,f=zi(o);++r<o;){var a=t[r];u?f[r]=Hr(a,i)?n[a]:b:f[r]=e?b:n[a]}return f}function wt(n,t,r){r||(r={});for(var e=-1,u=t.length;++e<u;){var i=t[e];r[i]=n[i]}return r}function xt(n,t,r){var e=typeof n;return"function"==e?t===b?n:or(n,t,r):null==n?Ri:"object"==e?zt(n):t===b?Si(n):Dt(n,t)}function bt(n,t,r,e,u,i,o){var f;if(r&&(f=u?r(n,e,u):r(n)),f!==b)return f;if(!Wu(n))return n;var a=Cf(n);if(a){if(f=Yr(n),!t)return et(n,f)}else{var c=ro.call(n),l=c==Y;if(c!=X&&c!=q&&(!l||u))return Dn[c]?Jr(n,c,t):u?n:{};if(f=Gr(l?{}:n),!t)return dt(f,n)}i||(i=[]),o||(o=[]);for(var s=i.length;s--;)if(i[s]==n)return o[s];return i.push(n),o.push(f),(a?ut:$t)(n,function(e,u){f[u]=bt(e,t,r,u,n,i,o)}),f}function At(n,t,r){if("function"!=typeof n)throw new Ji(z);return so(function(){n.apply(b,r)},t)}function jt(n,t){var e=n?n.length:0,u=[];if(!e)return u;var i=-1,o=Mr(),f=o==r,a=f&&t.length>=T?_r(t):null,c=t.length;a&&(o=Hn,f=!1,t=a);n:for(;++i<e;){var l=n[i];if(f&&l===l){for(var s=c;s--;)if(t[s]===l)continue n;u.push(l)}else o(t,l,0)<0&&u.push(l)}return u}function kt(n,t){var r=!0;return No(n,function(n,e,u){return r=!!t(n,e,u)}),r}function It(n,t,r,e){var u=e,i=u;return No(n,function(n,o,f){var a=+t(n,o,f);(r(a,u)||a===e&&a===i)&&(u=a,i=n)}),i}function Rt(n,t,r,e){var u=n.length;for(r=null==r?0:+r||0,0>r&&(r=-r>u?0:u+r),e=e===b||e>u?u:+e||0,0>e&&(e+=u),u=r>e?0:e>>>0,r>>>=0;u>r;)n[r++]=t;return n}function Ot(n,t){var r=[];return No(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function Et(n,t,r,e){var u;return r(n,function(n,r,i){return t(n,r,i)?(u=e?r:n,!1):void 0}),u}function Ct(n,t,r,e){e||(e=[]);for(var u=-1,i=n.length;++u<i;){var o=n[u];v(o)&&Zr(o)&&(r||Cf(o)||ku(o))?t?Ct(o,t,r,e):lt(e,o):r||(e[e.length]=o)}return e}function Ut(n,t){return Lo(n,t,ni)}function $t(n,t){return Lo(n,t,Df)}function St(n,t){return Bo(n,t,Df)}function Wt(n,t){for(var r=-1,e=t.length,u=-1,i=[];++r<e;){var o=t[r];Su(n[o])&&(i[++u]=o)}return i}function Ft(n,t,r){if(null!=n){r!==b&&r in se(n)&&(t=[r]);for(var e=0,u=t.length;null!=n&&u>e;)n=n[t[e++]];return e&&e==u?n:b}}function Nt(n,t,r,e,u,i){return n===t?!0:null==n||null==t||!Wu(n)&&!v(t)?n!==n&&t!==t:Tt(n,t,Nt,r,e,u,i)}function Tt(n,t,r,e,u,i,o){var f=Cf(n),a=Cf(t),c=M,l=M;f||(c=ro.call(n),c==q?c=X:c!=X&&(f=Mu(n))),a||(l=ro.call(t),l==q?l=X:l!=X&&(a=Mu(t)));var s=c==X,p=l==X,h=c==l;if(h&&!f&&!s)return Br(n,t,c);if(!u){var v=s&&no.call(n,"__wrapped__"),_=p&&no.call(t,"__wrapped__");if(v||_)return r(v?n.value():n,_?t.value():t,e,u,i,o)}if(!h)return!1;i||(i=[]),o||(o=[]);for(var g=i.length;g--;)if(i[g]==n)return o[g]==t;i.push(n),o.push(t);var y=(f?Lr:zr)(n,t,r,e,u,i,o);return i.pop(),o.pop(),y}function Lt(n,t,r){var e=t.length,u=e,i=!r;if(null==n)return!u;for(n=se(n);e--;){var o=t[e];if(i&&o[2]?o[1]!==n[o[0]]:!(o[0]in n))return!1}for(;++e<u;){o=t[e];var f=o[0],a=n[f],c=o[1];if(i&&o[2]){if(a===b&&!(f in n))return!1}else{var l=r?r(a,c,f):b;if(!(l===b?Nt(c,a,r,!0):l))return!1}}return!0}function Bt(n,t){var r=-1,e=Zr(n)?zi(n.length):[];return No(n,function(n,u,i){e[++r]=t(n,u,i)}),e}function zt(n){var t=Pr(n);if(1==t.length&&t[0][2]){var r=t[0][0],e=t[0][1];return function(n){return null==n?!1:n[r]===e&&(e!==b||r in se(n))}}return function(n){return Lt(n,t)}}function Dt(n,t){var r=Cf(n),e=ne(n)&&ee(t),u=n+"";return n=pe(n),function(i){if(null==i)return!1;var o=u;if(i=se(i),(r||!e)&&!(o in i)){if(i=1==n.length?i:Ft(i,Jt(n,0,-1)),null==i)return!1;o=Ie(n),i=se(i)}return i[o]===t?t!==b||o in i:Nt(t,i[o],b,!0)}}function qt(n,t,r,e,u){if(!Wu(n))return n;var i=Zr(t)&&(Cf(t)||Mu(t)),o=i?b:Df(t);return ut(o||t,function(f,a){if(o&&(a=f,f=t[a]),v(f))e||(e=[]),u||(u=[]),Mt(n,t,a,qt,r,e,u);else{var c=n[a],l=r?r(c,f,a,n,t):b,s=l===b;s&&(l=f),l===b&&(!i||a in n)||!s&&(l===l?l===c:c!==c)||(n[a]=l)}}),n}function Mt(n,t,r,e,u,i,o){for(var f=i.length,a=t[r];f--;)if(i[f]==a)return void(n[r]=o[f]);var c=n[r],l=u?u(c,a,r,n,t):b,s=l===b;s&&(l=a,Zr(a)&&(Cf(a)||Mu(a))?l=Cf(c)?c:Zr(c)?et(c):[]:zu(a)||ku(a)?l=ku(c)?Gu(c):zu(c)?c:{}:s=!1),i.push(a),o.push(l),s?n[r]=e(l,a,u,i,o):(l===l?l!==c:c===c)&&(n[r]=l)}function Pt(n){return function(t){return null==t?b:t[n]}}function Kt(n){var t=n+"";return n=pe(n),function(r){return Ft(r,n,t)}}function Vt(n,t){for(var r=n?t.length:0;r--;){var e=t[r];if(e!=u&&Hr(e)){var u=e;po.call(n,e,1)}}return n}function Yt(n,t){return n+yo(Io()*(t-n+1))}function Gt(n,t,r,e,u){return u(n,function(n,u,i){r=e?(e=!1,n):t(r,n,u,i)}),r}function Jt(n,t,r){var e=-1,u=n.length;t=null==t?0:+t||0,0>t&&(t=-t>u?0:u+t),r=r===b||r>u?u:+r||0,0>r&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0;for(var i=zi(u);++e<u;)i[e]=n[e+t];return i}function Xt(n,t){var r;return No(n,function(n,e,u){return r=t(n,e,u),!r}),!!r}function Zt(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].value;return n}function Ht(n,t,r){var e=Dr(),u=-1;t=ct(t,function(n){return e(n)});var i=Bt(n,function(n){var r=ct(t,function(t){return t(n)});return{criteria:r,index:++u,value:n}});return Zt(i,function(n,t){return a(n,t,r)})}function Qt(n,t){var r=0;return No(n,function(n,e,u){r+=+t(n,e,u)||0}),r}function nr(n,t){var e=-1,u=Mr(),i=n.length,o=u==r,f=o&&i>=T,a=f?_r():null,c=[];a?(u=Hn,o=!1):(f=!1,a=t?[]:c);n:for(;++e<i;){var l=n[e],s=t?t(l,e,n):l;if(o&&l===l){for(var p=a.length;p--;)if(a[p]===s)continue n;t&&a.push(s),c.push(l)}else u(a,s,0)<0&&((t||f)&&a.push(s),c.push(l))}return c}function tr(n,t){for(var r=-1,e=t.length,u=zi(e);++r<e;)u[r]=n[t[r]];return u}function rr(n,t,r,e){for(var u=n.length,i=e?u:-1;(e?i--:++i<u)&&t(n[i],i,n););return r?Jt(n,e?0:i,e?i+1:u):Jt(n,e?i+1:0,e?u:i)}function er(n,t){var r=n;r instanceof qn&&(r=r.value());for(var e=-1,u=t.length;++e<u;){var i=t[e];r=i.func.apply(i.thisArg,lt([r],i.args))}return r}function ur(n,t,r){var e=0,u=n?n.length:e;if("number"==typeof t&&t===t&&Uo>=u){for(;u>e;){var i=e+u>>>1,o=n[i];(r?t>=o:t>o)&&null!==o?e=i+1:u=i}return u}return ir(n,t,Ri,r)}function ir(n,t,r,e){t=r(t);for(var u=0,i=n?n.length:0,o=t!==t,f=null===t,a=t===b;i>u;){var c=yo((u+i)/2),l=r(n[c]),s=l!==b,p=l===l;if(o)var h=p||e;else h=f?p&&s&&(e||null!=l):a?p&&(e||s):null==l?!1:e?t>=l:t>l;h?u=c+1:i=c}return Ao(i,Co)}function or(n,t,r){if("function"!=typeof n)return Ri;if(t===b)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)};case 5:return function(r,e,u,i,o){return n.call(t,r,e,u,i,o)}}return function(){return n.apply(t,arguments)}}function fr(n){var t=new io(n.byteLength),r=new ho(t);return r.set(new ho(n)),t}function ar(n,t,r){for(var e=r.length,u=-1,i=bo(n.length-e,0),o=-1,f=t.length,a=zi(f+i);++o<f;)a[o]=t[o];for(;++u<e;)a[r[u]]=n[u];for(;i--;)a[o++]=n[u++];return a}function cr(n,t,r){for(var e=-1,u=r.length,i=-1,o=bo(n.length-u,0),f=-1,a=t.length,c=zi(o+a);++i<o;)c[i]=n[i];for(var l=i;++f<a;)c[l+f]=t[f];for(;++e<u;)c[l+r[e]]=n[i++];return c}function lr(n,t){return function(r,e,u){var i=t?t():{};if(e=Dr(e,u,3),Cf(r))for(var o=-1,f=r.length;++o<f;){var a=r[o];n(i,a,e(a,o,r),r)}else No(r,function(t,r,u){n(i,t,e(t,r,u),u)});return i}}function sr(n){return yu(function(t,r){var e=-1,u=null==t?0:r.length,i=u>2?r[u-2]:b,o=u>2?r[2]:b,f=u>1?r[u-1]:b;for("function"==typeof i?(i=or(i,f,5),u-=2):(i="function"==typeof f?f:b,u-=i?1:0),o&&Qr(r[0],r[1],o)&&(i=3>u?b:i,u=1);++e<u;){var a=r[e];a&&n(t,a,i)}return t})}function pr(n,t){return function(r,e){var u=r?qo(r):0;if(!re(u))return n(r,e);for(var i=t?u:-1,o=se(r);(t?i--:++i<u)&&e(o[i],i,o)!==!1;);return r}}function hr(n){return function(t,r,e){for(var u=se(t),i=e(t),o=i.length,f=n?o:-1;n?f--:++f<o;){var a=i[f];if(r(u[a],a,u)===!1)break}return t}}function vr(n,t){function r(){var u=this&&this!==nt&&this instanceof r?e:n;return u.apply(t,arguments)}var e=yr(n);return r}function _r(n){return go&&lo?new Zn(n):null}function gr(n){return function(t){for(var r=-1,e=ji(li(t)),u=e.length,i="";++r<u;)i=n(i,e[r],r);return i}}function yr(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Fo(n.prototype),e=n.apply(r,t);return Wu(e)?e:r}}function dr(n){function t(r,e,u){u&&Qr(r,e,u)&&(e=b);var i=Tr(r,n,b,b,b,b,b,e);return i.placeholder=t.placeholder,i}return t}function mr(n,t){return yu(function(r){var e=r[0];return null==e?e:(r.push(t),n.apply(b,r))})}function wr(n,t){return function(r,e,u){if(u&&Qr(r,e,u)&&(e=b),e=Dr(e,u,3),1==e.length){r=Cf(r)?r:le(r);var i=ft(r,e,n,t);if(!r.length||i!==t)return i}return It(r,e,n,t)}}function xr(n,r){return function(e,u,i){if(u=Dr(u,i,3),Cf(e)){var o=t(e,u,r);return o>-1?e[o]:b}return Et(e,u,n)}}function br(n){return function(r,e,u){return r&&r.length?(e=Dr(e,u,3),t(r,e,n)):-1}}function Ar(n){return function(t,r,e){return r=Dr(r,e,3),Et(t,r,n,!0)}}function jr(n){return function(){for(var t,r=arguments.length,e=n?r:-1,u=0,i=zi(r);n?e--:++e<r;){var o=i[u++]=arguments[e];if("function"!=typeof o)throw new Ji(z);!t&&nn.prototype.thru&&"wrapper"==qr(o)&&(t=new nn([],!0))}for(e=t?-1:r;++e<r;){o=i[e];var f=qr(o),a="wrapper"==f?Do(o):b;t=a&&te(a[0])&&a[1]==(U|R|E|$)&&!a[4].length&&1==a[9]?t[qr(a[0])].apply(t,a[3]):1==o.length&&te(o)?t[f]():t.thru(o)}return function(){var n=arguments,e=n[0];if(t&&1==n.length&&Cf(e)&&e.length>=T)return t.plant(e).value();for(var u=0,o=r?i[u].apply(this,n):e;++u<r;)o=i[u].call(this,o);return o}}}function kr(n,t){return function(r,e,u){return"function"==typeof e&&u===b&&Cf(r)?n(r,e):t(r,or(e,u,3))}}function Ir(n){return function(t,r,e){return("function"!=typeof r||e!==b)&&(r=or(r,e,3)),n(t,r,ni)}}function Rr(n){return function(t,r,e){return("function"!=typeof r||e!==b)&&(r=or(r,e,3)),n(t,r)}}function Or(n){return function(t,r,e){var u={};return r=Dr(r,e,3),$t(t,function(t,e,i){var o=r(t,e,i);e=n?o:e,t=n?t:o,u[e]=t}),u}}function Er(n){return function(t,r,e){return t=u(t),(n?t:"")+Sr(t,r,e)+(n?"":t)}}function Cr(n){var t=yu(function(r,e){var u=g(e,t.placeholder);return Tr(r,n,b,e,u)});return t}function Ur(n,t){return function(r,e,u,i){var o=arguments.length<3;return"function"==typeof e&&i===b&&Cf(r)?n(r,e,u,o):Gt(r,Dr(e,i,4),u,o,t)}}function $r(n,t,r,e,u,i,o,f,a,c){function l(){for(var m=arguments.length,w=m,x=zi(m);w--;)x[w]=arguments[w];if(e&&(x=ar(x,e,u)),i&&(x=cr(x,i,o)),v||y){var A=l.placeholder,I=g(x,A);if(m-=I.length,c>m){var R=f?et(f):b,O=bo(c-m,0),U=v?I:b,$=v?b:I,S=v?x:b,W=v?b:x;t|=v?E:C,t&=~(v?C:E),_||(t&=~(j|k));var F=[n,t,r,S,U,W,$,R,a,O],N=$r.apply(b,F);return te(n)&&Mo(N,F),N.placeholder=A,N}}var T=p?r:this,L=h?T[n]:n;return f&&(x=ae(x,f)),s&&a<x.length&&(x.length=a),this&&this!==nt&&this instanceof l&&(L=d||yr(n)),L.apply(T,x)}var s=t&U,p=t&j,h=t&k,v=t&R,_=t&I,y=t&O,d=h?b:yr(n);return l}function Sr(n,t,r){var e=n.length;if(t=+t,e>=t||!wo(t))return"";var u=t-e;return r=null==r?" ":r+"",gi(r,_o(u/r.length)).slice(0,u)}function Wr(n,t,r,e){function u(){for(var t=-1,f=arguments.length,a=-1,c=e.length,l=zi(c+f);++a<c;)l[a]=e[a];for(;f--;)l[a++]=arguments[++t];var s=this&&this!==nt&&this instanceof u?o:n;return s.apply(i?r:this,l)}var i=t&j,o=yr(n);return u}function Fr(n){var t=Pi[n];return function(n,r){return r=r===b?0:+r||0,r?(r=ao(10,r),t(n*r)/r):t(n)}}function Nr(n){return function(t,r,e,u){var i=Dr(e);return null==e&&i===xt?ur(t,r,n):ir(t,r,i(e,u,1),n)}}function Tr(n,t,r,e,u,i,o,f){var a=t&k;if(!a&&"function"!=typeof n)throw new Ji(z);var c=e?e.length:0;if(c||(t&=~(E|C),e=u=b),c-=u?u.length:0,t&C){var l=e,s=u;e=u=b}var p=a?b:Do(n),h=[n,t,r,e,u,l,s,i,o,f];if(p&&(ue(h,p),t=h[1],f=h[9]),h[9]=null==f?a?0:n.length:bo(f-c,0)||0,t==j)var v=vr(h[0],h[2]);else v=t!=E&&t!=(j|E)||h[4].length?$r.apply(b,h):Wr.apply(b,h);var _=p?zo:Mo;return _(v,h)}function Lr(n,t,r,e,u,i,o){var f=-1,a=n.length,c=t.length;if(a!=c&&!(u&&c>a))return!1;for(;++f<a;){var l=n[f],s=t[f],p=e?e(u?s:l,u?l:s,f):b;if(p!==b){if(p)continue;return!1}if(u){if(!ht(t,function(n){return l===n||r(l,n,e,u,i,o)}))return!1}else if(l!==s&&!r(l,s,e,u,i,o))return!1}return!0}function Br(n,t,r){switch(r){case P:case K:return+n==+t;case V:return n.name==t.name&&n.message==t.message;case J:return n!=+n?t!=+t:n==+t;case Z:case Q:return n==t+""}return!1}function zr(n,t,r,e,u,i,o){var f=Df(n),a=f.length,c=Df(t),l=c.length;if(a!=l&&!u)return!1;for(var s=a;s--;){var p=f[s];if(!(u?p in t:no.call(t,p)))return!1}for(var h=u;++s<a;){p=f[s];var v=n[p],_=t[p],g=e?e(u?_:v,u?v:_,p):b;if(!(g===b?r(v,_,e,u,i,o):g))return!1;h||(h="constructor"==p)}if(!h){var y=n.constructor,d=t.constructor;if(y!=d&&"constructor"in n&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof d&&d instanceof d))return!1}return!0}function Dr(n,t,r){var e=G.callback||ki;return e=e===ki?xt:e,r?e(n,t,r):e}function qr(n){for(var t=n.name,r=Wo[t],e=r?r.length:0;e--;){var u=r[e],i=u.func;if(null==i||i==n)return u.name}return t}function Mr(n,t,e){var u=G.indexOf||je;return u=u===je?r:u,n?u(n,t,e):u}function Pr(n){for(var t=ti(n),r=t.length;r--;)t[r][2]=ee(t[r][1]);return t}function Kr(n,t){var r=null==n?b:n[t];return Tu(r)?r:b}function Vr(n,t,r){for(var e=-1,u=r.length;++e<u;){var i=r[e],o=i.size;switch(i.type){case"drop":n+=o;break;case"dropRight":t-=o;break;case"take":t=Ao(t,n+o);break;case"takeRight":n=bo(n,t-o)}}return{start:n,end:t}}function Yr(n){var t=n.length,r=new n.constructor(t);return t&&"string"==typeof n[0]&&no.call(n,"index")&&(r.index=n.index,r.input=n.input),r}function Gr(n){var t=n.constructor;return"function"==typeof t&&t instanceof t||(t=Vi),new t}function Jr(n,t,r){var e=n.constructor;switch(t){case tn:return fr(n);case P:case K:return new e(+n);case rn:case en:case un:case on:case fn:case an:case cn:case ln:case sn:var u=n.buffer;return new e(r?fr(u):u,n.byteOffset,n.length);case J:case Q:return new e(n);case Z:var i=new e(n.source,Cn.exec(n));i.lastIndex=n.lastIndex}return i}function Xr(n,t,r){null==n||ne(t,n)||(t=pe(t),n=1==t.length?n:Ft(n,Jt(t,0,-1)),t=Ie(t));var e=null==n?n:n[t];return null==e?b:e.apply(n,r)}function Zr(n){return null!=n&&re(qo(n))}function Hr(n,t){return n="number"==typeof n||Sn.test(n)?+n:-1,t=null==t?$o:t,n>-1&&n%1==0&&t>n}function Qr(n,t,r){if(!Wu(r))return!1;var e=typeof t;if("number"==e?Zr(r)&&Hr(t,r.length):"string"==e&&t in r){var u=r[t];return n===n?n===u:u!==u}return!1}function ne(n,t){var r=typeof n;if("string"==r&&An.test(n)||"number"==r)return!0;if(Cf(n))return!1;var e=!bn.test(n);return e||null!=t&&n in se(t)}function te(n){var t=qr(n);if(!(t in qn.prototype))return!1;var r=G[t];if(n===r)return!0;var e=Do(r);return!!e&&n===e[0]}function re(n){return"number"==typeof n&&n>-1&&n%1==0&&$o>=n}function ee(n){return n===n&&!Wu(n)}function ue(n,t){var r=n[1],e=t[1],u=r|e,i=U>u,o=e==U&&r==R||e==U&&r==$&&n[7].length<=t[8]||e==(U|$)&&r==R;if(!i&&!o)return n;e&j&&(n[2]=t[2],u|=r&j?0:I);var f=t[3];if(f){var a=n[3];n[3]=a?ar(a,f,t[4]):et(f),n[4]=a?g(n[3],D):et(t[4])}return f=t[5],f&&(a=n[5],n[5]=a?cr(a,f,t[6]):et(f),n[6]=a?g(n[5],D):et(t[6])),f=t[7],f&&(n[7]=et(f)),e&U&&(n[8]=null==n[8]?t[8]:Ao(n[8],t[8])),null==n[9]&&(n[9]=t[9]),n[0]=t[0],n[1]=u,n}function ie(n,t){return n===b?t:Uf(n,t,ie)}function oe(n,t){n=se(n);for(var r=-1,e=t.length,u={};++r<e;){var i=t[r];i in n&&(u[i]=n[i])}return u}function fe(n,t){var r={};return Ut(n,function(n,e,u){t(n,e,u)&&(r[e]=n)}),r}function ae(n,t){for(var r=n.length,e=Ao(t.length,r),u=et(n);e--;){var i=t[e];n[e]=Hr(i,r)?u[i]:b}return n}function ce(n){for(var t=ni(n),r=t.length,e=r&&n.length,u=!!e&&re(e)&&(Cf(n)||ku(n)),i=-1,o=[];++i<r;){var f=t[i];(u&&Hr(f,e)||no.call(n,f))&&o.push(f)}return o}function le(n){return null==n?[]:Zr(n)?Wu(n)?n:Vi(n):ii(n)}function se(n){return Wu(n)?n:Vi(n)}function pe(n){if(Cf(n))return n;var t=[];return u(n).replace(jn,function(n,r,e,u){t.push(e?u.replace(On,"$1"):r||n)}),t}function he(n){return n instanceof qn?n.clone():new nn(n.__wrapped__,n.__chain__,et(n.__actions__))}function ve(n,t,r){t=(r?Qr(n,t,r):null==t)?1:bo(yo(t)||1,1);for(var e=0,u=n?n.length:0,i=-1,o=zi(_o(u/t));u>e;)o[++i]=Jt(n,e,e+=t);return o}function _e(n){for(var t=-1,r=n?n.length:0,e=-1,u=[];++t<r;){var i=n[t];i&&(u[++e]=i)}return u}function ge(n,t,r){var e=n?n.length:0;return e?((r?Qr(n,t,r):null==t)&&(t=1),Jt(n,0>t?0:t)):[]}function ye(n,t,r){var e=n?n.length:0;return e?((r?Qr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Jt(n,0,0>t?0:t)):[]}function de(n,t,r){return n&&n.length?rr(n,Dr(t,r,3),!0,!0):[]}function me(n,t,r){return n&&n.length?rr(n,Dr(t,r,3),!0):[]}function we(n,t,r,e){var u=n?n.length:0;return u?(r&&"number"!=typeof r&&Qr(n,t,r)&&(r=0,e=u),Rt(n,t,r,e)):[]}function xe(n){return n?n[0]:b}function be(n,t,r){var e=n?n.length:0;return r&&Qr(n,t,r)&&(t=!1),e?Ct(n,t):[]}function Ae(n){var t=n?n.length:0;return t?Ct(n,!0):[]}function je(n,t,e){var u=n?n.length:0;if(!u)return-1;if("number"==typeof e)e=0>e?bo(u+e,0):e;else if(e){var i=ur(n,t);return u>i&&(t===t?t===n[i]:n[i]!==n[i])?i:-1}return r(n,t,e||0)}function ke(n){return ye(n,1)}function Ie(n){var t=n?n.length:0;return t?n[t-1]:b}function Re(n,t,r){var e=n?n.length:0;if(!e)return-1;var u=e;if("number"==typeof r)u=(0>r?bo(e+r,0):Ao(r||0,e-1))+1;else if(r){u=ur(n,t,!0)-1;var i=n[u];return(t===t?t===i:i!==i)?u:-1}if(t!==t)return h(n,u,!0);for(;u--;)if(n[u]===t)return u;return-1}function Oe(){var n=arguments,t=n[0];if(!t||!t.length)return t;for(var r=0,e=Mr(),u=n.length;++r<u;)for(var i=0,o=n[r];(i=e(t,o,i))>-1;)po.call(t,i,1);return t}function Ee(n,t,r){var e=[];if(!n||!n.length)return e;var u=-1,i=[],o=n.length;for(t=Dr(t,r,3);++u<o;){var f=n[u];t(f,u,n)&&(e.push(f),i.push(u))}return Vt(n,i),e}function Ce(n){return ge(n,1)}function Ue(n,t,r){var e=n?n.length:0;return e?(r&&"number"!=typeof r&&Qr(n,t,r)&&(t=0,r=e),Jt(n,t,r)):[]}function $e(n,t,r){var e=n?n.length:0;return e?((r?Qr(n,t,r):null==t)&&(t=1),Jt(n,0,0>t?0:t)):[]}function Se(n,t,r){var e=n?n.length:0;return e?((r?Qr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Jt(n,0>t?0:t)):[]}function We(n,t,r){return n&&n.length?rr(n,Dr(t,r,3),!1,!0):[]}function Fe(n,t,r){return n&&n.length?rr(n,Dr(t,r,3)):[]}function Ne(n,t,e,u){var i=n?n.length:0;if(!i)return[];null!=t&&"boolean"!=typeof t&&(u=e,e=Qr(n,t,u)?b:t,t=!1);var o=Dr();return(null!=e||o!==xt)&&(e=o(e,u,3)),t&&Mr()==r?y(n,e):nr(n,e)}function Te(n){if(!n||!n.length)return[];var t=-1,r=0;n=at(n,function(n){return Zr(n)?(r=bo(n.length,r),!0):void 0});for(var e=zi(r);++t<r;)e[t]=ct(n,Pt(t));return e}function Le(n,t,r){var e=n?n.length:0;if(!e)return[];var u=Te(n);return null==t?u:(t=or(t,r,4),ct(u,function(n){return st(n,t,b,!0)}))}function Be(){for(var n=-1,t=arguments.length;++n<t;){var r=arguments[n];if(Zr(r))var e=e?lt(jt(e,r),jt(r,e)):r}return e?nr(e):[]}function ze(n,t){var r=-1,e=n?n.length:0,u={};for(!e||t||Cf(n[0])||(t=[]);++r<e;){var i=n[r];t?u[i]=t[r]:i&&(u[i[0]]=i[1])}return u}function De(n){var t=G(n);return t.__chain__=!0,t}function qe(n,t,r){return t.call(r,n),n}function Me(n,t,r){return t.call(r,n)}function Pe(){return De(this)}function Ke(){return new nn(this.value(),this.__chain__)}function Ve(n){for(var t,r=this;r instanceof H;){var e=he(r);t?u.__wrapped__=e:t=e;var u=e;r=r.__wrapped__}return u.__wrapped__=n,t}function Ye(){var n=this.__wrapped__,t=function(n){return r&&r.__dir__<0?n:n.reverse()};if(n instanceof qn){var r=n;return this.__actions__.length&&(r=new qn(this)),r=r.reverse(),r.__actions__.push({func:Me,args:[t],thisArg:b}),new nn(r,this.__chain__)}return this.thru(t)}function Ge(){return this.value()+""}function Je(){return er(this.__wrapped__,this.__actions__)}function Xe(n,t,r){var e=Cf(n)?ot:kt;return r&&Qr(n,t,r)&&(t=b),("function"!=typeof t||r!==b)&&(t=Dr(t,r,3)),e(n,t)}function Ze(n,t,r){var e=Cf(n)?at:Ot;return t=Dr(t,r,3),e(n,t)}function He(n,t){return uf(n,zt(t))}function Qe(n,t,r,e){var u=n?qo(n):0;return re(u)||(n=ii(n),u=n.length),r="number"!=typeof r||e&&Qr(t,r,e)?0:0>r?bo(u+r,0):r||0,"string"==typeof n||!Cf(n)&&qu(n)?u>=r&&n.indexOf(t,r)>-1:!!u&&Mr(n,t,r)>-1}function nu(n,t,r){var e=Cf(n)?ct:Bt;return t=Dr(t,r,3),e(n,t)}function tu(n,t){return nu(n,Si(t))}function ru(n,t,r){var e=Cf(n)?at:Ot;return t=Dr(t,r,3),e(n,function(n,r,e){return!t(n,r,e)})}function eu(n,t,r){if(r?Qr(n,t,r):null==t){n=le(n);var e=n.length;return e>0?n[Yt(0,e-1)]:b}var u=-1,i=Yu(n),e=i.length,o=e-1;for(t=Ao(0>t?0:+t||0,e);++u<t;){var f=Yt(u,o),a=i[f];i[f]=i[u],i[u]=a}return i.length=t,i}function uu(n){return eu(n,Oo)}function iu(n){var t=n?qo(n):0;return re(t)?t:Df(n).length}function ou(n,t,r){var e=Cf(n)?ht:Xt;return r&&Qr(n,t,r)&&(t=b),("function"!=typeof t||r!==b)&&(t=Dr(t,r,3)),e(n,t)}function fu(n,t,r){if(null==n)return[];r&&Qr(n,t,r)&&(t=b);var e=-1;t=Dr(t,r,3);var u=Bt(n,function(n,r,u){return{criteria:t(n,r,u),index:++e,value:n}});return Zt(u,f)}function au(n,t,r,e){return null==n?[]:(e&&Qr(t,r,e)&&(r=b),Cf(t)||(t=null==t?[]:[t]),Cf(r)||(r=null==r?[]:[r]),Ht(n,t,r))}function cu(n,t){return Ze(n,zt(t))}function lu(n,t){if("function"!=typeof t){if("function"!=typeof n)throw new Ji(z);var r=n;n=t,t=r}return n=wo(n=+n)?n:0,function(){return--n<1?t.apply(this,arguments):void 0}}function su(n,t,r){return r&&Qr(n,t,r)&&(t=b),t=n&&null==t?n.length:bo(+t||0,0),Tr(n,U,b,b,b,b,t)}function pu(n,t){var r;if("function"!=typeof t){if("function"!=typeof n)throw new Ji(z);var e=n;n=t,t=e}return function(){return--n>0&&(r=t.apply(this,arguments)),1>=n&&(t=b),r}}function hu(n,t,r){function e(){h&&oo(h),c&&oo(c),_=0,c=h=v=b}function u(t,r){r&&oo(r),c=h=v=b,t&&(_=gf(),l=n.apply(p,a),h||c||(a=p=b))}function i(){var n=t-(gf()-s);0>=n||n>t?u(v,c):h=so(i,n)}function o(){u(y,h)}function f(){if(a=arguments,s=gf(),p=this,v=y&&(h||!d),g===!1)var r=d&&!h;else{c||d||(_=s);var e=g-(s-_),u=0>=e||e>g;u?(c&&(c=oo(c)),_=s,l=n.apply(p,a)):c||(c=so(o,e))}return u&&h?h=oo(h):h||t===g||(h=so(i,t)),r&&(u=!0,l=n.apply(p,a)),!u||h||c||(a=p=b),l}var a,c,l,s,p,h,v,_=0,g=!1,y=!0;if("function"!=typeof n)throw new Ji(z);if(t=0>t?0:+t||0,r===!0){var d=!0;y=!1}else Wu(r)&&(d=!!r.leading,g="maxWait"in r&&bo(+r.maxWait||0,t),y="trailing"in r?!!r.trailing:y);return f.cancel=e,f}function vu(n,t){if("function"!=typeof n||t&&"function"!=typeof t)throw new Ji(z);var r=function(){var e=arguments,u=t?t.apply(this,e):e[0],i=r.cache;if(i.has(u))return i.get(u);var o=n.apply(this,e);return r.cache=i.set(u,o),o};return r.cache=new vu.Cache,r}function _u(n){if("function"!=typeof n)throw new Ji(z);return function(){return!n.apply(this,arguments)}}function gu(n){return pu(2,n)}function yu(n,t){if("function"!=typeof n)throw new Ji(z);return t=bo(t===b?n.length-1:+t||0,0),function(){for(var r=arguments,e=-1,u=bo(r.length-t,0),i=zi(u);++e<u;)i[e]=r[t+e];switch(t){case 0:return n.call(this,i);case 1:return n.call(this,r[0],i);case 2:return n.call(this,r[0],r[1],i)}var o=zi(t+1);for(e=-1;++e<t;)o[e]=r[e];return o[t]=i,n.apply(this,o)}}function du(n){if("function"!=typeof n)throw new Ji(z);return function(t){return n.apply(this,t)}}function mu(n,t,r){var e=!0,u=!0;if("function"!=typeof n)throw new Ji(z);return r===!1?e=!1:Wu(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),hu(n,t,{leading:e,maxWait:+t,trailing:u})}function wu(n,t){return t=null==t?Ri:t,Tr(t,E,b,[n],[])}function xu(n,t,r,e){return t&&"boolean"!=typeof t&&Qr(n,t,r)?t=!1:"function"==typeof t&&(e=r,r=t,t=!1),"function"==typeof r?bt(n,t,or(r,e,1)):bt(n,t)}function bu(n,t,r){return"function"==typeof t?bt(n,!0,or(t,r,1)):bt(n,!0)}function Au(n,t){return n>t}function ju(n,t){return n>=t}function ku(n){return v(n)&&Zr(n)&&no.call(n,"callee")&&!co.call(n,"callee")}function Iu(n){return n===!0||n===!1||v(n)&&ro.call(n)==P}function Ru(n){return v(n)&&ro.call(n)==K}function Ou(n){return!!n&&1===n.nodeType&&v(n)&&!zu(n)}function Eu(n){return null==n?!0:Zr(n)&&(Cf(n)||qu(n)||ku(n)||v(n)&&Su(n.splice))?!n.length:!Df(n).length}function Cu(n,t,r,e){r="function"==typeof r?or(r,e,3):b;var u=r?r(n,t):b;return u===b?Nt(n,t,r):!!u}function Uu(n){return v(n)&&"string"==typeof n.message&&ro.call(n)==V}function $u(n){return"number"==typeof n&&wo(n)}function Su(n){return Wu(n)&&ro.call(n)==Y}function Wu(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function Fu(n,t,r,e){return r="function"==typeof r?or(r,e,3):b,Lt(n,Pr(t),r)}function Nu(n){return Bu(n)&&n!=+n}function Tu(n){return null==n?!1:Su(n)?uo.test(Qi.call(n)):v(n)&&$n.test(n)}function Lu(n){return null===n}function Bu(n){return"number"==typeof n||v(n)&&ro.call(n)==J}function zu(n){var t;if(!v(n)||ro.call(n)!=X||ku(n)||!no.call(n,"constructor")&&(t=n.constructor,"function"==typeof t&&!(t instanceof t)))return!1;var r;return Ut(n,function(n,t){r=t}),r===b||no.call(n,r)}function Du(n){return Wu(n)&&ro.call(n)==Z}function qu(n){return"string"==typeof n||v(n)&&ro.call(n)==Q}function Mu(n){return v(n)&&re(n.length)&&!!zn[ro.call(n)]}function Pu(n){return n===b}function Ku(n,t){return t>n}function Vu(n,t){return t>=n}function Yu(n){var t=n?qo(n):0;return re(t)?t?et(n):[]:ii(n)}function Gu(n){return wt(n,ni(n))}function Ju(n,t,r){var e=Fo(n);return r&&Qr(n,t,r)&&(t=b),t?dt(e,t):e}function Xu(n){return Wt(n,ni(n))}function Zu(n,t,r){var e=null==n?b:Ft(n,pe(t),t+"");return e===b?r:e}function Hu(n,t){if(null==n)return!1;var r=no.call(n,t);if(!r&&!ne(t)){if(t=pe(t),n=1==t.length?n:Ft(n,Jt(t,0,-1)),null==n)return!1;t=Ie(t),r=no.call(n,t)}return r||re(n.length)&&Hr(t,n.length)&&(Cf(n)||ku(n))}function Qu(n,t,r){r&&Qr(n,t,r)&&(t=b);for(var e=-1,u=Df(n),i=u.length,o={};++e<i;){var f=u[e],a=n[f];t?no.call(o,a)?o[a].push(f):o[a]=[f]:o[a]=f}return o}function ni(n){if(null==n)return[];Wu(n)||(n=Vi(n));var t=n.length;t=t&&re(t)&&(Cf(n)||ku(n))&&t||0;for(var r=n.constructor,e=-1,u="function"==typeof r&&r.prototype===n,i=zi(t),o=t>0;++e<t;)i[e]=e+"";for(var f in n)o&&Hr(f,t)||"constructor"==f&&(u||!no.call(n,f))||i.push(f);return i}function ti(n){n=se(n);for(var t=-1,r=Df(n),e=r.length,u=zi(e);++t<e;){var i=r[t];u[t]=[i,n[i]]}return u}function ri(n,t,r){var e=null==n?b:n[t];return e===b&&(null==n||ne(t,n)||(t=pe(t),n=1==t.length?n:Ft(n,Jt(t,0,-1)),e=null==n?b:n[Ie(t)]),e=e===b?r:e),Su(e)?e.call(n):e}function ei(n,t,r){if(null==n)return n;var e=t+"";t=null!=n[e]||ne(t,n)?[e]:pe(t);for(var u=-1,i=t.length,o=i-1,f=n;null!=f&&++u<i;){var a=t[u];Wu(f)&&(u==o?f[a]=r:null==f[a]&&(f[a]=Hr(t[u+1])?[]:{})),f=f[a]}return n}function ui(n,t,r,e){var u=Cf(n)||Mu(n);if(t=Dr(t,e,4),null==r)if(u||Wu(n)){var i=n.constructor;r=u?Cf(n)?new i:[]:Fo(Su(i)?i.prototype:b)}else r={};return(u?ut:$t)(n,function(n,e,u){return t(r,n,e,u)}),r}function ii(n){return tr(n,Df(n))}function oi(n){return tr(n,ni(n))}function fi(n,t,r){return t=+t||0,r===b?(r=t,t=0):r=+r||0,n>=Ao(t,r)&&n<bo(t,r)}function ai(n,t,r){r&&Qr(n,t,r)&&(t=r=b);var e=null==n,u=null==t;if(null==r&&(u&&"boolean"==typeof n?(r=n,n=1):"boolean"==typeof t&&(r=t,u=!0)),e&&u&&(t=1,u=!1),n=+n||0,u?(t=n,n=0):t=+t||0,r||n%1||t%1){var i=Io();return Ao(n+i*(t-n+fo("1e-"+((i+"").length-1))),t)}return Yt(n,t)}function ci(n){return n=u(n),n&&n.charAt(0).toUpperCase()+n.slice(1)}function li(n){
return n=u(n),n&&n.replace(Wn,c).replace(Rn,"")}function si(n,t,r){n=u(n),t+="";var e=n.length;return r=r===b?e:Ao(0>r?0:+r||0,e),r-=t.length,r>=0&&n.indexOf(t,r)==r}function pi(n){return n=u(n),n&&dn.test(n)?n.replace(gn,l):n}function hi(n){return n=u(n),n&&In.test(n)?n.replace(kn,s):n||"(?:)"}function vi(n,t,r){n=u(n),t=+t;var e=n.length;if(e>=t||!wo(t))return n;var i=(t-e)/2,o=yo(i),f=_o(i);return r=Sr("",f,r),r.slice(0,o)+n+r}function _i(n,t,r){return(r?Qr(n,t,r):null==t)?t=0:t&&(t=+t),n=mi(n),ko(n,t||(Un.test(n)?16:10))}function gi(n,t){var r="";if(n=u(n),t=+t,1>t||!n||!wo(t))return r;do t%2&&(r+=n),t=yo(t/2),n+=n;while(t);return r}function yi(n,t,r){return n=u(n),r=null==r?0:Ao(0>r?0:+r||0,n.length),n.lastIndexOf(t,r)==r}function di(n,t,r){var e=G.templateSettings;r&&Qr(n,t,r)&&(t=r=b),n=u(n),t=yt(dt({},r||t),e,gt);var i,o,f=yt(dt({},t.imports),e.imports,gt),a=Df(f),c=tr(f,a),l=0,s=t.interpolate||Fn,h="__p += '",v=Yi((t.escape||Fn).source+"|"+s.source+"|"+(s===xn?En:Fn).source+"|"+(t.evaluate||Fn).source+"|$","g"),_="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Bn+"]")+"\n";n.replace(v,function(t,r,e,u,f,a){return e||(e=u),h+=n.slice(l,a).replace(Nn,p),r&&(i=!0,h+="' +\n__e("+r+") +\n'"),f&&(o=!0,h+="';\n"+f+";\n__p += '"),e&&(h+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),l=a+t.length,t}),h+="';\n";var g=t.variable;g||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(pn,""):h).replace(hn,"$1").replace(vn,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var y=Hf(function(){return Mi(a,_+"return "+h).apply(b,c)});if(y.source=h,Uu(y))throw y;return y}function mi(n,t,r){var e=n;return(n=u(n))?(r?Qr(e,t,r):null==t)?n.slice(d(n),m(n)+1):(t+="",n.slice(i(n,t),o(n,t)+1)):n}function wi(n,t,r){var e=n;return n=u(n),n?(r?Qr(e,t,r):null==t)?n.slice(d(n)):n.slice(i(n,t+"")):n}function xi(n,t,r){var e=n;return n=u(n),n?(r?Qr(e,t,r):null==t)?n.slice(0,m(n)+1):n.slice(0,o(n,t+"")+1):n}function bi(n,t,r){r&&Qr(n,t,r)&&(t=b);var e=S,i=W;if(null!=t)if(Wu(t)){var o="separator"in t?t.separator:o;e="length"in t?+t.length||0:e,i="omission"in t?u(t.omission):i}else e=+t||0;if(n=u(n),e>=n.length)return n;var f=e-i.length;if(1>f)return i;var a=n.slice(0,f);if(null==o)return a+i;if(Du(o)){if(n.slice(f).search(o)){var c,l,s=n.slice(0,f);for(o.global||(o=Yi(o.source,(Cn.exec(o)||"")+"g")),o.lastIndex=0;c=o.exec(s);)l=c.index;a=a.slice(0,null==l?f:l)}}else if(n.indexOf(o,f)!=f){var p=a.lastIndexOf(o);p>-1&&(a=a.slice(0,p))}return a+i}function Ai(n){return n=u(n),n&&yn.test(n)?n.replace(_n,w):n}function ji(n,t,r){return r&&Qr(n,t,r)&&(t=b),n=u(n),n.match(t||Tn)||[]}function ki(n,t,r){return r&&Qr(n,t,r)&&(t=b),v(n)?Oi(n):xt(n,t)}function Ii(n){return function(){return n}}function Ri(n){return n}function Oi(n){return zt(bt(n,!0))}function Ei(n,t){return Dt(n,bt(t,!0))}function Ci(n,t,r){if(null==r){var e=Wu(t),u=e?Df(t):b,i=u&&u.length?Wt(t,u):b;(i?i.length:e)||(i=!1,r=t,t=n,n=this)}i||(i=Wt(t,Df(t)));var o=!0,f=-1,a=Su(n),c=i.length;r===!1?o=!1:Wu(r)&&"chain"in r&&(o=r.chain);for(;++f<c;){var l=i[f],s=t[l];n[l]=s,a&&(n.prototype[l]=function(t){return function(){var r=this.__chain__;if(o||r){var e=n(this.__wrapped__),u=e.__actions__=et(this.__actions__);return u.push({func:t,args:arguments,thisArg:n}),e.__chain__=r,e}return t.apply(n,lt([this.value()],arguments))}}(s))}return n}function Ui(){return nt._=eo,this}function $i(){}function Si(n){return ne(n)?Pt(n):Kt(n)}function Wi(n){return function(t){return Ft(n,pe(t),t+"")}}function Fi(n,t,r){r&&Qr(n,t,r)&&(t=r=b),n=+n||0,r=null==r?1:+r||0,null==t?(t=n,n=0):t=+t||0;for(var e=-1,u=bo(_o((t-n)/(r||1)),0),i=zi(u);++e<u;)i[e]=n,n+=r;return i}function Ni(n,t,r){if(n=yo(n),1>n||!wo(n))return[];var e=-1,u=zi(Ao(n,Eo));for(t=or(t,r,1);++e<n;)Eo>e?u[e]=t(e):t(e);return u}function Ti(n){var t=++to;return u(n)+t}function Li(n,t){return(+n||0)+(+t||0)}function Bi(n,t,r){return r&&Qr(n,t,r)&&(t=b),t=Dr(t,r,3),1==t.length?vt(Cf(n)?n:le(n),t):Qt(n,t)}_=_?tt.defaults(nt.Object(),_,tt.pick(nt,Ln)):nt;var zi=_.Array,Di=_.Date,qi=_.Error,Mi=_.Function,Pi=_.Math,Ki=_.Number,Vi=_.Object,Yi=_.RegExp,Gi=_.String,Ji=_.TypeError,Xi=zi.prototype,Zi=Vi.prototype,Hi=Gi.prototype,Qi=Mi.prototype.toString,no=Zi.hasOwnProperty,to=0,ro=Zi.toString,eo=nt._,uo=Yi("^"+Qi.call(no).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),io=_.ArrayBuffer,oo=_.clearTimeout,fo=_.parseFloat,ao=Pi.pow,co=Zi.propertyIsEnumerable,lo=Kr(_,"Set"),so=_.setTimeout,po=Xi.splice,ho=_.Uint8Array,vo=Kr(_,"WeakMap"),_o=Pi.ceil,go=Kr(Vi,"create"),yo=Pi.floor,mo=Kr(zi,"isArray"),wo=_.isFinite,xo=Kr(Vi,"keys"),bo=Pi.max,Ao=Pi.min,jo=Kr(Di,"now"),ko=_.parseInt,Io=Pi.random,Ro=Ki.NEGATIVE_INFINITY,Oo=Ki.POSITIVE_INFINITY,Eo=4294967295,Co=Eo-1,Uo=Eo>>>1,$o=9007199254740991,So=vo&&new vo,Wo={};G.support={};G.templateSettings={escape:mn,evaluate:wn,interpolate:xn,variable:"",imports:{_:G}};var Fo=function(){function n(){}return function(t){if(Wu(t)){n.prototype=t;var r=new n;n.prototype=b}return r||{}}}(),No=pr($t),To=pr(St,!0),Lo=hr(),Bo=hr(!0),zo=So?function(n,t){return So.set(n,t),n}:Ri,Do=So?function(n){return So.get(n)}:$i,qo=Pt("length"),Mo=function(){var n=0,t=0;return function(r,e){var u=gf(),i=N-(u-t);if(t=u,i>0){if(++n>=F)return r}else n=0;return zo(r,e)}}(),Po=yu(function(n,t){return v(n)&&Zr(n)?jt(n,Ct(t,!1,!0)):[]}),Ko=br(),Vo=br(!0),Yo=yu(function(n){for(var t=n.length,e=t,u=zi(s),i=Mr(),o=i==r,f=[];e--;){var a=n[e]=Zr(a=n[e])?a:[];u[e]=o&&a.length>=120?_r(e&&a):null}var c=n[0],l=-1,s=c?c.length:0,p=u[0];n:for(;++l<s;)if(a=c[l],(p?Hn(p,a):i(f,a,0))<0){for(var e=t;--e;){var h=u[e];if((h?Hn(h,a):i(n[e],a,0))<0)continue n}p&&p.push(a),f.push(a)}return f}),Go=yu(function(t,r){r=Ct(r);var e=mt(t,r);return Vt(t,r.sort(n)),e}),Jo=Nr(),Xo=Nr(!0),Zo=yu(function(n){return nr(Ct(n,!1,!0))}),Ho=yu(function(n,t){return Zr(n)?jt(n,t):[]}),Qo=yu(Te),nf=yu(function(n){var t=n.length,r=t>2?n[t-2]:b,e=t>1?n[t-1]:b;return t>2&&"function"==typeof r?t-=2:(r=t>1&&"function"==typeof e?(--t,e):b,e=b),n.length=t,Le(n,r,e)}),tf=yu(function(n){return n=Ct(n),this.thru(function(t){return rt(Cf(t)?t:[se(t)],n)})}),rf=yu(function(n,t){return mt(n,Ct(t))}),ef=lr(function(n,t,r){no.call(n,r)?++n[r]:n[r]=1}),uf=xr(No),of=xr(To,!0),ff=kr(ut,No),af=kr(it,To),cf=lr(function(n,t,r){no.call(n,r)?n[r].push(t):n[r]=[t]}),lf=lr(function(n,t,r){n[r]=t}),sf=yu(function(n,t,r){var e=-1,u="function"==typeof t,i=ne(t),o=Zr(n)?zi(n.length):[];return No(n,function(n){var f=u?t:i&&null!=n?n[t]:b;o[++e]=f?f.apply(n,r):Xr(n,t,r)}),o}),pf=lr(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),hf=Ur(st,No),vf=Ur(pt,To),_f=yu(function(n,t){if(null==n)return[];var r=t[2];return r&&Qr(t[0],t[1],r)&&(t.length=1),Ht(n,Ct(t),[])}),gf=jo||function(){return(new Di).getTime()},yf=yu(function(n,t,r){var e=j;if(r.length){var u=g(r,yf.placeholder);e|=E}return Tr(n,e,t,r,u)}),df=yu(function(n,t){t=t.length?Ct(t):Xu(n);for(var r=-1,e=t.length;++r<e;){var u=t[r];n[u]=Tr(n[u],j,n)}return n}),mf=yu(function(n,t,r){var e=j|k;if(r.length){var u=g(r,mf.placeholder);e|=E}return Tr(t,e,n,r,u)}),wf=dr(R),xf=dr(O),bf=yu(function(n,t){return At(n,1,t)}),Af=yu(function(n,t,r){return At(n,t,r)}),jf=jr(),kf=jr(!0),If=yu(function(n,t){if(t=Ct(t),"function"!=typeof n||!ot(t,e))throw new Ji(z);var r=t.length;return yu(function(e){for(var u=Ao(e.length,r);u--;)e[u]=t[u](e[u]);return n.apply(this,e)})}),Rf=Cr(E),Of=Cr(C),Ef=yu(function(n,t){return Tr(n,$,b,b,b,Ct(t))}),Cf=mo||function(n){return v(n)&&re(n.length)&&ro.call(n)==M},Uf=sr(qt),$f=sr(function(n,t,r){return r?yt(n,t,r):dt(n,t)}),Sf=mr($f,_t),Wf=mr(Uf,ie),Ff=Ar($t),Nf=Ar(St),Tf=Ir(Lo),Lf=Ir(Bo),Bf=Rr($t),zf=Rr(St),Df=xo?function(n){var t=null==n?b:n.constructor;return"function"==typeof t&&t.prototype===n||"function"!=typeof n&&Zr(n)?ce(n):Wu(n)?xo(n):[]}:ce,qf=Or(!0),Mf=Or(),Pf=yu(function(n,t){if(null==n)return{};if("function"!=typeof t[0]){var t=ct(Ct(t),Gi);return oe(n,jt(ni(n),t))}var r=or(t[0],t[1],3);return fe(n,function(n,t,e){return!r(n,t,e)})}),Kf=yu(function(n,t){return null==n?{}:"function"==typeof t[0]?fe(n,or(t[0],t[1],3)):oe(n,Ct(t))}),Vf=gr(function(n,t,r){return t=t.toLowerCase(),n+(r?t.charAt(0).toUpperCase()+t.slice(1):t)}),Yf=gr(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),Gf=Er(),Jf=Er(!0),Xf=gr(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),Zf=gr(function(n,t,r){return n+(r?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),Hf=yu(function(n,t){try{return n.apply(b,t)}catch(r){return Uu(r)?r:new qi(r)}}),Qf=yu(function(n,t){return function(r){return Xr(r,n,t)}}),na=yu(function(n,t){return function(r){return Xr(n,r,t)}}),ta=Fr("ceil"),ra=Fr("floor"),ea=wr(Au,Ro),ua=wr(Ku,Oo),ia=Fr("round");return G.prototype=H.prototype,nn.prototype=Fo(H.prototype),nn.prototype.constructor=nn,qn.prototype=Fo(H.prototype),qn.prototype.constructor=qn,Vn.prototype["delete"]=Yn,Vn.prototype.get=Gn,Vn.prototype.has=Jn,Vn.prototype.set=Xn,Zn.prototype.push=Qn,vu.Cache=Vn,G.after=lu,G.ary=su,G.assign=$f,G.at=rf,G.before=pu,G.bind=yf,G.bindAll=df,G.bindKey=mf,G.callback=ki,G.chain=De,G.chunk=ve,G.compact=_e,G.constant=Ii,G.countBy=ef,G.create=Ju,G.curry=wf,G.curryRight=xf,G.debounce=hu,G.defaults=Sf,G.defaultsDeep=Wf,G.defer=bf,G.delay=Af,G.difference=Po,G.drop=ge,G.dropRight=ye,G.dropRightWhile=de,G.dropWhile=me,G.fill=we,G.filter=Ze,G.flatten=be,G.flattenDeep=Ae,G.flow=jf,G.flowRight=kf,G.forEach=ff,G.forEachRight=af,G.forIn=Tf,G.forInRight=Lf,G.forOwn=Bf,G.forOwnRight=zf,G.functions=Xu,G.groupBy=cf,G.indexBy=lf,G.initial=ke,G.intersection=Yo,G.invert=Qu,G.invoke=sf,G.keys=Df,G.keysIn=ni,G.map=nu,G.mapKeys=qf,G.mapValues=Mf,G.matches=Oi,G.matchesProperty=Ei,G.memoize=vu,G.merge=Uf,G.method=Qf,G.methodOf=na,G.mixin=Ci,G.modArgs=If,G.negate=_u,G.omit=Pf,G.once=gu,G.pairs=ti,G.partial=Rf,G.partialRight=Of,G.partition=pf,G.pick=Kf,G.pluck=tu,G.property=Si,G.propertyOf=Wi,G.pull=Oe,G.pullAt=Go,G.range=Fi,G.rearg=Ef,G.reject=ru,G.remove=Ee,G.rest=Ce,G.restParam=yu,G.set=ei,G.shuffle=uu,G.slice=Ue,G.sortBy=fu,G.sortByAll=_f,G.sortByOrder=au,G.spread=du,G.take=$e,G.takeRight=Se,G.takeRightWhile=We,G.takeWhile=Fe,G.tap=qe,G.throttle=mu,G.thru=Me,G.times=Ni,G.toArray=Yu,G.toPlainObject=Gu,G.transform=ui,G.union=Zo,G.uniq=Ne,G.unzip=Te,G.unzipWith=Le,G.values=ii,G.valuesIn=oi,G.where=cu,G.without=Ho,G.wrap=wu,G.xor=Be,G.zip=Qo,G.zipObject=ze,G.zipWith=nf,G.backflow=kf,G.collect=nu,G.compose=kf,G.each=ff,G.eachRight=af,G.extend=$f,G.iteratee=ki,G.methods=Xu,G.object=ze,G.select=Ze,G.tail=Ce,G.unique=Ne,Ci(G,G),G.add=Li,G.attempt=Hf,G.camelCase=Vf,G.capitalize=ci,G.ceil=ta,G.clone=xu,G.cloneDeep=bu,G.deburr=li,G.endsWith=si,G.escape=pi,G.escapeRegExp=hi,G.every=Xe,G.find=uf,G.findIndex=Ko,G.findKey=Ff,G.findLast=of,G.findLastIndex=Vo,G.findLastKey=Nf,G.findWhere=He,G.first=xe,G.floor=ra,G.get=Zu,G.gt=Au,G.gte=ju,G.has=Hu,G.identity=Ri,G.includes=Qe,G.indexOf=je,G.inRange=fi,G.isArguments=ku,G.isArray=Cf,G.isBoolean=Iu,G.isDate=Ru,G.isElement=Ou,G.isEmpty=Eu,G.isEqual=Cu,G.isError=Uu,G.isFinite=$u,G.isFunction=Su,G.isMatch=Fu,G.isNaN=Nu,G.isNative=Tu,G.isNull=Lu,G.isNumber=Bu,G.isObject=Wu,G.isPlainObject=zu,G.isRegExp=Du,G.isString=qu,G.isTypedArray=Mu,G.isUndefined=Pu,G.kebabCase=Yf,G.last=Ie,G.lastIndexOf=Re,G.lt=Ku,G.lte=Vu,G.max=ea,G.min=ua,G.noConflict=Ui,G.noop=$i,G.now=gf,G.pad=vi,G.padLeft=Gf,G.padRight=Jf,G.parseInt=_i,G.random=ai,G.reduce=hf,G.reduceRight=vf,G.repeat=gi,G.result=ri,G.round=ia,G.runInContext=x,G.size=iu,G.snakeCase=Xf,G.some=ou,G.sortedIndex=Jo,G.sortedLastIndex=Xo,G.startCase=Zf,G.startsWith=yi,G.sum=Bi,G.template=di,G.trim=mi,G.trimLeft=wi,G.trimRight=xi,G.trunc=bi,G.unescape=Ai,G.uniqueId=Ti,G.words=ji,G.all=Xe,G.any=ou,G.contains=Qe,G.eq=Cu,G.detect=uf,G.foldl=hf,G.foldr=vf,G.head=xe,G.include=Qe,G.inject=hf,Ci(G,function(){var n={};return $t(G,function(t,r){G.prototype[r]||(n[r]=t)}),n}(),!1),G.sample=eu,G.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(t){return eu(t,n)}):eu(this.value())},G.VERSION=A,ut(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){G[n].placeholder=G}),ut(["drop","take"],function(n,t){qn.prototype[n]=function(r){var e=this.__filtered__;if(e&&!t)return new qn(this);r=null==r?1:bo(yo(r)||0,0);var u=this.clone();return e?u.__takeCount__=Ao(u.__takeCount__,r):u.__views__.push({size:r,type:n+(u.__dir__<0?"Right":"")}),u},qn.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),ut(["filter","map","takeWhile"],function(n,t){var r=t+1,e=r!=B;qn.prototype[n]=function(n,t){var u=this.clone();return u.__iteratees__.push({iteratee:Dr(n,t,1),type:r}),u.__filtered__=u.__filtered__||e,u}}),ut(["first","last"],function(n,t){var r="take"+(t?"Right":"");qn.prototype[n]=function(){return this[r](1).value()[0]}}),ut(["initial","rest"],function(n,t){var r="drop"+(t?"":"Right");qn.prototype[n]=function(){return this.__filtered__?new qn(this):this[r](1)}}),ut(["pluck","where"],function(n,t){var r=t?"filter":"map",e=t?zt:Si;qn.prototype[n]=function(n){return this[r](e(n))}}),qn.prototype.compact=function(){return this.filter(Ri)},qn.prototype.reject=function(n,t){return n=Dr(n,t,1),this.filter(function(t){return!n(t)})},qn.prototype.slice=function(n,t){n=null==n?0:+n||0;var r=this;return r.__filtered__&&(n>0||0>t)?new qn(r):(0>n?r=r.takeRight(-n):n&&(r=r.drop(n)),t!==b&&(t=+t||0,r=0>t?r.dropRight(-t):r.take(t-n)),r)},qn.prototype.takeRightWhile=function(n,t){return this.reverse().takeWhile(n,t).reverse()},qn.prototype.toArray=function(){return this.take(Oo)},$t(qn.prototype,function(n,t){var r=/^(?:filter|map|reject)|While$/.test(t),e=/^(?:first|last)$/.test(t),u=G[e?"take"+("last"==t?"Right":""):t];u&&(G.prototype[t]=function(){var t=e?[1]:arguments,i=this.__chain__,o=this.__wrapped__,f=!!this.__actions__.length,a=o instanceof qn,c=t[0],l=a||Cf(o);l&&r&&"function"==typeof c&&1!=c.length&&(a=l=!1);var s=function(n){return e&&i?u(n,1)[0]:u.apply(b,lt([n],t))},p={func:Me,args:[s],thisArg:b},h=a&&!f;if(e&&!i)return h?(o=o.clone(),o.__actions__.push(p),n.call(o)):u.call(b,this.value())[0];if(!e&&l){o=h?o:new qn(this);var v=n.apply(o,t);return v.__actions__.push(p),new nn(v,i)}return this.thru(s)})}),ut(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(n){var t=(/^(?:replace|split)$/.test(n)?Hi:Xi)[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:join|pop|replace|shift)$/.test(n);G.prototype[n]=function(){var n=arguments;return e&&!this.__chain__?t.apply(this.value(),n):this[r](function(r){return t.apply(r,n)})}}),$t(qn.prototype,function(n,t){var r=G[t];if(r){var e=r.name,u=Wo[e]||(Wo[e]=[]);u.push({name:t,func:r})}}),Wo[$r(b,k).name]=[{name:"wrapper",func:b}],qn.prototype.clone=Mn,qn.prototype.reverse=Pn,qn.prototype.value=Kn,G.prototype.chain=Pe,G.prototype.commit=Ke,G.prototype.concat=tf,G.prototype.plant=Ve,G.prototype.reverse=Ye,G.prototype.toString=Ge,G.prototype.run=G.prototype.toJSON=G.prototype.valueOf=G.prototype.value=Je,G.prototype.collect=G.prototype.map,G.prototype.head=G.prototype.first,G.prototype.select=G.prototype.filter,G.prototype.tail=G.prototype.rest,G}var b,A="3.10.1",j=1,k=2,I=4,R=8,O=16,E=32,C=64,U=128,$=256,S=30,W="...",F=150,N=16,T=200,L=1,B=2,z="Expected a function",D="__lodash_placeholder__",q="[object Arguments]",M="[object Array]",P="[object Boolean]",K="[object Date]",V="[object Error]",Y="[object Function]",G="[object Map]",J="[object Number]",X="[object Object]",Z="[object RegExp]",H="[object Set]",Q="[object String]",nn="[object WeakMap]",tn="[object ArrayBuffer]",rn="[object Float32Array]",en="[object Float64Array]",un="[object Int8Array]",on="[object Int16Array]",fn="[object Int32Array]",an="[object Uint8Array]",cn="[object Uint8ClampedArray]",ln="[object Uint16Array]",sn="[object Uint32Array]",pn=/\b__p \+= '';/g,hn=/\b(__p \+=) '' \+/g,vn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_n=/&(?:amp|lt|gt|quot|#39|#96);/g,gn=/[&<>"'`]/g,yn=RegExp(_n.source),dn=RegExp(gn.source),mn=/<%-([\s\S]+?)%>/g,wn=/<%([\s\S]+?)%>/g,xn=/<%=([\s\S]+?)%>/g,bn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,An=/^\w*$/,jn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,kn=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,In=RegExp(kn.source),Rn=/[\u0300-\u036f\ufe20-\ufe23]/g,On=/\\(\\)?/g,En=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Cn=/\w*$/,Un=/^0[xX]/,$n=/^\[object .+?Constructor\]$/,Sn=/^\d+$/,Wn=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Fn=/($^)/,Nn=/['\n\r\u2028\u2029\\]/g,Tn=function(){var n="[A-Z\\xc0-\\xd6\\xd8-\\xde]",t="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(n+"+(?="+n+t+")|"+n+"?"+t+"|"+n+"+|[0-9]+","g")}(),Ln=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],Bn=-1,zn={};zn[rn]=zn[en]=zn[un]=zn[on]=zn[fn]=zn[an]=zn[cn]=zn[ln]=zn[sn]=!0,zn[q]=zn[M]=zn[tn]=zn[P]=zn[K]=zn[V]=zn[Y]=zn[G]=zn[J]=zn[X]=zn[Z]=zn[H]=zn[Q]=zn[nn]=!1;var Dn={};Dn[q]=Dn[M]=Dn[tn]=Dn[P]=Dn[K]=Dn[rn]=Dn[en]=Dn[un]=Dn[on]=Dn[fn]=Dn[J]=Dn[X]=Dn[Z]=Dn[Q]=Dn[an]=Dn[cn]=Dn[ln]=Dn[sn]=!0,Dn[V]=Dn[Y]=Dn[G]=Dn[H]=Dn[nn]=!1;var qn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Mn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Pn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Kn={"function":!0,object:!0},Vn={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Yn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Gn=Kn[typeof exports]&&exports&&!exports.nodeType&&exports,Jn=Kn[typeof module]&&module&&!module.nodeType&&module,Xn=Gn&&Jn&&"object"==typeof global&&global&&global.Object&&global,Zn=Kn[typeof self]&&self&&self.Object&&self,Hn=Kn[typeof window]&&window&&window.Object&&window,Qn=Jn&&Jn.exports===Gn&&Gn,nt=Xn||Hn!==(this&&this.window)&&Hn||Zn||this,tt=x();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(nt._=tt,define(function(){return tt})):Gn&&Jn?Qn?(Jn.exports=tt)._=tt:Gn._=tt:nt._=tt}).call(this);
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],22:[function(require,module,exports){
var Stats=function(){var e=Date.now(),t=e,n=0,i=1/0,a=0,d=0,l=1/0,o=0,s=0,r=0,p=document.createElement("div");p.id="stats",p.addEventListener("mousedown",function(e){e.preventDefault(),y(++r%2)},!1),p.style.cssText="width:80px;opacity:0.9;cursor:pointer";var c=document.createElement("div");c.id="fps",c.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",p.appendChild(c);var h=document.createElement("div");h.id="fpsText",h.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",h.innerHTML="FPS",c.appendChild(h);var f=document.createElement("div");for(f.id="fpsGraph",f.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",c.appendChild(f);74>f.children.length;){var x=document.createElement("span");x.style.cssText="width:1px;height:30px;float:left;background-color:#113",f.appendChild(x)}var m=document.createElement("div");m.id="ms",m.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",p.appendChild(m);var u=document.createElement("div");u.id="msText",u.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",u.innerHTML="MS",m.appendChild(u);var v=document.createElement("div");for(v.id="msGraph",v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",m.appendChild(v);74>v.children.length;)x=document.createElement("span"),x.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(x);var y=function(e){switch(r=e){case 0:c.style.display="block",m.style.display="none";break;case 1:c.style.display="none",m.style.display="block"}};return{REVISION:12,domElement:p,setMode:y,begin:function(){e=Date.now()},end:function(){var r=Date.now();n=r-e,i=Math.min(i,n),a=Math.max(a,n),u.textContent=n+" MS ("+i+"-"+a+")";var p=Math.min(30,30-30*(n/200));return v.appendChild(v.firstChild).style.height=p+"px",s++,r>t+1e3&&(d=Math.round(1e3*s/(r-t)),l=Math.min(l,d),o=Math.max(o,d),h.textContent=d+" FPS ("+l+"-"+o+")",p=Math.min(30,30-30*(d/100)),f.appendChild(f.firstChild).style.height=p+"px",t=r,s=0),r},update:function(){e=this.end()}}};"object"==typeof module&&(module.exports=Stats);
},{}],23:[function(require,module,exports){
!function(i,e){"use strict";var s="0.7.9",o="",r="?",n="function",a="undefined",t="object",w="string",l="major",d="model",p="name",c="type",u="vendor",m="version",f="architecture",g="console",b="mobile",h="tablet",v="smarttv",x="wearable",k="embedded",y={extend:function(i,e){for(var s in e)-1!=="browser cpu device engine os".indexOf(s)&&e[s].length%2===0&&(i[s]=e[s].concat(i[s]));return i},has:function(i,e){return"string"==typeof i?-1!==e.toLowerCase().indexOf(i.toLowerCase()):!1},lowerize:function(i){return i.toLowerCase()},major:function(i){return typeof i===w?i.split(".")[0]:e}},A={rgx:function(){for(var i,s,o,r,w,l,d,p=0,c=arguments;p<c.length&&!l;){var u=c[p],m=c[p+1];if(typeof i===a){i={};for(r in m)w=m[r],typeof w===t?i[w[0]]=e:i[w]=e}for(s=o=0;s<u.length&&!l;)if(l=u[s++].exec(this.getUA()))for(r=0;r<m.length;r++)d=l[++o],w=m[r],typeof w===t&&w.length>0?2==w.length?typeof w[1]==n?i[w[0]]=w[1].call(this,d):i[w[0]]=w[1]:3==w.length?typeof w[1]!==n||w[1].exec&&w[1].test?i[w[0]]=d?d.replace(w[1],w[2]):e:i[w[0]]=d?w[1].call(this,d,w[2]):e:4==w.length&&(i[w[0]]=d?w[3].call(this,d.replace(w[1],w[2])):e):i[w]=d?d:e;p+=2}return i},str:function(i,s){for(var o in s)if(typeof s[o]===t&&s[o].length>0){for(var n=0;n<s[o].length;n++)if(y.has(s[o][n],i))return o===r?e:o}else if(y.has(s[o],i))return o===r?e:o;return i}},E={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},S={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[p,m],[/\s(opr)\/([\w\.]+)/i],[[p,"Opera"],m],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium)\/([\w\.-]+)/i],[p,m],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[p,"IE"],m],[/(edge)\/((\d+)?[\w\.]+)/i],[p,m],[/(yabrowser)\/([\w\.]+)/i],[[p,"Yandex"],m],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[p,m],[/(dolfin)\/([\w\.]+)/i],[[p,"Dolphin"],m],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[p,"Chrome"],m],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[m,[p,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[m,[p,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[m,[p,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[m,p],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[p,[m,A.str,E.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape)\/([\w\.-]+)/i],[[p,"Netscape"],m],[/fxios\/([\w\.-]+)/i],[m,[p,"Firefox"]],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[p,m]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,y.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[f,/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[f,y.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[d,u,[c,h]],[/applecoremedia\/[\w\.]+ \((ipad)/],[d,[u,"Apple"],[c,h]],[/(apple\s{0,1}tv)/i],[[d,"Apple TV"],[u,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[u,d,[c,h]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[d,[u,"Amazon"],[c,h]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[d,A.str,E.device.amazon.model],[u,"Amazon"],[c,b]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[d,u,[c,b]],[/\((ip[honed|\s\w*]+);/i],[d,[u,"Apple"],[c,b]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|huawei|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[u,d,[c,b]],[/\(bb10;\s(\w+)/i],[d,[u,"BlackBerry"],[c,b]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7)/i],[d,[u,"Asus"],[c,h]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[u,"Sony"],[d,"Xperia Tablet"],[c,h]],[/(?:sony)?(?:(?:(?:c|d)\d{4})|(?:so[-l].+))\sbuild\//i],[[u,"Sony"],[d,"Xperia Phone"],[c,b]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[u,d,[c,g]],[/android.+;\s(shield)\sbuild/i],[d,[u,"Nvidia"],[c,g]],[/(playstation\s[3portablevi]+)/i],[d,[u,"Sony"],[c,g]],[/(sprint\s(\w+))/i],[[u,A.str,E.device.sprint.vendor],[d,A.str,E.device.sprint.model],[c,b]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[u,d,[c,h]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|huawei|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[u,[d,/_/g," "],[c,b]],[/(nexus\s9)/i],[d,[u,"HTC"],[c,h]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[d,[u,"Microsoft"],[c,g]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[u,"Microsoft"],[c,b]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i],[d,[u,"Motorola"],[c,b]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[d,[u,"Motorola"],[c,h]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n8000|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[u,"Samsung"],d,[c,h]],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-n900))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[u,"Samsung"],d,[c,b]],[/(samsung);smarttv/i],[u,d,[c,v]],[/\(dtv[\);].+(aquos)/i],[d,[u,"Sharp"],[c,v]],[/sie-(\w+)*/i],[d,[u,"Siemens"],[c,b]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[u,"Nokia"],d,[c,b]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[d,[u,"Acer"],[c,h]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[u,"LG"],d,[c,h]],[/(lg) netcast\.tv/i],[u,d,[c,v]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i],[d,[u,"LG"],[c,b]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[d,[u,"Lenovo"],[c,h]],[/linux;.+((jolla));/i],[u,d,[c,b]],[/((pebble))app\/[\d\.]+\s/i],[u,d,[c,x]],[/android.+;\s(glass)\s\d/i],[d,[u,"Google"],[c,x]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus)?[\s_]*(?:\d\w)?)\s+build/i],[[d,/_/g," "],[u,"Xiaomi"],[c,b]],[/(mobile|tablet);.+rv\:.+gecko\//i],[[c,y.lowerize],u,d]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[p,m],[/rv\:([\w\.]+).*(gecko)/i],[m,p]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[p,m],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[p,[m,A.str,E.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[p,"Windows"],[m,A.str,E.os.windows.version]],[/\((bb)(10);/i],[[p,"BlackBerry"],m],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[p,m],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[p,"Symbian"],m],[/\((series40);/i],[p],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[p,"Firefox OS"],m],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[p,m],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[p,"Chromium OS"],m],[/(sunos)\s?([\w\.]+\d)*/i],[[p,"Solaris"],m],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[p,m],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[p,"iOS"],[m,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[p,"Mac OS"],[m,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[p,m]]},T=function(e,s){if(!(this instanceof T))return new T(e,s).getResult();var r=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:o),n=s?y.extend(S,s):S;return this.getBrowser=function(){var i=A.rgx.apply(this,n.browser);return i.major=y.major(i.version),i},this.getCPU=function(){return A.rgx.apply(this,n.cpu)},this.getDevice=function(){return A.rgx.apply(this,n.device)},this.getEngine=function(){return A.rgx.apply(this,n.engine)},this.getOS=function(){return A.rgx.apply(this,n.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(i){return r=i,this},this.setUA(r),this};T.VERSION=s,T.BROWSER={NAME:p,MAJOR:l,VERSION:m},T.CPU={ARCHITECTURE:f},T.DEVICE={MODEL:d,VENDOR:u,TYPE:c,CONSOLE:g,MOBILE:b,SMARTTV:v,TABLET:h,WEARABLE:x,EMBEDDED:k},T.ENGINE={NAME:p,VERSION:m},T.OS={NAME:p,VERSION:m},typeof exports!==a?(typeof module!==a&&module.exports&&(exports=module.exports=T),exports.UAParser=T):typeof define===n&&define.amd?define(function(){return T}):i.UAParser=T;var N=i.jQuery||i.Zepto;if(typeof N!==a){var z=new T;N.ua=z.getResult(),N.ua.get=function(){return z.getUA()},N.ua.set=function(i){z.setUA(i);var e=z.getResult();for(var s in e)N.ua[s]=e[s]}}}("object"==typeof window?window:this);
},{}],24:[function(require,module,exports){
var CalcPanel=function(t){function e(){console.log("calc panel init"),r=$("#calc-panels"),r.find(":text").keyup(o);var e=_.random(5e3,2e4),n=_.random(5e3,2e4),l=_.random(1e4,2e4),f=0,s=_.random(5,30),c=e+s*_.random(-100,100),v=n+s*_.random(-100,100),x=l+s*_.random(-100,100),m=f+s;r.find("#x-pre").text(a(e)),r.find("#y-pre").text(a(n)),r.find("#z-pre").text(a(l)),r.find("#t-pre").text(a(f)),r.find("#x-post").text(a(c)),r.find("#y-post").text(a(v)),r.find("#z-post").text(a(x)),r.find("#t-post").text(a(m)),d=(c-e)/s,i=(v-n)/s,p=(x-l)/s,t.getIsDev()&&(r.find("#v-post-x").attr("placeholder",d),r.find("#v-post-y").attr("placeholder",i),r.find("#v-post-z").attr("placeholder",p))}function n(){r.find(":text").val("")}function a(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function o(){t.hideEstimate(),l=Number(r.find("#v-post-x").val())===d&&Number(r.find("#v-post-y").val())===i&&Number(r.find("#v-post-z").val())===p;var e=l?1:0;t.showEstimate(e)}var r,d,i,p,l=!1;return{init:e,wipeInputs:n}};module.exports=CalcPanel;
},{}],25:[function(require,module,exports){
var ATUtil=require("shared/utils/general-utils");Controls=function(e,t,o,n){function i(e){h.mouseDown=!0,v=0,E=0,f.set(0,0),y.copy(h.object.rotation),p.set(e.clientX,e.clientY),b.set(e.clientX,e.clientY)}function s(){if(h.mouseDown=!1,f.length()<4&&h.deployEnabled){var t=e.getEarthIntersection(h.mousePos);t.length>0&&e.placeDeployZone(t[0].point)}}function r(e){if(h.mousePos.x=e.clientX/window.innerWidth*2-1,h.mousePos.y=2*-(e.clientY/window.innerHeight)+1,h.mouseDown){b.set(e.clientX,e.clientY),f.subVectors(b,p);var t=f.x/window.innerHeight*Math.PI,o=f.y/window.innerWidth*Math.PI;L.y=y.y+t*w,L.y%=2*Math.PI,L.x=ATUtil.clamp(y.x+o*w,-d,d)}}function a(e){e.preventDefault(),e.stopPropagation(),r(e.touches[0]),i(e.touches[0])}function u(e){e.preventDefault(),e.stopPropagation(),s(e.touches[0])}function c(e){e.preventDefault(),e.stopPropagation(),r(e.touches[0])}function l(){g(),o.rotation.x+=(L.x-o.rotation.x)/20,o.rotation.y+=(L.y-o.rotation.y)/20}function m(){t.on("update",l),$("#game-webgl")[0].addEventListener("mousemove",r,!1),$("#game-webgl")[0].addEventListener("mousedown",i,!1),$("#game-webgl")[0].addEventListener("mouseup",s,!1),$("#game-webgl")[0].addEventListener("touchstart",a,!1),$("#game-webgl")[0].addEventListener("touchend",u,!1),$("#game-webgl")[0].addEventListener("touchmove",c,!1)}function g(){if(h.deployEnabled){var t=e.getEarthIntersection(h.mousePos);t.length>0?$("#game-webgl").css("cursor","pointer"):$("#game-webgl").css("cursor","default")}}this.object=o,this.domElement=n,this.mouseDown=!1,this.mousePos=new THREE.Vector2(0,0),this.deployEnabled=!0,this.gotoPosZ=-350;var d=.3*Math.PI,h=this,w=1,v=0,E=0,p=new THREE.Vector2,b=new THREE.Vector2,f=new THREE.Vector2,y=new THREE.Vector3,L=new THREE.Vector3;this.init=function(){y.copy(h.object.rotation),m()},this.removeListeners=function(){t.off("update",l),$("#game-webgl")[0].removeEventListener("mousemove",r,!1),$("#game-webgl")[0].removeEventListener("mousedown",i,!1),$("#game-webgl")[0].removeEventListener("mouseup",s,!1),$("#game-webgl")[0].removeEventListener("touchstart",a,!1),$("#game-webgl")[0].removeEventListener("touchend",u,!1),$("#game-webgl")[0].removeEventListener("touchmove",c,!1)},this.enableDeploy=function(e){h.deployEnabled=e},this.setRotation=function(e,t){L.x=e,L.y=t}},module.exports=Controls;
},{"shared/utils/general-utils":193}],26:[function(require,module,exports){
var ns=require("shared/namespace"),DeployBtn=function(e){function a(){l.click(e.onDeployBtnClick),l.mouseover(t),l.mouseout(s),l.mousedown(n),l.mouseup(w),o()}function o(){TweenMax.to(M,.5,{delay:1.3,opacity:.5,ease:i}),TweenMax.to(u,.5,{delay:1.5,opacity:.5,ease:i}),TweenMax.to(p,.5,{delay:1,opacity:.2,ease:i}),TweenMax.to(p,.8,{delay:1,width:"222px",ease:Power4.easeOut})}function t(){ns.audioProxy.triggerEvent("view_btn_over"),TweenMax.to(M,.2,{opacity:0,ease:i}),TweenMax.to(M,.8,{scale:1.5,ease:Power4.easeOut}),TweenMax.to(T,.2,{opacity:1,ease:i}),TweenMax.to(T,.5,{scale:1.1,ease:Power4.easeOut}),TweenMax.to(u,.5,{delay:.1,opacity:1,color:P,ease:i}),TweenMax.to(p,1,{x:"10%",opacity:.7,width:"30px",ease:Power4.easeOut})}function s(){x?(TweenMax.to(M,.5,{opacity:1,ease:i}),TweenMax.to(M,.3,{scale:1,ease:Power4.easeOut})):(TweenMax.to(M,.5,{opacity:.3,ease:i}),TweenMax.to(M,.3,{scale:1,ease:Power4.easeOut})),TweenMax.to(T,.2,{opacity:0,ease:i}),TweenMax.to(T,.5,{delay:.15,scale:.5,ease:Power4.easeOut}),TweenMax.to(u,.5,{delay:.1,opacity:.5,color:"#fff",ease:i}),TweenMax.to(p,1,{x:"0%",opacity:.2,width:"222px",ease:Power4.easeOut})}function n(){x?(TweenMax.to(T,.5,{scale:.9,borderColor:d,ease:Power4.easeOut}),TweenMax.to(u,.5,{color:d,ease:i})):(TweenMax.to(T,.5,{scale:.9,borderColor:f,ease:Power4.easeOut}),TweenMax.to(u,.5,{color:f,ease:i})),TweenMax.to(y,.5,{scale:.75,ease:Power4.easeOut}),TweenMax.to(y,.5,{opacity:.05,ease:i}),TweenMax.to(p,1,{x:"100%",ease:Power4.easeOut})}function w(){TweenMax.to(T,.5,{borderColor:P,ease:i}),TweenMax.to(T,.5,{scale:1.1,ease:Power4.easeOut}),TweenMax.to(y,.5,{scale:.1,ease:Power4.easeOut}),TweenMax.to(y,.5,{opacity:0,ease:i}),TweenMax.to(u,.5,{color:P,ease:i}),TweenMax.to(p,1,{x:"100%",ease:Power4.easeOut}),e.getIsMobile()&&TweenMax.delayedCall(1,s)}function r(){l.off("mouseout",s)}function c(e){e?TweenMax.to(M,.5,{opacity:1,borderColor:d,ease:i}):TweenMax.to(M,.5,{opacity:.3,borderColor:P,ease:i}),x=e}var x=!1,i=RoughEase.ease.config({strength:5.1,points:55}),l=$(".stemBtn"),u=$(".tmTxt"),M=$(".tmC1"),T=$(".tmC2"),y=$(".tmC3"),p=$(".stemSideline"),d="#ffcb05",f="#e93e43",P="#fff";return{init:a,activate:c,disableRollout:r}};module.exports=DeployBtn;
},{"shared/namespace":175}],27:[function(require,module,exports){
var paths=require("shared/paths"),DotShader=require("shared/shaders/DotShader.js"),ATUtil=require("shared/utils/general-utils"),Earth=function(e,a){function t(a){h=a;var t=new THREE.MeshBasicMaterial({opacity:1,color:0}),n=new THREE.SphereGeometry(f-2,26,26);E=new THREE.Mesh(n,t),h.add(E),g=new THREE.MeshBasicMaterial({depthWrite:!1,blending:THREE.AdditiveBlending,transparent:!0,wireframe:!0,wireframeLinewidth:1.5,vertexColors:THREE.VertexColors});var i=new THREE.SphereGeometry(M,32,32);u=new THREE.Mesh(i,g),h.add(u),o(i,16711680);var s=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/trajectory-mapping/dot.png");m=new THREE.PointCloudMaterial({size:10,map:s,blending:THREE.AdditiveBlending,depthTest:!1,transparent:!0,opacity:.5,color:16777215});var l=i.clone(),p=new THREE.PointCloud(l,m);p.sortParticles=!1,u.add(p),d=new Image,d.onload=r,d.crossOrigin="Anonymous",d.src=e.getIsMobile()?paths.CDN+"imgs/trajectory-mapping/earth-300.jpg":paths.CDN+"imgs/trajectory-mapping/earth-600.jpg"}function r(){e.getIsMobile()||a.on("update",n);var t=d.width,r=d.height,o=document.createElement("canvas");o.width=t,o.height=r;var i=o.getContext("2d");i.drawImage(d,0,0);for(var E=i.getImageData(0,0,t,r).data,u=0,m=0;t>m;++m)for(var g=0;r>g;++g){u=4*m+g*(4*t);var M=E[u],w=E[u+1],y=E[u+2],H=M+w+y;if(H>T){var R={x:(m-t/2)*Math.PI*2/t,y:(g-r/2)*Math.PI/r};v.push(R)}}var x={alphaPos:{type:"f",value:[]}};c=new THREE.ShaderMaterial({uniforms:DotShader.uniforms,attributes:x,vertexShader:DotShader.vertexShader,fragmentShader:DotShader.fragmentShader,transparent:!0,depthWrite:!1}),c.uniforms.texture.value=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/trajectory-mapping/dot.png"),p=new THREE.Geometry,l=v.length,p.colors=[];for(var S=0;l>S;S++){var R=v[S],C=new THREE.Vector3;C.x=f*Math.cos(R.y)*Math.cos(R.x),C.y=f*Math.cos(R.y)*Math.sin(R.x),C.z=f*-Math.sin(R.y),x.alphaPos.value[S]=Math.random()*Math.PI*2,p.vertices.push(C);var D=new THREE.Color(16777215*Math.random());p.colors.push(D)}var I=new THREE.PointCloud(p,c);I.sortParticles=!1,I.rotation.x=-Math.PI/2,h.add(I),n(),a.trigger("earth-init-complete"),a.on("resize",s),s()}function o(e){for(var a=0;a<e.faces.length;a++)for(var t=e.faces[a],r=0;3>r;r++){var o=new THREE.Color(0);Math.random()<.3&&o.setHSL(0,0,Math.random()/3),t.vertexColors[r]=o}e.colorsNeedUpdate=!0}function n(){c.uniforms.time.value=e.getVizTime()/2,u.rotateY(3e-4)}function i(e,a,t){TweenMax.to(c.uniforms.opacity,a,{value:e,delay:t}),TweenMax.to(m,a,{opacity:e,delay:t}),TweenMax.to(g,a,{opacity:e,delay:t})}function s(){var a=Math.min(e.getVizSize().w,e.getVizSize().h),t=ATUtil.clamp(a/1e3*15,8,15);c.uniforms.size.value=t}var h,d,l,p,E,u,c,m,g,v=[],T=100,f=400,M=500;return{init:t,update:n,EARTH_RAD:f,getEarth:function(){return E},fadeTo:i}};module.exports=Earth;
},{"shared/paths":176,"shared/shaders/DotShader.js":179,"shared/utils/general-utils":193}],28:[function(require,module,exports){
require("shared/lib/three.js-master/examples/js/postprocessing/EffectComposer"),require("shared/lib/three.js-master/examples/js/postprocessing/RenderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/ShaderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/MaskPass"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader");var LinesShader=require("shared/shaders/LinesShader"),GlowShader=require("shared/shaders/GlowShader"),VignetteShader=require("shared/shaders/VignetteShader"),VerticalTiltShiftShader=require("shared/shaders/VerticalTiltShiftShader"),BarrelBlurShader=require("shared/shaders/BarrelBlurShader"),FXHandler=function(e,r){function s(){r.on("update",a),n=new THREE.EffectComposer(e.getRenderer()),l=new THREE.RenderPass(e.getScene(),e.getCamera()),d=new THREE.ShaderPass(THREE.CopyShader),t={},t.lines=new THREE.ShaderPass(LinesShader),t.glow=new THREE.ShaderPass(GlowShader),t.vignette=new THREE.ShaderPass(VignetteShader),t.tiltshift=new THREE.ShaderPass(VerticalTiltShiftShader),t.barrelBlur=new THREE.ShaderPass(BarrelBlurShader),t.lines.uniforms.lineSize.value=1840,t.lines.uniforms.lineStrength.value=.1,t.lines.uniforms.lineTilt.value=.85,t.glow.uniforms.amount.value=.6,t.glow.uniforms.size.value=3.7,t.glow.uniforms.darkness.value=.14,t.vignette.uniforms.offset.value=.9,t.tiltshift.uniforms.v.value=.005,t.tiltshift.uniforms.r.value=.5,t.barrelBlur.uniforms.amount.value=.01,n=new THREE.EffectComposer(e.getRenderer()),n.addPass(l),n.addPass(t.glow),n.addPass(t.vignette),n.addPass(t.barrelBlur),n.addPass(d),d.renderToScreen=!0,i()}function a(){n.render(.1),h+=.1,t.barrelBlur.uniforms.time.value=h}function i(){n&&n.setSize(e.getVizSize().w,e.getVizSize().h)}var t,n,l,d,h=0;return{init:s,update:a,onResize:i}};module.exports=FXHandler;
},{"shared/lib/three.js-master/examples/js/postprocessing/EffectComposer":163,"shared/lib/three.js-master/examples/js/postprocessing/MaskPass":165,"shared/lib/three.js-master/examples/js/postprocessing/RenderPass":166,"shared/lib/three.js-master/examples/js/postprocessing/ShaderPass":167,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/shaders/BarrelBlurShader":177,"shared/shaders/GlowShader":182,"shared/shaders/LinesShader":184,"shared/shaders/VerticalTiltShiftShader":185,"shared/shaders/VignetteShader":186}],29:[function(require,module,exports){
var Earth=require("./earth"),Controls=require("./controls"),FXHandler=require("./fx-handler"),CalcPanel=require("./calc-panel"),DeployBtn=require("./deploy-btn"),Stats=require("stats-js"),Clock=require("../common/clock"),ATUtil=require("shared/utils/general-utils"),client=require("shared/utils/client/client"),ns=require("shared/namespace"),paths=require("shared/paths"),GameMain=function(){function e(e,n,a){me||(me=!0,K=a,x=0!==n.difficulty,Z=18e4+4e4*(3-Number(n.difficulty)),console.log("difficulty",n.difficulty),console.log("gameDuration",Z),te.on("earth-init-complete",t),window.location.href.indexOf("?dev")>-1&&(w=!0),window.location.href.indexOf("mobile")>-1&&(ne=!0),v=new Clock({$el:e.find(".clock .time"),countdown:Z/1e3}),v.start(),b=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4),b.position.z=500,P=new THREE.Scene,C=new THREE.WebGLRenderer,C.setSize(window.innerWidth,window.innerHeight),L=new THREE.Object3D,P.add(L),e.children("#game-webgl").append(C.domElement),P.fog=new THREE.Fog(0,500,1500),Q=new THREE.Object3D,L.add(Q),Q.rotation.y=.2,F=new THREE.Object3D,Q.add(F),Q.position.x=-180,Q.position.y=-81,Q.position.z=-1e3,R=new Earth(GameMain,te),R.init(F),H=new CalcPanel(GameMain),H.init(),M=new DeployBtn(GameMain),M.init(),D=new Stats,D.domElement.style.position="absolute",D.domElement.style.top="0px",w&&($("#game-webgl").append(D.domElement),$("#debug-text").css("display","block")),A=new THREE.Raycaster,Y=Date.now(),TweenMax.to($(".clock"),1,{opacity:1,ease:RoughEase.ease.config({strength:4,points:20}),delay:1.5}),TweenMax.staggerFrom($("#calc1").children(),.5,{x:-25,ease:Expo.easeOut,delay:2},.06),TweenMax.staggerFrom($("#calc1").children(),.5,{opacity:0,ease:RoughEase.ease.config({strength:1,points:7,randomize:!1,clamp:!0}),delay:2},.06),ns.audioProxy.triggerEvent("game1_start"),console.log("isMobile",ne),ne&&($("#mobile-deploy-btn").show(),$("#answer-prompt").addClass("mobile"),$("#calc-panels").hide(),$(".stemSideline").hide(),se=60))}function t(){var e=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/trajectory-mapping/payload.png");e.minFilter=e.magFilter=THREE.LinearFilter;var t=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/trajectory-mapping/white-ring.png");t.minFilter=t.magFilter=THREE.LinearFilter;var n=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/trajectory-mapping/orng-ring.png");n.minFilter=n.magFilter=THREE.LinearFilter;var o=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/trajectory-mapping/deploy.png");o.minFilter=o.magFilter=THREE.LinearFilter;var r=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/trajectory-mapping/estimate.png");r.minFilter=r.magFilter=THREE.LinearFilter;var s=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/trajectory-mapping/explosion.png");s.minFilter=s.magFilter=THREE.LinearFilter,f=new Controls(GameMain,te,F,$("#webgl")[0]),f.init(),O=new THREE.Geometry,a();var l=new THREE.LineBasicMaterial({color:16763653,linewidth:3,depthWrite:!1,transparent:!0,opacity:0});ee=new THREE.Line(O,l),F.add(ee);var c=new THREE.SpriteMaterial({map:s,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!1,opacity:0});k=new THREE.Object3D,F.add(k),k.position.copy(B);var d=new THREE.SpriteMaterial({map:e,transparent:!0,depthTest:!1,opacity:0});z=new THREE.Sprite(d),z.scale.set(1.2*se,1.2*se,1.2*se),k.add(z);var p=new THREE.SpriteMaterial({map:n,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!1,opacity:0});J=new THREE.Sprite(p),k.add(J),J.scale.set(se,se,se),W=new THREE.SpriteMaterial({map:t,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!1,opacity:0}),G=new THREE.Sprite(c),F.add(G),G.position.copy(B),G.scale.set(1.2*se,1.2*se,1.2*se),V=new THREE.Sprite(W),F.add(V),V.position.copy(B),TweenLite.fromTo(V.scale,1,{x:.3,y:.3},{x:4*se,y:4*se,ease:Power0.none,delay:2}),TweenLite.fromTo(W,1,{opacity:1},{opacity:0,ease:Power0.none,delay:2,immediateRender:!1}),TweenLite.fromTo(d,1,{opacity:0},{opacity:1,ease:Expo.easeOut,delay:2,immediateRender:!1}),TweenLite.fromTo(c,1,{opacity:0},{opacity:1,ease:Expo.easeOut,delay:2,immediateRender:!1}),TweenLite.fromTo(l,1,{opacity:0},{opacity:1,ease:Expo.easeOut,delay:2,immediateRender:!1}),TweenMax.fromTo(p,1.2,{opacity:1},{opacity:0,ease:Power0.none,repeat:-1,delay:4,immediateRender:!1}),TweenMax.fromTo(J.scale,1.2,{x:1.4*se,y:1.4*se},{x:4*se,y:4*se,delay:4,ease:Power0.none,repeat:-1,immediateRender:!1}),TweenMax.delayedCall(2,function(){ns.audioProxy.triggerEvent("trajectory_explosion")}),TweenMax.delayedCall(4,function(){ns.audioProxy.triggerEvent("craft_ping")}),TweenMax.delayedCall(2,function(){ns.audioProxy.triggerEvent("trajectory_mapping_start")}),ne||(h=new FXHandler(GameMain,te),h.init()),window.addEventListener("resize",m,!1),m(),i();var E=new THREE.PlaneGeometry(20,20,1,1),g=new THREE.MeshBasicMaterial({map:o,transparent:!0,depthTest:!1,side:THREE.DoubleSide,opacity:.8});j=new THREE.Mesh(E,g),F.add(j),j.visible=!1;var y=x?-300:-350;TweenMax.fromTo(Q.position,4,{z:-1200},{z:y,ease:Expo.easeOut}),ns.audioProxy.triggerEvent("zoom");var T={x:U.x*Math.PI/180,y:(-U.y-90)*Math.PI/180+Math.PI/20};f.setRotation(T.x,T.y),F.rotation.y=T.y+Math.PI/2,S=x?4:7}function n(){R.fadeTo(0,1,1),TweenMax.to($(".clock"),1,{opacity:0,ease:RoughEase.ease.config({strength:4,points:20})}),TweenMax.staggerTo($("#calc1").children(),.5,{opacity:0,ease:RoughEase.ease.config({strength:1,points:7,randomize:!1,clamp:!0})},.06),TweenMax.to($("#next-btn"),.6,{opacity:0,ease:RoughEase.ease}),TweenMax.to(ee.material,1,{opacity:0,delay:1}),TweenMax.to(j.material,1,{opacity:0,delay:1}),TweenMax.to(z.material,1,{opacity:0,delay:1}),TweenMax.to(G.material,1,{opacity:0,delay:1})}function a(){if(x)U=new THREE.Vector2(_.random(31.3,48.5,!0),_.random(-123.83,-68.4,!0)),q=new THREE.Vector2(_.random(61.5,69.7,!0),_.random(-160,-142.1,!0));else{U=new THREE.Vector2(_.random(-20,60),_.random(-180,180));var e=new THREE.Vector2(_.random(5,25),_.random(10,50));Math.random()>.5&&(e.x=-e.x),Math.random()>.5&&(e.y=-e.y),q=U.clone().add(e)}B=g(U.x,U.y,R.EARTH_RAD+100),N=g(q.x,q.y,R.EARTH_RAD);var t=B.clone();t.lerp(N,.5),t.setLength(R.EARTH_RAD+120),I=new THREE.QuadraticBezierCurve3(B,t,N);for(var n=0;re>n;n++)O.vertices[n]=new THREE.Vector3;O.verticesNeedUpdate=!0}function i(){ae||(requestAnimationFrame(i),D.update(),te.trigger("update"),ie+=.1,ne&&C.render(P,b),o(),Math.abs(v.getTime())<15e3&&!Ee&&(ns.audioProxy.triggerEvent("time_up_start"),Ee=!0))}function o(){if(!de){var e=Date.now()-Y;le=e/Z,ce&&(le=X/Z+(e-X)/(Z-X)*50),le=ATUtil.lerp(le,.06,1);for(var t=0;re>t;t++)O.vertices[t]=I.getPoint(le*t/(re-1));O.verticesNeedUpdate=!0,k.position.copy(I.getPoint(le)),le>=1&&s()}}function r(e){return ge?(e.preventDefault(),e.stopPropagation(),void(ce||(ce=!0,f.enableDeploy(!1),X=Date.now()-Y,console.log("onDeployBtnClick",X),ns.audioProxy.triggerEvent("main_click"),ns.audioProxy.triggerEvent("travel_loop_start"),v.stop(),$("#calc-panels").css("pointer-events","none"),M.disableRollout()))):(ns.audioProxy.triggerEvent("submit_fail"),$("#answer-prompt").html(ne?"CLICK ON THE GLOBE TO SELECT DEPLOY TARGET.":"INCORRECT. RECALCULATE YOUR ANSWER OR CLICK THE GLOBE TO PICK A LOCATION."),TweenMax.killTweensOf($("#answer-prompt")),TweenMax.to($("#answer-prompt"),.6,{opacity:1,ease:RoughEase.ease.config({strength:4,points:20})}),TweenMax.to($("#answer-prompt"),1,{opacity:0,delay:3,immediateRender:!1}),$(".deploy-btn").addClass("incorrect"),TweenMax.delayedCall(3,function(){$(".deploy-btn").removeClass("incorrect")}),R.fadeTo(.25,.5,0),void TweenMax.delayedCall(3,function(){R.fadeTo(.5,.5,0)}))}function s(){V.position.copy(N),TweenLite.fromTo(W,1,{opacity:1},{opacity:0,ease:Power0.none,immediateRender:!1}),TweenLite.fromTo(V.scale,1,{x:.3,y:.3},{x:4*se,y:4*se,ease:Power0.none,immediateRender:!1}),J.visible=!1,v.stop(),de=!0,setTimeout(l,2e3),ns.audioProxy.triggerEvent("craft_impact"),ns.audioProxy.triggerEvent("travel_loop_stop"),ns.audioProxy.triggerEvent("craft_ping_stop"),ns.audioProxy.triggerEvent("game_end"),ns.audioProxy.triggerEvent("time_up_end"),n()}function l(){var e=j.scale.x,t=8*e;console.log("minDistanceToScore:",t);var n=Math.max(k.position.distanceTo(j.position)-3,0);console.log("distance:",n),console.log("payloadHolder.position:",k.position),console.log("deployZone.position:",j.position);var a=Math.max(t-n,0)/t,i={accuracy:a,skill:Math.max(pe,.001),speed:1-X/Z},o=i.accuracy>0;console.log(i),o?K.trigger("win",{score:i}):K.trigger("lose",{score:i})}function c(){ge=!1,j.visible=!1,M.activate(!1)}function d(e){pe=e,0!==e&&(E(N),f.enableDeploy(!1))}function p(e){TweenMax.set($("#answer-prompt"),{opacity:0});var t=e.clone();R.getEarth().worldToLocal(t),E(t),ns.audioProxy.triggerEvent("impact_zone_click"),H.wipeInputs()}function E(e){M.activate(!0),ge=!0,j.position.copy(e.clone()),j.lookAt(new THREE.Vector3(0,0,0)),j.visible=!0,j.scale.set(S,S,S),TweenMax.fromTo(j.scale,.3,{x:S/2,y:S/2,z:S/2},{x:S,y:S,z:S,ease:Expo.easeOut})}function g(e,t,n){var a=e*Math.PI/180,i=(t-180)*Math.PI/180,o=-n*Math.cos(a)*Math.cos(i),r=n*Math.sin(a),s=n*Math.cos(a)*Math.sin(i);return new THREE.Vector3(o,r,s)}function m(){oe.w=window.innerWidth,oe.h=window.innerHeight,b.aspect=oe.w/oe.h,b.updateProjectionMatrix(),C.setSize(oe.w,oe.h),ne||h.onResize(),oe.h>oe.w?L.scale.set(b.aspect,b.aspect,b.aspect):L.scale.set(1,1,1),te.trigger("resize",b.aspect)}function y(e){$("#debug-text").text(e)}function T(e){return A.setFromCamera(e,b),A.intersectObject(R.getEarth())}function u(){f.removeListeners(),ae=!0,v.stop(),ns.audioProxy.triggerEvent("trajectory_mapping_end"),ns.audioProxy.triggerEvent("travel_loop_stop"),ns.audioProxy.triggerEvent("craft_ping_stop")}var w,x,h,R,f,v,H,M,b,P,C,D,L,F,O,I,S,z,A,j,k,B,G,N,q,U,V,W,K,X,Y,Z,Q,J,ee,te=_.extend({},Backbone.Events),ne="mobile"===client.device.type||"tablet"===client.device.type,ae=!1,ie=0,oe={},re=50,se=30,le=0,ce=!1,de=!1,pe=0,Ee=!1,ge=!1,me=!1;return{init:e,trace:y,exit:u,getMainHolder:function(){return L},getVizTime:function(){return ie},getScene:function(){return P},getCamera:function(){return b},getRenderer:function(){return C},getVizSize:function(){return oe},getIsMobile:function(){return ne},getEarthIntersection:T,getEarth:function(){return R},getIsDev:function(){return w},onDeployBtnClick:r,showEstimate:d,hideEstimate:c,placeDeployZone:p}}();module.exports=GameMain;
},{"../common/clock":124,"./calc-panel":24,"./controls":25,"./deploy-btn":26,"./earth":27,"./fx-handler":28,"shared/namespace":175,"shared/paths":176,"shared/utils/client/client":190,"shared/utils/general-utils":193,"stats-js":22}],30:[function(require,module,exports){
var gamebase=require("../game-base"),GameMain=require("./game-main.js"),ns=require("shared/namespace"),TrajMapping=function(e){console.log("TrajMapping",e);var a=this;_.extend(this,gamebase),_.extend(this,{enter:function(){var n=$(ns.templates.trajectory_mapping());e.$parent.append(n),GameMain.init(n,e,a)},exit:function(){GameMain.exit()}})};module.exports=TrajMapping;
},{"../game-base":125,"./game-main.js":29,"shared/namespace":175}],31:[function(require,module,exports){
var ns=require("shared/namespace"),paths=require("shared/paths"),CandidatePanel=function(e,a){function s(){a.on("candidate-found",c),console.log("candidate panel init"),g=$("#candidate-panel"),v=g.find("#submit-btn"),v.click(i),g.find(".view-btn").click(t),h=[];for(var e=0;m>e;e++)h.push(e);h=_.shuffle(h),l()}function i(){if($(this).hasClass("enabled")&&-1!==C){var a=$("#thumb-"+C);d(C)?(f++,a.addClass("positive"),l(),TweenMax.fromTo($("#positive-text"),.3,{opacity:0},{opacity:1,ease:RoughEase.ease.config({strength:4,points:5,randomize:!1,clamp:!0})}),f===p&&e.gameOver(!0),ns.audioProxy.triggerEvent("submit_success")):(a.addClass("negative"),ns.audioProxy.triggerEvent("submit_fail"),x++,console.log("ACCURACY SCORE DECREMENT")),$(this).removeClass("enabled")}}function t(){if(-1!==C){var e=$(this).data("view");n(e),ns.audioProxy.triggerEvent("switch_filter")}}function n(e){E&&$("#view-btn-"+E).removeClass("selected"),E=e,$("#view-btn-"+E).addClass("selected"),$("#big-img").css("backgroundImage","url("+paths.CDN+"imgs/uav-search/candidates/big/"+E+"/"+o(C)+".jpg)"),TweenMax.fromTo($("#big-img"),.3,{opacity:0},{opacity:1,ease:RoughEase.ease.config({strength:4,points:5,randomize:!1,clamp:!0})})}function r(){var e=$("#thumb-"+C);e.removeClass("selected"),void 0!==$(this).data("id")&&(C=$(this).data("id")),n(E),e=$("#thumb-"+C),e.addClass("selected"),g.find(".view-btn").addClass("enabled"),ns.audioProxy.triggerEvent("click_photo"),e.hasClass("positive")||e.hasClass("negative")?v.removeClass("enabled"):v.addClass("enabled")}function d(e){var a=h[e],s=p>a;return s}function o(e){var a=h[e],s=p>a,i=s?"positive":"negative",t=a+1;s||(t=a-p+1),10>t&&(t="0"+t);var n=i+"/"+t;return n}function c(){ns.audioProxy.triggerEvent("scan_cell");var e=b,a=$("#thumb-"+e);a.css("backgroundImage","url("+paths.CDN+"imgs/uav-search/candidates/thumb/"+o(e)+".jpg)");var s=new Image;s.src=paths.CDN+"imgs/uav-search/candidates/big/ir/"+o(e)+".jpg";var i=new Image;i.src=paths.CDN+"imgs/uav-search/candidates/big/spec/"+o(e)+".jpg",a.addClass("enabled"),a.click(r),b++,l(),1===b&&(C=0,r())}function l(){var e="SCANNED: "+b+" / "+m+"<br>";$("#candidate-text").html(e),e="POSITIVE: "+f+" / "+p+"<br>",$("#positive-text").html(e)}function u(){return 1-x/(m-p)}var g,v,h,m=24,p=4,b=0,f=0,C=-1,E="ir",x=0;return{init:s,getAccuracy:u}};module.exports=CandidatePanel;
},{"shared/namespace":175,"shared/paths":176}],32:[function(require,module,exports){
require("shared/lib/three.js-master/examples/js/postprocessing/EffectComposer"),require("shared/lib/three.js-master/examples/js/postprocessing/RenderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/ShaderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/MaskPass"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader");var LinesShader=require("shared/shaders/LinesShader"),GlowShader=require("shared/shaders/GlowShader"),VignetteShader=require("shared/shaders/VignetteShader"),VerticalTiltShiftShader=require("shared/shaders/VerticalTiltShiftShader"),BarrelBlurShader=require("shared/shaders/BarrelBlurShader"),FXHandler=function(e,r){function s(){r.on("update",a),n=new THREE.EffectComposer(e.getRenderer()),l=new THREE.RenderPass(e.getScene(),e.getCamera()),d=new THREE.ShaderPass(THREE.CopyShader),t={},t.lines=new THREE.ShaderPass(LinesShader),t.glow=new THREE.ShaderPass(GlowShader),t.vignette=new THREE.ShaderPass(VignetteShader),t.tiltshift=new THREE.ShaderPass(VerticalTiltShiftShader),t.barrelBlur=new THREE.ShaderPass(BarrelBlurShader),t.lines.uniforms.lineSize.value=1840,t.lines.uniforms.lineStrength.value=.1,t.lines.uniforms.lineTilt.value=.85,t.glow.uniforms.amount.value=.4,t.glow.uniforms.size.value=2.7,t.glow.uniforms.darkness.value=.14,t.vignette.uniforms.offset.value=.9,t.tiltshift.uniforms.v.value=.005,t.tiltshift.uniforms.r.value=.5,t.barrelBlur.uniforms.amount.value=.01,n=new THREE.EffectComposer(e.getRenderer()),n.addPass(l),n.addPass(t.glow),n.addPass(t.vignette),n.addPass(t.barrelBlur),n.addPass(d),d.renderToScreen=!0,i()}function a(){n.render(.1),h+=.1,t.barrelBlur.uniforms.time.value=h}function i(){n&&n.setSize(e.getVizSize().w,e.getVizSize().h)}var t,n,l,d,h=0;return{init:s,update:a,onResize:i}};module.exports=FXHandler;
},{"shared/lib/three.js-master/examples/js/postprocessing/EffectComposer":163,"shared/lib/three.js-master/examples/js/postprocessing/MaskPass":165,"shared/lib/three.js-master/examples/js/postprocessing/RenderPass":166,"shared/lib/three.js-master/examples/js/postprocessing/ShaderPass":167,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/shaders/BarrelBlurShader":177,"shared/shaders/GlowShader":182,"shared/shaders/LinesShader":184,"shared/shaders/VerticalTiltShiftShader":185,"shared/shaders/VignetteShader":186}],33:[function(require,module,exports){
var Manpad=require("./manpad"),UAV=require("./uav"),GameMap=require("./map"),FXHandler=require("./fx-handler"),Stats=require("stats-js"),Clock=require("../common/clock"),CandidatePanel=require("./candidate-panel"),client=require("shared/utils/client/client"),ATUtil=require("shared/utils/general-utils"),ns=require("shared/namespace"),paths=require("shared/paths"),GameMain=function(){function e(e,n,o){ee||(ee=!0,window.location.href.indexOf("?dev")>-1&&(v=!0),j=o,console.log("difficulty",n.difficulty),V.manpadCount=Number(n.difficulty)+3,V.duration=60*(7-Number(n.difficulty)),F.on("uavDown",i),R=new CandidatePanel(GameMain,F),R.init(),x=new Clock({$el:e.find(".clock .time")}),x.start(),window.location.href.indexOf("mobile")>-1&&(A=!0),z=new THREE.Scene,P=new THREE.WebGLRenderer,P.setSize(window.innerWidth,window.innerHeight),P.sortObjects=!1,z.fog=new THREE.Fog(0,1e3,2e3),e.children("#game-webgl").append(P.domElement),H=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,1e4),G=new THREE.Object3D,z.add(G),C=new THREE.Object3D,G.add(C),b=new Stats,b.domElement.style.position="absolute",b.domElement.style.top="0px",v&&($("#game-webgl").append(b.domElement),$("#debug-text").css("display","block")),O=new THREE.Raycaster,window.addEventListener("resize",c,!1),A||(M=new FXHandler(GameMain,F),M.init()),$("body").on("mousemove",f),A&&($("#analyze-btn").click(function(){$("#cover-panel").show(),$("#candidate-panel").show()}),$("#exit-btn").click(function(){$("#cover-panel").hide(),$("#candidate-panel").hide()}),$("#analyze-btn").show(),$("#candidate-panel").addClass("mobile")),c(),m(),C.rotation.x=5.8,H.position.y=-50,TweenMax.fromTo(H.position,3,{z:2500},{z:1e3,ease:Expo.easeOut}),TweenMax.fromTo(C.rotation,3,{x:5.8,z:Math.PI/4},{x:5.3,z:0,ease:Expo.easeOut}),TweenMax.staggerFrom($(".panel").children(),.5,{opacity:0,ease:RoughEase.ease.config({strength:1,points:7,randomize:!1,clamp:!0}),delay:1},.1),TweenMax.to($(".clock"),1,{opacity:1,ease:RoughEase.ease.config({strength:4,points:20}),delay:1}),t())}function n(){TweenMax.staggerTo($(".panel").children(),.5,{opacity:0,ease:RoughEase.ease.config({strength:1,points:7,randomize:!1,clamp:!0})},.06),TweenMax.to($(".clock"),1,{opacity:0,ease:RoughEase.ease.config({strength:4,points:20})}),TweenMax.to(H.position,1,{z:2500,ease:Expo.easeIn,delay:1}),TweenMax.to(C.rotation,1,{x:5.8,ease:Expo.easeIn,delay:1})}function t(){T=new GameMap(GameMain,F),T.init(C);var e=new THREE.PlaneGeometry(100,100,1,1),n=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/uav-search/base.png");n.minFilter=n.magFilter=THREE.LinearFilter;var t=new THREE.MeshBasicMaterial({map:n,transparent:!0,depthTest:!1});q=new THREE.Mesh(e,t),q.position.set(0,-GameMap.MAP_DIMS.y/2+40,0),C.add(q);var o=t.clone(),i=new THREE.Mesh(e,o);i.position.set(0,-GameMap.MAP_DIMS.y/2+40,1),C.add(i);var r=1.6;TweenMax.fromTo(o,1.2,{opacity:1},{opacity:0,ease:Power0.none,repeat:-1,delay:2,immediateRender:!1}),TweenMax.fromTo(i.scale,1.2,{x:1,y:1,z:1},{x:r,y:r,z:r,delay:2,ease:Power0.none,repeat:-1,immediateRender:!1}),D=new THREE.Object3D,C.add(D);for(var s=0;s<V.manpadCount;s++){new Manpad(GameMain,D,F)}var c=new THREE.ObjectLoader;c.load("assets/models/games/uav-search/uav.json",function(e){for(k=new THREE.Object3D,C.add(k),s=0;s<V.uavCount;s++){var n=new UAV(GameMain,k,s,F,e.children[0].clone());U.push(n)}S=new THREE.Clock,S.start(),a()}),ns.audioProxy.triggerEvent("uav_search_start")}function o(e){$("#debug-text").text(e)}function a(){W||(B=S.getDelta(),requestAnimationFrame(a),I+=S.getDelta(),F.trigger("update"),b.update(),A&&P.render(z,H))}function i(){L++,L===V.uavCount&&r(!1)}function r(e){x.stop(),n(),setTimeout(function(){s(e)},2e3)}function s(e){W=!0;for(var n=0,t=0;t<V.uavCount;t++)n+=U[t].getNormHealth();var o=n/V.uavCount,a={accuracy:R.getAccuracy(),skill:o,speed:Math.max((1e3*V.duration-x.getTime())/(1e3*V.duration),0)};e?j.trigger("win",{score:a}):j.trigger("lose",{score:a}),ns.audioProxy.triggerEvent("time_up_end")}function c(){N.w=window.innerWidth,N.h=window.innerHeight,H.aspect=N.w/N.h,H.updateProjectionMatrix(),P.setSize(N.w,N.h),A||M.onResize(),N.h>N.w?C.scale.set(H.aspect,H.aspect,H.aspect):C.scale.set(1,1,1),F.trigger("resize")}function d(e){O.setFromCamera(e,H);var n=O.intersectObject(T.getMountains());if(n.length>0){var t=n[0].point;return T.getMountains().worldToLocal(t),t}return"off-edge"}function u(e){var n=e.clone();return T.getMountains().localToWorld(n),n.project(H),n}function l(){W=!0,x.stop(),ns.audioProxy.triggerEvent("uav_search_end"),p()}function m(){$("body").on("mousedown",g),$("body").on("mouseup",w),$("body").on("mouseleave",w),$("body").on("mousemove",f),$("body").on("touchstart",h),$("body").on("touchmove",E),$("body").on("touchend",w)}function p(){$("body").off("mousedown",g),$("body").off("mouseup",w),$("body").off("mouseleave",w),$("body").off("mousemove",f),$("body").off("touchstart",h),$("body").off("touchmove",E),$("body").off("touchend",w)}function f(e){Z.x=e.clientX/window.innerWidth*2-1,Z.y=2*-(e.clientY/window.innerHeight)+1,y()}function g(){X=!0,Y=Z.clone(),K=C.rotation.clone()}function w(){X=!1}function h(e){f(e.originalEvent.touches[0]),g(e.originalEvent.touches[0])}function E(e){f(e.originalEvent.touches[0]),e.preventDefault(),e.stopPropagation()}function y(){X&&(J.subVectors(Z,Y),C.rotation.z=K.z+J.x*Q,C.rotation.x=ATUtil.clamp(K.x-J.y*Q,5,5.8),F.trigger("resize"))}var v,T,b,x,M,R,H,z,P,C,G,k,q,D,O,j,S,A="mobile"===client.device.type||"tablet"===client.device.type,F=_.extend({},Backbone.Events),V={payloadPieces:24,scanRadius:40,manpadCount:3,uavCount:3,baseWidth:60,duration:360},W=!1,I=0,U=[],L=0,N={},B=0,X=!1,Y=new THREE.Vector2,J=new THREE.Vector2,K=new THREE.Vector3,Q=1.1,Z=new THREE.Vector2(0,0),ee=!1;return{init:e,trace:o,config:V,getBase:function(){return q},getUAVs:function(){return U},getGameTime:function(){return I},screenPosToMapPos:d,getScene:function(){return z},getCamera:function(){return H},getRenderer:function(){return P},getVizSize:function(){return N},getDelta:function(){return B},exit:l,gameOver:r,mapPosToScreenPos:u,getMap:function(){return T}}}();module.exports=GameMain;
},{"../common/clock":124,"./candidate-panel":31,"./fx-handler":32,"./manpad":35,"./map":36,"./uav":37,"shared/namespace":175,"shared/paths":176,"shared/utils/client/client":190,"shared/utils/general-utils":193,"stats-js":22}],34:[function(require,module,exports){
var gamebase=require("../game-base"),GameMain=require("./game-main.js"),ns=require("shared/namespace"),UAVSearch=function(e){console.log("UAVSearch",e);var a=this;_.extend(this,gamebase),_.extend(this,{enter:function(){var n=$(ns.templates.uav_search());e.$parent.append(n),GameMain.init(n,e,a)},exit:function(){GameMain.exit()}})};module.exports=UAVSearch;
},{"../game-base":125,"./game-main.js":33,"shared/namespace":175}],35:[function(require,module,exports){
var ImprovedNoise=require("shared/lib/ImprovedNoise"),Map=require("./map"),Manpad=function(e,i,t){var o=new ImprovedNoise,a=40,n=30,r=20,d=.3,s=this;this.parent=i;var p=0;this.init=function(){t.off("update",this.update),t.on("update",this.update),s.holder=new THREE.Object3D,s.noisePos=100*Math.random(),s.parent.add(this.holder);for(var e=new THREE.EllipseCurve(0,0,40,40,0,2*Math.PI,!1),i=new THREE.Path(e.getPoints(20)),o=i.createPointsGeometry(20),a=0;6>a;a++){var n=new THREE.LineBasicMaterial({color:16711680,linewidth:2,opacity:d,transparent:!0,depthTest:!1,dashSize:10,gapSize:10,blending:THREE.AdditiveBlending}),p=new THREE.Line(o,n);s.holder.add(p),p.position.z=r*a;var l=.1*a+.2;p.scale.set(l,l,l)}var h=new THREE.LineBasicMaterial({color:16711680,linewidth:2,opacity:d,transparent:!0,depthTest:!1,blending:THREE.AdditiveBlending}),E=new THREE.Geometry;E.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,100)];var c=new THREE.Line(E,h);s.holder.add(c)},this.update=function(){s.holder.position.x=o.noise(e.getGameTime()*n,s.noisePos,0)*Map.MAP_DIMS.x*.95,s.holder.position.y=o.noise(e.getGameTime()*n,s.noisePos+200,1e3)*Map.MAP_DIMS.y*.95,s.holder.position.z=e.getMap().getHeight(s.holder.position);for(var i=0;i<e.config.uavCount;i++){var t=e.getUAVs()[i];t.alive&&!t.uavAtBase&&t.getPos().distanceTo(s.holder.position)<a&&t.doHit()}for(p=(p+.01)%1,i=0;6>i;i++){var l=s.holder.children[i];l.position.z=r*i+r*p;var h=.2+.1*i+.1*p;l.scale.set(h,h,h)}s.holder.children[0].material.opacity=p*d,s.holder.children[5].material.opacity=(1-p)*d},this.init()};module.exports=Manpad;
},{"./map":36,"shared/lib/ImprovedNoise":157}],36:[function(require,module,exports){
var ATUtil=require("shared/utils/general-utils"),ImprovedNoise=require("shared/lib/ImprovedNoise"),ns=require("shared/namespace"),paths=require("shared/paths"),MAP_DIMS=new THREE.Vector2(800,800),Map=function(e,a){function r(r){a.on("update",s),d=new THREE.Object3D,r.add(d),l=1e3*Math.random();var i=new THREE.PlaneGeometry(1.1*MAP_DIMS.x,1.1*MAP_DIMS.y,1,1),o=new THREE.MeshBasicMaterial({});v=new THREE.Mesh(i,o),d.add(v),v.visible=!1;var T=new THREE.PlaneGeometry(MAP_DIMS.x,MAP_DIMS.y,H.x,H.y);n(T);var R=new THREE.MeshBasicMaterial({wireframe:!0,color:16777215,transparent:!0,opacity:.08});c=new THREE.Mesh(T,R),d.add(c);var f=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/uav-search/ground2.jpg");f.minFilter=THREE.LinearFilter,f.magFilter=THREE.LinearFilter;var g=new THREE.MeshBasicMaterial({map:f,vertexColors:THREE.VertexColors}),y=1.5,h=new THREE.PlaneGeometry(MAP_DIMS.x*y,MAP_DIMS.y*y,H.x*y,H.y*y);n(h);var m=new THREE.Mesh(h,g);m.position.z=-1,d.add(m);var A=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/uav-search/dot.png"),P=new THREE.PointCloudMaterial({size:7,map:A,blending:THREE.AdditiveBlending,transparent:!0,opacity:1,color:16777215}),w=T.clone(),I=new THREE.PointCloud(w,P);I.sortParticles=!1,d.add(I),M=T.clone();var D=new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:1,depthTest:!1,depthWrite:!1,vertexColors:THREE.FaceColors,blending:THREE.AdditiveBlending});E=new THREE.Mesh(M,D),d.add(E),_.forEach(M.faces,function(e){e.color.setHex(0)}),u=[];for(var S=0;S<H.x;S++){for(var b=[],C=0;C<H.y;C++){var U={scanned:!1,payload:!1};b.push(U)}u.push(b)}p=new THREE.Object3D,d.add(p);var B=(new THREE.PlaneGeometry(x.x,x.x,1,1),THREE.ImageUtils.loadTexture(paths.CDN+"imgs/uav-search/tri.png"));B.minFilter=B.magFilter=THREE.LinearFilter;var F=new THREE.SpriteMaterial({map:B,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!1,fog:!0});for(S=0;S<e.config.payloadPieces;S++){var j=_.random(1,H.x-1),N=_.random(1,H.y-1),U=u[j][N];U.payload=!0,U.objId=S;var z=new THREE.Object3D;p.add(z);var O=new THREE.Sprite(F),V=20;O.scale.set(V,V,V),z.add(O),z.position.set(N*x.x-MAP_DIMS.x/2+x.x/2,-(j*x.y-MAP_DIMS.y/2)-x.y/2,0),z.position.z=t(z.position)+V/2,z.visible=!1}}function n(e){_.forEach(e.faces,function(a){for(var r=0;3>r;r++){var n=a[f[r]],i=new THREE.Color,o=e.vertices[n];o.z=t(o),i.setHSL(.3,0,o.z/R*.5+.1),a.vertexColors[r]=i}})}function t(e){var a=99999,r=.003,n=(T.noise((e.x+a)*r+l,(e.y+a)*r,0)+.5)/2;return r=.01,n+=(T.noise((e.x+a)*r+l,(e.y+a)*r,0)+.5)/2,n=n*n*n,n*R}function i(e,a){var r=2*e*H.x+2*a;return r}function o(r){for(var n=ATUtil.clamp(Math.round((-r.y+MAP_DIMS.y/2-e.config.scanRadius)/x.x),0,H.x),t=ATUtil.clamp(Math.round((-r.y+MAP_DIMS.y/2+e.config.scanRadius)/x.x),0,H.x),o=ATUtil.clamp(Math.round((r.x+MAP_DIMS.x/2-e.config.scanRadius)/x.y),0,H.y),s=ATUtil.clamp(Math.round((r.x+MAP_DIMS.x/2+e.config.scanRadius)/x.y),0,H.y),d=n;t>d;d++)for(var l=o;s>l;l++){var c=u[d][l];if(!c.scanned){c.scanned=!0;var E=i(d,l),v=c.payload?6710886:1381653;if(M.faces[E].color.setHex(v),M.faces[E+1].color.setHex(v),M.colorsNeedUpdate=!0,c.payload){ns.audioProxy.triggerEvent("scan_cell"),a.trigger("candidate-found");var T=p.children[c.objId];T.visible=!0,TweenMax.from(T.position,1,{z:"+=30",ease:Bounce.easeOut})}}}}function s(){for(var a=0;a<e.config.uavCount;a++){var r=e.getUAVs()[a];r.alive&&!r.uavAtBase&&o(r.getPos())}}var d,l,c,E,M,u,p,v,T=new ImprovedNoise,H=new THREE.Vector2(40,40),x=new THREE.Vector2(MAP_DIMS.x/H.x,MAP_DIMS.y/H.y),R=100,f=["a","b","c"];return{init:r,getObj3D:function(){return d},getMountains:function(){return v},getHeight:t}};Map.MAP_DIMS=MAP_DIMS,module.exports=Map;
},{"shared/lib/ImprovedNoise":157,"shared/namespace":175,"shared/paths":176,"shared/utils/general-utils":193}],37:[function(require,module,exports){
var Draggable=require("../../../../../node_modules/gsap/src/uncompressed/utils/Draggable"),paths=require("shared/paths"),ns=require("shared/namespace"),dragSuccesful=!1,UAV=function(e,t,a,o,n){function i(){o.on("update",h),o.on("resize",d),t.add(N),N.add(G),G.add(n);var i=1.8;n.scale.set(i,i,i),n.position.set(0,0,O),n.rotation.x+=Math.PI/2,n.rotation.z-=Math.PI/2,G.position.copy(e.getBase().position),x=new THREE.MeshBasicMaterial({color:16776960,opacity:1,depthTest:!1}),n.material=x;var g=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/uav-search/cp"+a+".png");g.minFilter=g.magFilter=THREE.LinearFilter;var p=new THREE.MeshBasicMaterial({map:g,transparent:!0,depthWrite:!1,depthTest:!1}),f=new THREE.Mesh(new THREE.PlaneGeometry(40,40,1,1),p);G.add(f);var m=new THREE.LineBasicMaterial({color:16777215,linewidth:1.5,opacity:.3,transparent:!0,depthTest:!1}),E=new THREE.Geometry;E.vertices=[new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,O)];var w=new THREE.Line(E,m);G.add(w),R=new THREE.LineBasicMaterial({color:A,linewidth:1.5,opacity:.4,transparent:!0,depthTest:!1}),T=$(".uav-info").eq(a),P=T.find(".bar.health"),H=T.find(".bar.fuel");for(var y=0;y<B.numCPs;y++){var M={id:y,active:!1},_=T.children().eq(y);_.css("backgroundImage",'url("'+paths.CDN+"imgs/uav-search/cp"+a+'.png")'),Draggable.create(_,{type:"x,y",bounds:$("#ui-overlay"),onDragEnd:u,cp:M,onPress:function(){this.startX=this.x,this.startY=this.y,TweenMax.to(this.target,.3,{scale:V,ease:Power2.easeOut}),M.$elem.css({opacity:1})},onDrag:function(){$(this.target).css({opacity:1}),TweenMax.to($("#drag-prompt"),.3,{opacity:0})},cursor:""}),_.on("mousedown mouseup touchstart touchend",function(e){e.preventDefault(),e.stopPropagation()}),_.mouseenter(s),_.mouseleave(r),M.$elem=_,_.data("cp",M),U.push(M)}c(),v(),l()}function s(){TweenMax.to($(this),.3,{scale:1.2,ease:Power2.easeOut}),dragSuccesful||(TweenMax.fromTo($("#drag-prompt"),.3,{opacity:0},{opacity:1,ease:RoughEase.ease.config({strength:4,points:5,randomize:!1,clamp:!0})}),$("#drag-prompt").offset({top:$(this).offset().top})),ns.audioProxy.triggerUI(ns.audioProxy.UI_EVENTS.GAME_1_UAV_ROLL_OVER)}function r(){TweenMax.to($(this),.3,{scale:1,ease:Power2.easeOut})}function u(){if(ns.audioProxy.triggerEvent("drop_plot_point"),TweenMax.to(this.target,.3,{scale:1,ease:Power2.easeOut}),"off-edge"===g($(this.target)))TweenMax.to(this.target,1,{x:this.startX,y:this.startY,ease:Expo.easeOut});else{dragSuccesful=!0;var e=$(this.target).data("cp");e.active||(e.active=!0,_.pull(U,e),S.push(e),c()),l()}}function c(){_.forEach(U,function(e,t){e.$elem.css({top:"0",left:"0"}),TweenMax.set(e.$elem,{x:5,y:5}),t<U.length-1?e.$elem.css({opacity:0}):e.$elem.css({opacity:1})})}function l(){E&&N.remove(E);var t=[];t.push(G.position.clone()),_.forEach(S,function(e){var a=g(e.$elem);t.push(a),e.mapPos=a.clone()});var a=e.getBase().position.clone();t.push(a),w=new THREE.SplineCurve3(t);var o=new THREE.Geometry;o.vertices=w.getPoints(50),E=new THREE.Line(o,R),N.add(E),L=0}function g(t){var a=t[0].getBoundingClientRect(),o=new THREE.Vector2;o.x=(a.left+a.width/2)/window.innerWidth*2-1,o.y=2*-((a.top+a.height/2)/window.innerHeight)+1;var n=e.screenPosToMapPos(o);return n.z=0,n}function p(t,a){var o=e.mapPosToScreenPos(a),n=t[0].getBoundingClientRect();t.offset({left:(o.x/2+.5)*window.innerWidth-n.width/2,top:(-o.y/2+.5)*window.innerHeight-n.height/2+window.pageYOffset})}function d(){_.forEach(S,function(e){p(e.$elem,e.mapPos)})}function h(){if(0===S.length&&G.position.distanceTo(e.getBase().position)<5)C.uavAtBase||ns.audioProxy.triggerEvent("drone_arrives_at_base"),C.uavAtBase=!0,G.rotation.set(0,0,0),G.position.copy(e.getBase().position),b.fuel+=B.refillRate,b.fuel=Math.min(B.uavRange,b.fuel),E&&N.remove(E);else{C.uavAtBase=!1,b.fuel-=B.uavFuelBurnRate*e.getDelta(),L+=B.uavSpeed*e.getDelta()/w.getLength(),L%=1;var t=w.getPointAt(L);G.position.copy(t),q=w.getTangentAt(L).normalize(),z.crossVectors(I,q).normalize();var a=Math.acos(I.dot(q));G.quaternion.setFromAxisAngle(z,a);var o=15;if(S.length>0){var n=S[0];if(G.position.distanceTo(n.mapPos)<o)return S.shift(),n.active=!1,U.push(n),c(),l(),!1}}f(),v(),y=!1,b.fuel<35&&!M&&(M=!0,ns.audioProxy.triggerEvent("low_fuel_warning")),b.fuel<0&&(m("OUT OF FUEL!"),ns.audioProxy.triggerEvent("drone_out_of_fuel")),b.damage>B.uavMaxDamage&&(ns.audioProxy.triggerEvent("drone_shot_down"),m("HACKED!"))}function f(){x.color.setHex(y?16711680:16777215),R.color.setHex(y?16711680:A),T.toggleClass("hit",y)}function m(e){o.trigger("uavDown"),o.off("update",h),this.alive=!1;var t="DRONE "+(a+1)+" <br>"+e;T.html(t),_.forEach(U,function(e){e.$elem.css("display","none")}),_.forEach(S,function(e){e.$elem.css("display","none")}),G.visible=!1,f(),N.remove(E)}function v(){H.width(b.fuel/B.uavRange*F),P.width((1-b.damage/B.uavMaxDamage)*F),H.css("backgroundColor",b.fuel<35?"#FF0000":"#ffcb05"),b.damage>65&&P.css("backgroundColor","#FF0000")}this.uavAtBase=!1,this.alive=!0;var E,w,T,R,x,y,P,H,M,D,B={scanRadius:40,numCPs:4,cpWidth:40,uavRange:100,uavMaxDamage:100,uavSpeed:25,manpadDamage:12,uavFuelBurnRate:1.2,refillRate:.2},b={fuel:B.uavRange,damage:0},A=16763653,O=120,F=60,V=1.4,C=this,L=0,S=[],U=[],q=new THREE.Vector3,z=new THREE.Vector3,I=new THREE.Vector3(0,1,0),N=new THREE.Object3D,G=new THREE.Object3D,W=5e3;this.doHit=function(){this.alive&&(b.damage+=B.manpadDamage*e.getDelta(),D||(D=!0,ns.audioProxy.triggerEvent("threat_warning"),setTimeout(function(){D=!1},W)),y=!0)},this.getPos=function(){return G.position},this.getNormHealth=function(){return Math.max(1-b.damage/B.uavMaxDamage,0)},i()};module.exports=UAV;
},{"../../../../../node_modules/gsap/src/uncompressed/utils/Draggable":5,"shared/namespace":175,"shared/paths":176}],38:[function(require,module,exports){
"use strict";module.exports={colors:{green:714097,yellow:16763653,red:15158348}};
},{}],39:[function(require,module,exports){
var gamebase=require("../game-base"),ns=require("shared/namespace"),Clock=require("../common/clock"),View=require("./views/view-main"),WebGL=require("./webgl/webgl-main"),ns=require("shared/namespace"),paths=require("shared/paths"),ClearPath=function(e){function a(){m=$(ns.templates.clear_path({})),e.$parent.append(m),p=new Clock({$el:m.find(".clock .time")}),t()}function t(){v.on("win",c.bind(this)),v.on("lose",s.bind(this)),v.on("detonate",n)}function n(){var e=v.get("chargesLeft"),a=v.get("chargesSet");v.set("chargesLeft",e-a),v.set("chargesSet",0);var t=v.get("numDetonations");t++,v.set("numDetonations",t)}function r(){var e=u.par.accuracy.high,a=u.par.accuracy.low,t=u.num_charges-v.get("chargesLeft"),n=v.get("numDetonations"),r=Math.min(1,(a-(t+n))/(a-e));return r}function o(){var e=u.par.skill.high,a=u.par.skill.low;console.log(v);var t=v.get("cumulativeForce"),n=u.num_charges-v.get("chargesLeft"),r=t/n;console.log(t,n,r);var o=Math.min(1,(r-a)/(e-a));return o}function i(){var e=p.getTime()/1e3,a=u.par.speed.high,t=u.par.speed.low,n=Math.min(1,Math.max(1e-4,t-e)/(t-a));return n}function c(){ns.audioProxy.triggerEvent("clear_path_end");var e={accuracy:r(),skill:o(),speed:i()};d.trigger("win",{score:e})}function s(){ns.audioProxy.triggerEvent("clear_path_end"),d.trigger("lose")}function g(){p.start(),h=new WebGL({local:v,parent:e.$parent,config:e.config,data:u}),f=new View({local:v,$el:m,config:e.config,data:u}),ns.audioProxy.triggerEvent("clear_path_start")}console.log("ClearPath",e);var l=Math.floor(Math.random()*e.gameData.length),u=e.gameData[l];console.log("game data",u);var h,f,m,p,d=this,v=new Backbone.Model({currentLevel:1,chargesLeft:u.num_charges,chargesSet:0,cumulativeForce:0,numDetonations:0,cameraMoving:!0});a(),_.extend(this,gamebase),_.extend(this,{load:function(e){"function"==typeof e&&e()},enter:function(e){g(),"function"==typeof e&&e()},exit:function(e){h.exit(function(){"function"==typeof e&&e()})}})};module.exports=ClearPath;
},{"../common/clock":124,"../game-base":125,"./views/view-main":43,"./webgl/webgl-main":60,"shared/namespace":175,"shared/paths":176}],40:[function(require,module,exports){
var setObjectAlongPath=function(t,o,a,r,e,i,n,l,s){var c=o.getPointAt(a),m=r.tangents.length,p=a*m,g=Math.floor(p),y=(g+1)%m;t=t||new THREE.Object3D,e.subVectors(r.binormals[y],r.binormals[g]),e.multiplyScalar(p-g).add(r.binormals[g]);var d=o.getTangentAt(a);n=l?-n:n,i.copy(e).cross(d),c.add(i.clone().multiplyScalar(n)),t.position.copy(c);var u=t.position.clone();if(u.normalize(),d.z<0?i.y*=-1:(i.multiplyScalar(-1),d.multiplyScalar(-1)),"PerspectiveCamera"===t.type){s+=.1;var A=Math.min(s,a+.05),b=o.getPointAt(A);t.lookAt(b)}else{var A=a+.01,v=o.getPointAt(A);v.copy(c).add(d),t.matrix.lookAt(t.position,v,i),t.rotation.setFromRotationMatrix(t.matrix,t.rotation.order)}return t};module.exports=setObjectAlongPath;
},{}],41:[function(require,module,exports){
var ns=require("shared/namespace"),paths=require("shared/paths"),CameraPanel=Backbone.View.extend({enabled:!1,initialize:function(e){_.extend(this,e),this.$el=e.$el,this.bindEvents(),this._setSelection(1)},bindEvents:function(){_.bindAll(this,"onClickCameraButton"),this.$el.on("click","svg .btn",this.onClickCameraButton),this.$el.on("click",".cam-rotation .btn",this.onClickCameraButton),this.listenTo(this.local,"change:cameraMoving",this.onChangeCameraMoving),this.listenTo(this.local,"change:currentLevel",this.onChangeLevel),this.local.on("detonation-start",this.handleDetonateStart.bind(this)),this.local.on("detonation-finished",this.handleDetonateFinish.bind(this)),this.local.on("currentCameraViewPercent",this.updateCameraPanelSelection.bind(this))},handleDetonateStart:function(){this.$el.addClass("disabled")},handleDetonateFinish:function(e){e||this.$el.removeClass("disabled")},currSelection:1,updateCameraPanelSelection:function(e){var t=Math.round(2*e+1);this.currSelection!==t&&this._setSelection(t,!0)},onChangeLevel:function(){this._setSelection(1)},onChangeCameraMoving:function(){this.local.get("cameraMoving")?this.$el.addClass("disabled"):this.$el.removeClass("disabled")},onOverCameraButton:function(){ns.audioProxy.triggerEvent("view_btn_over")},onClickCameraButton:function(e){if(!this.local.get("cameraMoving")){ns.audioProxy.triggerEvent("view_btn_click");var t=$(e.currentTarget).attr("btn");this._setSelection(t)}},_setSelection:function(e,t){this.$(".active").attr({"class":"btn entering"}),this.$('.btn[btn="'+e+'"]').attr({"class":"btn active entering"}),t||this.local.trigger("change-camera-view",e),this.currSelection=e}});module.exports=CameraPanel;
},{"shared/namespace":175,"shared/paths":176}],42:[function(require,module,exports){
var constants=require("../constants"),client=require("shared/utils/client/client"),isMobile="mobile"===client.device.type||"tablet"===client.device.type,CursorManager=require("shared/utils/cursor-manager"),Charges=Backbone.View.extend({padding:isMobile?38:50,dragging:!1,startMousePos:null,maxColumns:isMobile?6:3,enabled:!0,objects:[],initialize:function(t){_.extend(this,t),_.extend(this.gamebase),isMobile&&this.initMobile();for(var i=0;i<this.data.num_charges;i++)setTimeout(function(t){isMobile?this.createMobileCharge(t):this.createCharge(t)}.bind(this),80*i,i);this.listenTo(this.local,"change:cameraMoving",this.onChangeCameraMoving.bind(this)),this.local.on("moving-marker",this.moveMarkerStart.bind(this))},initMobile:function(){var t=this.$(".count"),i=parseInt(this.local.get("chargesSet")),e=this.data.num_charges-i,s=10>e?"0"+e:e;t.html(s),t.addClass("show")},onChangeCameraMoving:function(){this.local.get("cameraMoving")?this.$el.addClass("disabled"):this.$el.removeClass("disabled")},createMobileCharge:function(t){var i=this.dpr>1?1.5*this.dpr:this.dpr,e=[22,13,3],s=this.getDragObject(constants.colors.yellow,{radius:e[0]*i,opacity:.15,line_opacity:.6},{radius:e[1]*i,opacity:.2,line_opacity:.7},{radius:e[2]*i,opacity:.6,line_opacity:1});this.positionObject(s,t),s.x=(this.padding+this.$el.offset().left+25)*this.dpr,s.y=(this.padding+this.$el.offset().top-2)*this.dpr,s.origin={},s.origin.x=s.x,s.origin.y=s.y,t>0&&(s.scale.x=0,s.scale.y=0),s.idx=t,this.stage.addChild(s),this.objects.push({_drag:s,_static:null}),s.interactive=!0,s.touchstart=this.touchStart.bind(this),s.touchend=this.touchEnd.bind(this),this.stage.touchmove=this.touchMove.bind(this)},createCharge:function(t){var i=this.dpr>1?1.5*this.dpr:this.dpr,e=isMobile?[10,6,1]:[14,8,2],s=this.getDragObject(5592405,{radius:e[0]*i,opacity:.1,line_opacity:.7},{radius:e[1]*i,opacity:.5,line_opacity:.85},{radius:e[2]*i,opacity:.8,line_opacity:1});this.positionObject(s,t),this.stage.addChild(s);var a=this.getDragObject(constants.colors.yellow,{radius:e[0]*i,opacity:.1,line_opacity:.5},{radius:e[1]*i,opacity:.2,line_opacity:.7},{radius:e[2]*i,opacity:.4,line_opacity:1});this.positionObject(a,t),a.origin={},a.origin.x=a.x,a.origin.y=a.y,a.scale.x=0,a.scale.y=0,a.staticObj=s,s.dragObj=a,this.stage.addChild(a),this.objects.push({_drag:a,_static:s}),a.interactive=!0,a.mousedown=this.mouseDown.bind(this),a.mouseup=this.mouseUp.bind(this),a.mouseover=function(){CursorManager.setCursor(document.body,"grab")}.bind(this),a.mouseout=function(){CursorManager.setCursor(document.body,"auto")}.bind(this),this.stage.mousemove=this.mouseMove.bind(this);var r={t:0},o=!1,n=0,h=2;TweenMax.to(r,.2,{t:1,onUpdate:function(){n++,n%h||(o=!o,a.scale.x=o,a.scale.y=o,s.scale.x=o,s.scale.y=o)},onComplete:function(){a.scale.x=1,a.scale.y=1,s.scale.x=1,s.scale.y=1}})},positionObject:function(t,i){t.x=(i%this.maxColumns*this.padding+this.$el.offset().left)*this.dpr,t.y=(Math.floor(i/this.maxColumns)*this.padding+this.$el.offset().top+20)*this.dpr},moveMarkerStart:function(t,i){if(this.enabled){var e=parseInt(this.local.get("chargesSet"));if(e--,this.local.set("chargesSet",e),isMobile){var s=this.local.get("chargesLeft")-e,a=10>s?"0"+s:s;this.$(".count").html(a)}this.currDragObj=t,this.dragging=!0,this.startMousePos={},this.startMousePos.x=i.pageX*this.dpr,this.startMousePos.y=i.pageY*this.dpr,this.currDragObj.position.set(this.startMousePos.x,this.startMousePos.y),TweenMax.to(this.currDragObj.scale,.4,{x:2,y:2,ease:Quart.easeIn,delay:.05})}},touchStart:function(t){this.enabled&&(this.currDragObj=t.target,this.dragging=!0,this.startMousePos={},this.startMousePos.x=t.data.originalEvent.changedTouches[0].clientX*this.dpr,this.startMousePos.y=t.data.originalEvent.changedTouches[0].clientY*this.dpr,this.currDragObj.interactive=!0,this.currDragObj.renderable=!0,this.currDragObj.position.set(this.startMousePos.x,this.startMousePos.y),TweenMax.to(this.currDragObj.scale,.4,{x:1.8,y:1.8,ease:Quart.easeIn,delay:.05}))},touchMove:function(t){this.enabled&&this.dragging&&(this.local.trigger("placing-marker"),this.currDragObj.position.x=t.data.global.x,this.currDragObj.position.y=t.data.global.y)},touchEnd:function(t){this.enabled&&(this.dragging=!1,TweenMax.killTweensOf(this.currDragObj),this.beingSet=!0,this.local.trigger("try-to-place-charge",this.currDragObj,function(i,e){if(i){var s=parseInt(this.local.get("chargesSet"));s++,this.local.set("chargesSet",s),TweenMax.to(this.currDragObj.scale,.4,{x:0,y:0,ease:Quart.easeIn,delay:.05,onComplete:function(){this.beingSet=!1}.bind(this)}),this.currDragObj.chargeSet=!0;var a=this.local.get("chargesLeft")-s,r=10>a?"0"+a:a;this.$(".count").html(r),console.log(this.objects[this.currDragObj.idx+1]),this.objects[this.currDragObj.idx+1]&&!this.objects[this.currDragObj.idx+1]._drag.chargeSet&&TweenMax.to(this.objects[t.target.idx+1]._drag.scale,.5,{x:1,y:1,ease:Quart.easeIn,delay:.05})}else this.currDragObj.chargeSet=!1,TweenMax.to(this.currDragObj.position,.4,{x:this.currDragObj.origin.x,y:this.currDragObj.origin.y,ease:Quart.easeInOut,delay:.1,onComplete:function(){this.beingSet=!1}.bind(this)}),TweenMax.to(this.currDragObj.scale,.4,{x:1,y:1,ease:Quart.easeIn,delay:.05}),this.objects[this.currDragObj.idx-1]&&!this.objects[this.currDragObj.idx-1].chargeSet&&TweenMax.to(this.objects[t.target.idx+1]._drag.scale,.5,{x:0,y:0,ease:Quart.easeIn,delay:.05})}.bind(this)))},mouseDown:function(t){this.enabled&&(this.currDragObj=t.target,this.dragging=!0,this.startMousePos={},this.startMousePos.x=t.data.global.x,this.startMousePos.y=t.data.global.y,this.currDragObj.interactive=!0,this.currDragObj.renderable=!0,this.currDragObj.position.set(this.startMousePos.x,this.startMousePos.y),TweenMax.to(this.currDragObj.scale,.4,{x:1.5,y:1.5,ease:Quart.easeIn,delay:.05}))},mouseMove:function(t){this.enabled&&this.dragging&&(CursorManager.setCursor(document.body,"grabbing"),this.local.trigger("placing-marker"),this.currDragObj.position.x=t.data.global.x,this.currDragObj.position.y=t.data.global.y)},mouseUp:function(t){this.enabled&&(this.dragging=!1,CursorManager.setCursor(document.body,"auto"),TweenMax.killTweensOf(this.currDragObj),this.beingSet=!0,this.local.trigger("try-to-place-charge",this.currDragObj,function(t,i){if(t){var e=parseInt(this.local.get("chargesSet"));e++,this.local.set("chargesSet",e),this.currDragObj.ref=i,TweenMax.to(this.currDragObj.scale,.4,{x:0,y:0,ease:Quart.easeIn,delay:.05,onComplete:function(){this.beingSet=!1}.bind(this)})}else TweenMax.to(this.currDragObj.position,.4,{x:this.currDragObj.origin.x,y:this.currDragObj.origin.y,ease:Quart.easeInOut,delay:.1,onComplete:function(){this.beingSet=!1}.bind(this)}),TweenMax.to(this.currDragObj.scale,.4,{x:1,y:1,ease:Quart.easeIn,delay:.05})}.bind(this)))},getDragObject:function(t,i,e,s){var a=new PIXI.Graphics;return a.beginFill(16777215,i.opacity),a.lineStyle(this.dpr,16777215,i.line_opacity/this.dpr),a.drawCircle(0,0,i.radius),a.endFill(),a.beginFill(16777215,e.opacity),a.lineStyle(this.dpr,16777215,e.line_opacity/this.dpr),a.drawCircle(0,0,e.radius),a.endFill(),a.beginFill(16777215,s.opacity),a.lineStyle(this.dpr,16777215,s.line_opacity/this.dpr),a.drawCircle(0,0,s.radius),a.endFill(),a.tint=t,a},resize:function(){window.innerWidth,window.innerHeight;this.objects.forEach(function(t,i){isMobile?(t._drag.x=(this.padding+this.$el.offset().left+25)*this.dpr,t._drag.y=(this.padding+this.$el.offset().top-2)*this.dpr):(this.positionObject(t._drag,i),this.positionObject(t._static,i))}.bind(this))},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1}});module.exports=Charges;
},{"../constants":38,"shared/utils/client/client":190,"shared/utils/cursor-manager":192}],43:[function(require,module,exports){
var Charges=require("./charges"),CameraPanel=require("./camera-panel"),dpr=1;void 0!==window.devicePixelRatio&&(dpr=window.devicePixelRatio);var ns=require("shared/namespace"),paths=require("shared/paths"),client=require("shared/utils/client/client"),isMobile="mobile"===client.device.type||"tablet"===client.device.type,Main=Backbone.View.extend({initialize:function(e){_.extend(this,e),_.extend(this.gamebase),this.setElement(e.$el),this.initDetonateBtn(),this.createPixi(),isMobile?this.$(".panels.left").addClass("hide"):this.createCamControls(),this.bindEvents()},bindEvents:function(){this.local.on("webgl-update",this.update.bind(this)),this.$(".tmDeploy").on("mouseover",this.stemBtnMouseOver.bind(this)),this.$(".tmDeploy").on("mouseout",this.stemBtnMouseOut.bind(this)),this.$(".tmDeploy").on("mousedown",this.stemBtnMouseDown.bind(this)),this.$(".tmDeploy").on("mouseup",this.stemBtnMouseUp.bind(this)),this.$(".tmDeploy").on("click",this.handleDetonateClick.bind(this)),this.$(".pixi_stage").on("click",this.clickStage.bind(this)),this.$(".pixi_stage").on("mousedown",this.mouseDownStage.bind(this)),this.$(".pixi_stage").on("mousemove",this.mouseMoveStage.bind(this)),this.$(".pixi_stage canvas").on("touchstart",this.touchStartStage.bind(this)),this.$(".pixi_stage canvas").on("touchmove",this.touchMoveStage.bind(this)),this.local.on("select-rock",this.showSelectedRockMeasurements.bind(this)),this.local.on("detonation-start",this.handleDetonateStart.bind(this)),this.local.on("detonation-finished",this.handleDetonateFinish.bind(this)),this.$(".detail-panel .close-btn").on("click",this.closeRockMeasurements.bind(this)),this.local.on("placing-marker",function(){this.moving_marker=!0}.bind(this)),this.$(".pixi_stage").on("mouseup",function(){this.moving_marker=!1,this.mousedown=!1}.bind(this)),this.$(".pixi_stage canvas").on("touchend",function(){this.moving_marker=!1,this.mousedown=!1}.bind(this)),this.listenTo(this.local,"change:cameraMoving",this.onChangeCameraMoving),this.listenTo(this.local,"ui:enter",this.enter),window.addEventListener("resize",this.onResize.bind(this),!1)},onChangeCameraMoving:function(e,t){t?(this.$(".tmDeploy").addClass("disabled"),this.charges&&this.charges.disable(),this.$(".pixi_stage").addClass("disabled")):(this.$(".tmDeploy").removeClass("disabled"),this.charges&&this.charges.enable(),this.$(".pixi_stage").removeClass("disabled"))},clickStage:function(e){this.charges&&!this.charges.beingSet&&this.local.trigger("click-stage",e)},currMousePosY:null,mouseDownStage:function(e){this.mousedown=!0,this.currMousePosY=e.pageY,this.local.trigger("mousedown-stage",e)},moving_marker:!1,mouseMoveStage:function(e){if(!this.moving_marker&&this.mousedown){var t=e.pageY-this.currMousePosY;Math.abs(t)>0&&this.local.trigger("mousemove-stage",t),this.currMousePosY=e.pageY}},touchMoveStage:function(e){if(!this.moving_marker&&this.mousedown){var t=e.originalEvent.touches[0].pageY-this.currMousePosY;Math.abs(t)>0&&this.local.trigger("mousemove-stage",t),this.currMousePosY=e.originalEvent.touches[0].pageY}},touchStartStage:function(e){this.mousedown=!0,this.currMousePosY=e.originalEvent.touches[0].pageY,this.local.trigger("touchstart-stage",e)},createPixi:function(){var e=window.innerWidth,t=window.innerHeight;this.renderer=new PIXI.autoDetectRenderer(e*dpr,t*dpr,{transparent:!0,antialias:!0}),this.renderer.view.style.position="absolute",this.renderer.view.style.width=e+"px",this.renderer.view.style.height=t+"px",this.$(".pixi_stage").append(this.renderer.view),this.stage=new PIXI.Container,this.stage.interactive=!0},createCamControls:function(){this.cameraPanel=new CameraPanel({$el:this.$(".panel.camera-panel"),local:this.local})},createCharges:function(){this.charges=new Charges({$el:this.$(".panel.charges .container"),stage:this.stage,data:this.data,local:this.local,dpr:dpr})},handleDetonateOver:function(){ns.audioProxy.triggerEvent("view_btn_over")},handleDetonateClick:function(){this.local.trigger("detonate")},handleDetonateStart:function(){this.$(".detonate-btn").addClass("disabled"),this.charges.disable(),this.$(".pixi_stage").addClass("disabled"),setTimeout(function(){this.$(".overlay").removeClass("hidden").addClass("entering"),this.$(".overlay .analyzing").addClass("loop")},2200),console.log(this.currRock),this.closeRockMeasurements()},handleDetonateFinish:function(e){this.$(".overlay .analyzing").removeClass("loop"),e?this.$(".overlay").addClass("passed"):this.$(".overlay").addClass("failed"),setTimeout(function(){this.$(".overlay").removeClass("entering"),setTimeout(function(){this.$(".overlay").addClass("hidden"),this.$(".overlay").removeClass("failed").removeClass("passed")},1300),e||(this.$(".detonate-btn").removeClass("disabled"),this.charges.enable(),this.$(".pixi_stage").removeClass("disabled"))}.bind(this),1600)},currRock:null,showSelectedRockMeasurements:function(e){return this.currRock?(this.closeRockMeasurements(),void setTimeout(function(){this.showSelectedRockMeasurements(e)}.bind(this),1e3)):(this.currRock=e,this.$(".detail-panel .content .dimensions .value").html(this.currRock._rockCubicFeet+" ft ^3"),this.$(".detail-panel .content .mass .value").html(this.currRock._rockDisplayMass+" kg"),this.$(".detail-panel .content .material .value").html(this.currRock._rockMaterial),this.$(".detail-panel").removeClass("hidden"),void console.log(this,this.currRock))},closeRockMeasurements:function(){this.currRock&&this.local.trigger("unselect-rock",this.currRock),this.currRock=null,this.$(".detail-panel").addClass("hidden")},update:function(){this.renderer.render(this.stage)},enter:function(){setTimeout(function(){isMobile||(setTimeout(function(){this.$(".camera-panel .title").addClass("entering")}.bind(this),1),setTimeout(function(){this.$(".camera-panel .cam-rotation").addClass("entering")}.bind(this),100),setTimeout(function(){this.$(".camera-panel .cam-rotation .btn:eq(1)").addClass("entering")}.bind(this),200),setTimeout(function(){this.$(".camera-panel .cam-rotation .btn:eq(2)").addClass("entering")}.bind(this),300),setTimeout(function(){this.$(".map-panel .title").addClass("entering")}.bind(this),540)),setTimeout(function(){this.$(".panel.charges .title").addClass("entering")}.bind(this),900),setTimeout(function(){this.createCharges()}.bind(this),1e3),setTimeout(function(){this.$(".panel.detonate").addClass("entering"),this.btnTranIn()}.bind(this),1500)}.bind(this),12e3),setTimeout(function(){this.$(".clock").addClass("entering")}.bind(this),680)},onResize:function(){var e=window.innerWidth,t=window.innerHeight;this.renderer.view.style.width=e+"px",this.renderer.view.style.height=t+"px",this.renderer.resize(e*dpr,t*dpr),this.charges.resize()},initDetonateBtn:function(){this.$tmDeploy=$(".tmDeploy"),this.$stemBtn=$(".stemBtn"),this.$tmTxt=$(".tmTxt"),this.$tmC1=$(".tmC1"),this.$tmC2=$(".tmC2"),this.$tmC3=$(".tmC3"),this.$stemSideline=$(".stemSideline")},sGold:"#ffcb05",sRed:"#e93e43",sWhite:"#fff",objSelect:0,$tmC1:null,$tmC2:null,$tmC3:null,$tmTxt:null,$stemSideline:null,btnTranIn:function(){TweenMax.to(this.$tmC1,.5,{delay:.3,opacity:.5,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$tmTxt,.5,{delay:.5,opacity:.5,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$stemSideline,.5,{delay:0,opacity:.2,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$stemSideline,.8,{delay:0,width:"172px",ease:Power4.easeOut})},btnReady:function(){TweenMax.to(this.$tmC1,.5,{opacity:1,borderColor:this.sGold,ease:RoughEase.ease.config({strength:5.1,points:55})})},btnReset:function(){TweenMax.to(this.$tmC1,.5,{opacity:.3,borderColor:this.sWhite,ease:RoughEase.ease.config({strength:5.1,points:55})})},stemBtnMouseOver:function(){TweenMax.to(this.$tmC1,.2,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$tmC1,.8,{scale:1.5,ease:Power4.easeOut}),TweenMax.to(this.$tmC2,.2,{opacity:1,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$tmC2,.5,{scale:1.1,ease:Power4.easeOut}),TweenMax.to(this.$tmTxt,.5,{delay:.1,opacity:1,color:this.sWhite,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$stemSideline,1,{x:"10%",opacity:.7,width:"30px",ease:Power4.easeOut})},stemBtnMouseOut:function(){TweenMax.to(this.$tmC1,.5,{opacity:1,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$tmC1,.3,{scale:1,ease:Power4.easeOut}),TweenMax.to(this.$tmC2,.2,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$tmC2,.5,{delay:.15,scale:.5,ease:Power4.easeOut}),TweenMax.to(this.$tmTxt,.5,{delay:.1,opacity:.5,color:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$stemSideline,1,{x:"0%",opacity:.2,width:"172px",ease:Power4.easeOut})},stemBtnMouseDown:function(){TweenMax.to(this.$tmC2,.5,{scale:.9,borderColor:this.sGold,ease:Power4.easeOut}),TweenMax.to(this.$tmTxt,.5,{color:this.sGold,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$tmC3,.5,{scale:.75,ease:Power4.easeOut}),TweenMax.to(this.$tmC3,.5,{opacity:.05,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$stemSideline,1,{x:"100%",ease:Power4.easeOut})},stemBtnMouseUp:function(){TweenMax.to(this.$tmC2,.5,{borderColor:this.sWhite,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$tmC2,.5,{scale:1.1,ease:Power4.easeOut}),TweenMax.to(this.$tmC3,.5,{scale:.1,ease:Power4.easeOut}),TweenMax.to(this.$tmC3,.5,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$tmTxt,.5,{color:this.sWhite,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(this.$stemSideline,1,{x:"100%",ease:Power4.easeOut})}});module.exports=Main;
},{"./camera-panel":41,"./charges":42,"shared/namespace":175,"shared/paths":176,"shared/utils/client/client":190}],44:[function(require,module,exports){
var ExplosionShader=require("../../../../shaders/explosion/explosion-shader"),ns=require("shared/namespace"),Charge=function(e){function o(o){setTimeout(function(){o.mesh.remove(o.mesh.children[0]),o.mesh.remove(o.mesh.children[1]),e.scene.remove(o.mesh),e.physics.world.removeRigidBody(o.body.body),e.physics.remove(o)},200)}var a=6e-5,t=new THREE.ShaderMaterial(new ExplosionShader),n=new THREE.MeshBasicMaterial({color:16763653,transparent:!0,opacity:.8}),r=!1,i=60,l=100,s=100,c=new THREE.SphereGeometry(i,l,s),d=new THREE.Mesh(c,n),u=new THREE.Object3D;u.add(d),u.scale.set(.04,.04,.04),d._isCharge=!0;var m=function(){e.local.trigger("detonation-start"),r=!0,d.material=t,a*=10;var n=33,l=n/i/1.2;l=.8,TweenLite.to(d.material.uniforms.opacity,1,{value:0,delay:.2}),TweenLite.to(u.scale,.15,{ease:Back.easeIn,delay:.1,x:.5*l,y:.5*l,z:.5*l}),TweenLite.to(u.scale,.6,{x:1.2*l,y:1.2*l,z:1.2*l,delay:.3,onComplete:function(){p()}});var s=0;setTimeout(function(){ns.audioProxy.triggerEvent("clear_path_explosion")},350),setTimeout(function(){e.obstacles.rocks.forEach(function(e){var a=740,t=e.body.body.getPosition().clone().sub(e.body.body.getPosition(),u.position),r=t.length();if(!(r>n)){var i=Math.sqrt(Math.max(0,n-r));a*=i,s+=a,e.body._explosion_deterioration+=a,e.body._explosion_deterioration>e.body._disintegration_point&&o(e);var l=t.normalize(t),c=l.scaleEqual(a),d=e.body.body.getPosition();e.body.body.applyImpulse(d,c),e.body.body.angularVelocity.scaleEqual(0)}});var a=e.local.get("cumulativeForce");e.local.set("cumulativeForce",s+a)},150)},y=Date.now()+1e4*Math.random(),h=function(){r&&(d.material.uniforms.time.value=a*(Date.now()-y))};e.local.on("webgl-update",h),e.local.on("detonate",m);var p=function(){e.local.off("webgl-update",h),e.local.off("detonate",m),e.scene.remove(u)};return{mesh:u,detonate:m,cleanup:p,marker:e.marker}};module.exports=Charge;
},{"../../../../shaders/explosion/explosion-shader":133,"shared/namespace":175}],45:[function(require,module,exports){
var dpr=1;void 0!==window.devicePixelRatio&&(dpr=window.devicePixelRatio);var ChargePlacer=function(e){function r(r,a){var t=r.position||r;i.x=t.x/(window.innerWidth*dpr)*2-1,i.y=2*-(t.y/(window.innerHeight*dpr))+1,n.setFromCamera(i,e.camera);var c=n.intersectObjects(e.scene.children,!0);c.length&&(o=!0);var l;c.forEach(function(e){0!=e.object.material.opacity&&((!l||e.distance<l.distance)&&(l=e),o=!0)}),o?(o=!1,e.local.trigger("addcharge",l.point,r,a)):a(!1)}function a(r){r.originalEvent&&(r=r.originalEvent),i.x=r.pageX/window.innerWidth*2-1,i.y=2*-(r.pageY/window.innerHeight)+1,n.setFromCamera(i,e.camera);var a=n.intersectObjects(e.scene.children,!0);a.forEach(function(a){a.object._isCharge&&(e.local.trigger("moving-marker",a.object._ref.marker,r),a.object._ref.cleanup(),e.local.trigger("move-charge"))})}var n=new THREE.Raycaster,i=new THREE.Vector2,o=!1;e.local.on("mousedown-stage",a),e.local.on("touchstart-stage",a),e.local.on("try-to-place-charge",r)};module.exports=ChargePlacer;
},{}],46:[function(require,module,exports){
function translateX(t,o){for(var r=0;r<t.length/3;r++){var n=3*r;t[n]+=o}return t}function translateY(t,o){for(var r=0;r<t.length/3;r++){var n=3*r+1;t[n]+=o}return t}function translateZ(t,o){for(var r=0;r<t.length/3;r++){var n=3*r+2;t[n]+=o}return t}var Cliff=function(){function t(){var t="maintray",o=["box","box","box","box","box"],r=[70,5,70,100,10,100,15,5,100,15,5,100,15,5,100],n=[0,2,0,-45,40,0,37,7,0,5,5,45,5,5,-45],a=[0,0,0,0,0,-75,0,0,50,0,90,-50,0,90,50],e=["main","","","",""];return n=translateY(n,-6),{name:t,type:o,size:r,pos:n,rot:a,target:e}}function o(){var t="oob",o=n();translateX(o.pos,120),translateY(o.pos,-67);var a=r();translateY(a.pos,-6);var e={type:[],size:[],pos:[],rot:[]};return e.type=e.type.concat(o.type,a.type),e.size=e.size.concat(o.size,a.size),e.pos=e.pos.concat(o.pos,a.pos),e.rot=e.rot.concat(o.rot,a.rot),e.name=t,e}function r(){var t=["box"],o=[100,10,300],r=[0,0,-5],n=[0,0,-3];return{type:t,size:o,pos:r,rot:n}}function n(){var t=["box","box","box","box","box"],o=[80,10,150,80,10,150,80,10,150,80,10,150,80,10,150],r=[40,-10,-75,-40,-10,-75,40,-10,75,-40,-10,75,-45,25,0],n=[12,0,12,12,0,-12,-12,0,12,-12,0,-12,0,0,-55];return{type:t,size:o,pos:r,rot:n}}return{outofbounds:o(),maintray:t()}};module.exports=Cliff;
},{}],47:[function(require,module,exports){
function translateX(t,o){for(var r=0;r<t.length/3;r++){var n=3*r;t[n]+=o}return t}function translateY(t,o){for(var r=0;r<t.length/3;r++){var n=3*r+1;t[n]+=o}return t}function translateZ(t,o){for(var r=0;r<t.length/3;r++){var n=3*r+2;t[n]+=o}return t}var CliffLeft=function(){function t(){var t="maintray",o=["box","box","box","box","box"],r=[70,5,70,100,10,100,15,5,100,15,5,100,15,5,100],n=[0,2,0,45,40,0,-37,7,0,5,5,45,5,5,-45],e=[0,0,0,0,0,75,0,0,-50,0,90,-50,0,90,50],a=["main","","","",""];return n=translateY(n,-6),{name:t,type:o,size:r,pos:n,rot:e,target:a}}function o(){var t="oob",o=n();translateX(o.pos,120),translateY(o.pos,-67);var e=r();translateY(e.pos,-6);var a={type:[],size:[],pos:[],rot:[]};return a.type=a.type.concat(o.type,e.type),a.size=a.size.concat(o.size,e.size),a.pos=a.pos.concat(o.pos,e.pos),a.rot=a.rot.concat(o.rot,e.rot),a.name=t,a}function r(){var t=["box"],o=[100,10,300],r=[0,0,-5],n=[0,0,-3];return{type:t,size:o,pos:r,rot:n}}function n(){var t=["box","box","box","box","box"],o=[80,10,150,80,10,150,80,10,150,80,10,150,80,10,150],r=[40,-10,-75,-40,-10,-75,40,-10,75,-40,-10,75,-45,25,0],n=[12,0,12,12,0,-12,-12,0,12,-12,0,-12,0,0,-55];return{type:t,size:o,pos:r,rot:n}}return{outofbounds:o(),maintray:t()}};module.exports=CliffLeft;
},{}],48:[function(require,module,exports){
require("shared/lib/three.js-master/examples/js/renderers/Projector"),require("shared/lib/three.js-master/examples/js/postprocessing/GlitchPass"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader"),require("shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader"),require("shared/lib/three.js-master/examples/js/shaders/DigitalGlitch"),require("shared/lib/three.js-master/examples/js/shaders/VignetteShader.js"),require("shared/shaders/FilmShader.js"),THREE.GlowShader=require("shared/shaders/GlowShader"),THREE.BarrelBlurShader=require("shared/shaders/BarrelBlurShader");var GlitchPassAlt=require("shared/shaders/GlitchPassAlt"),Effects=function(e){var s=new THREE.EffectComposer(e.renderer),r=new THREE.RenderPass(e.scene,e.camera),a=new THREE.ShaderPass(THREE.CopyShader),l={};return l.glow=new THREE.ShaderPass(THREE.GlowShader),l.barrelBlur=new THREE.ShaderPass(THREE.BarrelBlurShader),l.tiltshift=new THREE.ShaderPass(THREE.VerticalTiltShiftShader),l.film=new THREE.ShaderPass(THREE.FilmShader),l.vignette=new THREE.ShaderPass(THREE.VignetteShader),l.glitchPass=new GlitchPassAlt,l.glitchPass.enabled=!1,l.glitchPass.scalar=0,l.glow.uniforms.amount.value=.4,l.glow.uniforms.size.value=1.2,l.glow.uniforms.darkness.value=.1,l.tiltshift.uniforms.v.value=.001,l.tiltshift.uniforms.r.value=1,l.barrelBlur.uniforms.amount.value=.01,l.vignette.uniforms.offset.value=.8,l.barrelBlur.uniforms.amount.value=.01,l.film.uniforms.sCount.value=1200,l.film.uniforms.sIntensity.value=.15,l.film.uniforms.nIntensity.value=.2,l.film.uniforms.grayscale.value=0,s.addPass(r),s.addPass(l.glow),s.addPass(l.barrelBlur),s.addPass(l.film),s.addPass(l.vignette),s.addPass(l.glitchPass),s.addPass(a),a.renderToScreen=!0,{composer:s,passes:l}};module.exports=Effects;
},{"shared/lib/three.js-master/examples/js/postprocessing/GlitchPass":164,"shared/lib/three.js-master/examples/js/renderers/Projector":169,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/lib/three.js-master/examples/js/shaders/DigitalGlitch":171,"shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader":172,"shared/lib/three.js-master/examples/js/shaders/VignetteShader.js":173,"shared/shaders/BarrelBlurShader":177,"shared/shaders/FilmShader.js":180,"shared/shaders/GlitchPassAlt":181,"shared/shaders/GlowShader":182}],49:[function(require,module,exports){
function translateX(t,o){for(var r=0;r<t.length/3;r++){var a=3*r;t[a]+=o}return t}function translateY(t,o){for(var r=0;r<t.length/3;r++){var a=3*r+1;t[a]+=o}return t}function translateZ(t,o){for(var r=0;r<t.length/3;r++){var a=3*r+2;t[a]+=o}return t}var Flat=function(){function t(){var t="maintray",o=["box","box","box","box","box"],r=[70,5,70,15,5,100,15,5,100,15,5,100,15,5,100],a=[0,-3,0,40,0,0,-40,0,0,0,0,40,0,0,-40],n=[0,0,0,0,0,45,0,0,-45,0,90,-45,0,90,45],e=["main","","","",""];return a=translateY(a,0),{name:t,type:o,size:r,pos:a,rot:n,target:e}}function o(){var t="oob",o=a();translateX(o.pos,100),translateY(o.pos,-1);var n=a();translateX(n.pos,-100),translateY(n.pos,-1);var e=r();translateY(e.pos,-5);var s={type:[],size:[],pos:[],rot:[]};return s.type=s.type.concat(o.type,n.type,e.type),s.size=s.size.concat(o.size,n.size,e.size),s.pos=s.pos.concat(o.pos,n.pos,e.pos),s.rot=s.rot.concat(o.rot,n.rot,e.rot),s.name=t,s}function r(){var t=["box","box"],o=[50,10,300,50,10,300],r=[24,0,-5,-24,0,-5],a=[0,0,-4,0,0,4];return{type:t,size:o,pos:r,rot:a}}function a(){var t=["box","box","box","box"],o=[50,10,150,50,10,150,50,10,150,50,10,150],r=[25,-10,-75,-25,-10,-75,25,-10,75,-25,-10,75],a=[5,0,12,5,0,-12,-5,0,12,-5,0,-12];return{type:t,size:o,pos:r,rot:a}}return{outofbounds:o(),maintray:t()}};module.exports=Flat;
},{}],50:[function(require,module,exports){
var paths=require("shared/paths"),MiniMap=function(e){var t,a,n=e.scene,o=e.size||new THREE.Vector2,i=e.position||new THREE.Vector2,r=!1;window._minimap=this,t=new THREE.OrthographicCamera(0,o.x,o.y/2,-o.y/2,-5e3,1e4),t.up=new THREE.Vector3(0,0,-1),t.lookAt(new THREE.Vector3(0,-1,0)),t.rotation.z=Math.PI/2;var s=new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(paths.IMGS+"clear-path/focus.png"),transparent:!0}),p=600,E=new THREE.PlaneGeometry(p,p);a=new THREE.Mesh(E,s),a.position.y=3200,a.rotation.x=-Math.PI/2,n.add(a);var E=new THREE.PlaneGeometry(2e3,2e3);console.clear(),console.log(paths.IMGS+"clear-path/"+e.data.map+".png");var c=THREE.ImageUtils.loadTexture(paths.IMGS+"clear-path/"+e.data.map+".png"),h=new THREE.Mesh(E,new THREE.MeshBasicMaterial({map:c}));h.position.y=2900,h.position.z=-1e3,h.rotation.x=-Math.PI/2,h.rotation.z=Math.PI/2,n.add(h);var d=function(e){var t=new THREE.MeshBasicMaterial({color:4503773,wireframe:!1,transparent:!0,opacity:.5}),a=new THREE.Mesh(e,t);a.position.y=3e3,n.add(a)},w=function(e){var t=new THREE.MeshBasicMaterial({color:16763653}),a=40,o=32,i=new THREE.CircleGeometry(a,o),r=new THREE.Mesh(i,t);r.position.copy(e),r.rotation.x=-Math.PI/2,r.position.y=3100,n.add(r)},l=function(e){o.x&&r&&(e.setViewport(i.x,i.y,o.x,o.y),e.setScissor(i.x,i.y,o.x,o.y),e.enableScissorTest(!0),e.render(n,t),e.setViewport(0,0,window.innerWidth,window.innerHeight),e.enableScissorTest(!1))},M=function(){var e={t:0};TweenLite.to(e,.5,{t:1,onUpdate:function(){r=!r},onComplete:function(){r=!0}})};_.extend(this,{camera:t,render:l,addMarker:w,addGeometry:d,enter:M,position:i,size:o,focus:a})};module.exports=MiniMap;
},{"shared/paths":176}],51:[function(require,module,exports){
var Noise=require("shared/lib/ImprovedNoise");require("shared/lib/three.js-master/examples/js/exporters/OBJExporter"),require("shared/lib/three.js-master/examples/js/loaders/OBJLoader");var Map=function(e){function r(e){a()}function a(){var r=e.data.map,a=new THREE.JSONLoader;a.load("assets/models/games/clear-path/"+r+".js",function(r){var a=new THREE.MeshBasicMaterial({wireframe:!0,color:16777215,transparent:!0,opacity:.15}),s=["a","b","c"];_.forEach(r.faces,function(e,a){for(var o=new THREE.Color,t=0;3>t;t++){var i=e[s[t]],n=r.vertices[i].y/250;n=.15*n,o.setHSL(.3,0,n),e.vertexColors[t]=o;r.vertices[i]}}),e.holder.add(new THREE.Mesh(r,a));var t=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors});o=new THREE.Mesh(r,t),o.position.z=-1,e.holder.add(o),e.local.trigger("mountains-drawn")})}var o;new Noise,new THREE.Vector2(e.dimension,e.dimension),new THREE.Vector2(80,80),e.road;return r(),{}};module.exports=Map;
},{"shared/lib/ImprovedNoise":157,"shared/lib/three.js-master/examples/js/exporters/OBJExporter":160,"shared/lib/three.js-master/examples/js/loaders/OBJLoader":161}],52:[function(require,module,exports){
require("shared/lib/Oimo/build/Oimo.js");var client=require("shared/utils/client/client"),isMobile="mobile"===client.device.type||"tablet"===client.device.type,Obstacles=function(e){function i(){for(var i=0;i<c.length;i++){var t=c[i],n=t.material,l=t.mass,m=t.display_mass,h=t.dimensions,p=t.disintegration_point,u=o({rockMaterial:n,radius:h,mass:l,display_mass:m,dis_point:p});a({data:t,mesh:u});var y={x:180*Math.random()-90,y:180*Math.random()-90,z:180*Math.random()-90},b=r({mesh:u,radius:h,dimensions:t.dimensions,mass:l,rot:y,rockMaterial:n,focused:t.focused,disintegration_point:p},i);d.push({object:b,mesh:u})}e.local.on("detonation-start",s)}function s(){e.level==e.local.get("currentLevel")&&d.forEach(function(e){e.body.body.isStatic=!1,e.body.body.isDynamic=!0})}function o(e){var i,s,o,a=new THREE.SphereGeometry(e.radius,6,6);if(isMobile){switch(e.rockMaterial){case"limestone":i=5592405;break;case"greywhacke":i=3355443;break;case"granite":i=1579032}s=new THREE.MeshBasicMaterial({color:i}),o=.1}else{switch(e.rockMaterial){case"limestone":i=10066329;break;case"greywhacke":i=6710886;break;case"granite":i=3355443}s=new THREE.MeshPhongMaterial({color:i,shading:THREE.FlatShading}),o=.1}var r=new THREE.MeshBasicMaterial({wireframe:!0,transparent:!0,opacity:o}),t=new THREE.Object3D;t._rockColor=i,t._isRock=!0,t._rockMaterial=e.rockMaterial,t._rockCubicFeet=e.radius,t._rockMass=e.mass,t._rockDisplayMass=e.display_mass,t._rockDisPoint=e.dis_point;var n=new THREE.Mesh(a,r);n.clickTarget=t;var c=new THREE.Mesh(a,s);return c.scale.set(.99,.99,.99),n.clickTarget=t,t.add(n),t.add(c),t}function a(e){e.mesh.position.set(e.data.x,e.data.y,e.data.z)}function r(i,s){var o=[i.mass,1e5,0,1,4294967295],a={config:{type:"sphere",size:[i.radius],pos:[i.mesh.position.x,i.mesh.position.y,i.mesh.position.z],rot:[i.rot.x,i.rot.y,i.rot.z],move:!0,world:e.physics.world,config:o,name:"rock_"+e.level+"_"+s},props:{_isRock:!0,_rockMaterial:i.rockMaterial,_rockCubicFeet:i.radius,_disintegration_point:i.disintegration_point,_explosion_deterioration:0}};return a}function t(){d.forEach(function(i){var s=new OIMO.Body(i.object.config);s.body.isStatic=!0,s.body.isDynamic=!1,_.extend(s,i.object.props),i.body=s,s.body._mesh=i.mesh,i.mesh.rotation.needsUpdate=!0,e.scene.add(i.mesh),e.physics.add(i)})}function n(){d.forEach(function(i){i.mesh.remove(i.mesh.children[0]),i.mesh.remove(i.mesh.children[1]),e.scene.remove(i.mesh),e.physics.world.removeRigidBody(i.body.body),e.physics.remove(i)})}_.extend(this,e);var c=(e.config.obstacles,e.config.clusters[e.clusterID]),d=[];return i(),{rocks:d,add:t,remove:n}};module.exports=Obstacles;
},{"shared/lib/Oimo/build/Oimo.js":158,"shared/utils/client/client":190}],53:[function(require,module,exports){
function toRad(e){return Math.PI/180*e}function toDeg(e){return e*(180/Math.PI)}var UShape=require("./ushape"),Cliff=require("./cliff"),CliffLeft=require("./cliffleft"),Flat=require("./flat");require("shared/lib/three.js-master/examples/js/exporters/OBJExporter");var ObstacleTerrain=function(e){function t(){r(),o()}function r(){var t;switch(e.shape){case"u":t=UShape;break;case"cliff":t=Cliff;break;case"cliffleft":t=CliffLeft;break;case"flat":t=Flat}f=new t}function o(){c=a(_.extend(f.maintray,l))}function a(t){var r=t,o=r.type.length,a=[];for(r.target||(r.target=[]);o--;){var n=3*o,s=new THREE.Mesh(new THREE.BoxGeometry(r.size[n],r.size[n+1],r.size[n+2]),new THREE.MeshNormalMaterial({transparent:!0,opacity:0}));s.position.set(r.pos[n],r.pos[n+1],r.pos[n+2]),s.rotation.set(toRad(r.rot[n]),toRad(r.rot[n+1]),toRad(r.rot[n+2])),i(s);var f=s.position,c=s.rotation,l=(e.registration.rotation,{name:r.name,move:!1,world:r.world,config:r.config,type:r.type[o],size:[r.size[n],r.size[n+1],r.size[n+2]],pos:[f.x,f.y,f.z],rot:[toDeg(c.x),toDeg(c.y),toDeg(c.z)],target:r.target[o]});a.push(l),d.add(s)}return{objects:a,bodies:[],mesh:d}}function i(t){e.registration.add(t),e.registration.updateMatrixWorld(!0);var r=new THREE.Vector3,o=new THREE.Quaternion,a=new THREE.Vector3;t.matrixWorld.decompose(r,o,a),t.position.copy(r),t.quaternion.copy(o)}function n(){c.objects.forEach(function(e,t){var r=new OIMO.Body(e);r.body.target=e.target,c.bodies.push(r)})}function s(){c.bodies.forEach(function(t){e.physics.world.removeRigidBody(t.body)})}var f,c,d=new THREE.Object3D,l={move:!1,world:e.world,config:[1,1,0,1,4294967295]};return t(),{maintray:c,add:n,remove:s}};module.exports=ObstacleTerrain;
},{"./cliff":46,"./cliffleft":47,"./flat":49,"./ushape":59,"shared/lib/three.js-master/examples/js/exporters/OBJExporter":160}],54:[function(require,module,exports){
function toRad(o){return Math.PI/180*o}function toDeg(o){return o*(180/Math.PI)}var OutofBounds=function(o){function e(){y.forEach(a)}function a(e){var a={name:"oob",move:!1,world:o.world,config:[1,1,0,1,4294967295],type:"box",size:[e.scale.x,e.scale.y,e.scale.z],pos:[e.position.x,e.position.y,e.position.z],rot:[toDeg(e.rotation.x),toDeg(e.rotation.y),toDeg(e.rotation.z)]};new OIMO.Body(a)}function n(e){var a=new THREE.BoxGeometry(1,1,1),n=new THREE.Mesh(a,new THREE.MeshLambertMaterial({color:new THREE.Color(3355443)}));n._isOOB=!0,o.scene.add(n),n.scale.set(50,5,50),f&&(n.position.set(f.position.x,f.position.y+15,f.position.z),n.rotation.set(f.rotation.x,f.rotation.y,f.rotation.z),n.scale.set(f.scale.x,f.scale.y,f.scale.z)),e&&(f&&(f.material.color=new THREE.Color(3355443)),f=n,f.material.color=new THREE.Color(5592388))}function t(e){d.x=e.clientX/window.innerWidth*2-1,d.y=2*-(e.clientY/window.innerHeight)+1,k.setFromCamera(d,o.camera);var a=k.intersectObjects(o.scene.children,!0);a.length&&(w=!0);var n;a.forEach(function(o){o.object._isOOB&&((!n||o.distance<n.distance)&&(n=o.object),w=!0)}),w&&n?(w=!1,f&&(f.material.color=new THREE.Color(3355443)),f=n,f.material.color=new THREE.Color(5592388)):(f&&(f.material.color=new THREE.Color(3355443)),f=null)}function c(o,e){r("position",o,e,1*h)}function i(o,e){r("rotation",o,e,.005*h)}function s(o,e){r("scale",o,e,.1*h)}function r(o,e,a,n){a?f[o][e]+=n:f[o][e]-=n}function l(){console.log(f)}function b(o){x=o}function u(e){var a=!1;switch(e.keyCode){case 32:n(!0);break;case 68:f?o.scene.remove(f):console.log("no mesh selected");break;case 13:p();break;case 73:l();break;case 80:b("position");break;case 83:b("scale");break;case 82:b("rotation");break;case 37:a=["x",!1];break;case 38:a=["y",!0];break;case 39:a=["x",!0];break;case 40:a=["y",!1];break;case 188:a=["z",!1];break;case 190:a=["z",!0];break;case 49:h=1;break;case 50:h=4;break;case 51:h=8;break;case 52:h=16;break;case 53:h=32;break;case 54:h=40;break;case 55:h=80;break;case 56:h=160;break;case 57:h=320}a&&("rotation"===x?i.apply(this,a):"scale"===x?s.apply(this,a):c.apply(this,a))}function p(){console.log("save out objects");var e=[];o.scene.children.forEach(function(o){if(o._isOOB){var a={};a.position={x:o.position.x,y:o.position.y,z:o.position.z},a.rotation={x:o.rotation.x,y:o.rotation.y,z:o.rotation.z},a.scale={x:o.scale.x,y:o.scale.y,z:o.scale.z},e.push(a)}}),console.save(e)}var y=(o.dimension,o.oob),E=!0;e();var f,k=new THREE.Raycaster,d=new THREE.Vector2,w=!1,h=1,x="position";E&&(o.local.on("click-stage",t),$("body").on("keyup",u))};module.exports=OutofBounds;
},{}],55:[function(require,module,exports){
require("shared/lib/Oimo/build/Oimo.js");var PhysicsInterface=function(n){function o(){r=!1}function e(){r=!0}var i,t=n.local,c=[],r=!0,s=function(){u(),a()},u=function(){i=new OIMO.World(1/160,2,8)},a=function(){t.on("webgl-update",d),t.on("detonation-start",o),t.on("disable-physics",e)},d=function(){i.step();for(var n,o,e=c.length;e--;)n=c[e].body.body,o=c[e].mesh,n.sleeping||(o.position.copy(n.getPosition()),o.quaternion.copy(n.getQuaternion()))},f=function(n){c.push(n)},l=function(n){c.forEach(function(o,e){n.body.name===o.body.name&&c.splice(e,1)})};return s(),{add:f,remove:l,world:i,objects:c}};module.exports=PhysicsInterface;
},{"shared/lib/Oimo/build/Oimo.js":158}],56:[function(require,module,exports){
var Road=function(e){function r(){a()}function a(){var r=e.config.maps[e.data.map].road_curve,a=[];r.forEach(function(e){a.push(new THREE.Vector3(e[0],e[1],e[2]))}),n=new THREE.SplineCurve3(a);var c=[];c.push(new THREE.Vector2(0,0)),c.push(new THREE.Vector2(0,u/2)),c.push(new THREE.Vector2(-1,0)),c.push(new THREE.Vector2(0,-u/2));var s=new THREE.Shape(c);t=new THREE.TubeGeometry.FrenetFrames(n,200);var w={steps:200,bevelEnabled:!1,extrudePath:n,frames:t};E=new THREE.ExtrudeGeometry(s,w);var R=new THREE.MeshBasicMaterial({color:3355443,wireframe:!1});o=new THREE.Mesh(E,R),e.holder.add(o)}var E,n,o,t,u=50;return r(),{geometry:E,curve:n,width:u,frames:t}};module.exports=Road;
},{}],57:[function(require,module,exports){
var RockSelector=function(e){function c(c){if(e.local.get("cameraMoved"))return void e.local.set("cameraMoved",!1);r.x=c.clientX/window.innerWidth*2-1,r.y=2*-(c.clientY/window.innerHeight)+1,t.setFromCamera(r,e.camera);var o=t.intersectObjects(e.scene.children,!0);o.length&&(a=!0);var n;o.forEach(function(e){e.object.clickTarget&&((!n||e.distance<n.distance)&&(n=e.object),a=!0)}),a&&n&&n.clickTarget&&(a=!1,e.local.trigger("select-rock",n.clickTarget))}var t=new THREE.Raycaster,r=new THREE.Vector2,a=!1;e.local.on("click-stage",c)};module.exports=RockSelector;
},{}],58:[function(require,module,exports){
var ATUtil=require("shared/utils/general-utils"),Stars=function(e){function t(){e.local.on("webgl-update",r),n=new THREE.Object3D,e.scene.add(n),i=new THREE.Geometry;var t=THREE.ImageUtils.loadTexture("assets/imgs/site-webgl/star.png");o=new THREE.PointCloudMaterial({size:16,map:t,blending:THREE.AdditiveBlending,depthWrite:!0,transparent:!0,opacity:.7}),o.particleHue=Math.random(),o.color=new THREE.Color(16777215),o.color.setHSL(o.particleHue,1,1);for(var a=5e3,u=0;l>u;u++){var E=new THREE.Vector3(ATUtil.randomRange(-a,a),ATUtil.randomRange(550,850),ATUtil.randomRange(c,d));i.vertices.push(E),E.initPos=Math.random()}s=new THREE.PointCloud(i,o),s.sortParticles=!1,e.scene.add(s)}function r(){u+=.015;for(var e=0;l>e;e++){var t=Math.abs((i.vertices[e].initPos+.006*u)%1),r=(1-t)*(c-d)-c;i.vertices[e].z=r}i.verticesNeedUpdate=!0}function a(e,t){TweenMax.to(o,t,{opacity:e})}var n,i,o,s,l=1e3,d=6e3,c=-6e3,u=0;return{init:t,update:r,getGroupHolder:function(){return n},fade:a}};module.exports=Stars;
},{"shared/utils/general-utils":193}],59:[function(require,module,exports){
function translateX(t,o){for(var r=0;r<t.length/3;r++){var a=3*r;t[a]+=o}return t}function translateY(t,o){for(var r=0;r<t.length/3;r++){var a=3*r+1;t[a]+=o}return t}function translateZ(t,o){for(var r=0;r<t.length/3;r++){var a=3*r+2;t[a]+=o}return t}var UShape=function(t){function o(){var t="maintray",o=["box","box","box","box","box"],r=["main","","","",""],a=[70,5,70,100,10,100,100,10,100,100,10,10,100,10,10],e=[0,0,0,-38,20,0,38,20,0,0,5,45,0,5,-45],n=[0,0,0,0,0,-58,0,0,58,-40,0,0,40,0,0];return e=translateY(e,-5),{name:t,type:o,size:a,pos:e,rot:n,target:r}}function r(){var t="oob",o=e();translateX(o.pos,50),translateY(o.pos,-12),translateZ(o.pos,95);var r=e();translateX(r.pos,50),translateY(r.pos,-12),translateZ(r.pos,-95);var n=e();translateX(n.pos,-50),translateY(n.pos,-12),translateZ(n.pos,95);var s=e();translateX(s.pos,-50),translateY(s.pos,-12),translateZ(s.pos,-95);var p=a();translateY(p.pos,-7);var i={type:[],size:[],pos:[],rot:[]};return i.type=i.type.concat(o.type,r.type,n.type,s.type,p.type),i.size=i.size.concat(o.size,r.size,n.size,s.size,p.size),i.pos=i.pos.concat(o.pos,r.pos,n.pos,s.pos,p.pos),i.rot=i.rot.concat(o.rot,r.rot,n.rot,s.rot,p.rot),i.name=t,i}function a(){var t=["box","box"],o=[30,10,240,30,10,240],r=[15,0,0,-15,0,0],a=[0,0,-4,0,0,4];return{type:t,size:o,pos:r,rot:a}}function e(){var t=["box","box","box","box"],o=[30,10,50,30,10,50,30,10,50,30,10,50],r=[15,0,25,-15,0,25,15,0,-25,-15,0,-25],a=[-12,0,12,-12,0,-12,12,0,12,12,0,-12];return{type:t,size:o,pos:r,rot:a}}return{outofbounds:r(),maintray:o()}};module.exports=UShape;
},{}],60:[function(require,module,exports){
require("shared/lib/three.js-master/examples/js/controls/OrbitControls");var Road=require("./road"),Mountains=require("./mountains"),ObstacleTerrain=require("./obstacleterrain"),OutOfBounds=require("./outofbounds"),Obstacles=require("./obstacles"),ChargePlacer=require("./chargeplacer"),Charge=require("./charge"),Effects=require("./effects"),Physics=require("./physicsinterface.js"),objectAlongPath=require("../utils/objectalongpath"),RockSelector=require("./rockselector"),MiniMap=require("./minimap"),client=require("shared/utils/client/client"),ns=require("shared/namespace"),flickerTransition=require("shared/flickertransition"),Stars=require("./stars"),dpr=1;void 0!==window.devicePixelRatio&&(dpr=window.devicePixelRatio);var ClearPathWebGL=function(e){function n(){q=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,3e4),q.position.y=30,k=new THREE.Scene,z=new THREE.WebGLRenderer({canvas:K}),z.setClearColor((new THREE.Color).setRGB(.13,.13,.13)),z.setSize(window.innerWidth,window.innerHeight);var e=new THREE.SphereGeometry(500,30,30),n=new THREE.MeshBasicMaterial({color:16777215}),t=new THREE.Mesh(e,n);t.position.y=4e3,t.position.x=-1500,t.position.z=-1e4,k.add(t)}function t(){O=new Physics({local:U})}function o(){V=new Effects({scene:k,camera:q,renderer:z})}function i(){U.on("addcharge",m),U.on("change-camera-view",c),U.on("click-stage",function(){}),U.on("mountains-drawn",x),U.on("detonate",v),U.on("select-rock",r),U.on("unselect-rock",a),U.on("mousemove-stage",s),window.addEventListener("resize",P,!1),P()}function r(e){return B?(a(B),void setTimeout(function(){r(e)},1e3)):(B=e,void TweenLite.to(e.children[1].material.color,.6,{r:.75,g:.85,b:.95}))}function a(e){B=null;var n=new THREE.Color(e._rockColor);TweenLite.to(e.children[1].material.color,.6,{r:n.r,g:n.g,b:n.b})}function s(e){if(!U.get("cameraMoving")){TweenLite.killTweensOf(q.position),U.set("cameraMoved",!0),ae=!0;var n=U.get("currentLevel"),t=F.maps[J.map],o=t["level"+n].point_on_path,i=l(o+-.03).position,r=l(o+-.005).position;r.y+=120;var a=l(o+.03).position,s=l(o).position;I=new THREE.SplineCurve3([i,r,a]),re+=.001*e,re=Math.max(0,Math.min(1,re)),U.trigger("currentCameraViewPercent",re);var c=I.getPointAt(re);q.position.copy(c),q.lookAt(s)}}function c(e){if(N){var n=U.get("currentLevel"),t=F.maps[J.map],o=t["level"+n].point_on_path,i=0,r=0;switch(parseInt(e)){case 1:i=-.03;break;case 2:r=120,i=-.005;break;case 3:i=.03}var a=l(o+i).position;a.y+=r;var s=l(o).position;TweenLite.to(q.position,4,{x:a.x,y:a.y,z:a.z,ease:Power3.easeOut,onUpdate:function(){q.lookAt(s)}})}}function l(e){var n=new THREE.Vector3(0,0,0),t=new THREE.Vector3(0,0,0),o=objectAlongPath(null,S.curve,e,S.frames,n,t,30,!0);return o}function d(){j=new MiniMap({size:new THREE.Vector2(ne,ne),position:new THREE.Vector2,scene:k,data:J})}function u(){var n=new THREE.Object3D;k.add(n),n.position.y=-10,S=new Road({scene:e.scene,holder:n,local:U,data:J,config:F}),j&&j.addGeometry(S.geometry)}function p(){for(var e=F.maps[J.map],n=1;4>n;n++){var t=new THREE.Object3D;k.add(t),t.position.y=30;var o=new THREE.Vector3,i=new THREE.Vector3;objectAlongPath(t,S.curve,e["level"+n].point_on_path,S.frames,o,i,-8,!0);var r=new ObstacleTerrain({local:U,scene:k,data:J,config:F,registration:t,shape:e["level"+n].terrain,world:O.world});k.add(r.maintray.mesh),ee["_"+n]=r}}function g(){for(var e=F.maps[J.map],n=1;4>n;n++){var t=new THREE.Object3D;k.add(t),t.position.y=30;var o=new THREE.Vector3,i=new THREE.Vector3;objectAlongPath(t,S.curve,e["level"+n].point_on_path,S.frames,o,i,18,!0),Z["_"+n]=new Obstacles({scene:k,local:U,registration:t,clusterID:J["cluster"+n],config:F,physics:O,level:n}),k.remove(t),j&&j.addMarker(t.position)}}function w(){var n=new THREE.Object3D;n.position.z=-ne/2,k.add(n),G=new Mountains({scene:k,holder:n,local:U,road:S,dimension:ne,data:J,config:F,world:O.world});new OutOfBounds({scene:k,camera:q,holder:n,local:U,dimension:ne,data:J,config:F,world:O.world,oob:e.config.maps[J.map].oob})}function f(){W=new ChargePlacer({scene:k,local:U,camera:q})}function h(){D=new RockSelector({scene:k,local:U,camera:q})}function m(n,t,o){var i=new Charge({scene:k,local:e.local,obstacles:A.obstacles,physics:O,marker:t});i.mesh._ref=i,i.mesh.children[0]._ref=i,i.mesh.position.copy(n),k.add(i.mesh),o(!0,i),ns.audioProxy.triggerEvent("place_bomb"),Q.push(i)}function v(){if(Q.length){setTimeout(E,7e3);var e=.4*Q.length,n=.4*Q.length;setTimeout(function(){te||(V.passes.glitchPass.enabled=!0,TweenMax.to(V.passes.glitchPass,.3,{scalar:e,onComplete:function(){TweenMax.to(V.passes.glitchPass,n,{scalar:0,onComplete:function(){V.passes.glitchPass.enabled=!1,Q=[]}})}}))},250)}}function E(){for(var e=O.world.contacts,n=[],t=0;e;)e.touching&&("maintray"==e.body2.name&&"main"==e.body2.target?!_.contains(n,e.body1.name)&&e.body1._mesh.children[1]&&(n.push(e.body1.name),t+=e.body1.mass):"maintray"==e.body1.name&&"main"==e.body1.target),e=e.next;var o=1100;o=200,console.log("check current level","charges left",U.get("chargesLeft")),U.get("currentLevel")<3?U.get("chargesLeft")<1?U.trigger("lose"):o>t?(b(),U.trigger("detonation-finished",!0)):U.trigger("detonation-finished"):U.get("chargesLeft")<1&&t>=o?U.trigger("lose"):o>t?(b(),U.trigger("disable-physics")):U.trigger("detonation-finished")}function b(){var e=U.get("currentLevel")+1;e>3?T():y(e)}function T(){U.trigger("detonation-finished",!0),U.set("cameraMoving",!0),ns.audioProxy.triggerEvent("vehicle_start");var e=new THREE.Vector3,n=new THREE.Vector3,t=F.maps[J.map].level3.point_on_path-.03,o=F.maps[J.map].level3.point_on_path+.1,i={t:t},r=8;TweenLite.to(i,r,{t:o,ease:Power2.easeInOut,onUpdate:function(){objectAlongPath(q,S.curve,i.t,S.frames,e,n,30,!0,o)},onComplete:function(){U.set("cameraMoving",!1),ns.audioProxy.triggerEvent("vehicle_stop")}}),setTimeout(function(){U.trigger("win")},1e3*r*.5)}function y(e){U.set("currentLevel",e),setTimeout(function(){Z["_"+(e-1)]&&Z["_"+(e-1)].remove()},1e4),Z["_"+e].add(),ee["_"+e].add();var n=F.maps[J.map];A={obstacles:Z["_"+e],obstacleterrain:ee["_"+e],point_on_path:n["level"+e].point_on_path},H()}function R(){var e=new THREE.Vector3,n=new THREE.Vector3;objectAlongPath(q,S.curve,0,S.frames,e,n,30,!0,0)}function H(){U.set("cameraMoving",!0),re=0,ns.audioProxy.triggerEvent("vehicle_start");var e=new THREE.Vector3,n=new THREE.Vector3,t=F.maps[J.map],o=U.get("currentLevel"),i=0;o>1&&(i=t["level"+(o-1)].point_on_path-.03);var r=t["level"+o].point_on_path-.03,a={t:i},s=15;-1!==window.location.search.indexOf("fast")&&(s=1),TweenLite.to(a,s,{t:r,ease:Power2.easeInOut,onUpdate:function(){objectAlongPath(q,S.curve,a.t,S.frames,e,n,30,!0,r)},onComplete:function(){U.set("cameraMoving",!1),ns.audioProxy.triggerEvent("vehicle_stop")}})}function P(){if(X.w=window.innerWidth,X.h=window.innerHeight,q.aspect=X.w/X.h,q.updateProjectionMatrix(),z.setSize(X.w,X.h),V&&V.composer.setSize(window.innerWidth*dpr,window.innerHeight*dpr),j){var n=e.parent.find(".panel.map-panel"),t=n.width(),o=n.offset(),i=window.innerHeight-o.top-t-42;j.size.set(t,t),j.position.set(o.left,i)}}function L(){Y||(window.requestAnimationFrame(L),M())}function M(){V?V.composer.render(.1):z.render(k,q),j&&(j.focus.position.x=q.position.x,j.focus.position.z=q.position.z,j.render(z)),U.trigger("webgl-update")}function x(){setTimeout(function(){flickerTransition("in",function(){U.trigger("ui:enter")},$("#main"),0),$(K).addClass("entering")},500),setTimeout(function(){j&&j.enter()},14400),setTimeout(function(){N=!0,y(1)},10)}function C(){Y=!0}var k,q,O,j,V,z,A,S,G,W,D,B,I,U=e.local,F=e.config,J=e.data,K=e.parent.find("canvas")[0],N=!1,Q=[],X={},Y=!1,Z={},ee={},ne=2e3,te="mobile"===client.device.type||"tablet"===client.device.type,oe=function(){n(),t(),te||(ie(),o(),d()),u(),p(),g(),i(),w(),f(),h(),L(),R(),window.stars=new Stars({webGLMain:this,local:U,scene:k}),window.stars.init()},ie=function(){var e=new THREE.PointLight(16777215,1,2e3);e.position.set(-100,270,350),k.add(e);var n=new THREE.PointLight(16777215,1,4e3);n.position.set(0,400,-1e3),k.add(n);var t=new THREE.PointLight(3351057,1,4e3);t.position.set(-550,-150,200),k.add(t)},re=0,ae=!1;return oe(),{exit:C,addCharge:m}};module.exports=ClearPathWebGL;
},{"../utils/objectalongpath":40,"./charge":44,"./chargeplacer":45,"./effects":48,"./minimap":50,"./mountains":51,"./obstacles":52,"./obstacleterrain":53,"./outofbounds":54,"./physicsinterface.js":55,"./road":56,"./rockselector":57,"./stars":58,"shared/flickertransition":155,"shared/lib/three.js-master/examples/js/controls/OrbitControls":159,"shared/namespace":175,"shared/utils/client/client":190}],61:[function(require,module,exports){
"use strict";var threeUtils=require("shared/utils/three-utils"),utils=require("shared/utils/general-utils"),constants=require("./constants"),ns=require("shared/namespace"),Body=function(e,a,t,l,n,r){var s,o,u,i,c,d,v,f,y,p=constants.isMobile,m=p?.5:1,w=p?.5:.85,T=p?.12:.06,x=10,g=Quint.easeOut,M=!1,R=function(){s=this,_.extend(this,Backbone.Events),o=new THREE.Object3D,o.scale.set(m,m,m),b(),C(),H(),E(),h()},h=function(){var a=!1;_.each(e.ailments,function(e){r[e].amputated&&(a=!0)}),i.amputated.value=a?1:0,d.amputated.value=a?1:0},E=function(){f={color:{type:"c",value:new THREE.Color(16777215)},opacity:{type:"f",value:.15},scalar1:{type:"f",value:1},scalar2:{type:"f",value:1},scalar3:{type:"f",value:1},scalar4:{type:"f",value:1},scalar5:{type:"f",value:1},time:{type:"f",value:0}},y={scalarIndex:{type:"f",value:[]},position2:{type:"v3",value:[]}};for(var e,a,l,n=new THREE.ShaderMaterial({uniforms:f,attributes:y,vertexShader:require("../../../shaders/field-medicine/body-face-vertex.glsl"),fragmentShader:require("../../../shaders/field-medicine/body-face-fragment.glsl"),transparent:!0,blending:THREE.AdditiveBlending}),r=t,s=Math.floor(1*r.faces.length),u=_.sample(r.faces,s),i=r.vertices,c=new THREE.Geometry,d=0,v=0;s>v;v++)e=u[v],c.vertices.push(i[e.a],i[e.b],i[e.c]),c.faces.push(new THREE.Face3(d,d+1,d+2,e.normal)),l=5*Math.random()|0,y.scalarIndex.value.push(l,l,l),a=(new THREE.Vector3).add(i[e.a]).add(i[e.b]).add(i[e.c]).divideScalar(3),y.position2.value.push(a,a,a),d+=3;var p=new THREE.Mesh(c,n);o.add(p)},b=function(){i={color:{type:"c",value:new THREE.Color(16777215)},map:{type:"t",value:THREE.ImageUtils.loadTexture(constants.imagePath+"particle.png")},opacity:{type:"f",value:0},size:{type:"f",value:p?.1:.2},scalar1:{type:"f",value:x},scalar2:{type:"f",value:x},scalar3:{type:"f",value:x},scalar4:{type:"f",value:x},scalar5:{type:"f",value:x},time:{type:"f",value:0},amputated:{type:"f",value:0}},c={index:{type:"f",value:[]},offset:{type:"v3",value:[]}};var e,t,l=new THREE.ShaderMaterial({uniforms:i,attributes:c,vertexShader:require("../../../shaders/field-medicine/body-particle-vertex.glsl"),fragmentShader:require("../../../shaders/field-medicine/body-particle-fragment.glsl"),transparent:!0,depthWrite:!1}),n=new THREE.Geometry,r=a.vertices,s=r.length;for(t=0;s>t;t++)c.index.value.push(5*Math.random()|0),c.offset.value.push(threeUtils.getRandomVector3(-20,20)),n.vertices.push(r[t].clone());e=new THREE.PointCloud(n,l),o.add(e)},A=function(){var e='"use strict";self.addEventListener("message",function(e){for(var t,a=e.data.vertices,s=[],n=a.length,r=e.data.maxDistance||1,i=e.data.minDistance||.5,c=0;n>c;c++)for(var d=0;n>d;d++)t=distance(a[c],a[d]),c!==d&&r>=t&&t>=i&&s.push(a[c],a[d]);postMessage({vertices:s}),close()},!1);var distance=function(e,t){var a=t.x-e.x,s=t.y-e.y,n=t.z-e.z;return Math.sqrt(a*a+s*s+n*n)};',a=new Blob([e],{type:"text/javascript"});return a},H=function(){d={color:{type:"c",value:new THREE.Color(16777215)},opacity:{type:"f",value:0},scalar1:{type:"f",value:0},scalar2:{type:"f",value:0},scalar3:{type:"f",value:0},scalar4:{type:"f",value:0},scalar5:{type:"f",value:0},scalarAlt1:{type:"f",value:0},scalarAlt2:{type:"f",value:0},scalarAlt3:{type:"f",value:0},scalarAlt4:{type:"f",value:0},scalarAlt5:{type:"f",value:0},time:{type:"f",value:0},amputated:{type:"f",value:0}},v={scalarIndex:{type:"f",value:null},scalarAltIndex:{type:"f",value:null},offset:{type:"v3",value:null}};var e,t=new THREE.ShaderMaterial({uniforms:d,attributes:v,vertexShader:require("../../../shaders/field-medicine/body-line-vertex.glsl"),fragmentShader:require("../../../shaders/field-medicine/body-line-fragment.glsl"),linewidth:1,transparent:!0}),l=new THREE.BufferGeometry,n=a.vertices,r=A(),u=new Worker(URL.createObjectURL(r));u.onmessage=function(a){for(var n,r=a.data.vertices,i=r.length,c=new Float32Array(3*i),d=new Float32Array(i),v=new Float32Array(i),f=new Float32Array(3*i),y=0;i>y;y++)c[3*y+0]=r[y].x,c[3*y+1]=r[y].y,c[3*y+2]=r[y].z,d[y]=5*Math.random()|0,v[y]=5*Math.random()|0,n=threeUtils.getRandomVector3(-20,20),f[3*y+0]=n.x,f[3*y+1]=n.y,f[3*y+2]=n.z;l.addAttribute("position",new THREE.BufferAttribute(c,3)),l.addAttribute("offset",new THREE.BufferAttribute(f,3)),l.addAttribute("scalarIndex",new THREE.BufferAttribute(d,1)),l.addAttribute("scalarAltIndex",new THREE.BufferAttribute(v,1)),l.computeBoundingSphere(),e=new THREE.Line(l,t,THREE.LinePieces),o.add(e),u.terminate(),s.trigger("ready")},u.postMessage({vertices:n,minDistance:5,maxDistance:6.5})},O=function(e){var a,t=new THREE.Vector3,l=100;return r[e]&&(a=r[e].position3d,t.x=a.x,t.y=a.y,t.z=a.z,t.multiplyScalar(l)),t},C=function(){var a=e.ailments,t=a.length;u=[];for(var l=0;t>l;l++){var n=new THREE.Object3D;n.position.copy(O(a[l])),o.add(n),u.push(n)}},S=function(){for(var e=0;e<u.length;e++)threeUtils.disposeOfMesh(u[e]);u.length=0},q=function(a){e=a,h(),S(),C()},B=function(e){var a=1.5,t=.75;TweenMax.to(d.opacity,t,{value:0,ease:g}),f&&(TweenMax.to(f.scalar1,utils.randomRange(t,a),{value:1,delay:0,ease:g}),TweenMax.to(f.scalar2,utils.randomRange(t,a),{value:1,delay:.1,ease:g}),TweenMax.to(f.scalar3,utils.randomRange(t,a),{value:1,delay:.2,ease:g}),TweenMax.to(f.scalar4,utils.randomRange(t,a),{value:1,delay:.3,ease:g}),TweenMax.to(f.scalar5,utils.randomRange(t,a),{value:1,delay:.4,ease:g}));var l=.6,n=x;TweenMax.to(i.scalar1,utils.randomRange(t,a),{value:n,ease:g,delay:l}),TweenMax.to(i.scalar2,utils.randomRange(t,a),{value:n,ease:g,delay:l}),TweenMax.to(i.scalar3,utils.randomRange(t,a),{value:n,ease:g,delay:l}),TweenMax.to(i.scalar4,utils.randomRange(t,a),{value:n,ease:g,delay:l}),TweenMax.to(i.scalar5,t,{value:n,ease:g,delay:l,onComplete:e})},U=function(e){var a=1.5,t=.75;TweenMax.to(i.scalar1,utils.randomRange(t,a),{value:0,ease:g}),TweenMax.to(i.scalar2,utils.randomRange(t,a),{value:0,ease:g}),TweenMax.to(i.scalar3,utils.randomRange(t,a),{value:0,ease:g}),TweenMax.to(i.scalar4,utils.randomRange(t,a),{value:0,ease:g}),TweenMax.to(i.scalar5,t,{value:0,ease:g,onComplete:e});var l=1;TweenMax.to(d.opacity,t,{value:T,ease:g,delay:l/2}),f&&(TweenMax.to(f.scalar1,utils.randomRange(t,a),{value:0,delay:l,ease:g}),TweenMax.to(f.scalar2,utils.randomRange(t,a),{value:0,delay:l+.1,ease:g}),TweenMax.to(f.scalar3,utils.randomRange(t,a),{value:0,delay:l+.2,ease:g}),TweenMax.to(f.scalar4,utils.randomRange(t,a),{value:0,delay:l+.3,ease:g}),TweenMax.to(f.scalar5,utils.randomRange(t,a),{value:0,delay:l+.4,ease:g}))},I=function(e,a){if(i){var t=new THREE.Color(e);TweenMax.killTweensOf(i.color.value),TweenMax.killTweensOf(d.color.value),TweenMax.killTweensOf(f.color.value),TweenMax.to([i.color.value,d.color.value,f.color.value],.6,{r:t.r,g:t.g,b:t.b,onComplete:a})}},k=function(e){I(16777215,e)},z=function(){if(!M){ns.audioProxy.triggerEvent("warning_start"),M=!0;var e=function(){M&&P(e)};e()}},D=function(){M=!1,TweenMax.killTweensOf(i.color.value),TweenMax.killTweensOf(d.color.value)},j=function(){return M},P=function(e){I(constants.colors.red,function(){I(16777215,e)})},W=function(e){I(constants.colors.green,function(){I(16777215,e)})},F=function(){if(u){for(var e=[],a=0;a<u.length;a++)e.push(threeUtils.objectWorldPositionToScreen(u[a],l));n.updateInjuries(e)}i.time.value+=.001,d.time.value+=.001,f&&(f.time.value+=.001)},L=function(e){var a=1.5,t=.75,l=.4,n=a/2;TweenMax.to(d.opacity,n,{value:T,delay:0,ease:g}),TweenMax.to(i.opacity,n,{value:w,ease:Quart.easeOut}),TweenMax.to(i.scalar1,utils.randomRange(t,a),{value:0,ease:g}),TweenMax.to(i.scalar2,utils.randomRange(t,a),{value:0,ease:g}),TweenMax.to(i.scalar3,utils.randomRange(t,a),{value:0,ease:g}),TweenMax.to(i.scalar4,utils.randomRange(t,a),{value:0,ease:g}),TweenMax.to(i.scalar5,utils.randomRange(t,a),{value:0,ease:g,onComplete:e});var r=.6;TweenMax.to(d.scalarAlt1,l,{value:1,delay:r+0,ease:g}),TweenMax.to(d.scalarAlt2,l,{value:.8,delay:r+.2,ease:g}),TweenMax.to(d.scalarAlt3,l,{value:.6,delay:r+.4,ease:g}),TweenMax.to(d.scalarAlt4,l,{value:.4,delay:r+.6,ease:g}),TweenMax.to(d.scalarAlt5,l,{value:.2,delay:r+.8,ease:g}),f&&(TweenMax.to(f.scalar1,utils.randomRange(t,a),{value:0,delay:r,ease:g}),TweenMax.to(f.scalar2,utils.randomRange(t,a),{value:0,delay:r+.1,ease:g}),TweenMax.to(f.scalar3,utils.randomRange(t,a),{value:0,delay:r+.2,ease:g}),TweenMax.to(f.scalar4,utils.randomRange(t,a),{value:0,delay:r+.3,ease:g}),TweenMax.to(f.scalar5,utils.randomRange(t,a),{value:0,delay:r+.4,ease:g}))},V=function(e){var a=1,t=.4;TweenMax.to(d.scalarAlt1,t,{value:0,delay:0,ease:g}),TweenMax.to(d.scalarAlt2,t,{value:0,delay:.2,ease:g}),TweenMax.to(d.scalarAlt3,t,{value:0,delay:.4,ease:g}),TweenMax.to(d.scalarAlt4,t,{value:0,delay:.6,ease:g}),TweenMax.to(d.scalarAlt5,t,{value:0,delay:.8,ease:g});var l=.8;TweenMax.to(i.scalar1,utils.randomRange(t,a),{value:x,ease:g,delay:l}),TweenMax.to(i.scalar2,utils.randomRange(t,a),{value:x,ease:g,delay:l}),TweenMax.to(i.scalar3,utils.randomRange(t,a),{value:x,ease:g,delay:l}),TweenMax.to(i.scalar4,utils.randomRange(t,a),{value:x,ease:g,delay:l}),TweenMax.to(i.scalar5,t,{value:x,ease:g,delay:l}),f&&(TweenMax.to(f.scalar1,utils.randomRange(t,a),{value:1,delay:0,ease:g}),TweenMax.to(f.scalar2,utils.randomRange(t,a),{value:1,delay:.1,ease:g}),TweenMax.to(f.scalar3,utils.randomRange(t,a),{value:1,delay:.2,ease:g}),TweenMax.to(f.scalar4,utils.randomRange(t,a),{value:1,delay:.3,ease:g}),TweenMax.to(f.scalar5,utils.randomRange(t,a),{value:1,delay:.4,ease:g})),TweenMax.to(i.opacity,a,{value:0,delay:l,ease:g,onComplete:e})},G=function(){threeUtils.disposeOfChildren(o),threeUtils.disposeOfMesh(o),s=null,o=null,u=null,m=null,x=null,i=null,d=null,g=null};return{init:R,update:F,transitionIn:L,transitionOut:V,assemble:U,disassemble:B,setPatientData:q,setColor:I,resetColor:k,warn:P,praise:W,startWarning:z,stopWarning:D,isWarning:j,dispose:G,getMesh:function(){return o}}};module.exports=Body;
},{"../../../shaders/field-medicine/body-face-fragment.glsl":136,"../../../shaders/field-medicine/body-face-vertex.glsl":137,"../../../shaders/field-medicine/body-line-fragment.glsl":138,"../../../shaders/field-medicine/body-line-vertex.glsl":139,"../../../shaders/field-medicine/body-particle-fragment.glsl":140,"../../../shaders/field-medicine/body-particle-vertex.glsl":141,"./constants":62,"shared/namespace":175,"shared/utils/general-utils":193,"shared/utils/three-utils":197}],62:[function(require,module,exports){
"use strict";var paths=require("shared/paths");module.exports={imagePath:paths.IMGS+"field-medicine/",modelPath:paths.MODELS+"games/field-medicine/",isMobile:!1,minHeight:568,minHeightScalar:.8,gutter:32,treatmentBottom:67,breakpoint:720,conditions:{stable:{id:"stable",value:90},fair:{id:"fair",value:45},critical:{id:"critical",value:.1}},colors:{green:714097,yellow:16763653,red:15158348},deviceIsTooSmall:function(){return window.innerHeight<=this.minHeight}};
},{"shared/paths":176}],63:[function(require,module,exports){
"use strict";require("shared/lib/three.js-master/examples/js/postprocessing/EffectComposer"),require("shared/lib/three.js-master/examples/js/postprocessing/RenderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/ShaderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/MaskPass"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader");var GrainShader=require("shared/shaders/GrainShader"),GlowShader=require("shared/shaders/GlowShader"),BarrelBlurShader=require("shared/shaders/BarrelBlurShader.js"),EffectsManager=function(e){var r,s,a,n,l=function(){s=new THREE.EffectComposer(e.renderer),a=new THREE.RenderPass(e.scene,e.camera),n=new THREE.ShaderPass(THREE.CopyShader),r={},r.glow=new THREE.ShaderPass(GlowShader),r.glow.uniforms.amount.value=.4,r.glow.uniforms.size.value=3.7,r.glow.uniforms.darkness.value=.14,r.grain=new THREE.ShaderPass(GrainShader),r.barrelBlur=new THREE.ShaderPass(BarrelBlurShader),r.barrelBlur.uniforms.amount.value=.0075,s=new THREE.EffectComposer(e.renderer),s.addPass(a),s.addPass(r.glow),s.addPass(r.barrelBlur),s.addPass(r.grain),s.addPass(n),n.renderToScreen=!0,u()},d=function(){r.barrelBlur.uniforms.time.value+=.1,s.render(.1)},u=function(e,r){s&&s.setSize(e,r)},o=function(){r.glow=null,r.barrelBlur=null,r.grain=null,r=null,s=null,a=null,n=null};return l(),{update:d,resize:u,getPasses:function(){return r},dispose:o}};module.exports=EffectsManager;
},{"shared/lib/three.js-master/examples/js/postprocessing/EffectComposer":163,"shared/lib/three.js-master/examples/js/postprocessing/MaskPass":165,"shared/lib/three.js-master/examples/js/postprocessing/RenderPass":166,"shared/lib/three.js-master/examples/js/postprocessing/ShaderPass":167,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/shaders/BarrelBlurShader.js":177,"shared/shaders/GlowShader":182,"shared/shaders/GrainShader":183}],64:[function(require,module,exports){
"use strict";var PatientStatusItem=require("./patient-status-item"),TreatmentItem=require("./treatment-item-html"),PatientDataView=require("./patient-data-view-html"),pixiUtils=require("shared/utils/pixi-utils"),utils=require("shared/utils/general-utils"),Clock=require("../common/clock"),UITransitionManager=require("shared/utils/ui-transition-manager"),Hammer=require("hammerjs"),constants=require("./constants"),GameUI=function(t,e,n,i){var a,o,r,s,l,d,u,c,p,m,h,f,g,v,w,C,I,x,P,T,y,E,b,H=0,S=15,k=150,M=100,j=!1,L=1,A=function(){_.extend(this,Backbone.Events),a=this,PIXI.RESOLUTION=window.devicePixelRatio||1,o=new PIXI.CanvasRenderer(window.innerWidth,window.innerHeight,{transparent:!0,antialias:!1}),r=new PIXI.Container,o.view.style.position="absolute",o.view.style.pointerEvents="none",s=t.$parent.find("#game-ui"),s.addClass("disable-input"),s.append(o.view),l=!1,q(),O(),e.on("nextPatient",J),e.on("updateHeartrate",N),e.on("treatmentApplied",F),P=new UITransitionManager,ct()},q=function(){X(),V(),Y(n),Q(),et(),x=new Clock({$el:t.$parent.find(".clock .time")}),T=t.$parent.find(".clock"),T.removeClass("clock").addClass("clock-mobile"),x=new Clock({$el:T.find(".time")}),x.init(),C=c[i]},O=function(){E=new Hammer(f),E.get("press").set({time:350,threshold:500}),E.on("pan",W),E.on("press",B),E.on("pressup",U),window.addEventListener("touchend",R,!1)},W=function(t){if(y)y.touchmove(t.center.x-h.position.x,t.center.y,h.position.x);else{v||(v=h.position.x);var e=constants.deviceIsTooSmall()?constants.minHeightScalar:1,n=g.width()*e,i=n-window.innerWidth;if(n<window.innerWidth)return;var a=utils.map(Math.abs(t.velocityX),0,3,1,4);H=v+t.deltaX*a,H=utils.clamp(H,-(i+50*e),0),j=!0}},B=function(t){y=null;var e={x:0,y:0,width:0,height:0};_.each(m,function(n){var i=n.getPosition(),a=n.getWidth();e.x=i.x+h.position.x,e.y=i.y,e.width=a,e.height=a,utils.pointInRect(t.center.x,t.center.y,e)&&(y=n,n.touchstart(t.center.x-h.position.x,t.center.y))})},U=function(){v=null,y&&y.touchend(!1,h.position.x),y=null},R=function(t){U(t)},z=function(){x.stop()},D=function(){x.start()},X=function(){d=d||{};var t=document.createElement("div"),e=document.createElement("div"),n=it("PATIENT - 00"+(i+1),10,"#fff",{useBgPattern:!0}),a=d.label2||it("TREATMENT",10,"#fff",{useBgPattern:!0}),o=at(),r=at();s.append(t),s.append(e),t.appendChild(n),t.appendChild(o),e.appendChild(a),e.appendChild(r),b=n,$(t).addClass("header-top"),$(e).addClass("header-bottom"),d.header1=t,d.header2=e},V=function(){c=c||[],p=p||[];var t,n,a,o=e.getPatients(),r=document.createElement("div"),l=$(r),d=10,u=o.length;l.addClass("patient-indicator-container"),s.append(r);for(var m=0;u>m;m++)n=document.createElement("div"),a=$(n),0===m?a.addClass("patient-indicator-current"):a.addClass("patient-indicator-normal"),a.css("right",d*(u-m-1)+"pt"),l.append(n),p.push(n),console.log("create patient:",o[m].data,o[m]),t=c[m]||new PatientStatusItem({data:o[m].data,index:m+1,active:m===i}),t.isInitialized()||(t.initLite(),t.on("selected",G),e.registerPatientStatusItem(t,m)),c.push(t)},F=function(){e.off("treatmentApplied",F),L=j?1:.75},N=function(t){console.log("handleHeartrateUpdate:",t.modifier),w.setHeartrateAdditive(t.modifier)},G=function(t){C.setActive(!1),C=t.item,C.setActive(!0),a.trigger("patientSelected",t)},J=function(){i++,i<c.length&&(b.innerHTML="PATIENT - 00"+(i+1)),i===c.length?$(p[i-1]).removeClass("patient-indicator-current").addClass("patient-indicator-complete"):(C=c[i],a.trigger("patientSelected",{item:C,data:C.getData(),index:C.getRealIndex()}),C.startCountdown(),$(p[i-1]).removeClass("patient-indicator-current").addClass("patient-indicator-complete"),$(p[i]).removeClass("patient-indicator-normal").addClass("patient-indicator-current")),K(p[i-1])},K=function(t){P.removeAll(),P.add(t),P.transitionIn()},Q=function(){m=m||[],f=document.createElement("div"),g=$(f),g.addClass("treatment-item-container-m"),s.append(f),h=new PIXI.Container,r.addChild(h);for(var n,i=constants.deviceIsTooSmall(),o=_.toArray(t.config.treatments),l=i?constants.minHeightScalar:1,d=o.length,u=S,c=u*l,p=1,v=k*l,w=M*l,C=0,I=0,x=constants.gutter,P=g.position().top,T=0;d>T;T++)n=m[p-1]||new TreatmentItem({data:o[T],ui:a,index:p,width:v,height:w}),n.isInitialized()||(n.init(),e.registerTreatmentItem(n)),m[p-1]=n,h.addChild(n.getLine()),h.addChild(n.getContainer()),h.addChild(n.getDragObj()),f.appendChild(n.getMainElement()),n.setPosition(x,P),n.setPositionHTML(C,I),x+=v,C+=v/l,1===l&&(x+=c,C+=c/l),p++;g.css("width",C+"px")},Y=function(t){u=e.getInjuriesForPatient(t.index),console.log("createInjuries:",t.index,u);for(var n,i=0;i<u.length;i++)n=u[i],n.setPosition(window.innerWidth/2,window.innerHeight/2),r.addChild(n.getContainer()),s.append(n.getLabel());return u},Z=function(){for(var t=0;t<u.length;t++)r.removeChild(u[t].getContainer())},tt=function(){for(var t=0;t<m.length;t++)m[t].setInjuries(u)},et=function(){w=w||new PatientDataView,nt(),r.addChild(w.getContainer()),s.append(w.getContainerHTML()),e.registerPatientDataView(w)},nt=function(){var t,e=$(d.header1).position().top,n=$(d.header2).position().top,i=$(d.header1).find(".label").height(),a=n-e,o=.8*a/w.getOriginalSize().height;w.setScale(o),t=e+i+.5*(a-w.getHeight()),w.setPosition(window.innerWidth-32-w.getWidth(),t),pixiUtils.roundPosition(w.getContainer())},it=function(t,e,n,i){var a=document.createElement("div");return $(a).addClass("label"),i=i||{},i.useBgPattern&&(a.style.backgroundImage="url("+constants.imagePath+"tile_3x3_2.png)",a.style.backgroundRepeat="repeat",a.style.padding="3.5pt 0 0 3pt",a.style.height="15pt",a.style.minWidth="95pt"),i.glow&&(a.style.textShadow=i.glow),a.style.fontFamily="blender-book",a.style.fontSize=e+"px",a.style.color=n,a.style.position="absolute",a.style.pointerEvents="none",a.innerHTML=t,a},at=function(){var t=document.createElement("div");$(t).addClass("divider-m");var e=document.createElement("div");return $(e).addClass("line"),t.appendChild(e),t},ot=function(t){l=t},rt=function(){return l},st=function(){a.trigger("update"),o.render(r);var t=h.position.x;t+=.3*(H-t),g.css("left",t+"px"),h.position.x=t},lt=function(t){if(0!==u.length)for(var e=0;e<t.length;e++)u[e].setPosition(t[e].x,t[e].y,!0)},dt=function(t){I=t,w.setFlatline(t)},ut=function(t){w.setHeartrate(t)},ct=function(){P.removeAll(),P.add(d.header1,d.header2,x.getElement()),P.add(p),_.each(m,function(t){P.add(t.getMainElement())}),P.add([w.getContainer(),w.getContainerHTML()])},pt=function(t,e){o.resize(t,e),nt();for(var n=constants.deviceIsTooSmall(),i=n?constants.minHeightScalar:1,a=m.length,r=S*i,s=k*i,l=0,d=0,u=constants.gutter,c=g.position().top,p=0;a>p;p++)m[p].setPosition(u,c),m[p].setPositionHTML(l,d),m[p].checkContainerScale(),u+=s,l+=s/i,1===i&&(u+=r,l+=r/i);var f=g.width()*i,v=f-window.innerWidth,w=utils.clamp(h.position.x,-(v+50*i),0);g.css("left",w+"px"),h.position.x=w},mt=function(){C.startCountdown()},ht=function(){return x.getTime()},ft=function(t){for(var e,n=0,i=u.length,a=0;i>a;a++)e=a===i-1?t:null,u[a].transitionIn(n,e),n+=.1},gt=function(t){for(var e,n=0,i=u.length,a=0;i>a;a++)e=a===i-1?t:null,u[a].transitionOut(n,e),n+=.1},vt=function(t){ct(),P.transitionIn(50,function(){"function"==typeof t&&t(),ft(function(){e.enableTreatments(),D()})})},wt=function(t){gt(),ct(),P.transitionOut(20,!0,t)},Ct=function(){E.off("pan",W),E.off("press",B),E.off("pressup",U),window.removeEventListener("touchend",R),o.destroy(),w.dispose(),_.each(c,function(t){t.dispose()}),_.each(m,function(t){t.dispose()}),$(s).remove(),x.stop(),P.dispose(),a=null,o=null,r=null,s=null,l=null,d=null,u=null,c=null,p=null,m=null,h=null,f=null,g=null,w=null,C=null,I=null,x=null,P=null,T=null,y=null,E=null,j=null,L=null};return{init:A,update:st,resize:pt,transitionIn:vt,transitionOut:wt,transitionInInjuries:ft,transitionOutInjuries:gt,setBlockingMouse:ot,getBlockingMouse:rt,createInjuries:Y,removeInjuries:Z,updateInjuries:lt,sendInjuriesToTreatments:tt,setFlatline:dt,setHeartrate:ut,startPatientCountdowns:mt,disablePatientButtons:function(){},enablePatientButtons:function(){},getTotalTime:ht,addTransitionObjects:ct,startClock:D,stopClock:z,dispose:Ct,getInjuries:function(){return u},getPatientDataView:function(){return w},getViewedTreatmentsScore:function(){return L}}};module.exports=GameUI;
},{"../common/clock":124,"./constants":62,"./patient-data-view-html":70,"./patient-status-item":73,"./treatment-item-html":74,"hammerjs":6,"shared/utils/general-utils":193,"shared/utils/pixi-utils":194,"shared/utils/ui-transition-manager":198}],65:[function(require,module,exports){
"use strict";var PatientStatusItem=require("./patient-status-item"),TreatmentItem=require("./treatment-item-html"),PatientDataView=require("./patient-data-view-html"),constants=require("./constants"),Clock=require("../common/clock"),UITransitionManager=require("shared/utils/ui-transition-manager"),utils=require("shared/utils/general-utils"),GameUI=function(e,t,n,i){var a,r,s,o,d,l,u,c,f,h,p,v,g,m,w,C,b,x,I,y,P,T,k,E,H,W,M=!1,j=!1,S=1,B=!1,A=function(){_.extend(this,Backbone.Events),a=this,r=new PIXI.autoDetectRenderer(window.innerWidth,window.innerHeight,{transparent:!0,antialias:!0}),o=new PIXI.Container,r.view.style.position="absolute",s=$(r.view),s.addClass("disable-input"),d=e.$parent.find("#game-ui"),$(d).mousemove(function(e){_.each(h,function(t){t.mousemove(e)})}).mouseup(function(){_.each(h,function(e){e.mouseup()})}),l=!1,z(),d.append(r.view),t.on("updateHeartrate",R),t.on("treatmentApplied",V),W=new UITransitionManager,fe()},z=function(){L(),q(),K(n),Q(),ee(),H=new Clock({$el:e.$parent.find(".clock .time")}),H.init(),y=f[i]},O=function(){H.stop()},F=function(){H.start()},L=function(){u=u||{},u.divider1&&$(u.divider1).remove(),u.divider2&&$(u.divider2).remove(),u.divider3&&$(u.divider3).remove();var e=u.label1||te("STATUS",13,"#fff",{useBgPattern:!0}),t=ne(156);ie(e,{x:40,y:113}),ie(t,{x:40,y:115+$(e).height()+13});var n=window.innerWidth-255-242-40,i=u.label2||te("PATIENT",13,"#fff",{useBgPattern:!0}),a=ne(n);ie(i,{x:242,y:113}),ie(a,{x:242,y:115+$(i).height()+13});var r=u.label3||te("TREATMENT",13,"#fff",{useBgPattern:!0}),s=ne(224),o=242+n+40;ie(r,{x:o,y:113}),ie(s,{x:o,y:115+$(r).height()+13}),u.label1=e,u.divider1=t,u.label2=i,u.divider2=a,u.label3=r,u.divider3=s},q=function(){f=f||[];for(var e,n=2,a=7,r=41,s=170,d=15,l=1,u=t.getPatients(),c=0,h=0;a>h;h++){for(var p=0;n>p&&(e=f[l-1]||new PatientStatusItem({data:u[c].data,index:l,active:l===i+1}),e.isInitialized()||(e.init(),e.on("selected",X),t.registerPatientStatusItem(e,l-1)),f[l-1]=e,e.setPosition(r,s),o.addChild(e.getContainer()),r+=e.getWidth()+d,l++,c++,c!==u.length);p++);if(c===u.length)break;r=41,s+=e.getHeight()+d}},D=function(){B=!0},U=function(){B=!1},V=function(){t.off("treatmentApplied",V),S=j?1:.75},R=function(e){I.setHeartrateAdditive(e.modifier)},X=function(e){y.setActive(!1),y=e.item,y.setActive(!0),a.trigger("patientSelected",e)},G=function(e){var t=b-e;t=utils.clamp(t,170-(p.height-(x-20)),170),b=t},Q=function(){var n=101,i=94,r=20,s=20;x=4*i+3*s+r,h=h||[],p=p||new PIXI.Container,C=C||new PIXI.Graphics,C.clear(),C.beginFill(16711680),C.drawRect(0,0,265,x),C.endFill(),p.mask=C,o.addChild(p),o.addChild(C),v=v||document.createElement("div"),w=$(v),w.addClass("treatment-item-container"),w.css({height:x+"px"}),d.append(v),g=g||document.createElement("div"),m=$(g),m.addClass("treatment-item-container-child"),w.append(g);var l,u=2,c=25,f=8,I=0,y=window.innerWidth-255,E=170,H=0,W=0,M=1,j=_.toArray(e.config.treatments),S=0;p.position.set(y,E),C.position.set(y-8,E-4),w.css({left:y-10+"px",top:E-10+"px"}),b=E;var B=function(){return S===j.length};T=[[],[]],k=0;for(var A=0;c>A;A++){for(var z=0;u>z&&(l=h[M-1]||new TreatmentItem({data:j[S],ui:a,index:M,width:n,height:i,lrgFontSize:14,smlFontSize:12,left:9}),l.isInitialized()?l.checkBreakpoint():(l.init(),t.registerTreatmentItem(l),l.on("treatmentPickedUp",D),l.on("treatmentDropped",U)),h[M-1]=l,o.addChild(l.getLine()),p.addChild(l.getContainer()),o.addChild(l.getDragObj()),l.setPosition(H,W),l.setPositionHTML(H+10,W+10),l.checkBreakpoint(),g.appendChild(l.getMainElement()),T[I].push(l),H+=l.getWidth()+s,M++,S++,!B());z++);if(B())break;H=0,W+=l.getHeight()+s,M===f+1&&(H=0,W=0,I++)}if(j.length>8&&!P&&N(),P){var O,F=0;_.each(h,function(e){e.getContainer().position.y>F&&(F=e.getContainer().position.y,O=e.getHeight())}),$(P).css({top:F+O-5+2*s+"px"})}},N=function(){P=document.createElement("div"),$(P).addClass("pagination"),w.append(P);var e=document.createElement("div");$(e).addClass("top-divider"),P.appendChild(e);var t=function(e,t,n,i){var a=$(document.createElement("div"));a.addClass(t);var r=$(document.createElement("div"));r.addClass(n),r.html(e),a.append(r);var s=$(document.createElement("div"));return s.addClass(i),a.append(s),$(P).append(a),a},n=function(e,t){t=t||0;var n=!0,i=0;setTimeout(function(){var t=setInterval(function(){n=!n,e.css("opacity",n?1:0),i++,6===i&&clearInterval(t)},35)},t)},i=function(e,t){e.addClass("active"),e.find(".arrow").addClass("hidden"),e.find(".label").removeClass("label-left").removeClass("label-right").addClass("label-center"),t?e.find(".arrow").css("left","-10px"):e.find(".arrow").css("right","-10px"),n(e.find(".label"))},a=function(e,t){e.removeClass("active").removeClass("over"),e.find(".arrow").removeClass("hidden"),e.find(".label").removeClass("label-center").addClass(t?"label-left":"label-right"),t?e.find(".arrow").css("left","10px"):e.find(".arrow").css("right","10px")},r=t("01","page-01","label label-left","arrow arrow-left");r.mouseover(function(){$(this).hasClass("active")||($(this).addClass("over"),$(this).find(".label").removeClass("label-left").addClass("label-center"),$(this).find(".arrow").css("left","-10px"),n($(this).find(".label"),250))}).mouseout(function(){$(this).hasClass("active")||($(this).removeClass("over"),$(this).find(".label").removeClass("label-center").addClass("label-left"),$(this).find(".arrow").css("left","10px"))}).click(function(){$(this).hasClass("active")||(J(0,this),i(r,!0),a(s,!1))});var s=t("02","page-02","label label-right","arrow arrow-right");s.mouseover(function(){$(this).hasClass("active")||($(this).addClass("over"),$(this).find(".label").removeClass("label-right").addClass("label-center"),$(this).find(".arrow").css("right","-10px"),n($(this).find(".label"),250))}).mouseout(function(){$(this).hasClass("active")||($(this).removeClass("over"),$(this).find(".label").removeClass("label-center").addClass("label-right"),$(this).find(".arrow").css("right","10px"))}).click(function(){$(this).hasClass("active")||(J(1,this),i(s,!1),a(r,!0))}),i(r,!0)},J=function(e,t){k=e;var n=$(P).find(".page");_.each(n,function(e){console.log(e,t,e===t),e===t?$(e).addClass("page-active"):$(e).removeClass("page-active")});var i=0===k?1:0,a=0;_.each(T[i],function(e){e.hide(a),a+=50}),_.each(T[k],function(e){e.show(a),a+=50}),j=!0},K=function(e){console.log("createInjuries:",e.index,e),c=t.getInjuriesForPatient(e.index);for(var n,i=0;i<c.length;i++)n=c[i],n.setPosition(window.innerWidth/2,window.innerHeight/2),o.addChild(n.getContainer()),d.append(n.getLabel());return c},Y=function(){for(var e=0;e<c.length;e++)o.removeChild(c[e].getContainer())},Z=function(){for(var e=0;e<h.length;e++)h[e].setInjuries(c)},ee=function(){I=I||new PatientDataView;var e=$(u.divider2);I.setPosition(e.position().left+e.width()-I.getWidth(),e.position().top+28),o.addChild(I.getContainer()),d.append(I.getContainerHTML()),t.registerPatientDataView(I)},te=function(e,t,n,i){var a=document.createElement("div");return d.append(a),i=i||{},i.useBgPattern&&(a.style.backgroundImage="url("+constants.imagePath+"tile_3x3_2.png)",a.style.backgroundRepeat="repeat",a.style.padding="7px 11px 6px 11px",a.style.minWidth="74px"),i.glow&&(a.style.textShadow=i.glow),a.style.fontFamily="blender-book",a.style.fontSize=t+"px",a.style.color=n,a.style.position="absolute",a.style.pointerEvents="none",a.innerHTML=e,a},ne=function(e){var t=document.createElement("div");$(t).addClass("divider"),$(t).css({width:e+"px"}),d.append(t);var n=document.createElement("div");return $(n).addClass("line"),t.appendChild(n),t},ie=function(e,t){e.style.left=t.x+"px",e.style.top=t.y+"px"},ae=function(e){l=e},re=function(){return l},se=function(e){M=e},oe=function(){return M},de=function(e,t){e<window.innerWidth/2&&s.hasClass("disable-input")?s.removeClass("disable-input"):e>window.innerWidth/2&&!s.hasClass("disable-input")&&s.addClass("disable-input"),utils.isIE()&&(B&&r.width!==window.innerWidth?r.resize(window.innerWidth,window.innerHeight):B||r.width===p.position.x||r.resize(p.position.x,window.innerHeight)),p.position.y+=.2*(b-p.position.y);var n=m.position().top;n+=.2*(b-170-n),m.css({top:n+"px"}),_.each(h,function(e){e.updateWorldPosition()}),a.trigger("update"),r.render(o)},le=function(e){if(c&&0!==c.length)for(var t=0;t<e.length;t++)c[t]&&c[t].setPosition(e[t].x,e[t].y,!0)},ue=function(e){E=e,I.setFlatline(e)},ce=function(e){I.setHeartrate(e)},fe=function(){W.removeAll(),W.add(u.label1,u.divider1,u.label2,u.divider2,u.label3,u.divider3,[H.getElement(),H.getWands()]),_.each(f,function(e){W.add(e.getContainer())}),P&&(W.add($(P).find(".top-divider")),W.add($(P).find(".page-01")),W.add($(P).find(".page-02"))),W.add([I.getContainer(),I.getContainerHTML()])},he=function(e,t){r.resize(e,t),L(),q(),Q(),ee(),d.append(r.view)},pe=function(){_.each(f,function(e){e.disable()})},ve=function(){_.each(f,function(e){e.enable()})},ge=function(){_.each(f,function(e){e.startCountdown()})},me=function(){return H.getTime()},we=function(e){for(var t,n=0,i=c.length,a=0;i>a;a++)t=a===i-1?e:null,c[a].transitionIn(n,t),n+=.1},Ce=function(e){for(var t,n=0,i=c.length,a=0;i>a;a++)t=a===i-1?e:null,c[a].transitionOut(n,t),n+=.1},be=function(e){var n=$(u.divider1).width(),i=$(u.divider2).width(),a=$(u.divider3).width(),r=.35;$(u.divider1).css("width","0px"),$(u.divider2).css("width","0px"),$(u.divider3).css("width","0px"),TweenMax.to(u.divider1,.9,{css:{width:n},ease:Quart.easeInOut,delay:r}),TweenMax.to(u.divider2,.9,{css:{width:i},ease:Quart.easeInOut,delay:r+.25}),TweenMax.to(u.divider3,.9,{css:{width:a},ease:Quart.easeInOut,delay:r+.5}),r=0;for(var s=0;8>s;s++)h[s].show(r),r+=50;fe(),W.transitionIn(50,function(){"function"==typeof e&&e(),we(function(){t.enableTreatments(),F()})})},$e=function(e){Ce();for(var t=0,n=0===k?0:8,i=0===k?8:h.length,a=n;i>a;a++)h[a].hide(t),t+=50;fe(),W.transitionOut(20,!0,e)},xe=function(){t.off(),r.destroy(),I.dispose(),_.each(f,function(e){e.dispose()}),_.each(h,function(e){e.dispose()}),$(d).remove(),H.stop(),W.dispose(),a=null,r=null,o=null,d=null,l=null,u=null,c=null,f=null,h=null,I=null,y=null,E=null,H=null,W=null,M=null,j=null,S=null,B=null};return{init:A,update:de,resize:he,transitionIn:be,transitionOut:$e,transitionInInjuries:we,transitionOutInjuries:Ce,setBlockingMouse:ae,getBlockingMouse:re,setCursorLocked:se,getCursorLocked:oe,createInjuries:K,removeInjuries:Y,updateInjuries:le,sendInjuriesToTreatments:Z,setFlatline:ue,setHeartrate:ce,startPatientCountdowns:ge,disablePatientButtons:pe,enablePatientButtons:ve,getTotalTime:me,addTransitionObjects:fe,startClock:F,stopClock:O,handleScroll:G,dispose:xe,getInjuries:function(){return c},getPatientDataView:function(){return I},getViewedTreatmentsScore:function(){return S}}};module.exports=GameUI;
},{"../common/clock":124,"./constants":62,"./patient-data-view-html":70,"./patient-status-item":73,"./treatment-item-html":74,"shared/utils/general-utils":193,"shared/utils/ui-transition-manager":198}],66:[function(require,module,exports){
"use strict";var utils=require("shared/utils/general-utils"),ns=require("shared/namespace"),GraphWave=function(e){var t,n,a,i,l,r,u,o,c,s,h,p,m,g,f,d,v,w={heartrate:"heartrate",oxygen:"oxygen",temperature:"temperature"},T=!1,x=1,y=0,I=0,S=e.type.toLowerCase()===w.heartrate,b=!1,C=function(){e.color=e.color||16777215,e.beatSpacing=e.beatSpacing||30,t=new PIXI.Container,n=new PIXI.Graphics,i=B(),n.mask=i,t.addChild(n),a=new PIXI.Graphics,l=B(),a.mask=l,t.addChild(a),h=0,m=e.type!==w.temperature?0:e.height-6,k(),q(),e.type!==w.temperature?(e.heartrate&&(f=e.heartrate,F()),P(),X()):(g=e.temperature||98.6,G())},F=function(){var e=utils.clamp(6e4/f,100,5e3);clearTimeout(d),d=setTimeout(function(){b||X(),F()},e)},P=function(){r&&r.graphicsData&&(r.moveTo(y,I),T&&!b?(p=o[c],r.lineTo(h,p),c++,c===o.length&&(T=!1)):(p=m,r.lineTo(h,p),S||(s++,s>=e.beatSpacing/x&&X())),u.position.x=h+5,y=h,I=p,h++,h>=e.width&&q(),v=requestAnimationFrame(P))},G=function(){if(r&&r.graphicsData){r.moveTo(y,I);var t=90.6,n=106.6,a=utils.clamp(g,t,n);p=b?m:utils.map(a,t,n,m+25,m-25),r.lineTo(h,p),u.position.x=h+5,y=h,I=p,h++,h>=e.width&&q(),v=requestAnimationFrame(G)}},q=function(){h=0,y=0,I=m,u=u===l?i:l,i.position.x=0,l.position.x=0,r=r===n?a:n,r.clear(),r.lineStyle(1,e.color,1),r.moveTo(y,I)},X=function(){c=0,s=0,T=!0,S&&ns.audioProxy.triggerEvent("heart_beat")},k=function(){var t,n,a;switch(e.type.toLowerCase()){case w.heartrate:t=[0,-25,20,-2,-4,-6,-8,-10,12,3,-15,-9,18,-3,3,0],n=1,a=.6;break;case w.oxygen:t=[0,-5,-6,-7,-5,-4,-4,-4,-6,-6,-6,-1,0],n=2,a=1}o=void 0!==t?A(t,n,a):null},A=function(e,t,n){for(var a=[],i=0;i<e.length;i++)for(var l=0;t>l;l++)a.push(m+e[i]*n);return a},B=function(){var n=new PIXI.Graphics;return n.beginFill(65280,1),n.drawRect(0,-e.height/2,e.width,2*e.height),n.endFill(),t.addChild(n),n},D=function(e,n){t.position.set(e,n)},H=function(t){e.beatSpacing=t},L=function(e){g=e},W=function(e){b=e},E=function(e){x=e},R=function(e){f=e},_=function(){cancelAnimationFrame(v),clearTimeout(d),w=null,t=null,n=null,a=null,i=null,l=null,r=null,u=null,o=null,T=null,c=null,s=null,x=null,h=null,p=null,y=null,I=null,m=null,g=null,b=null,v=null,d=null,S=null,f=null};return C(),{setPosition:D,setBeatSpacing:H,setTemperature:L,setFlatline:W,setBeatSpacingScalar:E,setHeartrate:R,dispose:_,getContainer:function(){return t},getHeight:function(){return t.height}}};module.exports=GraphWave;
},{"shared/namespace":175,"shared/utils/general-utils":193}],67:[function(require,module,exports){
"use strict";var constants=require("./constants"),utils=require("shared/utils/general-utils"),ns=require("shared/namespace"),InjuryItem=function(e,n,t){var a,i,o,r,l,s,c,u,d,p,f=!1,h={value:null},y=constants.isMobile,m=Math.abs,g=0,v=function(){_.extend(this,Backbone.Events),a=this,i=new PIXI.Container,o=new PIXI.Graphics,o.beginFill(65280,0),o.drawCircle(0,0,36),o.endFill(),i.addChild(o),r=X(constants.colors.red,{radius:26,opacity:.17},{radius:17,opacity:.42},{radius:9,opacity:.42}),c=r,u=constants.colors.red,l=X(constants.colors.green,{radius:26,opacity:.17},{radius:17,opacity:.42},{radius:9,opacity:.42}),l.alpha=0,s=X(16777215,{radius:26,opacity:.17},{radius:17,opacity:.42},{radius:9,opacity:.42}),s.alpha=0,d=S(e.title.toUpperCase()),p=y?50:90;var n=$(d),t=F(n,r);i.addChild(r),i.addChild(l),i.addChild(s),i.addChild(t),i.alpha=0},x=function(e,n,t){e.style.left=n+"px",e.style.top=t+"px"},T=function(e,n){f&&!n||u===e||(c=e!==constants.colors.red&&e?e===constants.colors.green?l:s:r,u=e,w(c))},w=function(e){var n=[r,l,s];_.each(n,function(n){TweenMax.killTweensOf(n),n!==e?TweenMax.to(n,.3,{alpha:0}):(n.alpha=0,TweenMax.to(n,.3,{alpha:1}))})},C=function(e,n,t){var a=$(d),o=-5;if(t){i.x+=.3*(e-i.x),i.y+=.3*(n-i.y);var r=a.position().left,l=a.position().top;e+=-(p+a.width()),n+=-a.height()/2+o;var s=e-r,c=n-l;m(s)>.5&&(r+=.3*s),m(c)>.5&&(l+=.3*c),x(d,r,l)}else i.position.set(e,n),e+=-(p+a.width()),n+=-a.height()/2+o,x(d,e,n)},I=function(e){f=e,f?T(constants.colors.green,!0):T(constants.colors.red,!0)},M=function(){setTimeout(function(){Math.random()<.1&&P()},utils.randomRange(1e3,5e3))},P=function(){I(!1),a.trigger("relapse",{injury:a})},b=function(){return i.position},O=function(){return i},j=function(){return d},E=function(){return o},S=function(e){var n=document.createElement("div"),t=$(n);return t.html(e),t.addClass("injury-label"),constants.isMobile&&t.css({fontSize:"9px",padding:"6px 5px 5px 5px",height:"22px"}),n},X=function(e,n,t,a){var i=y?.65:1,o=new PIXI.Container,r=function(e,n,t){var a=new PIXI.Graphics;return a.lineStyle(1,16777215,1),a.beginFill(16777215,n),a.drawCircle(0,0,e),a.endFill(),a.tint=t,a},l=r(n.radius*i,n.opacity,e);l.scale.set(0,0),l.alpha=0,o.addChild(l);var s=r(t.radius*i,t.opacity,e);s.scale.set(0,0),s.alpha=0,o.addChild(s);var c=r(a.radius*i,a.opacity,e);return o.addChild(c),o},F=function(e,n){var t=new PIXI.Graphics;return t.lineStyle(1,16777215,.3),t.moveTo(-p,0),t.lineTo(n.position.x,n.position.y),t},q=function(){if(i){var e=Quart.easeInOut,n=.9,t=1.8,a=1.2,o=2.4;c.children[0].scale.set(0,0),c.children[0].alpha=1,c.children[1].scale.set(0,0),c.children[1].alpha=1,TweenMax.to(c.children[0].scale,n,{x:1,y:1,ease:e}),TweenMax.to(c.children[0],t,{alpha:0,ease:e}),TweenMax.to(c.children[1].scale,a,{x:1,y:1,ease:e}),TweenMax.to(c.children[1],o,{alpha:0,ease:e,onComplete:q})}},G=function(){T(constants.colors.green),setTimeout(function(){T(constants.colors.red)},500)},R=function(n){if(!f){g++;var i,o=!1,r=!1;-1!==e.primary_treatments.indexOf(n)?(null===h.value&&(h.value=1),i=t[n].time_scalar,I(!0),r=!0,console.log(n,"valid. is primary"),ns.audioProxy.triggerEvent("treatment_success")):-1!==e.secondary_treatments.indexOf(n)?(null===h.value&&(h.value=.5),i=t[n].time_scalar,r=!0,o=!0,console.log(n,"valid. is secondary"),ns.audioProxy.triggerEvent("treatment_success")):(r=!1,null===h.value&&(h.value=0),i=-t[n].time_scalar,console.log(n,"not valid."),ns.audioProxy.triggerEvent("treatment_fail")),console.log("applyTreatment:",i),a.trigger("treatmentApplied",{injury:a,timeScalar:i,treated:f,resetTime:t[n].time_to_administer,reset:r,canRelapse:o})}},k=function(e){I(e)},z=function(e,n){e=e||0,TweenMax.to(d,.6,{css:{opacity:1},delay:e}),TweenMax.to(i,.6,{alpha:1,delay:e,onComplete:function(){q(),"function"==typeof n&&n()}})},A=function(e,n){e=e||0,TweenMax.to(d,.3,{css:{opacity:0},delay:e}),TweenMax.to(i,.3,{alpha:0,delay:e,onComplete:function(){"function"==typeof n&&n()}})},B=function(){a=null,i=null,o=null,r=null,l=null,s=null,d=null,p=null,f=null,h=null,y=null,g=null};return{init:v,transitionIn:z,transitionOut:A,setTint:T,setPosition:C,setTreated:I,getPosition:b,getContainer:O,getLabel:j,getHit:E,applyTreatment:R,processTreatmentOutcome:k,possiblyRelapse:M,flash:G,getTreatmentScore:function(){return h.value},getNumberOfTries:function(){return g},getData:function(){return e},getTreated:function(){return f},getPatientIndex:function(){return n},dispose:B}};module.exports=InjuryItem;
},{"./constants":62,"shared/namespace":175,"shared/utils/general-utils":193}],68:[function(require,module,exports){
var gamebase=require("../game-base"),_=require("lodash"),EffectsManager=require("./effects-manager"),PatientManager=require("./patient-manager"),GameUI=require("./game-ui"),GameUIMobile=require("./game-ui-mobile"),Body=require("./body"),Particles=require("./particles"),utils=require("shared/utils/general-utils"),threeUtils=require("shared/utils/three-utils"),WebFont=require("shared/lib/webfontloader"),ns=require("shared/namespace"),client=require("shared/utils/client/client"),constants=require("./constants"),Stats=require("stats-js"),ns=require("shared/namespace"),CursorManager=require("shared/utils/cursor-manager"),FieldMedicine=function(e){var n,t,i,o,a,r,s,l,u,d,c,m,w,f,p,h,g,v,y,E=this,x={},b=new THREE.Vector3(0,0,.5),T=new THREE.Vector3(0,0,.5),P=new THREE.Vector3(0,0,.5),M={x:0,y:0},I={x:0,y:0},L={x:0,y:0},z={x:0,y:0},C={x:0,y:0},H=.1,q=!1,O=-40,R=40,D=10,j=0,S=50,U=225,Y=.2*(U-S)+S,X=U,F=1,W=!1,A=!1,B=function(){console.log("options: ",e),void 0!==window.devicePixelRatio&&(F=window.devicePixelRatio),t="mobile"===client.device.type||"tablet"===client.device.type,constants.isMobile=t,window.location.href.indexOf("mobile")>-1&&(t=!0),window.location.href.indexOf("?dev")>-1&&(n=!0),t&&(document.ontouchmove=function(e){e.preventDefault()},O*=.6,R*=.6,U=150,j=0),k(),ns.audioProxy.triggerEvent("field_medicine_start")},V=function(n){var t=.25*e.gameData.max_life_duration,i={skill:u.getOverallTreatmentScore()*g.getViewedTreatmentsScore(),accuracy:u.getAccuracyScore(),speed:Math.min(t/g.getTotalTime(),1)};n?E.trigger("win",{score:i}):E.trigger("lose",{score:i}),ns.audioProxy.triggerEvent("field_medicine_end")},k=function(){o=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4),o.position.set(0,j,X),a=new THREE.Scene;var d=$(ns.templates.field_medicine({}));e.$parent.append(d);var c=d.find("#game-webgl");r=new THREE.WebGLRenderer,r.setPixelRatio(1),r.setClearColor(986895,1),r.setSize(window.innerWidth,window.innerHeight),r.domElement.style.position="absolute",c.append(r.domElement),s=new THREE.Object3D,a.add(s);var m=new THREE.DirectionalLight(16777215,3);if(m.position.set(0,0,100),a.add(m),p=new THREE.Vector3,t){var w=require("hammerjs");y=new w(r.domElement),y.get("pan").set({direction:w.DIRECTION_ALL}),y.get("pinch").set({enable:!0}),y.on("pan",ie),y.on("pinch",oe),window.addEventListener("touchstart",ae,!1),window.addEventListener("touchend",re,!1)}else{var v=new THREE.HemisphereLight(16777215,8947848,1);a.add(v),f=new Particles(2500,250),s.add(f.getMesh()),l=new EffectsManager({renderer:r,camera:o,scene:a}),window.addEventListener("mousemove",Z,!1),window.addEventListener("mousedown",ee,!1),window.addEventListener("mouseup",ne,!1),window.addEventListener("mousewheel",te,!1),window.addEventListener("DOMMouseScroll",te,!1)}window.addEventListener("resize",de,!1);var E=0;u=new PatientManager(e,E),u.init(),u.on("allPatientsDead",G),u.on("allPatientsHealed",Q),u.on("allPatientsComplete",N);var x=u.getPatients()[E];g=t?new GameUIMobile(e,u,x,E):new GameUI(e,u,x,E),g.init(),g.on("patientSelected",K),g.setHeartrate(x.data.heartrate);var b=e.config.ailments[x.data.ailments[0]].body_section;j=0===b?R:1===b?D:O,J(x.data,function(){u.setBody(h),se(),h.transitionIn(function(){g.transitionIn(function(){g.enablePatientButtons(),g.startPatientCountdowns()})})}),n&&(i=new Stats,i.domElement.style.position="absolute",i.domElement.style.top="0px",i.domElement.style.zIndex=9999,$("#game-webgl").append(i.domElement)),de(),g.addTransitionObjects(),ue()},G=function(){le(function(){V(!1)})},Q=function(){le(function(){V(!0)})},N=function(){le(function(){V(!1)})},J=function(n,t){h=new Body(n,d,c,o,g,e.config.ailments),h.init(),h.on("ready",function(){"function"==typeof t&&t()}),s.add(h.getMesh())},K=function(n){ns.audioProxy.triggerEvent("patient_out"),u.setSwappingPatients(!0),u.disableTreatments(),g.setFlatline(!0),g.disablePatientButtons(),g.transitionOutInjuries(function(){g.removeInjuries(),g.createInjuries(n.data),g.sendInjuriesToTreatments()}),W=!1,TweenMax.to({z:X},.9,{z:U,delay:.3,ease:Quart.easeInOut,onUpdate:function(){X=this.target.z,o.position.z=X}}),A=!0;var i=s.rotation.y,a=Math.random()<.5?-(2*Math.PI):2*Math.PI;TweenMax.to(s.rotation,3,{y:i+a,ease:Quart.easeInOut,onComplete:function(){s.rotation.y=i,A=!1}}),h.disassemble(function(){ns.audioProxy.triggerEvent("patient_in"),u.setCurrentPatientIndex(n.index),h.setPatientData(n.data),g.transitionInInjuries(),TweenMax.to({z:X},.9,{z:Y,ease:Quart.easeInOut,onUpdate:function(){X=this.target.z,o.position.z=X}});var i,a=e.config.ailments[n.data.ailments[0]].body_section;i=0===a?R:1===a?D:O,TweenMax.to({y:j},.3,{y:i,ease:Quart.easeInOut,onUpdate:function(){j=this.target.y}}),h.assemble(function(){W=!0,g.setFlatline(!1),g.setHeartrate(n.data.heartrate),g.enablePatientButtons(),t&&g.startPatientCountdowns(),u.enableTreatments(),g.getPatientDataView().setLife(u.getCurrentPatientHealth()/100,!0,0,!1,function(){u.setSwappingPatients(!1)})})})},Z=function(e){b.x=e.clientX/window.innerWidth*2-1,b.y=2*-(e.clientY/window.innerHeight)+1,L.x=e.clientX,L.y=e.clientY,q&&!g.getBlockingMouse()&&(I.x=e.clientX,I.y=e.clientY)},ee=function(e){T.x=e.clientX,T.y=e.clientY,I.x=e.clientX,I.y=e.clientY,M.x=I.x,M.y=I.y,q=!0},ne=function(e){q=!1,P.x=e.clientX,P.y=e.clientY},te=function(e){e.preventDefault();var n=0;e.wheelDelta?n=.1*-e.wheelDelta:e.detail&&(n=e.detail),W&&(X=utils.clamp(X+n,S,U))},ie=function(e){Z({clientX:e.center.x,clientY:e.center.y})},oe=function(e){var n=e.scale;X=utils.clamp(X/n,S,U)},ae=function(e){e.changedTouches.length>0&&ee({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY})},re=function(e){e.changedTouches.length>0&&ne({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY})},se=function(){var n=e.$parent.find("#game-overlay");TweenMax.to({z:X},2,{z:Y,ease:Quart.easeInout,onUpdate:function(){X=this.target.z},onComplete:function(){W=!0}}),n.addClass("overlay-fade-out")},le=function(n){g.transitionOutInjuries(),h.transitionOut(),g.transitionOut(function(){var t=e.$parent.find("#game-overlay");t.removeClass("overlay-fade-out").addClass("overlay-fade-in"),"function"==typeof n&&setTimeout(function(){n()},900)})},ue=function(){var e=t?3:1;j=utils.clamp(j+.1*(I.y-M.y)*e,O,R);var n=X/U;o.position.x+=.1*(50*b.x-o.position.x),o.position.y+=(j/n+20*b.y-o.position.y)*(.1*n),o.position.z+=.1*(X-o.position.z),p.y=o.position.y,o.lookAt(p),A||(z.y=I.x-M.x,w=z.y-C.y,C.y+=w*H,threeUtils.rotateAroundWorldAxis(s,threeUtils.axisUp,.25*threeUtils.degreesToRads(C.y)*e)),M.x=I.x,M.y=I.y,h.update(),g.update(L.x,L.y),u.update(),t||g.getCursorLocked()||CursorManager.setCursor(document.body,"move"),l?l.update():r.render(a,o),f&&f.update(),i&&i.update(),v=requestAnimationFrame(ue)},de=function(){x.w=window.innerWidth,x.h=window.innerHeight,o.aspect=x.w/x.h,o.updateProjectionMatrix(),r.setSize(x.w,x.h),g.resize(x.w,x.h),l&&l.resize(x.w,x.h)};_.extend(this,gamebase),_.extend(this,{load:function(e){WebFont.load({custom:{families:["blender-book","blender-thin","blender-medium"]},active:function(){var n=t?"patient_mobile.js":"patient.js",i=t?"organs_mobile.js":"organs.js",o=new THREE.JSONLoader;o.load(constants.modelPath+n,function(n){d=n,o.load(constants.modelPath+i,function(n){c=n,"function"==typeof e&&e()})})}})},enter:function(){B()},exit:function(){this.destroy()},destroy:function(){console.log("FIELD MEDICINE DESTROY"),cancelAnimationFrame(v),t?(y.off("pan",ie),y.off("pinch",oe),document.ontouchmove=null,window.removeEventListener("touchstart",ae),window.removeEventListener("touchend",re)):(window.removeEventListener("mousemove",Z),window.removeEventListener("mousedown",ee),window.removeEventListener("mouseup",ne),window.removeEventListener("mousewheel",te),window.removeEventListener("DOMMouseScroll",te),f.dispose(),l.dispose(),CursorManager.dispose()),window.removeEventListener("resize",de),u.dispose(),g.off(),g.dispose(),h.dispose(),$(r.domElement).remove(),E=null,t=null,o=null,a=null,r=null,s=null,l=null,u=null,d=null,x=null,b=null,T=null,P=null,M=null,I=null,z=null,C=null,H=null,q=null,m=null,f=null,O=null,R=null,j=null,S=null,U=null,X=null,p=null,h=null,g=null,F=null,v=null,y=null,W=null,A=null}})};module.exports=FieldMedicine;
},{"../game-base":125,"./body":61,"./constants":62,"./effects-manager":63,"./game-ui":65,"./game-ui-mobile":64,"./particles":69,"./patient-manager":72,"hammerjs":6,"lodash":21,"shared/lib/webfontloader":174,"shared/namespace":175,"shared/utils/client/client":190,"shared/utils/cursor-manager":192,"shared/utils/general-utils":193,"shared/utils/three-utils":197,"stats-js":22}],69:[function(require,module,exports){
"use strict";var utils=require("shared/utils/general-utils"),threeUtils=require("shared/utils/three-utils"),constants=require("./constants"),Particles=function(e,t){var r,i,n=function(){for(var n=new THREE.ShaderMaterial({uniforms:{color:{type:"c",value:new THREE.Color(16777215)},opacity:{type:"f",value:.1},map:{type:"t",value:THREE.ImageUtils.loadTexture(constants.imagePath+"particle.png")},size:{type:"f",value:.75},time:{type:"f",value:0}},vertexShader:require("../../../shaders/field-medicine/dust-vertex.glsl"),fragmentShader:require("../../../shaders/field-medicine/dust-fragment.glsl"),transparent:!0,blending:THREE.AdditiveBlending,depthWrite:!1,fog:!0}),s=new THREE.Geometry,a=0;e>a;a++)s.vertices.push(new THREE.Vector3(utils.randomRange(-t,t),utils.randomRange(-t,t),utils.randomRange(-t,t)));r=n.uniforms.time,i=new THREE.PointCloud(s,n)},s=function(){r&&(r.value+=25e-6)},a=function(){threeUtils.disposeOfMesh(i),i=null,r=null};return n(),{update:s,dispose:a,getMesh:function(){return i}}};module.exports=Particles;
},{"../../../shaders/field-medicine/dust-fragment.glsl":142,"../../../shaders/field-medicine/dust-vertex.glsl":143,"./constants":62,"shared/utils/general-utils":193,"shared/utils/three-utils":197}],70:[function(require,module,exports){
"use strict";var pixiUtils=require("shared/utils/pixi-utils"),utils=require("shared/utils/general-utils"),constants=require("./constants"),GraphWave=require("./graph-wave"),PatientDataView=function(){var e,t,n,a,i,l,r,o,s,u,c,d,h=80,v=!1,f=function(){e=new PIXI.Container,t=document.createElement("div"),$(t).addClass("patient-data"),w(),M(),m(),p(),c={width:e.width,height:e.height}},p=function(){e&&(d=setTimeout(function(){if(e){if(v)P(0);else{var t,a=n.value;t=a>=constants.conditions.stable.value/100?utils.randomRange(94,96):a>=constants.conditions.fair.value/100?utils.randomRange(80,82):utils.randomRange(52,54),P(t)}p()}},utils.randomRange(500,3e3)))},g=function(e,n){var a=document.createElement("div");return $(a).addClass(n),a.innerHTML=e,t.appendChild(a),a},w=function(){l=g("0","heartrate-label"),g("HR","hr-label"),g("BPM","bpm-label");var t=C(3,90,5,"#ffffff",.25);S(t,0,60),o=new GraphWave({type:"heartrate",width:90,height:30,color:15158348,beatSpacing:30,heartrate:h}),o.setPosition(0,65),e.addChild(o.getContainer())},M=function(){r=g("0","oxygen-label"),g("Sp02","sp-label"),g("80","value-label"),g("%","percent-label");var t=C(3,90,5,"#ffffff",.25);S(t,0,183),s=new GraphWave({type:"oxygen",width:90,height:30,color:16763653,beatSpacing:12}),s.setPosition(0,188),e.addChild(s.getContainer())},m=function(){var t=pixiUtils.createCircle(45,2,16777215,.125);t.position.set(45,280),e.addChild(t),n={value:0},a=g((100*n.value).toString(),"life-value-label"),g("%","life-percent-label"),g("LIFE","life-label")},C=function(e,n,a,i,l){var r=document.createElement("div");$(r).addClass("graph-lines"),r.style.width=n+"px",t.appendChild(r);for(var o=0,s=0;e>s;s++){var u=document.createElement("div");$(u).addClass("graph-line"),u.style.top=o+"px",u.style.backgroundColor=i,5===e&&4===s?u.style.opacity=3*l:u.style.opacity=l,r.appendChild(u),o+=a}return r},x=function(t,l,r,o,s){TweenMax.killTweensOf(n);var u=-Math.PI/2;TweenMax.to(n,2,{value:t,delay:l||0,ease:Quart.easeInOut,onUpdate:function(){return e?(i&&(i.clear(),e.removeChild(i)),i=pixiUtils.createArc(45,u,u+2*Math.PI*this.target.value,3,U(this.target.value),1),i.position.set(r,o),i.currentPath&&(i.currentPath.shape.closed=!1),e.addChild(i),void(a.innerHTML=Math.round(100*this.target.value).toString())):void TweenMax.killTweensOf(this.target)},onComplete:s})},T=function(t,l,r,o,s){l=l||!1,r=r||0;var u=45,c=280;if(l)x(t,r,u,c,function(){0!==n.value||o||H(!0),"function"==typeof s&&s()});else{n.value=t;var d=-Math.PI/2;i&&(i.clear(),e.removeChild(i)),i=pixiUtils.createArc(45,d,d+2*Math.PI*n.value,3,U(n.value),1),i.position.set(u,c),i.currentPath&&(i.currentPath.shape.closed=!1),e.addChild(i),a.innerHTML=Math.round(100*n.value).toString(),0===n.value&&H(!0)}},y=function(e){h=e,o.setHeartrate(e);var t={value:parseInt(l.innerHTML)};TweenMax.to(t,.3,{value:e,onUpdate:function(){return l?void(l.innerHTML=Math.round(t.value)):void TweenMax.killTweensOf(this.target)}});var n=e/80;o.setBeatSpacingScalar(n)},b=function(e){y(h+e)},P=function(e){var t={value:parseInt(r.innerHTML)};TweenMax.to(t,.3,{value:e,onUpdate:function(){return r?void(r.innerHTML=Math.round(t.value)):void TweenMax.killTweensOf(this.target)}});var n=e/96;s.setBeatSpacingScalar(n)},H=function(e){v=e,v&&(T(0,!0,0,!0),y(0)),o.setFlatline(v),s.setFlatline(v)},S=function(e,t,n,a,i){a?e.style.right=t+"px":e.style.left=t+"px",i?e.style.bottom=n+"px":e.style.top=n+"px"},I=function(n,a){e.position.set(n,a),S(t,n,a)},L=function(n){e.scale.set(n,n),$(t).css({transform:"scale("+n+")"})},U=function(e){return e*=100,e>constants.conditions.stable.value?constants.colors.green:e>constants.conditions.fair.value?constants.colors.yellow:constants.colors.red},O=function(){return e.width},k=function(){return e.height},E=function(){return e},R=function(){return t},q=function(){return c},F=function(){o.dispose(),s.dispose(),e.destroy(!0),$(t).remove(),e=null,t=null,n=null,a=null,i=null,l=null,r=null,o=null,s=null,u=null,c=null,d=null,v=null,clearTimeout(d)};return f(),{setLife:T,setFlatline:H,setHeartrate:y,setHeartrateAdditive:b,setPosition:I,setScale:L,getWidth:O,getHeight:k,getOriginalSize:q,getContainer:E,getContainerHTML:R,dispose:F}};module.exports=PatientDataView;
},{"./constants":62,"./graph-wave":66,"shared/utils/general-utils":193,"shared/utils/pixi-utils":194}],71:[function(require,module,exports){
"use strict";var utils=require("shared/utils/general-utils"),constants=require("./constants"),PatientHealthBar=function(t,n,e,a){var o,i,r,u,s,l,c,f,d=!1,v=function(){_.extend(this,Backbone.Events),o=this,r=new PIXI.Container;var a,s=[new PIXI.Point(1,n),new PIXI.Point(t,n),new PIXI.Point(t,1),new PIXI.Point(1,1)],l=[0,-Math.PI/2,-Math.PI,Math.PI/2],d=[t-1,n-1,t-1,n-1];i=[];for(var v=0;4>v;v++)a=new PIXI.Graphics,a.position=s[v],a.rotation=l[v],a.userData={originalWidth:d[v]},r.addChild(a),i.push(a);c=e,u=Date.now(),f=!0,h()},I=function(){u=Date.now(),s=setInterval(function(){h()},1e3/30)},h=function(){var t=Date.now(),n=t-u;P(100*c-n/a*100)},P=function(t,n){if(f){l=utils.clamp(t,0,100);var e,a=Math.floor(l/25),r=l%25,u=n?n:g(l),c=i.length,d=[10,0,0,0],v=[0,0,0,10];0>=r&&(r=.1);var I=function(t,n,e){t.clear(),e>n&&(t.lineStyle(1,u,1),t.moveTo(n-.5,0),t.lineTo(e+.5,0))};for(e=0;a>e;e++)I(i[e],d[e],i[e].userData.originalWidth-v[e]);if(c>a)for(I(i[a],d[a],(i[a].userData.originalWidth-v[e])*(r/25)),e=a+1;e<i.length;e++)i[e].clear();0>=l&&(f=!1,o.trigger("dead"),clearInterval(s),s=null)}},g=function(t){return t>constants.conditions.stable.value?constants.colors.green:t>constants.conditions.fair.value?constants.colors.yellow:constants.colors.red},w=function(){return r},p=function(){return l},D=function(t){t=t},C=function(t){a=t},M=function(t){a*=t},T=function(t){var n={value:c};TweenMax.to(n,.6,{value:c*t,ease:Quart.easeInOut,onUpdate:function(){c=n.value}})},X=function(t,n){var e={value:u};TweenMax.to(e,.6,{value:u+a*t,ease:Quart.easeInOut,onUpdate:function(){u=e.value},onComplete:n})},m=function(t){d=t,d?(clearInterval(s),s=null,TweenMax.to({p:l},.6,{p:100,ease:Quart.easeInOut,onUpdate:function(){P(this.target.p,g(this.target.p))}})):(u=Date.now(),I())};return{init:v,setCondition:D,setDuration:C,scaleDuration:M,scaleLifePercentage:T,addTime:X,setHealed:m,getContainer:w,getPercentage:p,getColorForPercentage:g,startCountdown:I}};module.exports=PatientHealthBar;
},{"./constants":62,"shared/utils/general-utils":193}],72:[function(require,module,exports){
"use strict";var InjuryItem=require("./injury-item"),constants=require("./constants"),utils=require("shared/utils/general-utils"),ns=require("shared/namespace"),PatientManager=function(e,t){var n,i,a,r,s,u,o,l,c,f=!1,g=.25,d=function(){_.extend(this,Backbone.Events),n=this,i=t,s=0,p(),v()},h=function(){if(o&&a[i].statusItem&&!f){var e=S();o.setLife(e/100),c&&(e>0&&e<constants.conditions.fair.value&&!c.isWarning()?c.startWarning():e>=constants.conditions.fair.value&&c.isWarning()&&(c.stopWarning(),c.setColor(16777215)))}},m=function(t){var n=e.config.ailments,i=[];return _.each(n,function(e){e.body_section===t&&i.push(e)}),i},p=function(){var t,n,i,r,s,u=e.gameData.num_patients,o=e.gameData.injuries_per_patient,l=[0,1,2],c=1,f=.2;a=[];for(var d=0;u>d;d++)r=0,s={index:d,ailments:[],time:e.gameData.max_life_duration,health:1,heartrate:80},0===l.length&&(l=[0,1,2]),n=_.sample(l),t=m(n),l.splice(l.indexOf(n),1),i=_.sample(t,o),_.each(i,function(e){s.ailments.push(e.id),c-=e.damage*f,r+=e.heartrate_modifier*g}),s.health*=c,s.health=utils.clamp(s.health,0,1),s.heartrate+=r,console.log("patient initial health:",s.health),a.push({index:d,alive:!0,data:s,injuries:[],statusItem:null,treated:!1}),_.each(i,function(e){t.splice(_.indexOf(t,e),1)})},v=function(){for(var t,n=e.config.ailments,i=e.config.treatments,r=a.length,s=0;r>s;s++){t=a[s].data.ailments;for(var u=0;u<t.length;u++){var o=new InjuryItem(n[t[u]],s,i);o.init(),o.on("treatmentApplied",B),a[s].injuries.push(o)}}},P=function(e){i=e,M(i)&&y()},j=function(e){f=e,c&&(c.stopWarning(),c.setColor(16777215))},I=function(e){c=e},y=function(e){_.each(l,function(t){t.disable(),e&&t.cancelReset()})},x=function(){M(i)||_.each(l,function(e){e.enable()})},T=function(e,t){e.on("patientDead",R),a[t].statusItem=e},b=function(e){l||(l=[]),e.on("applied",k),l.push(e)},A=function(e){o=e},D=function(e){return console.log("getInjuriesForPatient:",e,a[e]),a[e].injuries},H=function(e){return a[e].statusItem.getPercentage()},S=function(){return H(i)},W=function(){return a},C=function(){var e=0,t=100*a.length;return _.each(a,function(t){e+=t.statusItem.getPercentage()}),e/t},w=function(){var e,t=0,n=0;return _.each(a,function(i){n+=i.injuries.length,e=1,_.each(i.injuries,function(n){e/=n.getNumberOfTries(),t+=e})}),t/n},E=function(){var e=0,t=0;return _.each(a,function(n){t+=n.injuries.length,_.each(n.injuries,function(t){e+=t.getTreatmentScore()})}),e/t},q=function(){var e=!0;return _.each(a,function(t){_.each(t.injuries,function(t){t.getTreated()||(e=!1)})}),console.log("checkIfAllPatientsHealed:",e),e},M=function(e){var t=!0;return _.each(a[e].injuries,function(e){e.getTreated()||(t=!1)}),t},O=function(e){return!a[e].alive},L=function(){var e=q(),t=!1;if(e)n.trigger("allPatientsHealed"),t=!0;else{var i=!0;_.each(a,function(e){O(e.index)||M(e.index)||(i=!1)}),i&&(t=!0,n.trigger("allPatientsComplete"))}return t},R=function(e){constants.isMobile?n.trigger("allPatientsDead"):(s++,ns.audioProxy.triggerEvent("patient_dead"),o&&a[i].statusItem&&e.index===i&&(o.setLife(0),y(!0),c.isWarning()&&c.stopWarning(),c.setColor(constants.colors.red)),a[e.index].alive=!1,a[e.index].statusItem.setAlive(!1),s===r?n.trigger("allPatientsDead"):L())},k=function(e){e.injury.applyTreatment(e.treatment.id)},B=function(e){a[i].statusItem.applyTimeAddition(e.timeScalar,function(){if(!(e.timeScalar<0)){var t=!1;e.treated?n.trigger("updateHeartrate",{modifier:-e.injury.getData().heartrate_modifier*g}):e.injury.flash(),M(i)&&(a[i].statusItem.setHealed(!0),c.praise(),y(!0),console.log("[PATIENT HEALED]"),constants.isMobile&&n.trigger("nextPatient"));var r=L();!r&&t&&(e.injury.on("relapse",F),e.injury.possiblyRelapse())}}),n.trigger("treatmentApplied")},F=function(e){e.injury.off("relapse",F),a[e.injury.getPatientIndex()].statusItem.setHealed(!1),e.injury.getPatientIndex()===i&&(c.warn(),x()),console.warn("handleRelapse:",e.injury.getPatientIndex(),M(e.injury.getPatientIndex()))},N=function(){_.each(a,function(e){_.each(e.injuries,function(e){e.off(),e.dispose()}),e.statusItem.off()}),n=null,i=null,a=null,r=null,s=null,u=null,o=null,l=null,c=null,f=null};return{init:d,update:h,setCurrentPatientIndex:P,setSwappingPatients:j,setBody:I,registerPatientStatusItem:T,registerTreatmentItem:b,registerPatientDataView:A,getInjuriesForPatient:D,getPatientHealth:H,getCurrentPatientHealth:S,getAllPatientsHealthPercentage:C,getAccuracyScore:w,getOverallTreatmentScore:E,getPatients:W,disableTreatments:y,enableTreatments:x,dispose:N}};module.exports=PatientManager;
},{"./constants":62,"./injury-item":67,"shared/namespace":175,"shared/utils/general-utils":193}],73:[function(require,module,exports){
"use strict";var PatientHealthBar=require("./patient-health-bar"),constants=require("./constants"),PatientStatusItem=function(t){var e,n,a,i,o,l,u,r=null,d=!1,s=!0,c=69,h=66,f=constants.imagePath+"human.png",x=function(){if(!r){_.extend(this,Backbone.Events),r=this,e=new PIXI.Container,n=new PIXI.Container,o=new PIXI.Graphics,o.lineStyle(1,16777215,.6),o.beginFill(16777215,.1),o.drawRect(0,0,c,h),o.endFill(),o.alpha=.25,n.addChild(o);var u=o.clone();u.alpha=0,e.addChild(u),e.addChild(n);var d=t.index<10?"0"+t.index:t.index.toString();i=new PIXI.Text(d,{font:"12.73px blender-thin",fill:16777215}),i.alpha=.3,i.position.set(7,4),n.addChild(i),a=new PatientHealthBar(c,h,t.data.health,t.data.time),a.init(),a.on("dead",m),n.addChild(a.getContainer());var s=PIXI.loader;s.resources.human||s.add("human",f),s.once("complete",function(){var e=new PIXI.Sprite(PIXI.utils.TextureCache[f]);e.position.set(.5*(o.width-e.width),.5*(o.height-e.height)),e.alpha=.2,n.addChild(e),l=e,t.active&&T(!0)}),s.load(),v()}},p=function(){r||(_.extend(this,Backbone.Events),r=this,a=new PatientHealthBar(c,h,t.data.health,t.data.time),a.init(),a.on("dead",m),d=t.active)},v=function(){e.interactive=!0,e.buttonMode=!0,e.mouseover=function(t){(l&&!d||!t)&&(TweenMax.to(o,.3,{alpha:.75}),TweenMax.to(l,.3,{alpha:.8}),TweenMax.to(i,.3,{alpha:.8}),t?TweenMax.to(n.position,.2,{x:4,y:-4,ease:Quart.easeOut}):TweenMax.to(n.position,.2,{x:0,y:0,ease:Quart.easeOut}))},e.mouseout=function(){l&&!d&&(TweenMax.to(o,.3,{alpha:.25}),TweenMax.to(l,.3,{alpha:.2}),TweenMax.to(i,.3,{alpha:.3}),TweenMax.to(n.position,.2,{x:0,y:0,ease:Quart.easeOut}))},e.click=function(){if(l&&!d){r.trigger("selected",{item:r,data:t.data,index:t.index-1});var n=!0,a=0;clearInterval(u),u=setInterval(function(){n=!n,e.visible=n,a++,8===a&&clearInterval(u)},35)}},w()},w=function(){e.interactive=!1,e.buttonMode=!1,e.mouseout()},g=function(){s&&(e.interactive=!0,e.buttonMode=!0)},I=function(t){s=t,s||w()},M=function(){a.startCountdown()},m=function(){if(console.log("handlePatientDead"),e){e.interactive=!1,e.buttonMode=!1;var a=constants.colors.red;o.tint=a,l.tint=a,i.tint=a,TweenMax.to(o,.3,{alpha:1}),TweenMax.to(l,.3,{alpha:.7}),TweenMax.to(n.position,.2,{x:0,y:0,ease:Quart.easeOut})}r.trigger("patientDead",{index:t.index-1})},P=function(t,e){a.addTime(t,e)},T=function(t){d=t,t?(e.interactive=!1,e.buttonMode=!1,e.mouseover()):(e.interactive=!0,e.buttonMode=!0,e.mouseout())},b=function(t,n){t=Math.round(t),n=Math.round(n),e.position.set(t,n)},C=function(t){e.scale.set(t,t)},X=function(t){a.setHealed(t)},y=function(){return e.width},H=function(){return e.height},S=function(){return e},B=function(){return a.getPercentage()},O=function(){return t.data},Q=function(){return t.index-1},k=function(){a.off(),clearInterval(u),r=null,e=null,n=null,d=null,s=null,a=null,i=null,o=null,c=null,h=null,f=null,l=null,u=null};return{init:x,initLite:p,disable:w,enable:g,setPosition:b,setScale:C,setActive:T,setHealed:X,setAlive:I,applyTimeAddition:P,startCountdown:M,getWidth:y,getHeight:H,dispose:k,getContainer:S,getPercentage:B,getData:O,getRealIndex:Q,isInitialized:function(){return null!==r}}};module.exports=PatientStatusItem;
},{"./constants":62,"./patient-health-bar":71}],74:[function(require,module,exports){
"use strict";var constants=require("./constants"),ns=require("shared/namespace"),CursorManager=require("shared/utils/cursor-manager"),TreatmentItem=function(e){var n,t,i,a,o,l,r,s,c,u,d,p,f,x,y,h,g,m,v,w=null,T=!1,b=new PIXI.Point,I=new PIXI.Point,M=!1,C=e.width||90,P=e.height||90,H=constants.isMobile,S={},k=1,E=!1,L={},z=function(){_.extend(this,Backbone.Events),w=this,H&&window.innerHeight<=constants.minHeight&&(k=constants.minHeightScalar),n=e.ui,t=n.getInjuries();var a=e.index<10?"0"+e.index:e.index.toString();h=F(a,e.data.title,"READY -"),$(h).css({width:C+"px",height:P+"px"}),y=new PIXI.Container,y.scale.set(k,k);var o=te(C,P,255,0);y.addChild(o),i=e.data.time_to_administer,p=ne(constants.colors.yellow,{radius:39,opacity:.17},{radius:25,opacity:.17},{radius:13,opacity:.42}),p.alpha=0,p.scale.set(0,0),p.renderable=!1,f=new PIXI.Point(1,1),x=new PIXI.Graphics,H||(X(),$(h).css({opacity:0,display:"none"}),y.renderable=!1,V()),g=!0,n.on("update",function(){Q()})},X=function(){var e=$(h);e.mouseover(function(){g&&Y()}).mouseout(function(){g&&B()}).mousedown(function(e){G(e.clientX,e.clientY)})},F=function(e,n,t){var i=document.createElement("div");$(i).addClass("treatment-item");var p=["box1","box2","box3","box4"];return _.each(p,function(e){var n=document.createElement("div");$(n).addClass(e),i.appendChild(n)}),r=$(i).find(".box1"),s=$(i).find(".box2"),c=$(i).find(".box3"),u=$(i).find(".box4"),l=document.createElement("div"),l.innerHTML=e,$(l).addClass("num-label"),u.append(l),o=document.createElement("div"),o.innerHTML=n.toUpperCase(),$(o).addClass("treatment-label"),u.append(o),a=document.createElement("div"),a.innerHTML=t.toUpperCase(),$(a).addClass("time-label"),u.append(a),d=$(document.createElement("div")),d.addClass("bottom-line"),u.append(d),i},O=function(n){n=n||1;var t=o.innerHTML.split(" "),i=!1;_.each(t,function(e){e.length>10&&(i=!0)}),i&&$(o).css({fontSize:e.lrgFontSize*n*.85+"px"})},j=function(){var n=1;window.innerHeight<constants.breakpoint&&(n=.8),$(h).css({height:P*n+"px"}),y.scale.y=k*n,e.lrgFontSize&&($(l).css({fontSize:e.lrgFontSize*n+"px"}),$(o).css({fontSize:e.lrgFontSize*n+"px"})),e.smlFontSize&&$(a).css({fontSize:e.smlFontSize*n+"px"}),O(n),de(L.pixi.x,L.pixi.y),pe(L.html.x,L.html.y)},D=function(){k=H&&window.innerHeight<=constants.minHeight?constants.minHeightScalar:1,y.scale.set(k,k)},Q=function(){x&&(x.clear(),p.renderable&&(x.lineStyle(1,16777215,.3),x.moveTo(p.position.x,p.position.y),x.lineTo(b.x+4,b.y+y.height/2),p.scale.x+=.25*(f.x-p.scale.x),p.scale.y+=.25*(f.y-p.scale.y),R(!0),M?CursorManager.setCursor(document.body,"grabbing"):CursorManager.setCursor(document.body,"grab")))},R=function(e){H||n.setCursorLocked(e)},Y=function(){g&&!T&&(R(!0),CursorManager.setCursor(document.body,"grab"),r.css({opacity:.3}),s.css({opacity:.4}),c.css({opacity:1}),u.css({backgroundColor:"rgba(255, 255, 255, 1)",marginLeft:"5px",marginTop:"-5px"}),$(l).css({opacity:.8,color:"#000000"}),$(o).css({color:"#000000"}),$(a).css({opacity:.6,color:"#000000"}),d.css({opacity:1}),ns.audioProxy.triggerEvent("treatment_over"))},B=function(){g&&!T&&(M||(R(!1),r.css({opacity:.1}),s.css({opacity:.2}),c.css({opacity:.8}),u.css({backgroundColor:"rgba(255, 255, 255, 0)",marginLeft:"0",marginTop:"0"}),$(l).css({opacity:.5,color:"#ffffff"}),$(o).css({color:"#ffffff"}),$(a).css({opacity:.5,color:"#ffffff"}),d.css({opacity:0})))},q=function(e){W(e.clientX,e.clientY)},A=function(){U()},G=function(e,t){n.setBlockingMouse(!0),g&&!T&&(H&&Y(),M=!0,S.x=e,S.y=t,p.interactive=!0,p.renderable=!0,p.position.set(S.x,S.y),TweenMax.to(p,.3,{alpha:1}),TweenMax.to(f,.3,{x:1,y:1,ease:Quart.easeOut}),Z(),w.trigger("treatmentPickedUp"))},U=function(t,i,a){if(n.setBlockingMouse(!1),R(!1),g&&M&&!T){if(i=i||0,a=a||0,H&&B(),ee(),!t){M=!1,TweenMax.killTweensOf(p),TweenMax.killTweensOf(f),TweenMax.killTweensOf(p.position),TweenMax.to(f,.3,{x:0,y:0,ease:Quart.easeInOut,delay:.15});var o=p.injury;if(o){console.log("dropped on injury:",o.getData()),o.setTint(null);var l=o.getPosition().clone();l.x-=i,l.y-=a,TweenMax.to(p.position,.3,{x:l.x,y:l.y,ease:Quart.easeInOut,onComplete:function(){TweenMax.to(p,.2,{alpha:0}),p.renderable=!1,p.interactive=!1,B(),K()}}),w.trigger("applied",{injury:o,treatment:e.data}),p.injury=null,ns.audioProxy.triggerEvent("treatment_drop")}else TweenMax.to(p.position,.3,{x:b.x+C/2*k,y:b.y+P/2*k,ease:Quart.easeInOut,onComplete:function(){TweenMax.to(p,.2,{alpha:0}),p.renderable=!1,p.interactive=!1,B()}})}w.trigger("treatmentDropped")}},W=function(e,n,i,a){if(g&&!T&&M){i=i||0,a=a||0,p.position.x=e,p.position.y=n;for(var o=null,l=new PIXI.Point(p.position.x+i,p.position.y+a),r=0;r<t.length;r++)t[r].getHit().containsPoint(l)?(o=t[r],t[r].setTint(16777215)):t[r].setTint(null);p.injury=o,f.x=o?.67:1,f.y=o?.67:1}},V=function(){M=!1,B(),U(!0),T=!0},J=function(){T=!1},K=function(e){e=e||i;var n=Date.now();g=!1,V(),clearInterval(m),m=setInterval(function(){var t=Date.now(),i=e-(t-n);a.innerHTML=Math.round(i/1e3)+" SEC",0>=i&&(clearInterval(m),a.innerHTML="READY -",J(),g=!0)},1e3/30)},N=function(){clearInterval(m),m=null,a.innerHTML="READY -",g=!0},Z=function(){if(y){var e=Quart.easeInOut,n=.9,t=1.8,i=1.2,a=2.4;p.children[0].scale.set(0,0),p.children[0].alpha=1,p.children[1].scale.set(0,0),p.children[1].alpha=1,TweenMax.to(p.children[0].scale,n,{x:1,y:1,ease:e}),TweenMax.to(p.children[0],t,{alpha:0,ease:e}),TweenMax.to(p.children[1].scale,i,{x:1,y:1,ease:e}),TweenMax.to(p.children[1],a,{alpha:0,ease:e,onComplete:Z})}},ee=function(){if(y){var e=Quart.easeOut,n=.6;TweenMax.to(p.children[0].scale,n,{x:0,y:0,ease:e}),TweenMax.to(p.children[0],n,{alpha:0,ease:e}),TweenMax.to(p.children[1].scale,n,{x:0,y:0,ease:e}),TweenMax.to(p.children[1],n,{alpha:0,ease:e,onComplete:Z})}},ne=function(e,n,t,i){var a=H?1.5:1,o=new PIXI.Container,l=function(e,n,t){var i=new PIXI.Graphics;return i.lineStyle(1,16777215,1),i.beginFill(16777215,n),i.drawCircle(0,0,e),i.endFill(),i.tint=t,i},r=l(n.radius*a,n.opacity,e);r.scale.set(0,0),r.alpha=0,o.addChild(r);var s=l(t.radius*a,t.opacity,e);s.scale.set(0,0),s.alpha=0,o.addChild(s);var c=l(i.radius*a,i.opacity,e);return o.addChild(c),o},te=function(e,n,t,i){var a=new PIXI.Graphics;return a.beginFill(t,i),a.drawRect(0,0,e,n),a.endFill(),a},ie=function(){return y.width},ae=function(){return y.height},oe=function(){return p},le=function(){return x},re=function(){return y},se=function(){return h},ce=function(){return y.position},ue=function(){b.set(I.x+y.parent.position.x,I.y+y.parent.position.y)},de=function(e,n){e=0|e,n=0|n,y.position.set(e,n),H?b.set(e,n):b.set(e+y.parent.position.x,n+y.parent.position.y),I.set(e,n),p.position.set(b.x+C/2,b.y+P/2),L.pixi={x:e,y:n}},pe=function(e,n){fe(h,e,n),L.html={x:e,y:n}},fe=function(e,n,t){e.style.left=n+"px",e.style.top=t+"px"},xe=function(e){t=e},ye=function(e){if(!E){e=e||0,E=!0;var n=0,t=!0;h.style.display="inline",clearInterval(v),setTimeout(function(){v=setInterval(function(){h.style.opacity=t?1:0,n++,t=!t,3===n&&clearInterval(v)},20)},e),y.renderable=!0}},he=function(e){if(E){e=e||0,E=!1;var n=0,t=!1;clearInterval(v),setTimeout(function(){v=setInterval(function(){h.style.opacity=t?1:0,n++,t=!t,3===n&&(h.style.display="none",clearInterval(v))},20)},e),y.renderable=!1}},ge=function(){n.off(),clearInterval(m),w=null,n=null,t=null,i=null,T=null,a=null,o=null,l=null,r=null,s=null,c=null,u=null,d=null,b=null,I=null,p=null,f=null,x=null,y=null,h=null,g=null,M=null,C=null,P=null,H=null,S=null,m=null,k=null,E=null,v=null,L=null};return{init:z,update:Q,disable:V,enable:J,resetTime:K,getWidth:ie,getHeight:ae,getContainer:re,getMainElement:se,getDragObj:oe,getLine:le,getPosition:ce,setPosition:de,setPositionHTML:pe,setInjuries:xe,touchstart:G,touchend:U,touchmove:W,mousemove:q,mouseup:A,updateWorldPosition:ue,show:ye,hide:he,checkBreakpoint:j,checkContainerScale:D,cancelReset:N,dispose:ge,isInitialized:function(){return null!==w},isVisible:function(){return E}}};module.exports=TreatmentItem;
},{"./constants":62,"shared/namespace":175,"shared/utils/cursor-manager":192}],75:[function(require,module,exports){
var EdgeHelper=require("shared/lib/EdgeHelper"),Buildings=function(e,n,r){for(var a=new THREE.LineBasicMaterial({color:16777215,transparent:!0,opacity:.1,blending:THREE.AdditiveBlending,linewidth:1.5}),t=new THREE.Geometry,i=new THREE.Vector3,o=140,E=o-1;E>=0;E--){var d=n,l=d*Math.random(),s=Math.random()*Math.PI*2,H=0+l*Math.cos(s),h=0+l*Math.sin(s),M=i.distanceTo(new THREE.Vector3(H,h,0)),w=(n-M)/n*r,T=n/w*Math.random()*.3+1;T=Math.min(T,3);var c={x:T,y:w,z:T},R=new THREE.BoxGeometry(c.x,c.y,c.z),g=new THREE.Matrix4;g.setPosition(new THREE.Vector3(H,.5*c.y,h)),t.merge(R,g)}var m=new THREE.Mesh(t,a),y=new EdgeHelper(m,a);y.rotation.y=45*Math.PI/180,e.add(y)};module.exports=Buildings;
},{"shared/lib/EdgeHelper":156}],76:[function(require,module,exports){
var CamControls=function(e,t,o,n){function a(e){l.enabled!==!1&&(0===e.button?p=E.ROTATE:1===e.button?p=E.ZOOM:2===e.button&&(p=E.PAN),m.set(e.clientX,e.clientY),t.removeEventListener("mousemove",c,!1),t.addEventListener("mousemove",c,!1),t.addEventListener("mouseup",s,!1),t.addEventListener("mouseout",s,!1),t.addEventListener("dblclick",s,!1))}function c(e){if(l.enabled!==!1){v.set(e.clientX,e.clientY);var t=v.x-m.x,o=v.y-m.y;p===E.ROTATE?l.pan(new THREE.Vector3(t,0,o)):p===E.ZOOM?l.zoom(new THREE.Vector3(0,0,o)):p===E.PAN,m.set(e.clientX,e.clientY)}}function s(e){t.removeEventListener("mousemove",c,!1),t.removeEventListener("mouseup",s,!1),t.removeEventListener("mouseout",s,!1),t.removeEventListener("dblclick",s,!1),p=E.NONE}function r(e){e.preventDefault();var t=0;e.wheelDelta?t=-e.wheelDelta:e.detail&&(t=10*e.detail),l.zoom(new THREE.Vector3(0,0,t))}function i(e){if(l.enabled!==!1){switch(e.touches.length){case 1:O[0].set(e.touches[0].pageX,e.touches[0].pageY,0),O[1].set(e.touches[0].pageX,e.touches[0].pageY,0);break;case 2:O[0].set(e.touches[0].pageX,e.touches[0].pageY,0),O[1].set(e.touches[1].pageX,e.touches[1].pageY,0),X=O[0].distanceTo(O[1])}V[0].copy(O[0]),V[1].copy(O[1])}}function u(e){if(l.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=function(e,t){var o=t[0];for(var n in t)o.distanceTo(e)>t[n].distanceTo(e)&&(o=t[n]);return o};switch(e.touches.length){case 1:O[0].set(e.touches[0].pageX,e.touches[0].pageY,0),O[1].set(e.touches[0].pageX,e.touches[0].pageY,0),l.rotate(O[0].sub(t(O[0],V)).multiplyScalar(-.005));break;case 2:O[0].set(e.touches[0].pageX,e.touches[0].pageY,0),O[1].set(e.touches[1].pageX,e.touches[1].pageY,0);var o=O[0].distanceTo(O[1]);l.zoom(new THREE.Vector3(0,0,X-o)),X=o;var n=O[0].clone().sub(t(O[0],V)),a=O[1].clone().sub(t(O[1],V));n.x=-n.x,a.x=-a.x,l.pan(n.add(a).multiplyScalar(.5))}V[0].copy(O[0]),V[1].copy(O[1])}}t=void 0!==t?t:document,this.enabled=!0,this.center=new THREE.Vector3;var l=this,E={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},p=E.NONE,d=this.center,h=new THREE.Matrix3,v=new THREE.Vector2,m=new THREE.Vector2,T=e.position.clone(),w=.18,f=3,g=1.5*n,y=1.5*-o,R=1.5*-o,H=1.5*o,b=1.5*o;this.rotateCamera=function(t){e.rotation._order="YXZ",TweenLite.to(e.rotation,.5,{y:t*Math.PI/2,ease:window.Power3.easeInOut})},this.update=function(){e.position.lerp(T,w)};var x=function(){T.y<f?T.y=f:T.y>g&&(T.y=g),T.z<R?T.z=R:T.z>b&&(T.z=b),T.x<y?T.x=y:T.x>H&&(T.x=H)};this.lookAt=function(e){d=e.clone()};var L={type:"change"};this.focus=function(e,t){},this.pan=function(t){var o=T.distanceTo(d);t.multiplyScalar(.0015*o),t.applyAxisAngle(new THREE.Vector3(0,1,0),e.rotation.y),T.add(t),x(),l.dispatchEvent(L)},this.zoom=function(t){var o=T.distanceTo(d);t.multiplyScalar(5e-5*o),t.length()>o||(t.applyMatrix3(h.getNormalMatrix(e.matrix)),T.add(t),x(),l.dispatchEvent(L))},this.rotate=function(e){},t.addEventListener("mousedown",a,!1),t.addEventListener("mousewheel",r,!1),t.addEventListener("DOMMouseScroll",r,!1);var O=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],V=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],X=null;t.addEventListener("touchstart",i,!1),t.addEventListener("touchmove",u,!1)};CamControls.prototype=Object.create(THREE.EventDispatcher.prototype),CamControls.prototype.constructor=THREE.EditorControls,module.exports=CamControls;
},{}],77:[function(require,module,exports){
var CamControls=require("./cam-controls"),Buildings=require("./buildings"),Mountains=require("./mountains"),CommDots=require("./comm-dots");require("shared/lib/three.js-master/examples/js/postprocessing/EffectComposer"),require("shared/lib/three.js-master/examples/js/postprocessing/RenderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/ShaderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/MaskPass"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader");var ColorifyShader=require("shared/shaders/ColorifyShader"),GlowShader=require("shared/shaders/glow-shader"),BarrelBlurShader=require("shared/shaders/BarrelBlurShader"),white=new THREE.Color(16777215),green=new THREE.Color(714097),orange=new THREE.Color(16763653),red=new THREE.Color(16729156),dpr=1;void 0!==window.devicePixelRatio&&(dpr=window.devicePixelRatio);var Cityscape3D=function(e){console.log("Cityscape3D",e),_.extend(this,Backbone.Events);var o,r,n,i,t,s,a=this,d=!1,c=50,l=20,u=!1,w={},m=0,h=new THREE.Vector2,E=new THREE.Vector2,f=function(){n=new THREE.Scene,n.fog=new THREE.Fog(657930,1,100),o=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),o.position.z=-20,o.position.y=20,o.lookAt(new THREE.Vector3),r=new CamControls(o,e.canvas,c,l);var t=new THREE.AmbientLight(16777215);t.position.set(0,0,1),n.add(t),i=new THREE.WebGLRenderer({canvas:e.canvas}),i.setPixelRatio(window.devicePixelRatio),i.setSize(window.innerWidth,window.innerHeight),i.setClearColor(1118481,1),e.canvas.addEventListener("mousemove",g),e.canvas.addEventListener("click",H),new Buildings(n,c,l),new Mountains(n,c),p(),s=new CommDots({scene:n,camera:o,mousePosition:h,cityBase:c,cityHeight:l,commsData:e.data}),s.on("commDot:mouseover",function(e){a.trigger("commDot:mouseover",e)}),s.on("commDot:mouseout",function(){a.trigger("commDot:mouseout")}),C()},p=function(){t=new THREE.EffectComposer(i),w.render=new THREE.RenderPass(n,o),w.barrelBlur=new THREE.ShaderPass(BarrelBlurShader),w.barrelBlur.uniforms.amount.value=.01,w.glow=new THREE.ShaderPass(GlowShader),w.glow.uniforms.amount.value=1,w.glow.uniforms.size.value=3,w.colorify=new THREE.ShaderPass(ColorifyShader),w.colorify.uniforms.opacity.value=0,w.copy=new THREE.ShaderPass(THREE.CopyShader),w.copy.renderToScreen=!0,t.addPass(w.render),t.addPass(w.glow),t.addPass(w.barrelBlur),t.addPass(w.colorify),t.addPass(w.copy)},v=function(e){},g=function(e){s.raycastCheck=!0,h.set(e.clientX/window.innerWidth*2-1,2*-(e.clientY/window.innerHeight)+1),E.set(e.clientX,e.clientY)},H=function(e){h.set(e.clientX/window.innerWidth*2-1,2*-(e.clientY/window.innerHeight)+1);var o=s.getClosestRaycastDot();o&&(u=!0,a.trigger("commDot:click",{index:o.index}),v(!0)),h.set(-1,-1)},R=Date.now(),C=function(){if(!d){var e=Date.now()-R;R=Date.now(),r.update(),m++,s.update(e),requestAnimationFrame(C),t.render()}};_.extend(this,{mouse:E,resize:function(){o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),t.setSize(window.innerWidth*dpr,window.innerHeight*dpr),i.setSize(window.innerWidth,window.innerHeight)},destroy:function(){d=!0,e.canvas.removeEventListener("mousemove",g)},setFilteredIndexes:function(e,o){s.setFilteredIndexes(e,o)},onDeselect:function(){r.lookAt(new THREE.Vector3),v(!1),u=!1},setDotState:function(e,o){s.setDotState(e,o)},submitEffect:function(e){e?w.colorify.uniforms.color.value=green:w.colorify.uniforms.color.value=red,TweenLite.fromTo(w.colorify.uniforms.opacity,2,{value:1},{value:0})},rotateCamera:function(e){r.rotateCamera(4-e)}}),f()};module.exports=Cityscape3D;
},{"./buildings":75,"./cam-controls":76,"./comm-dots":79,"./mountains":81,"shared/lib/three.js-master/examples/js/postprocessing/EffectComposer":163,"shared/lib/three.js-master/examples/js/postprocessing/MaskPass":165,"shared/lib/three.js-master/examples/js/postprocessing/RenderPass":166,"shared/lib/three.js-master/examples/js/postprocessing/ShaderPass":167,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/shaders/BarrelBlurShader":177,"shared/shaders/ColorifyShader":178,"shared/shaders/glow-shader":188}],78:[function(require,module,exports){
var paths=require("shared/paths"),CommDotShader=function(){return{attributes:{size:{type:"f",value:[]},customColor:{type:"c",value:[]},time:{type:"f",value:[]}},uniforms:{color:{type:"c",value:new THREE.Color(16777215)},texture:{type:"t",value:THREE.ImageUtils.loadTexture(paths.IMGS+"intel-sweep/dot-512.png")}},vertexShader:["attribute float size;","attribute vec3 customColor;","attribute float time;","varying vec3 vColor;","varying float vTime;","void main() {","vColor = customColor;","vTime = time;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = size * ( 300.0 / length( mvPosition.xyz ) );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D texture;","varying vec3 vColor;","varying float vTime;","void main() {","vec4 texel = texture2D( texture, gl_PointCoord );","if ( texel.a < ALPHATEST ) discard;","float blink = 0.65 + (sin(vTime*0.002)+1.0) * 0.25 - 0.25;","vec3 texColOp = texel.xyz * vColor * blink;","gl_FragColor = vec4( texColOp, texel.a );","}"].join("\n"),alphaTest:.9}};module.exports=CommDotShader;
},{"shared/paths":176}],79:[function(require,module,exports){
var white=new THREE.Color(16777215),green=new THREE.Color(714097),orange=new THREE.Color(16763653),red=new THREE.Color(16729156),CommDotShader=require("./comm-dot-shader"),DOT_SIZE=.75,CommDots=function(e){var t,o,a=e.scene,n=e.camera,r=e.commsData,i=e.mousePosition,s=e.cityHeight,c=e.cityBase,u=this,d=[],l=new THREE.Raycaster,m=function(){var e=new THREE.Geometry;r.forEach(function(t,o){var a=new THREE.Vector3;a.index=o;var n=new THREE.Vector3,i=o/r.length*c,u=Math.random()*Math.PI*2;a.x=i*Math.cos(u),a.z=i*Math.sin(u);var l=n.distanceTo(a);a.y=Math.random()*Math.abs(Math.min(l-s,2*DOT_SIZE)),a.y=Math.max(DOT_SIZE,a.y),a.active=!1,e.vertices.push(a),d.push(a)}),o=new THREE.ShaderMaterial(new CommDotShader),window.dotShaderMaterial=o,t=new THREE.PointCloud(e,o);for(var n=o.attributes.size.value,i=o.attributes.customColor.value,u=o.attributes.time.value,l=t.geometry.vertices,m=0,h=l.length;h>m;m++)n[m]=1e-5,i[m]=orange.clone(),u[m]=1e5*Math.random();a.add(t)},h=null,E=function(){var e=u.getClosestRaycastDot();e?h!==e.index&&(null!==h&&v(h,!1),h=e.index,v(h,!0),u.trigger("commDot:mouseover",{index:e.index})):null!==h&&(v(h,!1),h=null,u.trigger("commDot:mouseout"))},v=function(e,t){if(d[e].active!==!1){var a=t?.5:.3,n={ease:Power3.easeOut,onUpdate:function(){o.attributes.size.needsUpdate=!0}};n[e]=t?1.5*DOT_SIZE:DOT_SIZE,TweenLite.to(o.attributes.size.value,a,n)}},f=function(e,t){d[e].active=t;var a=t?.5:.3,n={ease:Power3.easeOut,onUpdate:function(){o.attributes.size.needsUpdate=!0},delay:.5*Math.random()};n[e]=t?DOT_SIZE:1e-7,TweenLite.to(o.attributes.size.value,a,n)},w=function(e,t){d[e].state=t;var a=.5,n={dismissed:white.clone(),correct:green.clone(),incorrect:red.clone()},r=n[t]||orange.clone();console.log("setDotState",e,t,r);var i={ease:Power3.easeOut,onUpdate:function(){o.attributes.customColor.needsUpdate=!0},r:r.r,g:r.g,b:r.b};TweenLite.to(o.attributes.customColor.value[e],a,i)};_.extend(this,Backbone.Events),_.extend(this,{raycastCheck:!1,update:function(e){this.raycastCheck&&(this.raycastCheck=!1,E());var t=o.attributes.time.value;t.forEach(function(o,a){t[a]+=e}),o.attributes.time.needsUpdate=!0},setDotState:w,setFilteredIndexes:function(e,t){e.forEach(function(e){f(e,!0)}),t.forEach(function(e){f(e,!1)})},getClosestRaycastDot:function(){l.setFromCamera(i,n);var e=l.intersectObject(t);return e=_.filter(e,function(e){return d[e.index].active?e:void 0}),e.sort(function(e,t){return e.distance>t.distance})[0]}}),this.setFilteredIndexes=_.throttle(this.setFilteredIndexes,500),m()};module.exports=CommDots;
},{"./comm-dot-shader":78}],80:[function(require,module,exports){
var gamebase=require("../game-base"),Cityscape3D=require("./cityscape"),Clock=require("../common/clock"),ns=require("shared/namespace"),util=require("shared/utils/util"),paths=require("shared/paths"),flickertransition=require("shared/flickertransition"),commsMediaPath=paths.INTEL_SWEEP+"comms/",IntelSweep=function(e){console.log("IntelSweep",e);var t,i,n,a,s,o,l=this,r=e.$parent,d=e.difficulty,c={translate:0,flag:0,dot:0,filters:0},u=0,f=0,m=function(){r.html(ns.templates.intel_sweep(_.extend({paths:paths},e.data))),i=r.find(".hover-item"),i.on("mouseover",function(){TweenLite.to(i,.2,{autoAlpha:0})}),n=r.find(".selected-item"),[i,n].forEach(function(e){e.css({visibility:"hidden"}),e.find(".item").css("display","none")}),r.find(".selected-overlay").css({visibility:"hidden"}),t.forEach(function(e){e.submitted=!1,e.flagged=!1}),s=new Clock({$el:r.find(".clock .time")}),s.start(),a=new Cityscape3D({canvas:r.find("canvas")[0],data:t}),flickertransition("in",function(){setTimeout(function(){this.$(".info-panels").addClass("state-active")}.bind(this),400),setTimeout(function(){A()},1200)},$("#main"),0),S(),ns.audioProxy.triggerEvent("intel_sweep_start")},v=function(e){setTimeout(function(){h(i,e.index);var t=40,n={top:"auto",left:"auto",bottom:"auto",right:"auto"};i.height()+a.mouse.y>window.innerHeight-120?n.top=a.mouse.y-i.height()-t:n.top=a.mouse.y+t,i.width()+a.mouse.x>window.innerWidth-t?n.left=a.mouse.x-i.width()-t:n.left=a.mouse.x+t,i.css(n)},10),ns.audioProxy.triggerEvent("intel_over")},p=function(){TweenLite.to(i,.2,{autoAlpha:0})},g=function(e){console.log("IntelSweep.onDotClick",e,t[e.index]),c.dot++,o=t[e.index],o.index=e.index,$(".selected-item .submit-btn, .selected-item .dismiss-btn").removeClass("incorrect correct dismissed").addClass(o.state);var a=$(".selected-item .translate-btn");if(a.removeClass("activated"),$(".selected-item .translation").css({opacity:0}),$(".selected-item .translating").css({visibility:"hidden"}),"text"===o.type&&o.translation.length>0?a.removeClass("disabled"):a.addClass("disabled"),TweenLite.to(i,.2,{autoAlpha:0}),n.find(".text-item .translation").html(o.translation),n.find(".audio-item .text").html(o.text),"audio"===o.type){var s=n.find("audio");s.attr({src:commsMediaPath+o.image}),s[0].volume=1,s[0].play(),ns.audioProxy.triggerEvent("audio_start")}r.find(".selected-overlay").removeClass("overlay-fade-out").addClass("overlay-fade-in"),h(n,e.index)},h=function(e,i){var n=t[i];e.css({visibility:"hidden"}),e.find(".item").css("display","none");var a=e.find(".header");a.find(".name").html(n.name),a.find(".date").html(n.date);var s;switch(n.type){case"text":s=e.find(".text-item"),s.find(".text").html(n.text);break;case"image":s=e.find(".image-item"),s.find("img")[0].src=commsMediaPath+n.image;break;case"audio":s=e.find(".audio-item")}s.css({display:"block"}),TweenLite.to(e,.25,{autoAlpha:1,ease:new RoughEase({strength:2,points:15})})},x=function(e){TweenLite.to(n,.3,{autoAlpha:0}),r.find(".selected-overlay").removeClass("overlay-fade-in").addClass("overlay-fade-out"),a.onDeselect();var t=n.find("audio");TweenLite.to(t,.5,{volume:0,onComplete:function(){t[0].pause(),ns.audioProxy.triggerEvent("audio_stop")}})},y=function(){console.log("onClickSubmitIntel",arguments),x(),"intel"===o.classification?(u++,a.submitEffect(!0),ns.audioProxy.triggerEvent("submit_success"),o.state="correct",$(".intel-folder .count .success").html(u),5===u&&R(!0)):(f++,a.submitEffect(!1),ns.audioProxy.triggerEvent("submit_fail"),o.state="incorrect",$(".intel-box .box-x.inactive")[0].classList.remove("inactive"),4===f&&R(!1)),a.setDotState(o.index,o.state)},b=function(){console.log("onClickDismiss"),x(),o.state="dismissed"===o.state?"":"dismissed",a.setDotState(o.index,o.state),c.flag++,ns.audioProxy.triggerEvent("dismiss_intel")},E=function(){var e=$(".selected-item .translate-btn");if(!e.hasClass("activated")){e.addClass("activated");var t=$(".selected-item .translating");t.css({visibility:"visible"});var i=$(".selected-item .translation"),n=i.html();i.html(""),n.split(" ").map(function(e){var t=document.createElement("span");t.className="word",t.style.display="inline-block",e.split("").map(function(e){var i=document.createElement("span");i.innerHTML=e,t.appendChild(i)}),i.append(t),i.append($('<span class="space"> </span>'))}),i.css({opacity:1}),TweenMax.staggerFromTo(i.find(".word span, .space"),.5,{opacity:0},{opacity:1},.05,function(){t.css({visibility:"hidden"})}),c.translate++}},w=function(e){r.find(".cam-rotation .btn.active").removeClass("active"),e.currentTarget.classList.add("active"),a.rotateCamera(parseInt(e.currentTarget.getAttribute("btn"))),ns.audioProxy.triggerUI(ns.audioProxy.UI_EVENTS.GAME_4_CAM_ROTATION_CLICK)},C=function(e){ns.audioProxy.triggerUI(ns.audioProxy.UI_EVENTS.GAME_4_CAM_ROTATION_ROLL_OVER)},T=function(e){ns.audioProxy.triggerUI(ns.audioProxy.UI_EVENTS.GAME_4_CAM_ROTATION_ROLL_OUT)},I=function(e){$(e.currentTarget).toggleClass("active"),A(),ns.audioProxy.triggerUI(ns.audioProxy.UI_EVENTS.GAME_4_FILTER_CLICK)},L=function(e){ns.audioProxy.triggerUI(ns.audioProxy.UI_EVENTS.GAME_4_FILTER_ROLL_OVER)},k=function(e){ns.audioProxy.triggerUI(ns.audioProxy.UI_EVENTS.GAME_4_FILTER_ROLL_OUT)},P=function(e){A()},A=function(){c.filters++;var e=[],i=[],n={image:0,text:0,audio:0},s={audio:r.find(".filter-panel .audio-btn").hasClass("active"),image:r.find(".filter-panel .image-btn").hasClass("active"),text:r.find(".filter-panel .text-btn").hasClass("active")},o=r.find(".search-field input")[0].value.toLowerCase();t.forEach(function(t,a){var l,r=s[t.type];0===o.length?l=!0:(l=-1!==t.text.toLowerCase().indexOf(o),void 0!==t.translation&&(l=l||-1!==t.translation.toLowerCase().indexOf(o))),r&&l?(e.push(a),n[t.type]++):i.push(a)}),a.setFilteredIndexes(e,i),M(n)},M=function(e){var t=function(e,t){var i=parseInt(e.html()),n={value:i};TweenLite.to(n,.5,{value:t,ease:Power3.easeOut,onUpdate:function(){e.html(util.padInt(5,n.value))}})};t(r.find(".audio-count .value"),e.audio),t(r.find(".text-count .value"),e.text),t(r.find(".image-count .value"),e.image)},O=function(){a.on("commDot:mouseover",v),a.on("commDot:mouseout",p),a.on("commDot:click",g),r.find(".filter-panel .btn").on("click",I).on("mouseenter",L).on("mouseleave",k),r.find(".selected-item .close-btn").on("click",x),r.find(".selected-item .submit-btn").on("click",y),r.find(".selected-item .dismiss-btn").on("click",b),r.find(".selected-item .translate-btn").on("click",E),r.find(".search-field input").on("input",P),r.find(".cam-rotation .btn").on("click",w).on("mouseenter",C).on("mouseleave",T),window.addEventListener("resize",S)},U=function(){a.off(),r.find(".filter-panel .btn").off("click",I),r.find(".filter-panel .btn").off("mouseenter",L),r.find(".filter-panel .btn").off("mouseleave",k),r.find(".selected-item .close-btn").off("click",x),r.find(".selected-item .submit-btn").off("click",y),r.find(".selected-item .dismiss-btn").off("click",b),r.find(".selected-item .translate-btn").off("click",E),r.find(".search-field input").off("input",P),r.find(".cam-rotation .btn").off("click",w),window.removeEventListener("resize",S)},S=function(){a.resize()},R=function(e){var t=3e5,i=200,n=(c.dot+c.flag+c.translate+c.filters/12)/i;n=Math.min(1,n);var a={skill:n,accuracy:(u-f)/5,speed:Math.min(t/s.getTime(),1)};e?l.trigger("win",{score:a}):l.trigger("lose",{score:a}),ns.audioProxy.triggerEvent("intel_sweep_end")};_.extend(this,gamebase),_.extend(this,{load:function(e){var i=5,n=_.sample(_.range(i))+1;$.get("assets/data/intel-sweep/General.json",function(i){$.get("assets/data/intel-sweep/V"+n+"b.json",function(n){console.log("specific",n);var a=i.length;1>=d?a=Math.round(.4*i.length):2===d&&(a=Math.round(.7*i.length));var s=_.shuffle(i).slice(0,a),o=s.concat(n),l=_.shuffle(o);console.log(l),t=l,e()})})},enter:function(){m(),O()},exit:function(){a.destroy(),U()}})};module.exports=IntelSweep;
},{"../common/clock":124,"../game-base":125,"./cityscape":77,"shared/flickertransition":155,"shared/namespace":175,"shared/paths":176,"shared/utils/util":199}],81:[function(require,module,exports){
var ImprovedNoise=require("shared/lib/ImprovedNoise"),paths=require("shared/paths"),Mountains=function(e,a){function r(){i=new THREE.Object3D,s=new THREE.MeshBasicMaterial({color:1579032}),n=new THREE.PlaneGeometry(h,h,d,d);var a=new THREE.Mesh(n,s);i.add(a),i.scale.set(l,l,l),a.rotation.x=-Math.PI/2,t();var r=THREE.ImageUtils.loadTexture(paths.IMGS+"intel-sweep/noise-3.jpg");r.wrapS=THREE.RepeatWrapping,r.wrapT=THREE.RepeatWrapping,r.repeat.set(12,12),o=new THREE.MeshBasicMaterial({transparent:!0,opacity:E.lineOpacity,color:16777215,alphaMap:r,wireframe:!0,wireframeLinewidth:1.5});var p=n.clone(),c=new THREE.Mesh(p,o);i.add(c),c.rotation.x=-Math.PI/2,e.add(i)}function t(){for(var e=d+1,r=1e3*Math.random(),t=0;e>t;t++)for(var i=0;e>i;i++){var o=t*e+i,s=(p.noise(t*E.noiseSize+r,i*E.noiseSize,0)+.5)*E.depth,c=n.vertices[o],v=c.length()/h;s*=v*v;var M=c.length()-1*a/l;M=.02*Math.max(0,M),M=Math.min(M,1),n.vertices[o].z=s*M}n.verticesNeedUpdate=!0}var i,n,o,s,p=new ImprovedNoise,h=12*a,d=200,l=.4,E={noiseSize:.2,depth:100,lineOpacity:.05,color:.15,light:1};r()};module.exports=Mountains;
},{"shared/lib/ImprovedNoise":157,"shared/paths":176}],82:[function(require,module,exports){
"use strict";var threeUtils=require("shared/utils/three-utils"),BackgroundShape=function(e){var r,s=function(){var s=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(2236962)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)},color:{type:"c",value:new THREE.Color(526344)},opacity:{type:"f",value:.4},time:{type:"f",value:0}}]),vertexShader:require("../../../shaders/security-bypass/background-shape-vertex.glsl"),fragmentShader:require("../../../shaders/security-bypass/background-shape-fragment.glsl"),transparent:!0,lights:!0,wireframe:!1,side:THREE.DoubleSide,shading:THREE.FlatShading});r=new THREE.Mesh(e,s)},i=function(e,s){e=e||1,s=s||0,TweenMax.to(r.material.uniforms.opacity,e,{value:1,delay:s})},a=function(){threeUtils.disposeOfMesh(r),r=null};return s(),{getMesh:function(){return r},transitionIn:i,dispose:a}};module.exports=BackgroundShape;
},{"../../../shaders/security-bypass/background-shape-fragment.glsl":144,"../../../shaders/security-bypass/background-shape-vertex.glsl":145,"shared/utils/three-utils":197}],83:[function(require,module,exports){
"use strict";var paths=require("shared/paths");module.exports={imagePath:paths.IMGS+"security-bypass/",modelPath:paths.MODELS+"games/security-bypass/",imagePathLocal:"assets/imgs/security-bypass/",zeroedVector3:new THREE.Vector3,minHeight:568,minHeightAlt:320,minHeightScalar:.6,maxPerRow:6,maxTotal:12,colors:{green:714097,yellow:16763653,red:15158348},operators:{add:"add",subtract:"subtract",multiply:"multiply",divide:"divide"},deviceIsTooSmall:function(e){return e=e||this.minHeight,window.innerHeight<=e}};
},{"shared/paths":176}],84:[function(require,module,exports){
"use strict";var threeUtils=require("shared/utils/three-utils"),utils=require("shared/utils/general-utils"),constants=require("./constants"),PathConnection=require("./path-connection"),LightShaft=require("./light-shaft"),ns=require("shared/namespace"),CursorManager=require("shared/utils/cursor-manager");require("shared/lib/three.js-master/examples/js/modifiers/ExplodeModifier");var DecryptionDevice=function(config){var scope,shape,camera,renderer,raycaster,vector,buttons,outlines,lastOverButton=null,lightShaftGeo,lightShaftTexture,lightShafts,selectionPath,connections,mouseDownButton=null,shouldSelectNumber=!0,hasMadeSelection=!1,time=0,enabled=!1,cursorLocked=!1,beingDragged=!1,init=function(){_.extend(this,Backbone.Events),scope=this,camera=config.camera,renderer=config.renderer,raycaster=new THREE.Raycaster,vector=new THREE.Vector3;var e=config.container,t=50,a=config.level<2?new THREE.IcosahedronGeometry(t,config.level):new THREE.OctahedronGeometry(t,config.level),n=new THREE.ExplodeModifier;n.modify(a);var o=new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(0)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)},color:{type:"c",value:new THREE.Color(197379)},opacity:{type:"f",value:1},time:{type:"f",value:0},amplitude1:{type:"f",value:1},amplitude2:{type:"f",value:1},amplitude3:{type:"f",value:1},positionMix1:{type:"f",value:1},positionMix2:{type:"f",value:1},positionMix3:{type:"f",value:1}}]),attributes:{displacement:{type:"v3",value:[]},amplitudeIndex:{type:"f",value:[]},positionAlt:{type:"v3",value:[]},positionMixIndex:{type:"f",value:[]},useOpacity:{type:"f",value:[]}},vertexShader:require("../../../shaders/security-bypass/device-vertex.glsl"),fragmentShader:require("../../../shaders/security-bypass/device-fragment.glsl"),transparent:!0,lights:!0,wireframe:!1,shading:THREE.FlatShading,side:THREE.DoubleSide}),i=o.attributes.displacement.value,r=o.attributes.amplitudeIndex.value;_.each(a.vertices,function(){i.push(new THREE.Vector3(1,1,1)),r.push(_.random(0,2))});var s,l,u=o.attributes.positionAlt.value,c=o.attributes.positionMixIndex.value,h=o.attributes.useOpacity.value;_.each(a.faces,function(e){s=(new THREE.Vector3).add(a.vertices[e.a]).add(a.vertices[e.b]).add(a.vertices[e.c]).divideScalar(3),u[e.a]=s,u[e.b]=s,u[e.c]=s,c.push(3*Math.random()|0,3*Math.random()|0,3*Math.random()|0),l=Math.random()<.5?1:0,h.push(l,l,l)}),shape=new THREE.Mesh(a,o),e.add(shape),lightShaftTexture=THREE.ImageUtils.loadTexture(constants.imagePath+"lightShaft.png"),lightShaftTexture.wrapS=THREE.RepeatWrapping;for(var d=threeUtils.getEdges(shape),p=0;p<d.length;p++){var f=createLightShaft(d[p]);shape.add(f.getMesh())}determineNeighbours(d);var m,g,v,y,b,E,x,w,T=shape.geometry.faces,M=shape.geometry.vertices,S=new THREE.PlaneBufferGeometry(3,1,1,1),D=new THREE.MeshBasicMaterial({color:16777215,side:THREE.DoubleSide}),R=new THREE.Object3D;buttons=[],outlines=[];var H={},O=THREE.ImageUtils.loadTexture;H[constants.operators.add]=O(constants.imagePathLocal+"op_add.png"),H[constants.operators.subtract]=O(constants.imagePathLocal+"op_subtract.png"),H[constants.operators.divide]=O(constants.imagePathLocal+"op_divide.png"),H[constants.operators.multiply]=O(constants.imagePathLocal+"op_multiply.png");for(var P,C=[constants.operators.add,constants.operators.subtract,constants.operators.divide,constants.operators.multiply],B=function(e){var t=e.split("_");return t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),0===t[0]&&(t[0]=1),{min:t[0],max:t[1]}},I=function(e){console.log("getSolvePath");var t=[],a=_.sample(T);t.push(a),a.isActive=!0;for(var n=function(e){for(var t,a=_.slice(e.neighbours),n=a.length,o=0;n>o;o++)if(t=_.sample(a),a.splice(a.indexOf(t),1),!t.isActive)return t.isActive=!0,t;return null},o=1;o<e.length;o++){var i=n(a);i&&(t.push(i),a=i)}return t},L=function(e,t,a){s=getCentroid(e,M),g=e.normal,m=new THREE.Mesh(S,D),m.position.copy(s.clone().multiplyScalar(1.001)),R.position.copy(s.clone()),E=s.clone(),E.add(g),R.lookAt(E),m.rotation.copy(R.rotation),v=createInnerOutline(e,M),v.material.opacity=0,v.visible=!1,outlines.push(v),shape.add(v),t.position.copy(s.clone().multiplyScalar(1.002)),t.rotation.copy(R.rotation),shape.add(t);var n=createButton(e,M,v,t,a);return n},U=function(){_.each(T,function(e){e.isActive=!1})},k=config.equationData,A=k.solve,q=!1,G=0;!q;)U(),P=I(A),P.length===A.length&&(q=!0),G++,!q&&G>=100&&(q=!0,console.log("can't seem to create a valid path for the equation."));var V,N=k.exclude,j=B(k.number_range),Q=!0,F=[];for(p=j.min;p<=j.max;p++)-1===N.indexOf(p.toString())&&F.push(p);for(p=0;p<P.length;p++)V=P[p],Q?(w=parseInt(A[p]),y=createText(A[p])):(b=H[A[p]],y=createOperator(b),w=A[p]),Q=!Q,x=L(V,y,w),shape.add(x),buttons.push(x);for(Q=!0,p=0;p<T.length;p++)if(V=T[p],!V.isActive){if(Q)w=_.sample(F),y=createText(w.toString()),config.isDev&&y.material.color.setHex(3355443);else{var z=_.sample(C);b=H[z],y=createOperator(b),w=z,config.isDev&&y.material.color.setHex(3355443)}Q=!Q,x=L(V,y,w),shape.add(x),buttons.push(x)}selectionPath=[],connections=[]},update=function(e,t){if(buttons){if(beingDragged=t,e&&!beingDragged){var a=threeUtils.getMouseIntersections(e,camera,raycaster,buttons,vector);a?(cursorLocked=!0,lastOverButton&&lastOverButton!==a.object&&mouseout(lastOverButton),beingDragged||CursorManager.setCursor(document.body,"pointer"),mouseover(a.object),lastOverButton=a.object):(cursorLocked=!1,lastOverButton&&(mouseout(lastOverButton),lastOverButton=null))}else beingDragged&&(cursorLocked=!1,mouseout(lastOverButton));var n;if(lightShafts)for(n=0;n<lightShafts.length;n++)lightShafts[n].getUniforms().time.value+=lightShafts[n].getUniforms().timeInc.value;var o;for(n=0;n<selectionPath.length;n++){o=selectionPath[n].userData.connections;for(var i=0;i<o.length;i++)o[i].update(time)}time+=.005}},mouseover=function(e){enabled&&e&&(e.userData.mouseover||e.userData.selected||(ns.audioProxy.triggerEvent("dice_over"),e.userData.mouseover=!0,TweenMax.to(e.userData.outline.material,.45,{opacity:1,ease:Quart.easeOut})))},mouseout=function(e){enabled&&e&&e.userData.mouseover&&!e.userData.selected&&(e.userData.mouseover=!1,TweenMax.to(e.userData.outline.material,.45,{opacity:0,ease:Quart.easeOut}))},mousedown=function(){enabled&&(mouseDownButton=lastOverButton)},mouseup=function(){enabled&&lastOverButton&&lastOverButton===mouseDownButton&&toggleSelection(lastOverButton)},mousedownMobile=function(e){if(enabled){var t=threeUtils.getMouseIntersections(e,camera,raycaster,buttons,vector);t&&(mouseDownButton=t.object)}},mouseupMobile=function(e){if(enabled){var t=threeUtils.getMouseIntersections(e,camera,raycaster,buttons,vector);t&&t.object===mouseDownButton&&toggleSelection(mouseDownButton)}},buttonsAreNeighbours=function(e,t){return-1!==e.userData.face.neighbours.indexOf(t.userData.face)},toggleSelection=function(e){if(e.userData.selected){for(var t=selectionPath.indexOf(e),a=selectionPath.length,n=t;a>n;n++)TweenMax.to(selectionPath[n].userData.outline.material,.45,{opacity:0,ease:Quart.easeOut}),selectionPath[n].userData.selected=!1,selectionPath[n].userData.label.material.color.setHex(16777215),selectionPath[n].userData.label.material.opacity=.38,destroyButtonConnections(selectionPath[n]);selectionPath.splice(t,a-t),shouldSelectNumber=selectionPath.length>0?selectionPath[selectionPath.length-1].userData.isOperator:!0,scope.trigger("deselect",{button:e,start:t,amount:a-t})}else{if(selectionPath.length>=constants.maxTotal)return void warn();if(shouldSelectNumber&&e.userData.isOperator||!shouldSelectNumber&&!e.userData.isOperator)return ns.audioProxy.triggerEvent("dice_click_fail"),void warn();if(selectionPath.length>0&&!buttonsAreNeighbours(selectionPath[selectionPath.length-1],e))return ns.audioProxy.triggerEvent("dice_click_fail"),void warn();if(ns.audioProxy.triggerEvent("dice_click_ok"),shouldSelectNumber=!shouldSelectNumber,hasMadeSelection=!0,selectionPath.push(e),e.userData.selected=!0,e.userData.label.material.color.setHex(13938432),e.userData.label.material.opacity=1,TweenMax.to(e.userData.outline.material,.45,{opacity:1,ease:Quart.easeOut}),selectionPath.length>1){var o=createConnection(selectionPath[selectionPath.length-2],selectionPath[selectionPath.length-1]);shape.add(o.getMesh())}scope.trigger("select",{button:e})}console.log("equation value:",getEquationValue())},determineNeighbours=function(e){var t,a,n,o,i,r,s=e.length,l=shape.geometry.faces;for(i=0;s>i;i++)t=e[i],n=l[t.faceIndex1],o=l[t.faceIndex2],n.edges=n.edges||[],o.edges=o.edges||[],n.edges.push(t),o.edges.push(t);for(s=l.length,i=0;s>i;i++)for(a=l[i],a.neighbours=[],r=0;r<a.edges.length;r++)a!==a.edges[r].face1&&a.neighbours.push(a.edges[r].face1),a!==a.edges[r].face2&&a.neighbours.push(a.edges[r].face2)},getOperatorStringForCode=function(e){var t;switch(e){case constants.operators.add:t="+";break;case constants.operators.subtract:t="-";break;case constants.operators.divide:t="/";break;case constants.operators.multiply:t="*"}return t},getEquationValue=function(){for(var len=selectionPath.length,value=selectionPath.length>0?selectionPath[0].userData.value:0,index=1,getValue=function(e){return e.isOperator?getOperatorStringForCode(e.value):e.value};len>index;)index+1<selectionPath.length&&(value=eval(value.toString()+getValue(selectionPath[index].userData)+getValue(selectionPath[index+1].userData))),index+=2;return value},getCentroid=function(e,t){return(new THREE.Vector3).add(t[e.a]).add(t[e.b]).add(t[e.c]).divideScalar(3)},destroyButtonConnections=function(e){for(var t=0;t<e.userData.connections.length;t++)e.userData.connections[t].isAlive()&&e.userData.connections[t].transitionOut(function(e){e.dispose()})},createConnection=function(e,t){var a=new PathConnection(e.userData.centroid,t.userData.centroid,16763653);return a.init(),e.userData.connections.push(a),t.userData.connections.push(a),a},createInnerOutline=function(e,t){var a=new THREE.LineBasicMaterial({color:13938432,transparent:!0,linewidth:3}),n=1.001,o=t[e.a].clone().multiplyScalar(n),i=t[e.b].clone().multiplyScalar(n),r=t[e.c].clone().multiplyScalar(n),s=new THREE.Geometry;s.vertices.push(o,i,r,o);var l=new THREE.Line(s,a);l.scale.set(.9,.9,.9);var u=1;switch(config.level){case 0:u=4.4;break;case 1:u=4.7;break;case 2:u=4.9}return l.position.add(e.normal.clone().multiplyScalar(u)),l},createButton=function(e,t,a,n,o){var i=new THREE.MeshBasicMaterial({color:constants.colors.yellow}),r=1.001,s=t[e.a].clone().multiplyScalar(r),l=t[e.b].clone().multiplyScalar(r),u=t[e.c].clone().multiplyScalar(r),c=new THREE.Geometry;c.vertices.push(s,l,u),c.faces.push(new THREE.Face3(0,1,2,e.normal.clone()));var h=new THREE.Mesh(c,i);return h.userData.face=e,h.userData.mouseover=!1,h.userData.selected=!1,h.userData.outline=a,h.userData.label=n,h.userData.value=o,h.userData.isOperator="string"==typeof o,h.userData.centroid=getCentroid(c.faces[0],c.vertices),h.userData.connections=[],h.visible=!1,h},createLightShaft=function(e){lightShafts||(lightShafts=[]);var t=e.face1.normal.clone().add(e.face2.normal.clone()).divideScalar(2),a=new THREE.Object3D,n=new THREE.Object3D,o=20;a.position.copy(e.vertex1),a.translateOnAxis(t,o),n.position.copy(e.vertex2),n.translateOnAxis(t,o),lightShaftGeo||(lightShaftGeo=new THREE.PlaneGeometry(1,1,1,1));var i=lightShaftGeo.clone(),r=new LightShaft({geometry:i,texture:lightShaftTexture,vertPositions:[a.position,n.position,e.vertex1,e.vertex2]});return lightShafts.push(r),r},createOperator=function(e){var t=.05,a=new THREE.Mesh(new THREE.PlaneBufferGeometry(64*t,64*t,1,1),new THREE.MeshBasicMaterial({color:16777215,map:e,transparent:!0,opacity:0}));return a},createText=function(e){var t=30,a=document.createElement("canvas"),n=a.getContext("2d");n.font=t+"pt blender-book",a.width=n.measureText(e).width,a.height=2*t,n.font=t+"pt blender-book",n.textAlign="left",n.textBaseline="middle",n.fillStyle="rgb(255, 255, 255)",n.fillText(e,0,t);var o=new THREE.Texture(a);o.needsUpdate=!0;var i=renderer.getMaxAnisotropy();o.needsUpdate=!0,o.minFilter=THREE.LinearFilter,o.magFilter=THREE.LinearFilter,o.generateMipmaps=!0,o.anisotropy=i;var r=.1,s=new THREE.Mesh(new THREE.PlaneBufferGeometry(a.width*r,a.height*r,1,1),new THREE.MeshBasicMaterial({color:16777215,map:o,transparent:!0,opacity:0}));return s},glitch=function(){config.isMobile||(config.glitchShader.enabled=!0,TweenMax.to(config.glitchShader,.6,{scalar:.5,onComplete:function(){TweenMax.to(config.glitchShader,.6,{scalar:0,onComplete:function(){config.glitchShader.enabled=!1}})}}))},warn=function(e){var t=lightShafts.length,a=0;config.isMobile||(config.colorifyShader.uniforms.color.value.setHex(constants.colors.red),TweenMax.to(config.colorifyShader.uniforms.opacity,.6,{value:1,onComplete:function(){TweenMax.to(config.colorifyShader.uniforms.opacity,.6,{value:0,onComplete:e})}}));for(var n=0;t>n;n++)TweenMax.to(lightShafts[n].getUniforms().warningColorMix,.3,{value:1,delay:utils.randomRange(0,.5),onComplete:function(){TweenMax.to(this.target,.3,{value:0,delay:utils.randomRange(0,.5),onComplete:function(){a++,a===t&&"function"==typeof e&&e()}})}})},warnAll=function(e){config.isMobile?"function"==typeof e&&e():TweenMax.to(config.colorifyShader.uniforms.opacity,.6,{value:1,onComplete:function(){TweenMax.to(config.colorifyShader.uniforms.opacity,.6,{value:0,onComplete:e})}})},praise=function(e){var t=lightShafts.length,a=0;config.isMobile||(config.colorifyShader.uniforms.color.value.setHex(constants.colors.yellow),TweenMax.to(config.colorifyShader.uniforms.opacity,.6,{value:1,onComplete:function(){TweenMax.to(config.colorifyShader.uniforms.opacity,.6,{value:0})}}));for(var n=0;t>n;n++)TweenMax.to(lightShafts[n].getUniforms().correctColorMix,.3,{value:1,delay:utils.randomRange(0,.5),onComplete:function(){TweenMax.to(this.target,.3,{value:0,delay:utils.randomRange(0,.5),onComplete:function(){a++,a===t&&"function"==typeof e&&e()}})}})},setEnabled=function(e){enabled=e},transitionIn=function(e){var t=function(){console.log("handleComplete"),_.each(outlines,function(e){e.visible=!0}),"function"==typeof e&&e()};ns.audioProxy.triggerEvent("dice_appear");var a=Quart.easeInOut,n=.6,o=.9;TweenMax.to(shape.material.uniforms.amplitude1,utils.randomRange(n,o),{value:0,ease:a}),TweenMax.to(shape.material.uniforms.amplitude2,utils.randomRange(n,o),{value:0,ease:a}),TweenMax.to(shape.material.uniforms.amplitude3,utils.randomRange(n,o),{value:0,ease:a}),TweenMax.to(shape.material.uniforms.positionMix1,utils.randomRange(n,o),{value:0,ease:a,delay:.1}),TweenMax.to(shape.material.uniforms.positionMix2,utils.randomRange(n,o),{value:0,ease:a,delay:.1}),TweenMax.to(shape.material.uniforms.positionMix3,o,{value:0,ease:a,delay:.1,onComplete:function(){shape.material.uniforms.opacity.value=1,_.each(buttons,function(e){var t=e.userData.label.position.clone().multiplyScalar(1.5),a=utils.randomRange(.3,.6),n=utils.randomRange(0,1);TweenMax.from(e.userData.label.position,a,{x:t.x,y:t.y,z:t.z,ease:Quart.easeInOut,delay:n}),TweenMax.to(e.userData.label.material,a,{opacity:.65,ease:Quart.easeInOut,delay:n})}),_.each(lightShafts,function(e,a){var n=utils.randomRange(0,1),o=a===lightShafts.length-1;e.transitionIn(o?.6:1.2,n,o?t:null)})}})},transitionOut=function(e){_.each(outlines,function(e){TweenMax.killTweensOf(e.material),TweenMax.to(e.material,.3,{opacity:0,onCompleteParams:[e],onComplete:function(e){threeUtils.disposeOfMesh(e)}})}),_.each(buttons,function(e){var t=e.userData.label.position.clone().multiplyScalar(1.5),a=utils.randomRange(.3,.6),n=utils.randomRange(0,1);destroyButtonConnections(e),TweenMax.to(e.userData.label.position,a,{x:t.x,y:t.y,z:t.z,ease:Quart.easeOut,delay:n}),TweenMax.to(e.userData.label.material,.95*a,{opacity:0,ease:Quart.easeOut,delay:n,onCompleteParams:[e.userData.label],onComplete:function(e){threeUtils.disposeOfMesh(e)}})}),_.each(lightShafts,function(e){e.transitionOut(.6,1)});var t=Quart.easeInOut,a=.6,n=.9,o=1.6,i=!0,r=0;TweenMax.to(shape.material.uniforms.amplitude1,utils.randomRange(a,n),{value:1,ease:t,delay:o}),TweenMax.to(shape.material.uniforms.amplitude2,utils.randomRange(a,n),{value:1,ease:t,delay:o}),TweenMax.to(shape.material.uniforms.amplitude3,utils.randomRange(a,n),{value:1,ease:t,delay:o}),TweenMax.to(shape.material.uniforms.positionMix1,utils.randomRange(a,n),{value:1,ease:t,delay:o}),TweenMax.to(shape.material.uniforms.positionMix2,utils.randomRange(a,n),{value:1,ease:t,delay:o}),TweenMax.to(shape.material.uniforms.positionMix3,n,{value:1,ease:t,delay:o,onUpdate:function(){r++,r%2===0&&(i=!i),shape.material.uniforms.opacity.value=i?1:0},onComplete:e})},dispose=function(){threeUtils.disposeOfChildren(shape),scope=null,shape=null,camera=null,renderer=null,raycaster=null,vector=null,buttons=null,outlines=null,lastOverButton=null,lightShaftGeo=null,lightShaftTexture=null,lightShafts=null,selectionPath=null,connections=null,mouseDownButton=null,shouldSelectNumber=null,hasMadeSelection=null,time=null,enabled=null};return{init:init,update:update,getEquationValue:getEquationValue,mousedown:mousedown,mouseup:mouseup,mousedownMobile:mousedownMobile,mouseupMobile:mouseupMobile,transitionIn:transitionIn,transitionOut:transitionOut,warn:warn,warnAll:warnAll,glitch:glitch,praise:praise,setEnabled:setEnabled,dispose:dispose,getMesh:function(){return shape},getHasMadeSelection:function(){return hasMadeSelection},getSelectionLength:function(){return selectionPath.length},getCursorLocked:function(){return cursorLocked}}};module.exports=DecryptionDevice;
},{"../../../shaders/security-bypass/device-fragment.glsl":150,"../../../shaders/security-bypass/device-vertex.glsl":151,"./constants":83,"./light-shaft":88,"./path-connection":91,"shared/lib/three.js-master/examples/js/modifiers/ExplodeModifier":162,"shared/namespace":175,"shared/utils/cursor-manager":192,"shared/utils/general-utils":193,"shared/utils/three-utils":197}],85:[function(require,module,exports){
"use strict";require("shared/lib/three.js-master/examples/js/postprocessing/EffectComposer"),require("shared/lib/three.js-master/examples/js/postprocessing/RenderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/ShaderPass"),require("shared/lib/three.js-master/examples/js/postprocessing/MaskPass"),require("shared/lib/three.js-master/examples/js/postprocessing/GlitchPass"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader"),require("shared/lib/three.js-master/examples/js/shaders/DigitalGlitch");var GrainShader=require("shared/shaders/GrainShader"),GlowShader=require("shared/shaders/GlowShader"),ColorifyShader=require("shared/shaders/ColorifyShader"),GlitchPassAlt=require("shared/shaders/GlitchPassAlt"),EffectsManager=function(e){var s,r,a,l,i=function(){r=new THREE.EffectComposer(e.renderer),a=new THREE.RenderPass(e.scene,e.camera),l=new THREE.ShaderPass(THREE.CopyShader),s={},s.glow=new THREE.ShaderPass(GlowShader),s.glow.uniforms.amount.value=.5,s.glow.uniforms.size.value=3.7,s.glow.uniforms.darkness.value=.14,s.grain=new THREE.ShaderPass(GrainShader),s.colorify=new THREE.ShaderPass(ColorifyShader),s.colorify.uniforms.color.value.setHex(15158348),s.colorify.uniforms.opacity.value=0,s.glitchPass=new GlitchPassAlt,s.glitchPass.enabled=!1,s.glitchPass.scalar=0,r=new THREE.EffectComposer(e.renderer),r.addPass(a),r.addPass(s.glow),r.addPass(s.grain),r.addPass(s.colorify),r.addPass(s.glitchPass),r.addPass(l),l.renderToScreen=!0,n()},o=function(){r.render(.1)},n=function(e,s){r&&r.setSize(e,s)},d=function(){s.glow=null,s.grain=null,s.colorify=null,s.glitchPass=null,s=null,r=null,a=null,l=null};return i(),{update:o,resize:n,getPasses:function(){return s},dispose:d}};module.exports=EffectsManager;
},{"shared/lib/three.js-master/examples/js/postprocessing/EffectComposer":163,"shared/lib/three.js-master/examples/js/postprocessing/GlitchPass":164,"shared/lib/three.js-master/examples/js/postprocessing/MaskPass":165,"shared/lib/three.js-master/examples/js/postprocessing/RenderPass":166,"shared/lib/three.js-master/examples/js/postprocessing/ShaderPass":167,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/lib/three.js-master/examples/js/shaders/DigitalGlitch":171,"shared/shaders/ColorifyShader":178,"shared/shaders/GlitchPassAlt":181,"shared/shaders/GlowShader":182,"shared/shaders/GrainShader":183}],86:[function(require,module,exports){
"use strict";var Clock=require("../common/clock"),UITransitionManager=require("shared/utils/ui-transition-manager"),constants=require("./constants"),GameUIMobile=function(e,t,n,a){var o,s,l,i,r,c,u,d,p,f=!1,g=0,v=6,m=25,h=function(){_.extend(this,Backbone.Events),o=this,s=e.$parent.find("#game-ui"),i={},T(),l=new UITransitionManager,R(),y(),Q(n),N(t)},w=function(){o.trigger("countdownComplete")},x=function(e){g++;var t,n=e.button.userData;t=n.isOperator?O(P(n.value),!0):O(n.value),p.appendChild(t);for(var a,o=$(p).children(),s=o.length,l=0;s>l;l++)a=d[l],$(t).css({left:a.x+"px",top:a.y+"px"});var r=.75*m,c=Math.floor(o.length/(v+1)),u=c*r,f=c>0?0:1,h=constants.deviceIsTooSmall()?constants.minHeightScalar:1,w=45*h+u;$(p).css("bottom",w+"pt"),$(i.equation).css("opacity",f),E()},b=function(e){var t,n,a=$(p).children(),o=a.length;for(t=e.start;t<e.start+e.amount;t++)$(a[t]).remove();for(a=$(p).children(),o=a.length,t=0;o>t;t++)n=d[t],$(a[t]).css({left:n.x+"px",top:n.y+"px"});var s=.75*m,l=Math.floor(o/(v+1)),r=l*s,c=l>0?0:1,u=constants.deviceIsTooSmall()?constants.minHeightScalar:1,f=45*u+r;$(p).css("bottom",f+"pt"),$(i.equation).css("opacity",c),E()},T=function(){c=e.$parent.find(".clock");var t=c.find(".time"),n=c.find(".wand"),a=constants.deviceIsTooSmall()?constants.minHeightScalar:1,o=34*a;c.removeClass("clock").addClass("clock-mobile"),r=new Clock({$el:t,$wands:n,countdown:e.gameData.countdown,stayPositive:!0}),r.on("countdownComplete",w),r.init();var l=i.solve||C("SOLVE",12,"#fff",{useBgPattern:!0});$(l).addClass("ui solve"),i.solve=l;var u=i.answer||C("00",42.5,"#ffcb05",{glow:"glow-yellow-less"});$(u).addClass("ui answer"),i.answer=u;var d=i.levels||C("LEVELS",12,"#fff",{useBgPattern:!0});$(d).addClass("ui levels"),i.levels=d;var f=i.level1||k("1");i.level1=f;var g=i.level2||k("2");$(g).css("marginLeft",o+"pt"),i.level2=g;var v=i.level3||k("3");$(v).css("marginLeft",2*o+"pt"),i.level3=v;var m=i.timer||C("TIMER",12,"#fff",{useBgPattern:!0});$(m).addClass("ui timer"),$(m).css("left",c.position().left+"px"),i.timer=m;var h=i.equation||C("EQUATION",12,"#fff",{useBgPattern:!0});$(h).addClass("ui equation"),i.equation=h;var x=i.unlockBtn||M();$(x).addClass("ui unlock"),i.unlockBtn=x,p=i.equationContainer||document.createElement("div");var b=$(p);b.hasClass("eq-container")||b.addClass("eq-container"),i.equationContainer=p,s.append(p)},y=function(){d=[];for(var e=20,t=0,n=0,a=0;e>a;a++)a%v===0&&0!==a&&(t=0,n+=1.5*m),d.push({x:t,y:n}),t+=m},C=function(e,t,n,a){var o=document.createElement("div");return s.append(o),a=a||{},a.useBgPattern&&(o.style.backgroundImage="url("+constants.imagePath+"tile_3x3_2.png)",o.style.backgroundRepeat="repeat",o.style.padding="2px 4px 3px 4px"),a.glow&&$(o).addClass(a.glow),o.style.fontFamily="blender-book",o.style.fontSize=t+"px",o.style.color=n,o.style.position="absolute",o.style.pointerEvents="none",o.innerHTML=e,o},M=function(){var e=$(document.createElement("div")),t=$(document.createElement("div")),a=$(document.createElement("div")),l=$(document.createElement("div")),i=$(document.createElement("div")),r=$(document.createElement("div"));t.html("UNLOCK"),e.addClass("sbUnlock"),t.addClass("sbC sbTxt"),a.addClass("sbC sbC1"),l.addClass("sbC sbC2"),i.addClass("sbC sbC3"),r.addClass("sbC stemBtn"),e.append(t),e.append(a),e.append(l),e.append(i),e.append(r),s.append(e);var c=!1;return r[0].addEventListener("touchstart",function(){c=!0,TweenMax.to(a,.2,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(a,.8,{scale:1.5,ease:Power4.easeOut});var e=n.getSelectionLength()>0?!0:!1;e?(TweenMax.to(l,.5,{scale:.9,borderColor:"#ffcb05",ease:Power4.easeOut}),TweenMax.to(t,.5,{color:"#ffcb05",ease:RoughEase.ease.config({strength:5.1,points:55})})):(TweenMax.to(l,.5,{scale:.9,borderColor:"#e93e43",ease:Power4.easeOut}),TweenMax.to(t,.5,{color:"#e93e43",ease:RoughEase.ease.config({strength:5.1,points:55})})),TweenMax.to(i,.5,{scale:.75,ease:Power4.easeOut}),TweenMax.to(i,.5,{opacity:.05,ease:RoughEase.ease.config({strength:5.1,points:55})})},!1),r[0].addEventListener("touchend",function(){c=!1;var e=n.getSelectionLength()>0?!0:!1;e?(TweenMax.to(a,.5,{opacity:1,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(a,.3,{scale:1,ease:Power4.easeOut})):(TweenMax.to(a,.5,{opacity:.3,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(a,.3,{scale:1,ease:Power4.easeOut})),TweenMax.to(l,.5,{borderColor:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(l,.5,{scale:1.1,ease:Power4.easeOut}),TweenMax.to(i,.5,{scale:.1,ease:Power4.easeOut}),TweenMax.to(i,.5,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(t,.5,{color:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})}),o.trigger("submit")},!1),TweenMax.to(a,.5,{opacity:.3,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(a,.3,{scale:1,ease:Power4.easeOut}),TweenMax.to(l,.2,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(l,.5,{delay:.15,scale:.5,ease:Power4.easeOut}),TweenMax.to(t,.5,{delay:.1,opacity:.5,color:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})}),e[0]},E=function(){var e=$(i.unlockBtn).find(".sbTxt"),t=$(i.unlockBtn).find(".sbC1"),a=$(i.unlockBtn).find(".sbC2"),o=n.getSelectionLength()>0?!0:!1;o?(TweenMax.to(t,.5,{opacity:1,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(t,.3,{scale:1,ease:Power4.easeOut})):(TweenMax.to(t,.5,{opacity:.3,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(t,.3,{scale:1,ease:Power4.easeOut})),TweenMax.to(a,.2,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(a,.5,{delay:.15,scale:.5,ease:Power4.easeOut}),TweenMax.to(e,.5,{delay:.1,opacity:.5,color:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})})},k=function(e){var t=document.createElement("div");return s.append(t),$(t).addClass("level-item locked-mobile"),t.innerHTML=e,t},P=function(e){var t;switch(e){case constants.operators.add:t=constants.imagePath+"op_add.png";break;case constants.operators.subtract:t=constants.imagePath+"op_subtract.png";break;case constants.operators.divide:t=constants.imagePath+"op_divide.png";break;case constants.operators.multiply:t=constants.imagePath+"op_multiply.png"}return t},O=function(e,t){var n=document.createElement("div");if(n.style.backgroundImage="url("+constants.imagePath+"ring_yellow.png)",n.style.backgroundSize="contain",n.style.backgroundRepeat="no-repeat",n.style.padding="7px 0px 0px 1px",n.style.width="31px",n.style.height="31px",t){var a=new Image;a.width=10,a.height=10,a.src=e,n.appendChild(a)}else n.style.fontFamily="blender-book",n.style.fontSize="14px",n.style.color="#fff",n.innerHTML=e;return n.style.position="absolute",n.style.pointerEvents="none",n.style.textAlign="center",n},L=function(e){R(),l.transitionIn(50,function(){"function"==typeof e&&e(),B(),z()})},I=function(e){R(),l.transitionOut(20,!0,e)},R=function(){l.removeAll(),l.add(i.solve,i.levels,i.timer,i.answer,i.level1,i.level2,i.level3,r.getElement(),i.equation,i.unlockBtn);var e=$(p).children();e.length>0&&l.add(e)},S=function(){c.length>0&&i.timer&&$(i.timer).css("left",c.position().left+"px")},q=function(){r.stop()},B=function(){r.start()},H=function(){return r.getTime()},U=function(){return g},z=function(){u=setInterval(function(){Math.abs(r.getTotalSeconds())<30&&(clearInterval(u),D())},1e3)},D=function(){f=!0;var e=function(){f&&(r.warn(),n.warn(e))};e()},A=function(){f=!1},F=function(){n.off()},G=function(e){var t=[i.level1,i.level2,i.level3];_.each(t,function(t,n){e>n?$(t).removeClass("locked-mobile").addClass("unlocked-mobile"):$(t).removeClass("unlocked-mobile").addClass("locked-mobile")})},N=function(e,n){t=e,n&&(a=n),G(t);var o=i.answer,s=parseInt(o.innerHTML);TweenMax.to({value:s},1,{value:a.answer,onUpdate:function(){o.innerHTML=_.round(this.target.value)}});var l=$(p).children();_.each(l,function(e,t){TweenMax.to(e,1.2,{css:{top:window.innerHeight+100+"px"},ease:Quart.easeInOut,delay:.1*t,onComplete:function(e){$(this.target).remove(),e===l.length-1&&($(p).css("bottom","7.4%"),$(i.equation).css("bottom","16.7%"))},onCompleteParams:[t]})})},Q=function(e){n=e,n.on("select",x),n.on("deselect",b)},V=function(){r.addPenalty(2e4)},j=function(){A(),clearInterval(u),$(s).remove(),r.off(),r.stop(),l.dispose(),o=null,s=null,l=null,i=null,r=null,c=null,u=null,f=null,g=null,d=null,v=null,p=null,m=null};return{init:h,resize:S,addTransitionObjects:R,transitionIn:L,transitionOut:I,startClock:B,stopClock:q,checkTime:z,removeDeviceListeners:F,setDevice:Q,setLevel:N,setLevelLabels:G,warn:V,getTotalSelections:U,getTotalTime:H,dispose:j}};module.exports=GameUIMobile;
},{"../common/clock":124,"./constants":83,"shared/utils/ui-transition-manager":198}],87:[function(require,module,exports){
"use strict";var threeUtils=require("shared/utils/three-utils"),utils=require("shared/utils/general-utils"),constants=require("./constants"),ImprovedNoise=require("shared/lib/ImprovedNoise"),Clock=require("../common/clock"),UITransitionManager=require("shared/utils/ui-transition-manager"),ns=require("shared/namespace"),GameUI=function(e,t,n,o){var a,s,i,l,r,d,h,c,u,p,f,g,w,x,m,y,v,b,T,P,C,M,I,R,E,U,k=25,L=0,O=!1,B=-Math.PI/2,H=0,S=34,F=function(){_.extend(this,Backbone.Events),a=this,s=new PIXI.WebGLRenderer(window.innerWidth,window.innerHeight,{transparent:!0,antialias:!0}),i=new PIXI.Container,s.view.style.position="absolute",l=e.$parent.find("#game-ui"),l.append(s.view),R=new Clock({$el:e.$parent.find(".clock .time"),$wands:e.$parent.find(".clock .wand"),countdown:e.gameData.countdown,stayPositive:!0}),R.on("countdownComplete",K),R.init(),setTimeout(function(){console.log("++++++",Math.abs(q()),1e3*e.gameData.countdown,Math.abs(q())/(1e3*e.gameData.countdown))},5e3),j(),r=[],h=[],c=[],d=new PIXI.Graphics,i.addChild(d),u=new ImprovedNoise,p=PIXI.Texture.fromImage(constants.imagePath+"tile_3x3_2.png"),J(S,B,B+H),Y(),w.renderable=!1,Z(),ee(),f=0,C=[],me(n),xe(t),U=new UITransitionManager,Ie(),D()},D=function(){b=[];for(var e=constants.maxTotal,t=0,n=0,o=0;e>o;o++)o%constants.maxPerRow===0&&0!==o&&(t=0,n+=1.5*k),b.push({x:t,y:n}),t-=k},W=function(){R.stop()},X=function(){R.start()},q=function(){return R.getTime()},G=function(){return L},z=function(){R.addPenalty(2e4)},K=function(){a.trigger("countdownComplete")},N=function(e){var t;switch(e){case constants.operators.add:t=constants.imagePath+"op_add.png";break;case constants.operators.subtract:t=constants.imagePath+"op_subtract.png";break;case constants.operators.divide:t=constants.imagePath+"op_divide.png";break;case constants.operators.multiply:t=constants.imagePath+"op_multiply.png"}return t},V=function(){var e,t,n,o=$(T).children(),a=o.length,s=h[P];_.each(o,function(i,l){n=Math.floor(l/constants.maxPerRow),e=a-l-1+constants.maxPerRow*n,a>constants.maxPerRow&&l<constants.maxPerRow&&(e-=a-constants.maxPerRow),t=b[e],ae(s,o[l],t.x,t.y)})},Q=function(e){L++;var t,n=e.button.userData;t=n.isOperator?pe(N(n.value),!0):pe(n.value),TweenMax.from(t,.6,{css:{opacity:0}}),T.appendChild(t);var o=$(T).children().length,a=Math.floor((o-1)/constants.maxPerRow),s=1.5*k*a;he(t,{x:0,y:s});var i=h[P];ne(i,[t],["html"]),V(),$(M.unlockBtn).find(".stemBtn").mouseout()},A=function(e){console.log("handleDeselection:",e);var t,n=0,o=h[P];for(t=e.start;t<e.start+e.amount;t++)TweenMax.to(o.elements[t],.3,{css:{opacity:0},delay:n,onComplete:function(){T.removeChild(this.target),V()}}),n+=.1;oe(o,e.start,e.amount),$(M.unlockBtn).find(".stemBtn").mouseout()},j=function(){g=window.innerHeight/2*1.05},J=function(e,t,n){if(x&&ge(x),void 0===e&&(e=4),void 0===t&&(t=0),void 0===n&&(n=2*Math.PI),x=new PIXI.Graphics,x.lineStyle(e,16777215,.5),x.arc(window.innerWidth/2,window.innerHeight/2,g,t,n),x.currentPath&&(x.currentPath.shape.closed=!1),w)w.mask=x;else{var o=PIXI.Texture.fromImage(constants.imagePath+"tile_3x3.png");w=new PIXI.extras.TilingSprite(o,window.innerWidth,window.innerHeight),w.mask=x}i.addChild(x),w.parent||i.addChild(w)},Y=function(){var e=threeUtils.degreesToRads(30),t=window.innerWidth/2,n=window.innerHeight/2,o=.15;m&&ge(m),y&&ge(y),v&&ge(v),m=new PIXI.Graphics,m.lineStyle(3,16777215,o),m.arc(t,n,g,Math.PI-e,Math.PI+e,!1),m.currentPath.shape.closed=!1,y=new PIXI.Graphics,y.lineStyle(3,16777215,o);var a=1;y.arc(t,n,g,-e,e*a,!1),y.currentPath.shape.closed=!1,v=new PIXI.Graphics,v.beginFill(16777215,.25);var s,l,r=Math.PI+threeUtils.degreesToRads(35),d=r+threeUtils.degreesToRads(100);for(l=0;12>l;l++)s=fe(utils.randomRange(r,d)),v.drawCircle(s.x,s.y,3);for(r=Math.PI-threeUtils.degreesToRads(35),d=r-threeUtils.degreesToRads(100),l=0;12>l;l++)s=fe(utils.randomRange(r,d)),v.drawCircle(s.x,s.y,3);v.endFill(),i.addChild(m),i.addChild(y),i.addChild(v)},Z=function(){M=M||{};var e=M.text||re("00",72,"#ffcb05",{glow:"glow-yellow-less"}),t=fe(Math.PI+threeUtils.degreesToRads(10),1.1*g,$(e).width(),$(e).height());he(e,t),M.text=e;var n=M.dash1||ce("left",constants.colors.yellow);t=fe(Math.PI+threeUtils.degreesToRads(20),1.125*g),t.x-=n.width,n.position=t,i.addChild(n),M.dash1=n;var o=M.dash2||ce("left",constants.colors.yellow);t=fe(Math.PI+threeUtils.degreesToRads(3),1.125*g),t.x-=o.width,o.position=t,i.addChild(o),M.dash2=o;var a=M.dash3||ce("left",constants.colors.yellow);t=fe(Math.PI+threeUtils.degreesToRads(-20),1.125*g),t.x-=a.width,a.position=t,i.addChild(a),M.dash3=a;var s=M.label1||re("SOLVE",12,"#fff",{useBgPattern:!0});t=fe(Math.PI+threeUtils.degreesToRads(22),1.15*g,$(s).width(),$(s).height()),he(s,t),M.label1=s;var d=M.label2||re("EQUATION",12,"#fff",{useBgPattern:!0});t=fe(Math.PI+threeUtils.degreesToRads(5),1.15*g,$(d).width(),$(d).height()),he(d,t),M.label2=d;var u=threeUtils.degreesToRads(30),p=2*u/3,f=M.pt1||ue(16777215);f.position=fe(Math.PI+u),i.addChild(f),M.pt1=f;var w=M.pt2||ue(16777215);w.position=fe(Math.PI-u+p+p),i.addChild(w),M.pt2=w;var x=M.pt3||ue(16777215);x.position=fe(Math.PI-u+p),i.addChild(x),M.pt3=x;var m=M.pt4||ue(16777215);m.position=fe(Math.PI-u),i.addChild(m),M.pt4=m,T=M.equationContainer||document.createElement("div"),$(T).hasClass("eq-container")||$(T).addClass("eq-container");var y=o.position.x+o.width+10;he(T,{x:y,y:o.position.y+k}),l.append(T),M.equationContainer=T;var v=M.unlockBtn||de(),b=$(v);b.css({left:a.position.x-b.width()-10+"px",top:a.position.y-35+"px"}),M.unlockBtn=v,r.length=0,r.push({start:f,end:n,offset:{x:n.width/2-1,y:0}},{start:f,end:o,offset:{x:o.width/2-1,y:0}},{start:w,end:n,offset:{x:n.width/2-1,y:0}},{start:w,end:o,offset:{x:o.width/2-1,y:0}},{start:w,end:a,offset:{x:a.width/2-1,y:0}},{start:x,end:a,offset:{x:a.width/2-1,y:0}},{start:x,end:o,offset:{x:o.width/2-1,y:0}},{start:m,end:a,offset:{x:a.width/2-1,y:0}},{start:m,end:o,offset:{x:o.width/2-1,y:0}});var C=h[P]||te([],[]);h.length=0,h.push(te([e],["html"]),te([n,s],["pixi","html"]),te([o,d],["pixi","html"]),C),P=h.length-1,c.length=0,c.push(te([v,a],["html","pixi"]))},ee=function(){I=I||{};var e=I.dash1||ce("right",constants.colors.yellow),t=fe(threeUtils.degreesToRads(-20),1.125*g);e.position=t,i.addChild(e),I.dash1=e;var n=I.dash2||ce("right",16777215);t=fe(threeUtils.degreesToRads(-3),1.125*g),n.position=t,i.addChild(n),I.dash2=n;var o=I.dash3||ce("right",16777215);t=fe(threeUtils.degreesToRads(20),1.125*g),o.position=t,i.addChild(o),I.dash3=o;var a=I.label1||re("LEVEL 01",12,"#fff",{useBgPattern:!0});t=fe(threeUtils.degreesToRads(-22),1.15*g,0,$(a).height()),he(a,t),I.label1=a;var s=I.label2||re("LEVEL 02",12,"#fff",{useBgPattern:!0});t=fe(threeUtils.degreesToRads(-5),1.15*g,0,$(s).height()),he(s,t),I.label2=s;var l=I.label3||re("LEVEL 03",12,"#fff",{useBgPattern:!0});t=fe(threeUtils.degreesToRads(18),1.15*g,0,$(l).height()),he(l,t),I.label3=l;var d=I.label4||re("LOCKED",18,"#fff");t=fe(threeUtils.degreesToRads(-18),1.175*g,-8,$(d).height()),he(d,t),I.label4=d;var c=I.label5||re("LOCKED",18,"#fff");t=fe(threeUtils.degreesToRads(-2),1.175*g,-10,$(c).height()),he(c,t),I.label5=c;var u=I.label6||re("LOCKED",18,"#fff");t=fe(threeUtils.degreesToRads(21),1.175*g,-20,$(u).height()),he(u,t),I.label6=u;var p=threeUtils.degreesToRads(30),f=2*p/3,w=I.pt1||ue(16777215);w.position=fe(p),i.addChild(w),I.pt1=w;var x=I.pt2||ue(16777215);x.position=fe(-p+f+f),i.addChild(x),I.pt2=x;var m=I.pt3||ue(16777215);m.position=fe(-p+f),i.addChild(m),I.pt3=m;var y=I.pt4||ue(16777215);y.position=fe(-p),i.addChild(y),I.pt4=y,r.push({start:w,end:o,offset:{x:o.width/2,y:0}},{start:w,end:n,offset:{x:n.width/2,y:0}},{start:x,end:o,offset:{x:o.width/2,y:0}},{start:x,end:n,offset:{x:n.width/2,y:0}},{start:x,end:e,offset:{x:e.width/2,y:0}},{start:m,end:e,offset:{x:e.width/2,y:0}},{start:m,end:n,offset:{x:n.width/2,y:0}},{start:y,end:e,offset:{x:e.width/2,y:0}},{start:y,end:n,offset:{x:n.width/2,y:0}}),h.push(te([e,a,d],["pixi","html","html"]),te([n,s,c],["pixi","html","html"]),te([o,l,u],["pixi","html","html"]))},te=function(e,t){for(var n={elements:e,seed:se(),origins:[],types:t},o=0;o<e.length;o++)"pixi"===t[o]?n.origins[o]={x:e[o].position.x,y:e[o].position.y}:n.origins[o]={x:$(e[o]).position().left,y:$(e[o]).position().top};return n},ne=function(e,t,n,o,a){for(var s,i,l=0;l<t.length;l++)e.elements.push(t[l]),e.types.push(n[l]),"pixi"===n[l]?(s=void 0===o?t[l].position.x:o,i=void 0===a?t[l].position.y:a,e.origins.push({x:s,y:i})):(s=void 0===o?$(t[l]).position().left:o,i=void 0===a?$(t[l]).position().top:a,e.origins.push({x:s,y:i}))},oe=function(e,t,n){e.elements.splice(t,n),e.types.splice(t,n),e.origins.splice(t,n)},ae=function(e,t,n,o){_.each(e.elements,function(a,s){a===t&&(void 0!==n&&(e.origins[s].x=n),void 0!==o&&(e.origins[s].y=o))})},se=function(){return{x:utils.randomRange(-Math.random(),Math.random()),y:utils.randomRange(-Math.random(),Math.random()),z:utils.randomRange(-Math.random(),Math.random())}},ie=function(e){var t,n,o,a,s,i,l,r,d,p,g=.15,w=new THREE.Vector2(e.x,e.y),x={x:0,y:0},m=function(e,t){var n,o,a=new THREE.Vector2(e,t),s=w,i=s.clone().sub(a),l=i.length(),r={x:0,y:0};return i.normalize(),n=1e5/(l*l),i.multiplyScalar(n),o=a.distanceTo(s),100>o&&(r.x=-i.x,r.y=-i.y),r};for(t=0;t<h.length;t++)for(o=h[t],l=10*u.noise(o.seed.x+f,o.seed.y+f,o.seed.z+f),n=0;n<o.elements.length;n++)r=o.origins[n].x+l,d=o.origins[n].y+l,"pixi"===o.types[n]?(p=m(o.elements[n].position.x,o.elements[n].position.y),o.elements[n].position.x+=(r+p.x-o.elements[n].position.x)*g,o.elements[n].position.y+=(d+p.y-o.elements[n].position.y)*g):(a=$(o.elements[n]),s=a.position(),i=a.offset(),p=m(i.left,i.top),s.left+=(r+p.x-s.left)*g,s.top+=(d+p.y-s.top)*g,a.css({left:s.left,top:s.top}));for(t=0;t<c.length;t++)for(o=c[t],l=10*u.noise(o.seed.x+f,o.seed.y+f,o.seed.z+f),n=0;n<o.elements.length;n++)r=o.origins[n].x+l,d=o.origins[n].y+l,"pixi"===o.types[n]?(p=x,o.elements[n].position.x+=(r+p.x-o.elements[n].position.x)*g,o.elements[n].position.y+=(d+p.y-o.elements[n].position.y)*g):(a=$(o.elements[n]),s=a.position(),i=a.offset(),p=x,s.left+=(r+p.x-s.left)*g,s.top+=(d+p.y-s.top)*g,a.css({left:s.left,top:s.top}))},le=function(){d.clear(),d.lineStyle(1,16777215,.1);for(var e=0;e<r.length;e++)d.moveTo(r[e].start.position.x,r[e].start.position.y),d.lineTo(r[e].end.position.x+r[e].offset.x,r[e].end.position.y)},re=function(e,t,n,o){var a=document.createElement("div");return l.append(a),o=o||{},o.useBgPattern&&(a.style.backgroundImage="url("+constants.imagePath+"tile_3x3_2.png)",a.style.backgroundRepeat="repeat",a.style.padding="2px 4px 3px 4px"),o.glow&&$(a).addClass(o.glow),a.style.fontFamily="blender-book",a.style.fontSize=t+"px",a.style.color=n,a.style.position="absolute",a.style.pointerEvents="none",a.innerHTML=e,a},de=function(){var e=$(document.createElement("div")),t=$(document.createElement("div")),o=$(document.createElement("div")),s=$(document.createElement("div")),i=$(document.createElement("div")),r=$(document.createElement("div"));t.html("UNLOCK"),e.addClass("sbUnlock"),t.addClass("sbC sbTxt"),o.addClass("sbC sbC1"),s.addClass("sbC sbC2"),i.addClass("sbC sbC3"),r.addClass("sbC stemBtn"),e.append(t),e.append(o),e.append(s),e.append(i),e.append(r),l.append(e);var d=!1;return r.mouseover(function(){TweenMax.to(o,.2,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(o,.8,{scale:1.5,ease:Power4.easeOut}),TweenMax.to(s,.2,{opacity:1,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(s,.5,{scale:1.1,ease:Power4.easeOut}),TweenMax.to(t,.5,{delay:.1,opacity:1,color:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})}),ns.audioProxy.triggerEvent("view_btn_over")}).mouseout(function(){var e=n.getSelectionLength()>0?!0:!1;e?(TweenMax.to(o,.5,{opacity:1,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(o,.3,{scale:1,ease:Power4.easeOut})):(TweenMax.to(o,.5,{opacity:.3,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(o,.3,{scale:1,ease:Power4.easeOut})),TweenMax.to(s,.2,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(s,.5,{delay:.15,scale:.5,ease:Power4.easeOut}),TweenMax.to(t,.5,{delay:.1,opacity:.5,color:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})}),d&&$(this).mouseup()}).mousedown(function(){d=!0;var e=n.getSelectionLength()>0?!0:!1;e?(TweenMax.to(s,.5,{scale:.9,borderColor:"#ffcb05",ease:Power4.easeOut}),TweenMax.to(t,.5,{color:"#ffcb05",ease:RoughEase.ease.config({strength:5.1,points:55})})):(TweenMax.to(s,.5,{scale:.9,borderColor:"#e93e43",ease:Power4.easeOut}),TweenMax.to(t,.5,{color:"#e93e43",ease:RoughEase.ease.config({strength:5.1,points:55})})),TweenMax.to(i,.5,{scale:.75,ease:Power4.easeOut}),TweenMax.to(i,.5,{opacity:.05,ease:RoughEase.ease.config({strength:5.1,points:55})})}).mouseup(function(){d=!1,TweenMax.to(s,.5,{borderColor:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(s,.5,{scale:1.1,ease:Power4.easeOut}),TweenMax.to(i,.5,{scale:.1,ease:Power4.easeOut}),TweenMax.to(i,.5,{opacity:0,ease:RoughEase.ease.config({strength:5.1,points:55})}),TweenMax.to(t,.5,{color:"#fff",ease:RoughEase.ease.config({strength:5.1,points:55})})}).click(function(e){e.preventDefault(),a.trigger("submit")}),r.mouseout(),e[0]},he=function(e,t){e.style.left=t.x+"px",e.style.top=t.y+"px"},ce=function(e,t){var n=new PIXI.Graphics;return"left"===e?(n.beginFill(t,1),n.drawRect(0,0,12,1),n.endFill(),n.beginFill(16777215,.2),n.drawRect(12,0,12,1),n.endFill()):(n.beginFill(16777215,.2),n.drawRect(0,0,12,1),n.endFill(),n.beginFill(t,1),n.drawRect(12,0,12,1),n.endFill()),n},ue=function(e){var t=new PIXI.Graphics;return t.beginFill(e),t.drawCircle(0,0,3),t.endFill(),t},pe=function(e,t){var n=document.createElement("div");if(n.style.backgroundImage="url("+constants.imagePath+"ring_yellow.png)",n.style.backgroundSize="contain",n.style.backgroundRepeat="no-repeat",n.style.padding="8px 0px 0px 1px",n.style.width="31px",n.style.height="31px",t){var o=new Image;o.width=10,o.height=10,o.src=e,n.appendChild(o)}else n.style.fontFamily="blender-book",n.style.fontSize="14px",n.style.color="#fff",n.innerHTML=e;return n.style.position="absolute",n.style.pointerEvents="none",n.style.textAlign="center",n},fe=function(e,t,n,o){var a=window.innerWidth/2,s=window.innerHeight/2;return t=t||g,n=n||0,o=o||0,new PIXI.Point(a-n+Math.cos(e)*t,s-o+Math.sin(e)*t)},ge=function(e){e.clear(),e.parent&&e.parent.removeChild(e)},we=function(e){var t=[I.label4,I.label5,I.label6];_.each(t,function(t,n){e>n?(t.innerHTML="UNLOCKED",t.style.color="#ffcb05",$(t).removeClass("glow-white").addClass("glow-yellow")):(t.innerHTML="LOCKED",t.style.color="#fff",$(t).removeClass("glow-yellow").addClass("glow-white"))})},xe=function(e,n){t=e,n&&(o=n),we(t);var a=M.text,s=parseInt(a.innerHTML),i=h[0].origins[0];TweenMax.to({value:s},1,{value:o.answer,onUpdate:function(){a.innerHTML=_.round(this.target.value);var e=fe(Math.PI+threeUtils.degreesToRads(10),1.1*g,$(a).width(),$(a).height());he(a,e),i.x=$(a).position().left,i.y=$(a).position().top}});var l=$(T).children();oe(h[P],0,l.length),_.each(l,function(e,t){TweenMax.to(e,1.2,{css:{top:window.innerHeight+100+"px"},ease:Quart.easeInOut,delay:.1*t,onComplete:function(e){$(this.target).remove(),e===l.length-1&&he(T,{x:M.dash2.position.x+M.dash2.width+10,y:M.dash2.position.y+25})},onCompleteParams:[t]})})},me=function(e){n=e,n.on("select",Q),n.on("deselect",A)},ye=function(){n.off()},ve=function(e){Ie(),TweenMax.to({value:0,lineWidth:S},3,{value:2*Math.PI,lineWidth:4,ease:Quart.easeInOut,onStart:function(){w.renderable=!0},onUpdate:function(){H=this.target.value,S=this.target.lineWidth,J(S,B,B+H)},onComplete:function(){ns.audioProxy.triggerEvent("interface_appear"),U.transitionIn(50,function(){"function"==typeof e&&e(),ns.audioProxy.triggerEvent("security_bypass_start"),X(),Ce()})}})},be=function(e){Ie(),U.transitionOut(20,!0),ns.audioProxy.triggerEvent("interface_appear"),TweenMax.to({value:2*Math.PI,lineWidth:S},2,{value:0,lineWidth:34,ease:Quart.easeInOut,onUpdate:function(){H=this.target.value,S=this.target.lineWidth,J(S,B,B+H)},onComplete:e})},Te=function(){O=!0;var e=function(){O&&(R.warn(),n.warn(e))};e()},Pe=function(){O=!1},Ce=function(){E=setInterval(function(){Math.abs(R.getTotalSeconds())<30&&(clearInterval(E),Te())},1e3)},Me=function(e){f+=.01,ie(e),le(),s.render(i)},Ie=function(){U.removeAll(),U.add([m,y,v],[R.getElement(),R.getWands()],M.text,[M.dash1,M.dash2,M.dash3],M.label1,M.label2,[M.pt1,M.pt2,M.pt3,M.pt4],M.equationContainer,M.unlockBtn,[I.dash1,I.dash2,I.dash3],I.label1,I.label2,I.label3,I.label4,I.label5,I.label6,[I.pt1,I.pt2,I.pt3,I.pt4],d);var e=$(T).children();e.length>0&&U.add(e)},Re=function(e,t){s.resize(e,t),j(),J(S,B,B+H),Y(),Z(),ee()},$e=function(){Pe(),clearInterval(E),s.destroy(),$(l).remove(),R.off(),R.stop(),U.dispose(),a=null,s=null,i=null,l=null,r=null,d=null,h=null,c=null,u=null,p=null,f=null,g=null,w=null,x=null,m=null,y=null,v=null,b=null,T=null,k=null,P=null,C=null,M=null,I=null,R=null,L=null,O=null,E=null,U=null};return{init:F,update:Me,transitionIn:ve,transitionOut:be,warn:z,stopClock:W,getTotalTime:q,getTotalSelections:G,resize:Re,setLevel:xe,setLevelLabels:we,setDevice:me,removeDeviceListeners:ye,addTransitionObjects:Ie,dispose:$e}};module.exports=GameUI;
},{"../common/clock":124,"./constants":83,"shared/lib/ImprovedNoise":157,"shared/namespace":175,"shared/utils/general-utils":193,"shared/utils/three-utils":197,"shared/utils/ui-transition-manager":198}],88:[function(require,module,exports){
"use strict";var utils=require("shared/utils/general-utils"),threeUtils=require("shared/utils/three-utils"),constants=require("./constants"),LightShaft=function(e){var t,o,s,i=function(){s=new THREE.ShaderMaterial({uniforms:{color:{type:"c",value:new THREE.Color(16777215)},color2:{type:"c",value:new THREE.Color(constants.colors.red)},color3:{type:"c",value:new THREE.Color(constants.colors.yellow)},warningColorMix:{type:"f",value:0},correctColorMix:{type:"f",value:0},map:{type:"t",value:e.texture},mapRepeat:{type:"v2",value:new THREE.Vector2(60,1)},opacity:{type:"f",value:0},time:{type:"f",value:1e3*Math.random()},timeInc:{type:"f",value:utils.randomRange(.005,.0125)}},vertexShader:require("../../../shaders/security-bypass/light-shafts-vertex.glsl"),fragmentShader:require("../../../shaders/security-bypass/light-shafts-fragment.glsl"),side:THREE.DoubleSide,blending:THREE.AdditiveBlending,transparent:!0,depthWrite:!1}),o=e.geometry,o.vertices[0].copy(e.vertPositions[2]),o.vertices[1].copy(e.vertPositions[3]),o.vertices[2].copy(e.vertPositions[2]),o.vertices[3].copy(e.vertPositions[3]),t=new THREE.Mesh(o,s)},r=function(t,i,r){t=t||.6,i=i||0,TweenMax.to(s.uniforms.opacity,.5*t,{value:.25,delay:i}),TweenMax.to(o.vertices[0],t,{x:e.vertPositions[0].x,y:e.vertPositions[0].y,z:e.vertPositions[0].z,delay:i,ease:Quart.easeInOut}),TweenMax.to(o.vertices[1],t,{x:e.vertPositions[1].x,y:e.vertPositions[1].y,z:e.vertPositions[1].z,delay:i,ease:Quart.easeInOut,onUpdate:function(){o.verticesNeedUpdate=!0},onComplete:r})},n=function(t,i,r){t=t||.6,i=i||0,TweenMax.to(s.uniforms.opacity,.5*t,{value:0,delay:i+.5*t}),TweenMax.to(o.vertices[0],t,{x:e.vertPositions[2].x,y:e.vertPositions[2].y,z:e.vertPositions[2].z,delay:i,ease:Quart.easeInOut}),TweenMax.to(o.vertices[1],t,{x:e.vertPositions[3].x,y:e.vertPositions[3].y,z:e.vertPositions[3].z,delay:i,ease:Quart.easeInOut,onUpdate:function(){o.verticesNeedUpdate=!0},onComplete:function(){"function"==typeof r&&r(),a()}})},a=function(){threeUtils.disposeOfMesh(t)};return i(),{transitionIn:r,transitionOut:n,dispose:a,getMesh:function(){return t},getMaterial:function(){return s},getUniforms:function(){return s.uniforms}}};module.exports=LightShaft;
},{"../../../shaders/security-bypass/light-shafts-fragment.glsl":152,"../../../shaders/security-bypass/light-shafts-vertex.glsl":153,"./constants":83,"shared/utils/general-utils":193,"shared/utils/three-utils":197}],89:[function(require,module,exports){
"use strict";var utils=require("shared/utils/general-utils"),threeUtils=require("shared/utils/three-utils"),constants=require("./constants"),LineParticle=function(e){var t,i,n,a,r,o,l,s,c,u,d=0,p=function(){LineParticle.particles=LineParticle.particles||[],LineParticle.particles.push(this);var d=16777215,p=new THREE.SpriteMaterial({color:d,map:THREE.ImageUtils.loadTexture(constants.imagePath+"particle.png"),transparent:!0,opacity:.5}),h=1,E=3;t=.1,i=!0,n=e.connectionDistance||50,a=new THREE.Vector3(utils.randomRange(-h,h),utils.randomRange(-h,h),0),r=e.position||new THREE.Vector3(utils.randomRange(-window.innerWidth*t,window.innerWidth*t),utils.randomRange(-window.innerHeight*t,window.innerHeight*t),utils.randomRange(-25,25));var m=new THREE.Vector3(utils.randomRange(-Math.PI,Math.PI),utils.randomRange(-Math.PI,Math.PI),utils.randomRange(-Math.PI,Math.PI));o=utils.randomRange(5e-4,.001),l=(new THREE.Vector3).sub(m).normalize(),s=g(r,p),c=new THREE.Object3D,c.add(s),u=[];for(var y=0;E>y;y++){var R=new THREE.LineBasicMaterial({color:d,linewidth:1,transparent:!0,opacity:0,side:THREE.DoubleSide,blending:THREE.AdditiveBlending}),w=new THREE.Geometry,T=new THREE.Line(w,R,THREE.LinePieces);w.vertices.push(r.clone(),r.clone()),u.push(T),c.add(T)}},g=function(e,t){var i=.25,n=new THREE.Sprite(t);return n.position.copy(e),n.scale.set(i,i,i),n},h=function(){for(var e=0;e<u.length;e++)u[e].geometry.vertices[0].set(r.x,r.y,r.z),u[e].geometry.vertices[1].set(r.x,r.y,r.z),u[e].geometry.verticesNeedUpdate=!0},E=function(){TweenMax.to({opacity:d},.9,{opacity:1,onUpdate:function(){d=this.target.opacity}})},m=function(){TweenMax.to({opacity:d},.9,{opacity:0,onUpdate:function(){d=this.target.opacity}})},y=function(){var e,t,a,c,p,g=LineParticle.particles,E=g.length,m=n,y=0;for(r.applyAxisAngle(l,o),s.position.copy(r),s.material.opacity=d,h(),p=0;E>p;p++)e=g[p],t=e.getPosition(),a=r.distanceTo(t),m>a&&y<u.length&&(c=u[y],c.geometry.vertices[1].set(t.x,t.y,t.z),c.geometry.verticesNeedUpdate=!0,i&&(c.material.opacity=utils.clamp(.5-a/m,0,1)*d),c.visible=c.material.opacity>.01,y++)},R=function(){threeUtils.disposeOfChildren(c),threeUtils.disposeOfMesh(c),t=null,i=null,n=null,a=null,r=null,o=null,l=null,s=null,c=null,u=null};return{init:p,update:y,transitionIn:E,transitionOut:m,dispose:R,getMesh:function(){return c},getPosition:function(){return r}}};module.exports=LineParticle;
},{"./constants":83,"shared/utils/general-utils":193,"shared/utils/three-utils":197}],90:[function(require,module,exports){
var gamebase=require("../game-base"),BackgroundShape=require("./background-shape"),DecryptionDevice=require("./decryption-device"),EffectsManager=require("./effects-manager"),LineParticle=require("./line-particle"),GameUI=require("./game-ui"),GameUIMobile=require("./game-ui-mobile"),utils=require("shared/utils/general-utils"),threeUtils=require("shared/utils/three-utils"),WebFont=require("shared/lib/webfontloader"),constants=require("./constants"),client=require("shared/utils/client/client"),ns=require("shared/namespace"),CursorManager=require("shared/utils/cursor-manager"),Stats=require("stats-js"),SecurityBypass=function(e){var n,t,i,o,r,s,a,l,u,c,d,m,w,h,p,f,g,v,y=this,x=0,E={},b=new THREE.Vector3(0,0,.5),L=new THREE.Vector3(0,0,.5),T=new THREE.Vector3(0,0,.5),q=new THREE.Vector3(0,0,.5),R={x:0,y:0},S={x:0,y:0},H={x:0,y:0},P={x:0,y:0},D={x:0,y:0},M={x:0,y:0},C=.1,I=!1,U=[],O=[],X=1,Y=function(){console.log("options: ",e),void 0!==window.devicePixelRatio&&(X=window.devicePixelRatio),t="mobile"===client.device.type||"tablet"===client.device.type,window.location.href.indexOf("mobile")>-1&&(t=!0),window.location.href.indexOf("?dev")>-1&&(n=!0),t&&(document.ontouchmove=function(e){e.preventDefault()}),o=[],o[0]=_.sample(e.gameData.equations.levels[0]),o[1]=_.sample(e.gameData.equations.levels[1]),o[2]=_.sample(e.gameData.equations.levels[2]),E.w=window.innerWidth,E.h=window.innerHeight,z(),ns.audioProxy.triggerEvent("security_bypass_start")},W=function(n){ns.audioProxy.triggerEvent("security_bypass_end");var t=0;_.each(o,function(e){t+=e.solve.length});var i=utils.clamp(f.getTotalSelections(),t,500),r=0;_.each(O,function(e){r+=e});var s=r/O.length,a={skill:s,accuracy:utils.clamp(t/i,0,1),speed:Math.abs(f.getTotalTime())/(1e3*e.gameData.countdown)};n?y.trigger("win",{score:a}):y.trigger("lose",{score:a})},z=function(){r=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4),r.position.z=100,s=new THREE.Scene;var h=$(ns.templates.security_bypass({}));e.$parent.append(h);var p=h.find("#game-webgl");if(a=new THREE.WebGLRenderer({antialias:!t}),a.setPixelRatio(1),a.setClearColor(0,1),a.setSize(window.innerWidth,window.innerHeight),a.context.getProgramInfoLog=function(){return""},a.context.getShaderInfoLog=function(){return""},a.domElement.style.position="absolute",p.append(a.domElement),l=new THREE.Object3D,s.add(l),w=new THREE.DirectionalLight(16777215,3),w.position.set(0,0,100),s.add(w),d=new BackgroundShape(c),l.add(d.getMesh()),t){var g=require("hammerjs");v=new g(document.body),v.get("pan").set({direction:g.DIRECTION_ALL}),v.on("pan",B),window.addEventListener("touchstart",F,!1),window.addEventListener("touchend",N,!1)}else{var y=new THREE.HemisphereLight(16777215,8947848,1);s.add(y),u=new EffectsManager({renderer:a,camera:r,scene:s}),A(),window.addEventListener("mousemove",j,!1),window.addEventListener("mousedown",V,!1),window.addEventListener("mouseup",G,!1)}window.addEventListener("resize",ne,!1),k(),f=t?new GameUIMobile(e,x,m,o[x]):new GameUI(e,x,m,o[x]),f.init(),f.on("submit",J),f.on("countdownComplete",Q),n&&(i=new Stats,i.domElement.style.position="absolute",i.domElement.style.top="0px",i.domElement.style.zIndex=9999,$("#game-webgl").append(i.domElement)),ne(),f.addTransitionObjects(),K(),ee()},k=function(){m&&(m.off(),m.dispose());var i=u?u.getPasses():{};m=new DecryptionDevice({isMobile:t,isDev:n,options:e,level:x,equationData:o[x],camera:r,renderer:a,container:l,lightPos:w.position,colorifyShader:i.colorify,glitchShader:i.glitchPass}),m.init(),m.on("select",function s(){m.off("select",s),O[x]=utils.clamp((M.x+M.y)/1e3,0,1)})},A=function(){for(var e=30,n=threeUtils.getPointsOnSphere(e),t=0;e>t;t++){var i=new LineParticle({minSpeed:.05,maxSpeed:.25,connectionDistance:50,position:n[t].multiplyScalar(utils.randomRange(60,90))});i.init(),l.add(i.getMesh()),U.push(i)}},j=function(e){b.x=e.clientX/window.innerWidth*2-1,b.y=2*-(e.clientY/window.innerHeight)+1,H.x=e.clientX,H.y=e.clientY,I&&(S.x=e.clientX,S.y=e.clientY)},V=function(e){T.x=e.clientX,T.y=e.clientY,S.x=e.clientX,S.y=e.clientY,R.x=S.x,R.y=S.y,I=!0,t?(L.x=e.clientX/window.innerWidth*2-1,L.y=2*-(e.clientY/window.innerHeight)+1,m.mousedownMobile(L)):m.mousedown(e)},G=function(e){I=!1,q.x=e.clientX,q.y=e.clientY;var n=T.distanceTo(q),i=t?10:1;i>=n&&(t?(L.x=e.clientX/window.innerWidth*2-1,L.y=2*-(e.clientY/window.innerHeight)+1,m.mouseupMobile(L)):m.mouseup(e))},B=function(e){j({clientX:e.center.x,clientY:e.center.y})},F=function(e){e.changedTouches.length>0&&V({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY})},N=function(e){e.changedTouches.length>0&&G({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY})},J=function(){var e=o[x].answer===m.getEquationValue();console.log("handleSubmission:",e),e?(x++,ns.audioProxy.triggerEvent("unlock_success"),3===x?(f.stopClock(),f.removeDeviceListeners(),m.praise(function(){f.setLevelLabels(x,o[x]),setTimeout(function(){f.transitionOut(50,!0),_.each(U,function(e){e.transitionOut()}),m.transitionOut(function(){Z(function(){W(!0)})})},1e3)})):(f.removeDeviceListeners(),m.praise(function(){m.transitionOut(function(){k(),m.transitionIn(function(){m.setEnabled(!0)}),f.setLevel(x,o[x]),f.setDevice(m)})}))):(ns.audioProxy.triggerEvent("unlock_fail"),m.glitch(),m.warn(),f.warn())},Q=function(){Z(function(){W(!1)})},K=function(){var n=e.$parent.find("#game-overlay");TweenMax.from(r.position,8,{z:4*r.position.z,ease:Quart.easeOut,delay:.75}),setTimeout(function(){setTimeout(function(){m.transitionIn(function(){d.transitionIn(3,1.5),f.transitionIn(function(){m.setEnabled(!0),_.each(U,function(e){e.transitionIn()})})})},1e3)},1e3),n.addClass("overlay-fade-out")},Z=function(n){var t=e.$parent.find("#game-overlay");t.removeClass("overlay-fade-out").addClass("overlay-fade-in"),"function"==typeof n&&setTimeout(function(){n()},900)},ee=function(){P.x=S.y-R.y,P.y=S.x-R.x,p=P.y-D.y,D.y+=p*C,threeUtils.rotateAroundWorldAxis(l,threeUtils.axisUp,.25*threeUtils.degreesToRads(D.y)),h=P.x-D.x,D.x+=h*C,threeUtils.rotateAroundWorldAxis(l,threeUtils.axisRight,.25*threeUtils.degreesToRads(D.x)),M.x+=Math.abs(D.x),M.y+=Math.abs(D.y),R.x=S.x,R.y=S.y,m.update(t?null:b,I),t||m.getCursorLocked()||CursorManager.setCursor(document.body,"move"),r.position.x+=.1*(25*b.x-r.position.x),r.position.y+=.1*(25*b.y-r.position.y),r.lookAt(constants.zeroedVector3);for(var e=0;e<U.length;e++)U[e].update();u?u.update():a.render(s,r),t||f.update(H),i&&i.update(),g=requestAnimationFrame(ee)},ne=function(){E.w=window.innerWidth,E.h=window.innerHeight,r.aspect=E.w/E.h,r.updateProjectionMatrix(),a.setSize(E.w,E.h),f.resize(E.w,E.h),u&&u.resize(E.w,E.h)};_.extend(this,gamebase),_.extend(this,{load:function(e){WebFont.load({custom:{families:["blender-book"]},active:function(){var n=new THREE.JSONLoader;n.load(constants.modelPath+"bgSphere.js",function(n){c=n,"function"==typeof e&&e()})}})},enter:function(){Y()},exit:function(){this.destroy()},destroy:function(){cancelAnimationFrame(g),f.off(),f.dispose(),m.dispose(),d.dispose(),t?(v.off("pan",B),window.removeEventListener("touchstart",F),window.removeEventListener("touchend",N)):(window.removeEventListener("mousemove",j),window.removeEventListener("mousedown",V),window.removeEventListener("mouseup",G),document.ontouchmove=null,u.dispose(),CursorManager.dispose()),window.removeEventListener("resize",ne),$(a.domElement).remove(),_.each(U,function(e){e.dispose()}),LineParticle.particles&&(LineParticle.particles.length=0),threeUtils.disposeOfChildren(l),y=null,n=null,t=null,i=null,x=null,r=null,s=null,a=null,l=null,u=null,c=null,m=null,w=null,E=null,b=null,L=null,T=null,q=null,R=null,S=null,H=null,P=null,D=null,M=null,C=null,I=null,h=null,p=null,U=null,f=null,O=null,X=null,g=null,v=null,d=null}})};module.exports=SecurityBypass;
},{"../game-base":125,"./background-shape":82,"./constants":83,"./decryption-device":84,"./effects-manager":85,"./game-ui":87,"./game-ui-mobile":86,"./line-particle":89,"hammerjs":6,"shared/lib/webfontloader":174,"shared/namespace":175,"shared/utils/client/client":190,"shared/utils/cursor-manager":192,"shared/utils/general-utils":193,"shared/utils/three-utils":197,"stats-js":22}],91:[function(require,module,exports){
"use strict";var utils=require("shared/utils/general-utils"),threeUtils=require("shared/utils/three-utils"),constants=require("./constants"),PathConnection=function(e,t,a){var r,n,i,l,s,u=!0,o=function(){r=this,u=!0,n=new THREE.Object3D;var o=e.distanceTo(t);s=utils.map(o/16.25,1,2,1.2,1.4);var p=e.clone().lerp(t,.5).multiplyScalar(s),h=new THREE.QuadraticBezierCurve3(e,p,t),y=Math.floor(6*s),m=new THREE.Geometry;m.vertices=d(h.getPoints(y)),m.vertices[0]=e.clone().multiplyScalar(1.001),m.vertices[m.vertices.length-1]=t.clone().multiplyScalar(1.001);var g=new THREE.ShaderMaterial({uniforms:{color:{type:"c",value:new THREE.Color(a)},map:{type:"t",value:THREE.ImageUtils.loadTexture(constants.imagePath+"particle.png")},opacity:{type:"f",value:0},size:{type:"f",value:3},time:{type:"f",value:0}},attributes:{canMove:{type:"f",value:[]},posScalar:{type:"f",value:[]}},vertexShader:require("../../../shaders/security-bypass/connection-point-vertex.glsl"),fragmentShader:require("../../../shaders/security-bypass/connection-point-fragment.glsl"),transparent:!0,blending:THREE.AdditiveBlending}),E=new THREE.Geometry;E.vertices=f(m.vertices);var b,T,R,S=new THREE.ShaderMaterial({uniforms:{color:{type:"c",value:new THREE.Color(a)},globalOpacity:{type:"f",value:0},time:{type:"f",value:0}},attributes:{opacity:{type:"f",value:[]},canMove:{type:"f",value:[]},posScalar:{type:"f",value:[]}},vertexShader:require("../../../shaders/security-bypass/connection-line-vertex.glsl"),fragmentShader:require("../../../shaders/security-bypass/connection-line-fragment.glsl"),linewidth:1,transparent:!0,blending:THREE.AdditiveBlending});for(R=0;R<m.vertices.length;R++)T=m.vertices[R],b={x:T.x,y:T.y,z:T.z},T.userData={origin:b},0===R||R===m.vertices.length-1?g.attributes.canMove.value.push(0):g.attributes.canMove.value.push(1),g.attributes.posScalar.value.push(0);for(R=0;R<E.vertices.length;R++)T=E.vertices[R],b={x:T.x,y:T.y,z:T.z},T.userData={origin:b},S.attributes.opacity.value.push(utils.randomRange(.025,.1)),c(T,m.vertices[0])||c(T,m.vertices[m.vertices.length-1])?S.attributes.canMove.value.push(0):S.attributes.canMove.value.push(1),S.attributes.posScalar.value.push(0);i=new THREE.PointCloud(m,g),n.add(i),l=new THREE.Line(E,S,THREE.LinePieces),n.add(l),v()},c=function(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z},v=function(){var e=l.material.attributes.posScalar.value;_.each(e,function(t,a){TweenMax.to({value:t},.6,{value:1,delay:.01*a,ease:Back.easeOut,onUpdateParams:[a],onUpdate:function(t){l&&(e[t]=this.target.value,l.material.attributes.posScalar.needsUpdate=!0)}})});var t=i.material.attributes.posScalar.value;_.each(t,function(e,a){TweenMax.to({value:e},.6,{value:1,delay:.1*a,ease:Back.easeOut,onUpdateParams:[a],onUpdate:function(e){i&&(t[e]=this.target.value,i.material.attributes.posScalar.needsUpdate=!0)}})}),TweenMax.to([l.material.uniforms.globalOpacity,i.material.uniforms.opacity],.6,{value:1})},p=function(e){TweenMax.to([l.material.uniforms.globalOpacity,i.material.uniforms.opacity],.3,{value:0,onComplete:function(){"function"==typeof e&&e(r)}})},d=function(e){for(var t=[],a=!0,r=1.5,n=new THREE.Vector3(-1,0,0).multiplyScalar(r),i=new THREE.Vector3(1,0,0).multiplyScalar(r),l=0;l<e.length;l++)a?t.push(e[l].add(n).add(threeUtils.getRandomVector3(-r,r))):t.push(e[l].add(i).add(threeUtils.getRandomVector3(-r,r))),a=!a;return t},f=function(e){for(var t=[],a=e.length,r=10*s,n=0;a>n;n++)for(var i=0;a>i;i++)n!==i&&e[n].distanceTo(e[i])<=r&&t.push(e[n],e[i]);return t},h=function(e){i&&l&&(l.material.uniforms.time.value=e,i.material.uniforms.time.value=e)},y=function(){threeUtils.disposeOfChildren(n),threeUtils.disposeOfMesh(n),i=null,l=null,n=null,s=null,u=null};return{init:o,update:h,transitionIn:v,transitionOut:p,dispose:y,getMesh:function(){return n},isAlive:function(){return u}}};module.exports=PathConnection;
},{"../../../shaders/security-bypass/connection-line-fragment.glsl":146,"../../../shaders/security-bypass/connection-line-vertex.glsl":147,"../../../shaders/security-bypass/connection-point-fragment.glsl":148,"../../../shaders/security-bypass/connection-point-vertex.glsl":149,"./constants":83,"shared/utils/general-utils":193,"shared/utils/three-utils":197}],92:[function(require,module,exports){
module.exports=function(o,e,t){function r(e){if(!o.killed){var t=[];Object.keys(e).forEach(function(o){"object"==typeof e[o]&&t.push(o)});var a=Math.floor(Math.random()*t.length);a=a==t.length?t.length-1:a,"object"==typeof e[t[a]]?(i.push(t[a]),i.length<u&&Object.keys(e[t[a]]).length>0?r(e[t[a]]):n()):r(e)}}function n(){if(!o.killed){console.log("burrow");var t="";i.forEach(function(o){t+="."+o,e=e[o]}),c=e,l=h[Math.floor(Math.random()*h.length)],c[l]=o,o.logger.log("Burrowed into: "+t+" &nbsp; Cut off tail."),a()}}function a(){o.killed||(o.currentLocation?(o.prevLocation=o.currentLocation,o.currentLocation=c,o.prevName=o.currentName,o.currentName=l,o.prevLocation[o.prevName]=f[Math.round(Math.random()*(f.length-1))]):(o.currentLocation=c,o.currentName=l))}var c,l,u=Math.round(7*Math.random()),i=[],h=["PANIC_BURROWER","WE_ARE_EVERYWHERE"],f=["Your skills are weak","You are too slow, rookie","We are always 2 steps ahead of you","Give it up"];r(e)};
},{}],93:[function(require,module,exports){
module.exports=function(e){function n(e){function n(e,t){var l=!1;i.forEach(function(i){l||e[i]&&"object"==typeof e[i]&&(c>o?e[i].disabled||(o++,n(e[i],i)):e[i].disabled||(l=!0,s(e,i)))}),l||s(e,t)}var i=Object.keys(e),i=Object.keys(e),o=0;n(e,"STEM main",!0)}var i=this,o=e.me,t=[],l=!1,c=7,s=function(e,n,i){i&&o.completeTakeover(),l||(l=!0,e.disabled=!0,e.el&&(e.el.style.visibility="hidden"),t.push(e),o.logger.log("Found integral component: "+n+" &nbsp; disabled and logged."),setTimeout(function(){l=!1},3e3))};i.deconstruct=function(e){o.killed||n(e)},i.cancel=function(){console.log("deconstructor cancel"),t.forEach(function(e){e.disabled=!1,e.el&&(e.el.style.visibility="visible")})}};
},{}],94:[function(require,module,exports){
var sequence=require("shared/utils/sequence"),Logger=require("./logger"),burrow=require("./burrower"),Deconstructor=require("./deconstructor"),Takeover=require("./takeover-screen"),ns=require("shared/namespace");module.exports=function(e){var t,n,o,r,i=this,c=function(){i.logger=new Logger({enabled:!0}),i.deconstructor=new Deconstructor({me:i}),setTimeout(a,1e3),l()},s=0,a=function(){glitch.screenshot(),3>s?(s++,setTimeout(a,50)):glitch.glitch(!0,v)},l=function(){i.logger.log("Awake. Logging on "+i.channel+"."),i.logger.log("Scanning intruder entrypoint..."),sequence([{fn:u,o:["target"]},{fn:g,i:["me","target"]},{fn:d,i:["me","target"]},{fn:h,i:["me","target"]},{fn:m}],{args:{me:i},completed:function(){}})},u=function(e){var n=!1;Object.keys(window).forEach(function(o){window[o]&&window[o].stemRemoteToken&&!n&&(n=!0,t=window[o],i.logger.log('Army STEM Mobile Lockpick found.  ref: <span style="color:#fff">'+window[o].stemRemoteToken+"</span>."),setTimeout(function(){e(t)},1e3))})},g=function(e,t,n){burrow(e,t),n()},d=function(e,t,n){o=setInterval(burrow,22e3,e,t),n()},h=function(e,t,n){r=setInterval(e.deconstructor.deconstruct,6700,t),n()},m=function(e){setTimeout(function(){t._security.disable(),e()},14e3)};this.kill=function(){console.log("helminth cancelled");var t=e.appModel.get("access_intel:skillpoints");t+=100,e.appModel.set("access_intel:skillpoints",t),i.logger.cancel(),i.deconstructor.cancel(),n.cancel(),this.killed=!0,clearInterval(o),r&&clearInterval(r),e.appModel.trigger("helminth-killed"),ns.audioProxy.triggerEvent("hack_resolved"),ns.audioProxy.triggerEvent("travel_loop_stop"),ns.audioProxy.triggerEvent("hacked_buzz_hum_end")},window.killWormShortCut=function(){console.log("helminth cancelled"),console.log(ns.user);var e;e=ns.user.get("name")?ns.user.get("name"):"rookie",alert("We see you, "+e+". Do not underestimate our ability to evolve. You have been registered as an enemy of the cause. We are PANIC. We are everywhere.")}.bind(this),this.currentLocation,this.currentName,this.prevLocation,this.prevName,this.signature="panic",this.channel=802;var v=function(){console.log("take over"),e.appModel.trigger("helminth-take-over"),n=new Takeover,$("body").append(n.$el),ns.audioProxy.triggerEvent("access_intel_hacked"),ns.audioProxy.triggerEvent("travel_loop_start"),ns.audioProxy.triggerEvent("hacked_buzz_hum_start")};this.completeTakeover=function(){},c()};
},{"./burrower":92,"./deconstructor":93,"./logger":95,"./takeover-screen":96,"shared/namespace":175,"shared/utils/sequence":195}],95:[function(require,module,exports){
module.exports=function(n){var e,t,o=0,i=[],l=function(){n.enabled&&(this.enabled=!0,e=setInterval(s,300),a())},a=function(){t=$('<div id="__log1" style="position:absolute; top:10%; left:50px; height:80%; width:500px; overflow:auto; background: transparent; color:#ccc; font-size:16px; padding:20px; z-index:100"></div>'),$("body").append(t)}.bind(this);this.log=function(n){i.push(n)},this.cancel=function(){console.log("cancelled logger"),t.remove()};var s=function(){if(o<i.length){var n=new Date;t.append($('<div class="item">[<span style="color:#777">'+n.toISOString()+"</span>] &nbsp; &nbsp;"+i[o]+"</div>")),o++,t.scrollTop(1e5)}};this.enable=function(){this.enabled=!0,clearInterval(e),e=setInterval(s,300),a()}.bind(this),l()};
},{}],96:[function(require,module,exports){
var ns=require("shared/namespace"),WebGL=require("./takeover-webgl");module.exports=Backbone.View.extend({template:"helminth-takeover",className:"helminth-takeover fullframe",initialize:function(){this.setElement(this.$el),this.$el.html(ns.templates[this.template]),this.webgl=new WebGL({canvas:this.$(".takeover-webgl")[0]}),this.webgl.enter()},cancel:function(){this.webgl.cancel(),this.$el.remove(),this.remove()}});
},{"./takeover-webgl":97,"shared/namespace":175}],97:[function(require,module,exports){
require("shared/lib/three.js-master/examples/js/renderers/Projector"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader"),require("shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader"),THREE.GlowShader=require("shared/shaders/GlowShader"),THREE.BarrelBlurShader=require("shared/shaders/BarrelBlurShader"),THREE.LinesShader=require("shared/shaders/LinesShader"),require("gsap");var Triangle=require("./webgl/triangle"),HollowTriangle=require("./webgl/hollowtriangle"),ThreeTriangles=require("./webgl/threetriangles"),ThreeHollowTriangles=require("./webgl/threehollowtriangles"),utils=require("shared/utils/general-utils"),threeUtils=require("shared/utils/three-utils"),CodeBG=require("./webgl/codebg");module.exports=function(e){function r(){t=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4),t.position.z=500,i=new THREE.Scene,i.fog=new THREE.Fog(0,.015,2200),o=new THREE.WebGLRenderer({canvas:E,preserveDrawingBuffer:!0}),o.setSize(window.innerWidth,window.innerHeight),window.addEventListener("resize",a,!1),a(),R(),setTimeout(H,1500),setTimeout(S,3e3),setTimeout(B,4500),s(),n()}function s(){u=new THREE.EffectComposer(o),h=new THREE.RenderPass(i,t),p=new THREE.ShaderPass(THREE.CopyShader),passes={},passes.glow=new THREE.ShaderPass(THREE.GlowShader),passes.barrelBlur=new THREE.ShaderPass(THREE.BarrelBlurShader),passes.lines=new THREE.ShaderPass(THREE.LinesShader),passes.lines.uniforms.lineSize.value=2e3,passes.lines.uniforms.lineStrength.value=.08,passes.lines.uniforms.lineTilt.value=1,passes.glow.uniforms.amount.value=1.7,passes.glow.uniforms.size.value=2,passes.glow.uniforms.darkness.value=.1,passes.barrelBlur.uniforms.amount.value=.005,u=new THREE.EffectComposer(o),u.addPass(h),u.addPass(passes.glow),u.addPass(passes.lines),u.addPass(p),p.renderToScreen=!0}function a(){m.w=window.innerWidth,m.h=window.innerHeight,t.aspect=m.w/m.h,t.updateProjectionMatrix(),o.setSize(m.w,m.h)}function n(){d||(requestAnimationFrame(n),u.render(.1),M+=.1,l.uniforms.time.value+=.06,c.trigger("webgl-update"),b(),y())}var i,t,o,l,d,u,h,p,w,E=e.canvas,c=_.extend({},Backbone.Events),m={},f=[],g=30,T=[Triangle,HollowTriangle],v=[],H=function(){new CodeBG({scene:i,events:c})},R=function(){l=new THREE.ShaderMaterial({uniforms:{color:{type:"c",value:new THREE.Color(16777215)},map:{type:"t",value:THREE.ImageUtils.loadTexture("assets/imgs/access-intel/helminth/panic_graphic.png")},invopacity:{type:"f",value:1},time:{type:"f",value:1e3*Math.random()}},vertexShader:require("../../../../shaders/access-intel/vuv-vertex.glsl"),fragmentShader:require("../../../../shaders/access-intel/logo-fragment.glsl"),side:THREE.DoubleSide,blending:THREE.AdditiveBlending,transparent:!0,depthWrite:!1});var e=new THREE.PlaneGeometry(700,700),r=(new THREE.BufferGeometry).fromGeometry(e),s=new THREE.Mesh(r,l);s.position.y=0,i.add(s)},S=function(){for(var e=0;g>e;e++){var r=new HollowTriangle({dim:200,color:16777215,transparent:!0,opacity:0,scalar:40,shader:!1});v.push(r),r.userData.speed=4,r.position.z=-1e3*e,r.position.y=150,i.add(r)}v.forEach(function(e){TweenLite.to(e.material,2,{opacity:.1})})},y=function(){v.forEach(function(e){e.position.z>500?e.position.z=-500*g:e.position.z+=e.userData.speed})},q=.125,b=function(){f.forEach(function(e){e.position.z>500?(e.position.z=-8e3,e.position.x=4e3*Math.random()-2e3,e.position.y=4e3*Math.random()-2e3):e.position.z+=e.userData.speed,e.material.uniforms&&(w=Math.round(Math.random())*q,e.material.uniforms.opacity.value=w)})},z=function(){TweenLite.to(l.uniforms.invopacity,1,{value:0,ease:new RoughEase({strength:2,points:25})})},B=function(){for(var e=0;g>e;e++){var r=Math.floor(Math.random()*T.length),s=new T[r]({dim:20*Math.random()+80,color:16777215,opacity:1,shader:!0});f.push(s),s.userData.speed=10*Math.random()+20,s.position.x=4e3*Math.random()-2e3,s.position.y=4e3*Math.random()-2e3,s.position.z=-2e3*e,i.add(s)}},M=0,P=function(){d=!0};return r(),{scene:i,events:c,canvas:E,renderer:o,camera:t,passes:passes,cancel:P,enter:z}};
},{"../../../../shaders/access-intel/logo-fragment.glsl":129,"../../../../shaders/access-intel/vuv-vertex.glsl":131,"./webgl/codebg":98,"./webgl/hollowtriangle":99,"./webgl/threehollowtriangles":100,"./webgl/threetriangles":101,"./webgl/triangle":102,"gsap":3,"shared/lib/three.js-master/examples/js/renderers/Projector":169,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader":172,"shared/shaders/BarrelBlurShader":177,"shared/shaders/GlowShader":182,"shared/shaders/LinesShader":184,"shared/utils/general-utils":193,"shared/utils/three-utils":197}],98:[function(require,module,exports){
var CodeBG=function(e){function o(){for(var o=0;d>o;o++)n(),TweenLite.to(r[o].material,2,{opacity:.3});e.events.on("webgl-update",t)}function n(){var o=i[Math.round(Math.random()*(i.length-1))];console.log("create code planes");var n=new THREE.PlaneGeometry(600,600),t=(new THREE.BufferGeometry).fromGeometry(n),a=new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("assets/imgs/access-intel/helminth/"+o),transparent:!0,blending:THREE.AdditiveBlending,opacity:0}),d=new THREE.Mesh(t,a);d.overdraw=!0,d.position.z=-3e3*Math.random(),d.position.x=2e3*Math.random()-1e3,d.position.y=2e3*Math.random()-1e3,e.scene.add(d),r.push(d)}function t(){r.forEach(function(e){e.position.z+=3,e.position.z>800&&a(e)})}function a(e){e.position.z=-4e3*Math.random(),e.position.x=2500*Math.random()-1250,e.position.y=2500*Math.random()-1250}var e=e||{},i=["code1.png","code2.png","code3.png","code4.png","code5.png","code6.png"],r=[],d=30;o()};module.exports=CodeBG;
},{}],99:[function(require,module,exports){
module.exports=function(e){function r(e){e.computeBoundingBox();var r=e.boundingBox.max,a=e.boundingBox.min,n=new THREE.Vector2(0-a.x,0-a.y),t=new THREE.Vector2(r.x-a.x,r.y-a.y);e.faceVertexUvs[0]=[];var E=e.faces;for(i=0;i<e.faces.length;i++){var c=e.vertices[E[i].a],s=e.vertices[E[i].b],o=e.vertices[E[i].c];e.faceVertexUvs[0].push([new THREE.Vector2((c.x+n.x)/t.x,(c.y+n.y)/t.y),new THREE.Vector2((s.x+n.x)/t.x,(s.y+n.y)/t.y),new THREE.Vector2((o.x+n.x)/t.x,(o.y+n.y)/t.y)])}e.uvsNeedUpdate=!0}var e=e||{},a=e.dim||100,n=e.color||16777215,t=e.wireframe||!1,E=e.opacity,c=new THREE.Geometry,s=60*Math.PI/180,o=e.scalar||20,H=-30/45,R=Math.sqrt(o*o+H*o*H*o);c.vertices.push(new THREE.Vector3(-a,0,0),new THREE.Vector3(0,-Math.tan(s)*a,0),new THREE.Vector3(a,0,0),new THREE.Vector3(-a+o,H*o,0),new THREE.Vector3(0,-(Math.tan(s)*a-R),0),new THREE.Vector3(a-o,H*o,0));var T=new THREE.Vector3(0,0,1);c.faces.push(new THREE.Face3(0,2,3,T),new THREE.Face3(1,3,4,T),new THREE.Face3(2,1,5,T),new THREE.Face3(3,0,1,T),new THREE.Face3(2,3,5,T),new THREE.Face3(1,5,4,T));var d=new THREE.ShaderMaterial({uniforms:{opacity:{type:"f",value:1}},vertexShader:require("../../../../../shaders/access-intel/basic-vertex.glsl"),fragmentShader:require("../../../../../shaders/access-intel/opacity-fragment.glsl"),side:THREE.DoubleSide,blending:THREE.AdditiveBlending,transparent:!0,depthWrite:!1});r(c);var w,x=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,color:n,wireframe:t,blending:THREE.AdditiveBlending,opacity:E,transparent:!0});return w=e.shader?new THREE.Mesh(c,d):new THREE.Mesh(c,x)};
},{"../../../../../shaders/access-intel/basic-vertex.glsl":128,"../../../../../shaders/access-intel/opacity-fragment.glsl":130}],100:[function(require,module,exports){
var HollowTriangle=require("./hollowtriangle");module.exports=function(o){var o=o||{},i=o.dim||100,r=o.color||16777215,a=o.wireframe||!1,e=o.opacity||1,l=new THREE.Object3D,n=new HollowTriangle({dim:i,color:r,wireframe:a,opacity:e});l.add(n);var t=60*Math.PI/180,w=-Math.tan(t)*i,d=new HollowTriangle({dim:i,color:r,wireframe:a,opacity:e});d.position.x=-i,d.position.y=w,l.add(d);var c=new HollowTriangle({dim:i,color:r,wireframe:a,opacity:e});return c.position.x=i,c.position.y=w,l.add(c),l.position.y=i,l};
},{"./hollowtriangle":99}],101:[function(require,module,exports){
var Triangle=require("./triangle");module.exports=function(i){var i=i||{},r=i.dim||100,o=i.color||16777215,a=i.wireframe||!1,e=i.opacity||1,n=new THREE.Object3D,t=new Triangle({dim:r,color:o,wireframe:a,opacity:e});n.add(t);var d=60*Math.PI/180,c=-(Math.tan(d)*r),l=new Triangle({dim:r,color:o,wireframe:a,opacity:e});l.position.x=-r,l.position.y=c,n.add(l);var p=new Triangle({dim:r,color:o,wireframe:a,opacity:e});return p.position.x=r,p.position.y=c,n.add(p),n.position.y=r,n};
},{"./triangle":102}],102:[function(require,module,exports){
module.exports=function(e){function r(e){e.computeBoundingBox();var r=e.boundingBox.max,t=e.boundingBox.min,a=new THREE.Vector2(0-t.x,0-t.y),n=new THREE.Vector2(r.x-t.x,r.y-t.y);e.faceVertexUvs[0]=[];var c=e.faces;for(i=0;i<e.faces.length;i++){var o=e.vertices[c[i].a],s=e.vertices[c[i].b],E=e.vertices[c[i].c];e.faceVertexUvs[0].push([new THREE.Vector2((o.x+a.x)/n.x,(o.y+a.y)/n.y),new THREE.Vector2((s.x+a.x)/n.x,(s.y+a.y)/n.y),new THREE.Vector2((E.x+a.x)/n.x,(E.y+a.y)/n.y)])}e.uvsNeedUpdate=!0}var e=e||{},t=e.dim||100,a=(e.color||16777215,e.wireframe||!1,e.opacity||1,new THREE.Geometry),n=60*Math.PI/180;a.vertices.push(new THREE.Vector3(-t,0,0),new THREE.Vector3(t,0,0),new THREE.Vector3(0,-Math.tan(n)*t,0)),a.faces.push(new THREE.Face3(0,1,2)),a.computeFaceNormals(),r(a);var c=new THREE.ShaderMaterial({uniforms:{color:{type:"c",value:new THREE.Color(16777215)},opacity:{type:"f",value:1}},vertexShader:require("../../../../../shaders/access-intel/basic-vertex.glsl"),fragmentShader:require("../../../../../shaders/access-intel/opacity-fragment.glsl"),side:THREE.DoubleSide,blending:THREE.AdditiveBlending,transparent:!0,depthWrite:!1}),o=new THREE.Mesh(a,c);return o};
},{"../../../../../shaders/access-intel/basic-vertex.glsl":128,"../../../../../shaders/access-intel/opacity-fragment.glsl":130}],103:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace"),WebGLBG=require("./webgl-bg");module.exports=Backbone.View.extend({template:"access_intel_level1",className:"access_intel level1 login",initialCodeCalls:["kilo","lima","five","niner","six","zulu","hotel","niner"],initialize:function(e){_.extend(this,e),_.extend(this.gamebase),this.setElement(this.$el),this.$el.html(ns.templates[this.template]),this.$parent.append(this.$el),this.webgl.events.on("webgl-update",this.webglUpdate.bind(this)),this.$("input").on("keyup",this.handleInput.bind(this)),console.clear(),console.log("level 1 initialize")},prepopulateFirst:function(){var e;ns.audioProxy.triggerEvent("initial_code"),e=this.appModel.get("forReview")?"polaris":this.config.level1_prepop_code;var i=function(t){t>e.length||(this.$(".code1").val(e.substring(0,t)),t++,this.handleInput(),setTimeout(i,400*Math.random()+300,t))}.bind(this);setTimeout(i,600,1)},createWebGLbg:function(){this.webglbg=new WebGLBG({webgl:this.webgl,local:this.model})},passCode1Correct:!1,passCode2Correct:!1,passCode3Correct:!1,handleInput:function(e){if(!this.disabled){ns.audioProxy.triggerEvent("input_field_keyup");var i=this.appModel.get("access_intel:inputs");i++,this.appModel.set("access_intel:inputs",i),console.log("LEVEL 1 INPUT"),(_.contains(this.config.level1_codes,this.$(".code1").val())&&this.$(".code1").val()!==this.$(".code2").val()&&this.$(".code1").val()!==this.$(".code3").val()||this.appModel.get("forReview")&&"polaris"===this.$(".code1").val())&&this.passCode1Correct===!1&&(this.passCode1Correct=!0,this.openRing(1)),(_.contains(this.config.level1_codes,this.$(".code2").val())&&this.$(".code2").val()!==this.$(".code1").val()&&this.$(".code2").val()!==this.$(".code3").val()||this.appModel.get("forReview")&&"polaris"===this.$(".code2").val())&&this.passCode2Correct===!1&&(this.passCode2Correct=!0,this.openRing(2)),(_.contains(this.config.level1_codes,this.$(".code3").val())&&this.$(".code3").val()!==this.$(".code1").val()&&this.$(".code3").val()!==this.$(".code2").val()||this.appModel.get("forReview")&&"polaris"===this.$(".code3").val())&&this.passCode3Correct===!1&&(this.passCode3Correct=!0,this.openRing(3)),!this.completed&&this.passCode1Correct&&this.passCode2Correct&&this.passCode3Correct&&(this.completed=!0,this.trigger("completed",this))}},openRing:function(e){if(this["ring"+e+"CSS"]){var i=$(this["ring"+e+"CSS"].element);i.isOpening=!0,TweenLite.to(i.find(".ring"),2,{opacity:.6}),TweenLite.to(i.find(".ring circle"),2,{css:{strokeDashoffset:0}})}},animateRing:function(e){var i=$(this["ring"+e+"CSS"].element);if(!i.isOpening){var t=1e4*e;TweenLite.to(i.find(".ring circle"),Math.random()+3*e,{css:{strokeDashoffset:Math.random()*t-t/2},onComplete:function(){setTimeout(this.animateRing.bind(this),3*Math.random()+1,e)}.bind(this)})}},webglUpdate:function(){},toRad:function(e){return Math.PI/180*e},initCSS3D:function(){this.ring1CSS=new THREE.CSS3DObject(this.$el.find(".ring1")[0]),this.ring1CSS.position.z=-100,this.webgl.sceneCSS.add(this.ring1CSS),this.ring2CSS=new THREE.CSS3DObject(this.$el.find(".ring2")[0]),this.ring2CSS.position.z=-100,this.webgl.sceneCSS.add(this.ring2CSS),this.ring3CSS=new THREE.CSS3DObject(this.$el.find(".ring3")[0]),this.ring3CSS.position.z=-100,this.webgl.sceneCSS.add(this.ring3CSS),this.mainCSS=new THREE.CSS3DObject(this.$el.find(".main")[0]),this.mainCSS.position.z=-100,this.webgl.sceneCSS.add(this.mainCSS),this.setElement(this.mainCSS.element),setTimeout(this.animateRing.bind(this),3*Math.random()+1,1),setTimeout(this.animateRing.bind(this),3*Math.random()+1,2),setTimeout(this.animateRing.bind(this),3*Math.random()+1,3)},enter:function(){this.createWebGLbg(),setTimeout(function(){ns.audioProxy.triggerEvent("go_for_code_one")}.bind(this),5800),setTimeout(this.prepopulateFirst.bind(this),8700),setTimeout(function(){ns.audioProxy.triggerEvent("login_screen_in"),ns.audioProxy.triggerEvent("level1_sparkle_start"),this.$(".foldertitle").addClass("exiting"),this.$(".line:nth-child(1)").addClass("exiting"),this.$(".line:nth-child(2)").addClass("exiting"),this.$(".line:nth-child(3)").addClass("exiting"),this.initCSS3D(),setTimeout(function(){setTimeout(function(){this.$(".foldertitle").removeClass("exiting")}.bind(this),1),setTimeout(function(){this.$(".line:nth-child(1)").removeClass("exiting")}.bind(this),100),setTimeout(function(){this.$(".line:nth-child(2)").removeClass("exiting")}.bind(this),350),setTimeout(function(){this.$(".line:nth-child(3)").removeClass("exiting")}.bind(this),600),setTimeout(function(){$(this.ring1CSS.element).addClass("entering")}.bind(this),1100),setTimeout(function(){$(this.ring2CSS.element).addClass("entering")}.bind(this),1550),setTimeout(function(){$(this.ring3CSS.element).addClass("entering")}.bind(this),1800)}.bind(this),300)}.bind(this),1800)},exit:function(e){this.remove(),this.webglbg.exit();var i=this.webgl.sceneCSS,t=this.ring1CSS,s=this.ring2CSS,n=this.ring3CSS;console.log(t,s,n),setTimeout(function(){ns.audioProxy.triggerEvent("login_screen_out"),ns.audioProxy.triggerEvent("file_structure_out"),ns.audioProxy.triggerEvent("level1_sparkle_end"),TweenLite.to(t.position,1.5,{z:-8e3,ease:Power3.easeIn,delay:.4,onComplete:function(){i.remove(t)}.bind(this)}),TweenLite.to(s.position,1.5,{z:-8e3,ease:Power3.easeIn,delay:.6,onComplete:function(){i.remove(s)}.bind(this)}),TweenLite.to(n.position,1.5,{z:-8e3,ease:Power3.easeIn,delay:.8,onComplete:function(){i.remove(n),i.remove(this.mainCSS)}.bind(this)}),this.$el.addClass("exiting"),setTimeout(function(){this.$(".foldertitle").addClass("exiting")}.bind(this),1),setTimeout(function(){this.$(".line:nth-child(1)").addClass("exiting")}.bind(this),150),setTimeout(function(){this.$(".line:nth-child(2)").addClass("exiting")}.bind(this),300),setTimeout(function(){this.$(".line:nth-child(3)").addClass("exiting")}.bind(this),450)}.bind(this),2e3),setTimeout(function(){e()},5800)},disableWebGl:function(){this.webglbg.disable()},reenableWebGl:function(){this.webglbg.enable()},disable:function(){this.disabled=!0},reenable:function(){this.disabled=!1}});
},{"../../game-base":125,"./webgl-bg":104,"shared/namespace":175}],104:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace"),paths=require("shared/paths");module.exports=function(e){function n(e,n){for(var t=[],o=2*Math.PI,a=-25*n+200+(8*Math.random()-4),i=0;e>i;i++){var r=c*Math.cos(o*i/e),s=c*-Math.sin(o*i/e),u=a;t.push(r),t.push(s),t.push(u)}return t}function t(){var e=2*Math.PI,n=Math.random();return{x:c/2*Math.cos(e*n),y:c/2*-Math.sin(e*n)}}var o=this;_.extend(o,gamebase),_.extend(o,e);var a=170,i=770,r=new THREE.Object3D,s=[],u=[],l=[],c=500,d=function(){o.webgl.scene.add(r);o.webgl.passes;f(),setTimeout(p,1e3)},p=function(){var e=o.webgl.passes;e.barrelBlur.uniforms.amount.value=.016,TweenLite.to(e.glow.uniforms.amount,2,{value:25,delay:3}),TweenLite.to(e.glow.uniforms.size,2,{value:1,delay:3}),E(),h()},f=function(){o.webgl.events.on("webgl-update",v)},h=function(){function e(e){var n=new THREE.LineBasicMaterial({color:10066329,opacity:.23,transparent:!0,blending:THREE.AdditiveBlending}),o=new THREE.Geometry;o.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,150),new THREE.Vector3(0,0,300));var a=new THREE.Line(o,n),i=t();a.position.x=i.x,a.position.y=i.y,a.position.z=1e3*Math.random()-500,r.add(a),l.push(a)}for(var n=1;i>n;n++)setTimeout(e,20*n,n)},E=function(){function e(e){for(var t=new THREE.BufferGeometry,o=Math.round(170*Math.random())+100,a=n(o,e),i=new Float32Array(a.length),u=0;u<a.length;u++)i[u]=a[u];t.addAttribute("position",new THREE.BufferAttribute(i,3)),THREE.ImageUtils.crossOrigin="";var l=THREE.ImageUtils.loadTexture(paths.CDN+"imgs/uav-search/dot.png"),c=new THREE.PointCloudMaterial({size:20,color:16777215,map:l,transparent:!0,opacity:.15,blending:THREE.AdditiveBlending}),d=new THREE.PointCloud(t,c);d.userData.rotation_speed=Math.round(1e3*(.01*Math.random()-.005))/1e3,r.add(d),s.push(d)}for(var t=1;a>t;t++)setTimeout(e,50*t,t)},g=0,v=function(){s.forEach(function(e){e.rotation.z+=e.userData.rotation_speed}),u.forEach(function(e){e.position.z+=4}),l.forEach(function(e){e.position.z<500?e.position.z+=4:e.position.z=-500}),g++};o.exit=function(){console.log("webgl bg exiting");var e={prop:1};TweenLite.to(e,2.5,{prop:0,delay:3.5,onUpdate:function(){r.scale.set(e.prop,e.prop,e.prop)},onComplete:function(){o.webgl.scene.remove(r)}})},o.disable=function(){console.log("level1 webgl disable"),r.visible=!1},o.enable=function(){console.log("level1 webgl enable"),r.visible=!0},d()},Math.radians=function(e){return e*Math.PI/180},Math.degrees=function(e){return 180*e/Math.PI};
},{"../../game-base":125,"shared/namespace":175,"shared/paths":176}],105:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace"),LineDrawing=require("./colorwheelLines");module.exports=function(e){var n=this;_.extend(n,gamebase),_.extend(n,e);var t,o,a,r,i,s,d=e.webgl,c=n.$el,l=500,u=function(){n.data;t=c.find(".color-selector")[0],r=$(t).find(".outside"),i=$(t).find(".middle"),o=new LineDrawing({canvas:c.find("canvas")[0]}),P(),g(),E(),d.events.on("webgl-update",L)},g=function(){r.on("mousedown",b),i.on("mousedown",b),c.find(".segment").on("click",f),c.find(".segment").on("mouseover",v),$(window).on("mouseup",M)},f=function(e){a?a=!1:(h($(e.currentTarget),e),ns.audioProxy.triggerEvent("color_click"))},v=function(){ns.audioProxy.triggerEvent("color_over")},h=function(e,t){var a=n.appModel.get("access_intel:inputs");a++,n.appModel.set("access_intel:inputs",a),console.log("LEVEL 2 COLOR WHEEL INPUT");var r=e.find(".title").html();e.hasClass("selected")?(e.removeClass("selected"),o.removeEndpoint(e),n.trigger("removeSelection",r)):(e.addClass("selected"),o.addEndpoint(e),n.trigger("addSelection",r))},m=0,p=0,w=0,x=0,b=function(e){s=e.currentTarget,$(window).on("mousemove",T),m=$(window).width()/2,p=$(window).height()/2;var n=e.clientX-m,t=e.clientY-p;w=Math.atan(t/n)},M=function(e){$(window).off("mousemove",T)},T=function(e){a=!0;var n=e.clientX-m,t=e.clientY-p,o=Math.atan(t/n);x=o-w,w=o},y=0,E=function(){if(x*=.92,Math.abs(x)>.001){var e=180*x/Math.PI;y+=e,$(s).css("transform","rotate("+y+"deg"),o.redraw()}requestAnimationFrame(E)},L=function(){},P=function(e){function n(e){var n=180*e/Math.PI,t=Math.sin(e)*l,o=Math.cos(e)*l,a=l/6.7,s="";s+="top:"+t+"px; ",s+="left:"+o+"px; ",s+="transform:rotate("+n+"deg); ",s+="margin-top:-"+a/2+"px; ",s+="height:"+a+"px";var d=hslToRgb(n,85,75),c="#"+rgbaToHex(d.r,d.g,d.b),u="background:hsl("+n+", 95%, 75%);",g=$('<div class="segment" style="'+s+'"><div class="segment-inner" style="'+u+'"></div><div class="title">'+c+"</div></div>");r.append(g);var t=Math.sin(e)*l*.75,o=Math.cos(e)*l*.75,a=l/9,s="";s+="top:"+t+"px; ",s+="left:"+o+"px; ",s+="margin-top:-"+a/2+"px; ",s+="transform:rotate("+n+"deg); ",s+="height:"+a+"px";var d=hslToRgb(n,100,75),c="#"+rgbaToHex(d.r,d.g,d.b),u="background:hsl("+n+", 100%, 50%);",f=$('<div class="segment" style="'+s+'"><div class="segment-inner" style="'+u+'"></div><div class="title">'+c+"</div></div>");i.append(f)}for(var t=40,o=2*Math.PI,a=o/t,s=0;t>s;s++)n(s*a)};n.enter=function(){$(t).find(".segment").each(function(e,n){setTimeout(function(){$(n).addClass("entering")},35*e)})},u()};var hslToRgb=function(e,n,t){function o(e,n){function t(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)}function o(e){return"string"==typeof e&&-1!=e.indexOf("%")}t(e)&&(e="100%");var a=o(e);return e=Math.min(n,Math.max(0,parseFloat(e))),a&&(e=parseInt(e*n,10)/100),Math.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function a(e,n,t){return 0>t&&(t+=1),t>1&&(t-=1),1/6>t?e+6*(n-e)*t:.5>t?n:2/3>t?e+(n-e)*(2/3-t)*6:e}var r,i,s;if(e=o(e,360),n=o(n,100),t=o(t,100),0===n)r=i=s=t;else{var d=.5>t?t*(1+n):t+n-t*n,c=2*t-d;r=a(c,d,e+1/3),i=a(c,d,e),s=a(c,d,e-1/3)}return{r:255*r,g:255*i,b:255*s}},rgbaToHex=function(e,n,t){function o(e){return 1==e.length?"0"+e:""+e}var a=[o(Math.round(e).toString(16)),o(Math.round(n).toString(16)),o(Math.round(t).toString(16))];return a.join("")};
},{"../../game-base":125,"./colorwheelLines":106,"shared/namespace":175}],106:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace");module.exports=function(e){var t=this;_.extend(t,gamebase),_.extend(t,e);var o=e.canvas,i=o.getContext("2d"),n={left:$(window).width()/2,top:$(window).height()/2},r=[],a=function(){d()};t.addEndpoint=function(e){r.push(e),f()};var f=function(){if(r.length>1){var e=r[r.length-2],t=r[r.length-1],o=e.offset(),a=t.offset();i.beginPath(),i.moveTo(o.left,o.top),i.bezierCurveTo(o.left,o.top,n.left,n.top,a.left,a.top),i.lineWidth=.65,i.strokeStyle="#dbc272",i.stroke()}};t.redraw=function(){i.clearRect(0,0,o.width,o.height);for(var e=1;e<r.length;e++){var t=r[e-1],a=r[e],f=t.offset(),d=a.offset();i.beginPath(),i.moveTo(f.left,f.top),i.bezierCurveTo(f.left,f.top,n.left,n.top,d.left,d.top),i.lineWidth=.65,i.strokeStyle="#dbc272",i.stroke()}},t.removeEndpoint=function(e){r.forEach(function(t,o){t.text()==e.text()&&(removeIDX=o)}),removeIDX&&r.splice(removeIDX,1),t.redraw()};var d=function(){var e=l(),t=$(window).width(),i=$(window).height();o.width=t*e,o.height=i*e,o.style.width=t+"px",o.style.height=i+"px",o.getContext("2d").setTransform(e,0,0,e,0,0)},l=function(){var e=document.createElement("canvas").getContext("2d"),t=window.devicePixelRatio||1,o=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/o};a()};
},{"../../game-base":125,"shared/namespace":175}],107:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace"),paths=require("shared/paths");module.exports=Backbone.View.extend({className:"access_intel level2 file",initialize:function(e){_.extend(gamebase,this),_.extend(this,e),this.template="access_intel_level2_file_"+e.data.type,this.$el.addClass(e.data.type);var t=this.data;"text"===e.data.type?t.decoded_content=t.content.replace(/\t/g,"&nbsp;&nbsp;"):"image"===e.data.type&&(t.constructed_url=paths.IMGS+"access-intel/"+t.url),this.$el.html(ns.templates[this.template](t)),this.webgl=e.webgl,this.initCSS3D(),this.bindEvents(),this.webgl.events.on("webgl-update",this.webglUpdate.bind(this))},bindEvents:function(){console.log("file bind events"),this.$(".close-btn").on("click",this.close.bind(this))},close:function(){this.trigger("goBackOne",this),this.remove(),this.webgl.sceneCSS.remove(this.objectCSS),ns.audioProxy.triggerUI(ns.audioProxy.UI_EVENTS.GAME_6_FILE_CLOSE)},webglUpdate:function(){},initCSS3D:function(){this.objectCSS=new THREE.CSS3DObject(this.el),this.webgl.sceneCSS.add(this.objectCSS)},enter:function(){}});
},{"../../game-base":125,"shared/namespace":175,"shared/paths":176}],108:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace"),client=require("shared/utils/client/client");module.exports=Backbone.View.extend({template:"access_intel_level2_folder",className:"access_intel level2 folder",config:{folderRadius:200},initialize:function(t){_.extend(gamebase,this),_.extend(this,t);var e={title:this.data.title};this.$el.html(ns.templates[this.template](e)),this.$bc=this.$(".buttoncontainer"),"top"===this.data.id&&this.$(".close-btn").addClass("hide"),this.isIE="ie"===client.browser.name.toLowerCase(),this.webgl=t.webgl,this.buildMenu(),this.bindEvents(),this.initCSS3D(),this.webgl.events.on("webgl-update",this.webglUpdate.bind(this))},buildMenu:function(){var t=this.data.contains.length;_.each(this.data.contains,function(e,i){var s=i+t/2,n=this.config.folderRadius*Math.cos(2*Math.PI*s/t),o=this.config.folderRadius*-Math.sin(2*Math.PI*s/t);n=Math.round(n),o=Math.round(o);switch(e.type){case"folder":var a=e.contains.length<10?"0"+e.contains.length:e.contains.length,h={title:e.title,contains:a},c=$(ns.templates.access_intel_level2_folder_icon(h));c.css("top",n),c.css("left",o),c.attr("ref",i),this.$bc.append(c);break;case"locked_folder":var c=$(ns.templates.access_intel_level2_locked_folder_icon(e));c.css("top",n),c.css("left",o),c.attr("ref",i),this.$bc.append(c);break;case"image":case"text":default:var c=$(ns.templates.access_intel_level2_file_icon(e));c.css("top",n),c.css("left",o),c.attr("ref",i),this.$bc.append(c)}}.bind(this))},bindEvents:function(){this.$(".button").on("mouseover",this.handleButtonMouseOver.bind(this)),this.$(".button").on("mouseenter",this.handleButtonEnter.bind(this)),this.$(".button").on("click",this.handleButtonClick.bind(this)),this.$(".hitarea").on("click",this.handleGoBackClick.bind(this)),this.$(".hitarea").on("mouseover",this.handleHitareaOver.bind(this)),this.$(".hitarea").on("mouseout",this.handleHitareaOut.bind(this)),this.$(".close-btn").on("click",this.close.bind(this))},close:function(){this.trigger("goBackOne")},handleButtonMouseOver:function(t){var e=.065,i=.5,s=$(t.currentTarget),n=parseInt(s.css("left")),o=parseInt(s.css("top")),a=o/this.config.folderRadius*e,h=n/this.config.folderRadius*e;TweenLite.to(this.objectCSS.rotation,i,{x:a,y:h,onUpdate:function(){this.objectCSS.rotation.needsUpdate=!0}.bind(this)}),TweenLite.to(this.objectCSS.rotation,5*i,{delay:i,x:0,y:0,onUpdate:function(){this.objectCSS.rotation.needsUpdate=!0}.bind(this)})},handleButtonEnter:function(t){ns.audioProxy.triggerEvent("file_over")},handleButtonClick:function(t){var e=$(t.currentTarget),i=e.attr("ref");this.trigger("selectFolderItem",this.data.contains[i]),ns.audioProxy.triggerEvent("file_click")},handleGoBackClick:function(){this.trigger("goBackToFolder",this.data.id)},handleHitareaOver:function(){this.$(".hitarea").hasClass("show")&&TweenLite.to(this.$el,.4,{css:{opacity:.35}})},handleHitareaOut:function(){this.$(".hitarea").hasClass("show")&&TweenLite.to(this.$el,.4,{css:{opacity:.2}})},webglUpdate:function(){},animateIn:function(){TweenLite.to(this.objectCSS.position,1,{delay:.3,x:0,z:0,onUpdate:function(){this.objectCSS.position.needsUpdate=!0}.bind(this)}),TweenLite.to(this.$(".dotring circle"),1.3,{delay:.7,css:{strokeDashoffset:0}}),TweenLite.to(this.$(".dotring circle"),.6,{delay:1.1,css:{r:100}}),TweenLite.to(this.$(".dotring circle"),.3,{delay:1.4,css:{"stroke-width":45}}),TweenLite.to(this.$(".innerring circle"),.6,{delay:1.7,css:{r:40}}),TweenLite.to(this.$(".foldertitle"),.5,{delay:2,css:{opacity:1}}),TweenLite.to(this.$(".foldertitle"),.4,{delay:2.1,css:{transform:"rotateX(0deg)"}});var t=1.7;_.each(this.$(".button"),function(e,i){var s=t+.1*i,n=$(e);TweenLite.to(n,1,{delay:s,css:{opacity:1}})}.bind(this)),setTimeout(function(){this.loopAnimateInnerRing(3*Math.random())}.bind(this),3e3),setTimeout(function(){this.loopAnimateDotRing(3*Math.random())}.bind(this),3e3)},animateOut:function(){_.each(this.$(".button"),function(t,e){var i=$(t);TweenLite.to(i,.2,{css:{opacity:0}})}.bind(this)),TweenLite.to(this.$(".foldertitle"),.5,{css:{opacity:0}}),TweenLite.to(this.$(".foldertitle"),.4,{css:{transform:"rotateX(70deg)"}}),TweenLite.to(this.$(".dotring circle"),.5,{delay:0,css:{strokeDashoffset:-1400}}),TweenLite.to(this.$(".dotring circle"),.3,{delay:0,css:{r:0}}),TweenLite.to(this.$(".dotring circle"),.3,{delay:0,css:{"stroke-width":4}}),TweenLite.to(this.$(".innerring circle"),.3,{delay:0,css:{r:0}})},loopAnimateDotRing:function(t){TweenLite.to(this.$(".dotring circle"),t,{css:{"stroke-width":20*Math.random()+30},onComplete:function(){this.loopAnimateDotRing(2*Math.random())}.bind(this)})},loopAnimateInnerRing:function(t){TweenLite.to(this.$(".innerring circle"),t,{css:{strokeDashoffset:1200*Math.random()-600},onComplete:function(){this.loopAnimateInnerRing(2*Math.random())}.bind(this)})},initCSS3D:function(){this.objectCSS=new THREE.CSS3DObject(this.el),this.objectCSS.position.z=600,this.glParent.add(this.objectCSS)},enter:function(){this.animateIn(),ns.audioProxy.triggerEvent("file_structure_in"),this.$el.addClass("show")},pushBack:function(){var t={x:0,y:this.objectCSS.position.y-80,z:this.objectCSS.position.z-200,opacity:.175};this.isIE?this.$el.removeClass("show"):this.moveFolder(t),this.$(".hitarea").addClass("show"),ns.audioProxy.triggerEvent("file_structure_out")},pushForward:function(){var t={x:0,y:this.objectCSS.position.y+80,z:this.objectCSS.position.z+200,opacity:.175};this.isIE?this.$el.removeClass("show"):this.moveFolder(t),this.$(".hitarea").addClass("show")},pushToFocus:function(){console.clear(),console.log(this.$el),this.$(".hitarea").removeClass("show");var t={x:0,y:0,z:0,opacity:1};this.$el.addClass("show"),this.moveFolder(t)},goAway:function(){this.$(".hitarea").removeClass("show"),this.animateOut();var t={x:0,y:0,z:600,opacity:1};this.isIE?this.$el.removeClass("show"):this.moveFolder(t),ns.audioProxy.triggerEvent("file_structure_out")},moveFolder:function(t){TweenLite.to(this.objectCSS.position,.65,{x:t.x,y:t.y,z:t.z,onUpdate:function(){this.objectCSS.position.needsUpdate=!0}.bind(this)}),TweenLite.to(this.$el,.65,{overwrite:!0,css:{opacity:t.opacity}})},exit:function(){this.$(".hitarea").removeClass("show"),this.animateOut();var t={x:0,y:0,z:-2e3,opacity:0};this.moveFolder(t),setTimeout(function(){this.glParent.remove(this.objectCSS)}.bind(this),1e3)}});
},{"../../game-base":125,"shared/namespace":175,"shared/utils/client/client":190}],109:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace");require("gsap");var WebGLBG=require("./webgl-bg"),Folder=require("./folder"),LockedFolder=require("./lockedfolder"),File=require("./file");module.exports=Backbone.View.extend({template:"access_intel_level2",className:"access_intel level2",folders:null,currentFolder:null,previousFolders:[],initialize:function(e){_.extend(this,e),_.extend(gamebase,this),this.model=new Backbone.Model,this.webgl=e.webgl,this.initCSS3D(),this.webgl.events.on("webgl-update",this.webglUpdate.bind(this))},createFolders:function(){this.folders=[];var e=function(e){var t=new Folder({id:e.id,data:e,appModel:this.appModel,glParent:this.objectCSS,webgl:this.webgl});this.folders.push(t),t.on("selectFolderItem",this.handleFolderItemSelect.bind(this)),t.on("goBackToFolder",this.handleGoBack.bind(this)),t.on("goBackOne",this.handleGoBackOne.bind(this))}.bind(this),t=function(i){_.each(i.contains,function(i){"folder"===i.type&&(e(i),t(i))}.bind(this))}.bind(this);e(this.data),t(this.data),this.goToFolder(this.folders[0])},handleFolderItemSelect:function(e){var t=this.appModel.get("access_intel:skillpoints");switch(t+=20,this.appModel.set("access_intel:skillpoints",t),e.type){case"folder":this.selectFolder(e.id);break;case"locked_folder":this.selectLockedFolder(e);break;case"text":case"image":default:this.selectFile(e)}},selectFile:function(e){var t=this.appModel.get("access_intel:skillpoints");t+=10,this.appModel.set("access_intel:skillpoints",t);var i=new File({data:e,appModel:this.appModel,glParent:this.objectCSS,webgl:this.webgl});i.on("goBackOne",this.handleGoBackOne.bind(this)),this.previousFolders.unshift(this.currentFolder),this.currentFolder=null,_.each(this.previousFolders,function(e){e.pushBack()}.bind(this)),i.enter()},selectLockedFolder:function(e){var t=new LockedFolder({data:e,appModel:this.appModel,$parent:this.$el,glParent:this.objectCSS,webgl:this.webgl});t.on("goBackOne",this.handleGoBackOne.bind(this)),t.on("complete",this.handleComplete.bind(this)),this.previousFolders.unshift(this.currentFolder),this.currentFolder=null,_.each(this.previousFolders,function(e){e.pushBack()}.bind(this)),t.enter(),ns.audioProxy.triggerEvent("color_wheel_animate_in")},handleComplete:function(){this.completed=!0,this.trigger("completed",this)},selectFolder:function(e){var t;_.each(this.folders,function(i){i.id===e&&(t=i)}),t&&this.goToFolder(t)},goToFolder:function(e){this.currentFolder&&(console.log(this.currentFolder),this.previousFolders.unshift(this.currentFolder)),this.currentFolder=e,_.each(this.previousFolders,function(e){e.pushBack()}.bind(this)),this.currentFolder.enter()},handleGoBackOne:function(){this.currentFolder&&this.currentFolder.goAway(),this.currentFolder=this.previousFolders[0],this.previousFolders[0].pushToFocus(),this.previousFolders.shift();for(var e=0;e<this.previousFolders.length;e++)this.previousFolders[e].pushForward()},handleGoBack:function(e){var t;_.each(this.previousFolders,function(i,s){i.id===e&&(t=s)}.bind(this)),this.currentFolder&&this.currentFolder.goAway(),this.currentFolder=this.previousFolders[t];for(var i=0;i<this.previousFolders.length;i++)t>i?this.previousFolders[i].goAway():i==t?this.previousFolders[i].pushToFocus():this.previousFolders[i].pushForward();0===t?this.previousFolders.shift():this.previousFolders.splice(0,t+1)},webglUpdate:function(){},createWebGLbg:function(){this.webglbg=new WebGLBG({webgl:this.webgl,local:this.model})},initCSS3D:function(){this.objectCSS=new THREE.CSS3DObject(this.el),this.webgl.sceneCSS.add(this.objectCSS)},enter:function(){this.createWebGLbg(),this.createFolders(),ns.audioProxy.triggerEvent("level2_digital_highway_start")},exit:function(e){this.remove(),this.webglbg.exit(),this.previousFolders.forEach(function(e){e.exit()}),setTimeout(function(){e()},2700),ns.audioProxy.triggerEvent("color_wheel_animate_out"),ns.audioProxy.triggerEvent("level2_digital_highway_end")},disableWebGl:function(){this.webglbg.disable()},reenableWebGl:function(){this.webglbg.enable()},disable:function(){this.disabled=!0},reenable:function(){this.disabled=!1}});
},{"../../game-base":125,"./file":107,"./folder":108,"./lockedfolder":110,"./webgl-bg":111,"gsap":3,"shared/namespace":175}],110:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace"),ColorWheel=require("./colorwheelDOM.js");module.exports=Backbone.View.extend({template:"access_intel_level2_locked_folder",className:"access_intel level2 locked_folder",colorSelections:[],completed:!1,initialize:function(e){_.extend(gamebase,this),_.extend(this,e);var t=this.data;this.$el.html(ns.templates[this.template](t)),this.webgl=e.webgl,this.colorselector=this.$(".color-selector")[0],this.createColorWheel(),this.initCSS3D(),this.bindEvents(),this.webgl.events.on("webgl-update",this.webglUpdate.bind(this))},bindEvents:function(){this.$(".close-btn").on("click",this.close.bind(this)),this.$(".password input").on("keyup",this.handleInput.bind(this))},close:function(){this.trigger("goBackOne",this),this.webgl.sceneCSS.remove(this.objectCSS)},webglUpdate:function(){},handleInput:function(){var e=this.appModel.get("access_intel:inputs");e++,this.appModel.set("access_intel:inputs",e),console.log("LEVEL 2 PASSWORD INPUT"),ns.audioProxy.triggerEvent("input_field_keyup"),this.checkSelections()},createColorWheel:function(){this.colorwheel=new ColorWheel({data:this.data,appModel:this.appModel,$el:this.$el,glParent:this.objectCSS,webgl:this.webgl}),this.colorwheel.on("removeSelection",this.handleRemoveSelection.bind(this)),this.colorwheel.on("addSelection",this.handleAddSelection.bind(this))},handleAddSelection:function(e){this.colorSelections.push(e),this.checkSelections()},handleRemoveSelection:function(e){var t=this.colorSelections.indexOf(e);this.colorSelections.splice(t,1)},checkSelections:function(){!this.completed&&_.isEqual(this.colorSelections,this.data.passcolor)&&this.$(".password input").val()===this.data.password?(this.goAway(),setTimeout(function(){this.completed=!0,this.trigger("complete"),this.remove(),this.webgl.sceneCSS.remove(this.objectCSS)}.bind(this),2e3)):this.appModel.get("forReview")&&"polaris"===this.$(".password input").val()&&_.contains(this.colorSelections,"#99ff80")&&(this.goAway(),setTimeout(function(){this.completed=!0,this.trigger("complete"),this.remove(),this.webgl.sceneCSS.remove(this.objectCSS)}.bind(this),2e3))},goAway:function(){this.$(".hitarea").removeClass("show");var e={x:0,y:0,z:-3e3,opacity:0};this.moveFolder(e)},moveFolder:function(e){TweenLite.to(this.objectCSS.position,2,{x:e.x,y:e.y,z:e.z,ease:Power3.easeInOut,onUpdate:function(){this.objectCSS.position.needsUpdate=!0}.bind(this)}),TweenLite.to(this.$el,2,{overwrite:!0,css:{opacity:e.opacity}})},initCSS3D:function(){this.objectCSS=new THREE.CSS3DObject(this.el),this.webgl.sceneCSS.add(this.objectCSS)},enter:function(){setTimeout(function(){this.colorwheel.enter(),setTimeout(function(){this.$(".login").addClass("entering")}.bind(this),3e3)}.bind(this),700)}});
},{"../../game-base":125,"./colorwheelDOM.js":105,"shared/namespace":175}],111:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace");module.exports=function(n){var i=this;_.extend(i,gamebase),_.extend(i,n);var o=650,e=["x","y","z"],a=["z","y","x"],t=1500,r=1500,s=30,s=20,d=[],u=!0,w=function(){var n=i.webgl.passes;n.glow.uniforms.amount.value=200,n.glow.uniforms.size.value=3,n.barrelBlur.uniforms.amount.value=.026,p(),h()},h=function(){i.webgl.events.on("webgl-update",m)},p=function(){function n(n){var o=new THREE.LineBasicMaterial({color:8947848,blending:THREE.AdditiveBlending,opacity:.25,transparent:!0}),r=new THREE.Geometry;r.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,t/2,0),new THREE.Vector3(0,t,0));var s=new THREE.Line(r,o);s.position.x=Math.random()*window.innerWidth*2.5-window.innerWidth/2,s.position.y=Math.random()*window.innerHeight*2.5-window.innerHeight/2,s.position.z=-800*Math.random();var n=(Math.random()*Math.random(),Math.floor(Math.random()*Math.random()*e.length)),u=e[n];s.rotation[u]=Math.PI/2,s.userData.axis=a[n],s.userData.direction=Math.round(Math.random()),i.webgl.scene.add(s),d.push(s)}for(var r=1;o>r;r++)setTimeout(n,20*r)},c=0,m=function(){d.forEach(function(n,i){n.userData.direction?n.position[n.userData.axis]>r?u&&(n.position.x=Math.random()*window.innerWidth*2-window.innerWidth/2,n.position.y=Math.random()*window.innerHeight*2-window.innerHeight/2,n.position.z=-800*Math.random(),n.position[n.userData.axis]=-r):n.position[n.userData.axis]+=s:n.position[n.userData.axis]<-r?u&&(n.position.x=Math.random()*window.innerWidth*2-window.innerWidth/2,n.position.y=Math.random()*window.innerHeight*2-window.innerHeight/2,n.position.z=-800*Math.random(),n.position[n.userData.axis]=r):n.position[n.userData.axis]-=s}),c++};i.exit=function(){var n={prop:1};u=!1,r=1e4,TweenLite.to(n,4,{prop:0,onUpdate:function(){s+=1,d.forEach(function(i){i.material.opacity=.25*n.prop})},onComplete:function(){d.forEach(function(n){i.webgl.scene.remove(n)})}})},i.disable=function(){console.log("level2 webgl disable")},w()};
},{"../../game-base":125,"shared/namespace":175}],112:[function(require,module,exports){
var Controls=function(t){function e(){return 2*Math.PI/60/60*p.autoRotateSpeed}function o(){return Math.pow(.95,p.zoomSpeed)}function n(t){p.enabled!==!1&&(t.preventDefault(),p.dispatchEvent({type:"mousedown",event:t,callback:a}))}function a(t,e){t?(V=C.PAN,g.set(e.clientX,e.clientY)):(V=C.ROTATE,b.set(e.clientX,e.clientY)),document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",s,!1),p.dispatchEvent(U)}function i(t){if(p.enabled!==!1){t.preventDefault();var e=p.domElement===document?p.domElement.body:p.domElement;if(V===C.ROTATE){if(p.noRotate===!0)return;f.set(t.clientX,t.clientY),v.subVectors(f,b),p.rotateLeft(2*Math.PI*v.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*v.y/e.clientHeight*p.rotateSpeed),b.copy(f)}else if(V===C.DOLLY){if(p.noZoom===!0)return;R.set(t.clientX,t.clientY),M.subVectors(R,H),M.y>0?p.dollyIn():M.y<0&&p.dollyOut(),H.copy(R)}else if(V===C.PAN){if(p.noPan===!0)return;y.set(t.clientX,t.clientY),T.subVectors(y,g),p.pan(T.x,T.y),g.copy(y)}V!==C.NONE&&p.update()}}function s(){p.enabled!==!1&&(document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",s,!1),p.dispatchEvent(I),V=C.NONE)}function c(t){p.target.clone()}function r(t){if(p.enabled!==!1&&V===C.NONE){k||(p.dispatchEvent({type:"mousewheel",event:t,callback:c}),k=!0),t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?p.dollyOut():0>e&&p.dollyIn(),p.update(),p.dispatchEvent(U),p.dispatchEvent(I)}}function h(t){if(p.enabled!==!1){switch(t.touches.length){case 1:if(p.noRotate===!0)return;V=C.TOUCH_ROTATE,b.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(p.noZoom===!0)return;V=C.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+o*o);H.set(0,n);break;case 3:if(p.noPan===!0)return;V=C.TOUCH_PAN,g.set(t.touches[0].pageX,t.touches[0].pageY);break;default:V=C.NONE}V!==C.NONE&&p.dispatchEvent(U)}}function l(t){if(p.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=p.domElement===document?p.domElement.body:p.domElement;switch(t.touches.length){case 1:if(p.noRotate===!0)return;if(V!==C.TOUCH_ROTATE)return;f.set(t.touches[0].pageX,t.touches[0].pageY),v.subVectors(f,b),p.rotateLeft(2*Math.PI*v.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*v.y/e.clientHeight*p.rotateSpeed),b.copy(f),p.update();break;case 2:if(p.noZoom===!0)return;if(V!==C.TOUCH_DOLLY)return;var o=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,a=Math.sqrt(o*o+n*n);R.set(0,a),M.subVectors(R,H),M.y>0?p.dollyOut():M.y<0&&p.dollyIn(),H.copy(R),p.update();break;case 3:if(p.noPan===!0)return;if(V!==C.TOUCH_PAN)return;y.set(t.touches[0].pageX,t.touches[0].pageY),T.subVectors(y,g),p.pan(T.x,T.y),g.copy(y),p.update();break;default:V=C.NONE}}}function d(){p.enabled!==!1&&(p.dispatchEvent(I),V=C.NONE)}this.enabled=t.enabled,this.object=t.object,this.domElement=void 0!==t.el?t.el:document,console.log(this.domElement),this.target=new THREE.Vector3,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=-(1/0),this.maxZoom=1/0,this.rotateSpeed=1,this.keyPanSpeed=7,this.minPolarAngle=-(1/0),this.maxPolarAngle=1/0,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0;var u,m,p=this,E=1e-6,b=new THREE.Vector2,f=new THREE.Vector2,v=new THREE.Vector2,g=new THREE.Vector2,y=new THREE.Vector2,T=new THREE.Vector2,O=new THREE.Vector3,j=new THREE.Vector3,H=new THREE.Vector2,R=new THREE.Vector2,M=new THREE.Vector2,N=0,w=0,A=1,x=new THREE.Vector3,P=new THREE.Vector3,L=new THREE.Quaternion,C={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},V=C.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var z=(new THREE.Quaternion).setFromUnitVectors(this.object.up,new THREE.Vector3(0,1,0)),D=z.clone().inverse(),Y={type:"change"},U={type:"start"},I={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=e()),w-=t},this.rotateUp=function(t){void 0===t&&(t=e()),N-=t},this.panLeft=function(t){var e=this.object.matrix.elements;O.set(e[0],e[1],e[2]),O.multiplyScalar(-t),x.add(O)},this.panUp=function(t){var e=this.object.matrix.elements;O.set(e[4],e[5],e[6]),O.multiplyScalar(t),x.add(O)},this.pan=function(t,e){var o=p.domElement===document?p.domElement.body:p.domElement;if(p.object instanceof THREE.PerspectiveCamera){var n=p.object.position,a=n.clone().sub(p.target),i=a.length();i*=Math.tan(p.object.fov/2*Math.PI/180),p.panLeft(2*t*i/o.clientHeight),p.panUp(2*e*i/o.clientHeight)}else p.object instanceof THREE.OrthographicCamera?(p.panLeft(t*(p.object.right-p.object.left)/o.clientWidth),p.panUp(e*(p.object.top-p.object.bottom)/o.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=o()),p.object instanceof THREE.PerspectiveCamera?A/=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),p.object.updateProjectionMatrix(),p.dispatchEvent(Y)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=o()),p.object instanceof THREE.PerspectiveCamera?A*=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),p.object.updateProjectionMatrix(),p.dispatchEvent(Y)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var t=this.object.position;j.copy(t).sub(this.target),j.applyQuaternion(z),u=Math.atan2(j.x,j.z),m=Math.atan2(Math.sqrt(j.x*j.x+j.z*j.z),j.y),this.autoRotate&&V===C.NONE&&this.rotateLeft(e()),u+=w,m+=N,u=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,u)),m=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,m)),m=Math.max(E,Math.min(Math.PI-E,m));var o=j.length()*A;o=Math.max(this.minDistance,Math.min(this.maxDistance,o)),this.target.add(x),j.x=o*Math.sin(m)*Math.sin(u),j.y=o*Math.cos(m),j.z=o*Math.sin(m)*Math.cos(u),j.applyQuaternion(D),t.copy(this.target).add(j),this.object.lookAt(this.target),w=0,N=0,A=1,x.set(0,0,0),(P.distanceToSquared(this.object.position)>E||8*(1-L.dot(this.object.quaternion))>E)&&(this.dispatchEvent(Y),P.copy(this.object.position),L.copy(this.object.quaternion))},this.reset=function(){V=C.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Y),this.update()},this.getPolarAngle=function(){return m},this.getAzimuthalAngle=function(){return u};var k=!1;this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",n,!1),this.domElement.addEventListener("mousewheel",r,!1),this.domElement.addEventListener("DOMMouseScroll",r,!1),this.domElement.addEventListener("touchstart",h,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",l,!1),this.update()};Controls.prototype=Object.create(THREE.EventDispatcher.prototype),Controls.prototype.constructor=Controls,module.exports=Controls;
},{}],113:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace"),client=require("shared/utils/client/client");module.exports=Backbone.View.extend({initialize:function(t){_.extend(gamebase,this),_.extend(this,t),this.$el.html(ns.templates[this.template]({idx:this.idx})),this.$el.on("click",this.click.bind(this)),this.isIE="ie"===client.browser.name.toLowerCase(),this.initCSS3D(),this.init()},click:function(){this.focused===!1&&(this.local.trigger("focus-document",this),this.local.set("document-focused",!0))},place:function(t,e,i){var s=this.local.get("docPadding"),o=this.$el.height()+s,n=(this.$el.width()+s,this.local.get("totalDocs"),1350);if(this.isIE&&(n=600),this.zoom)this.$el.addClass("zoomed"),t=t||0,console.log("y = "+-((this.idx-t)*o*.85),"h = "+o),TweenLite.to(this.objectCSS.position,.75,{x:0,y:-((this.idx-t)*o*.85),z:1e3,ease:Power2.easeInOut,onComplete:function(){e&&"function"==typeof e&&e(this)}.bind(this)}),TweenLite.to(this.objectCSS.rotation,.275,{x:.1,ease:Power2.easeIn}),TweenLite.to(this.objectCSS.rotation,.475,{x:0,delay:.275,ease:Power2.easeOut});else{this.$el.removeClass("zoomed");var h=this.local.get("docCols"),l=this.idx%2?1:-1,a=-Math.floor(this.idx/h);a+=a/2,a*=o,i?this.objectCSS.position.set(l*n,a,0):TweenLite.to(this.objectCSS.position,.75,{x:l*n,y:a,z:0})}},goToIDX:function(t,e){this.zoom=!0,this.place(t,e)},initCSS3D:function(){this.objectCSS=new THREE.CSS3DObject(this.$el[0]),this.place(null,null,!0),this.glParent.add(this.objectCSS),setTimeout(function(){this.$el.addClass("entering")}.bind(this),600)},sendBack:function(){this.zoom=!1,this.place()}});
},{"../../game-base":125,"shared/namespace":175,"shared/utils/client/client":190}],114:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace"),ModelViewer=require("./modelViewer"),MapViewer=require("./mapViewer"),RiddleViewer=require("./riddleViewer");module.exports=Backbone.View.extend({focused:!1,documents:[],currIDX:null,initialize:function(t){_.extend(gamebase,this),_.extend(this,t),this.setElement(this.$el),this.initCSS3D(),this.createDocuments(),this.bindEvents(),setTimeout(this.resize.bind(this),1)},bindEvents:function(){this.local.on("focus-document",this.focusDocument.bind(this)),this.$lightbox.on("click",this.handleCloseClick.bind(this))},handleCloseClick:function(){this.$lightbox.removeClass("show"),this.documents.forEach(function(t,e){t.blur(),t.sendBack(),this.local.set("document-focused",!1)}.bind(this))},focusDocument:function(t){var e=this.appModel.get("access_intel:skillpoints");e+=10,this.appModel.set("access_intel:skillpoints",e);var i;this.documents.forEach(function(e,s){e.cid===t.cid&&(i=s)}.bind(this)),this.documents.forEach(function(t,e){i===e?t.goToIDX(i,function(t){t.focus()}):(t.blur(),t.goToIDX(i))}.bind(this)),setTimeout(function(){this.$lightbox.addClass("show")}.bind(this),600)},createDocuments:function(){this.local.set("docCols",2),this.local.set("docPadding",160),this.local.set("totalDocs",this.data.length),this.data.forEach(function(t,e){switch(t.type){case"map":var i=new MapViewer({local:this.local,data:t,glParent:this.objectCSS,idx:e});this.$el.append(i.$el),this.documents.push(i);break;case"model":var i=new ModelViewer({local:this.local,data:t,glParent:this.objectCSS,idx:e});this.$el.append(i.$el),this.documents.push(i);break;case"riddle":var i=new RiddleViewer({local:this.local,data:t,glParent:this.objectCSS,idx:e});this.$el.append(i.$el),this.documents.push(i)}}.bind(this))},resize:function(){var t=this.documents.length<this.local.get("docRows")?this.documents.length:this.local.get("docRows"),e=Math.ceil(this.documents.length/this.local.get("docRows")),i=this.documents[0].$el.height(),s=this.documents[0].$el.width(),o=e*i+5*this.local.get("docPadding"),n=t*s+5*this.local.get("docPadding");this.$(".bg").css("height",o).attr("height",o).find("rect").attr("height",o),this.$(".bg").css("width",n).attr("width",n).find("rect").attr("width",n)},initCSS3D:function(){this.$lightbox=this.$(".lightbox");var t=new THREE.CSS3DObject(this.$lightbox[0]);t.position.z=0,this.webgl.sceneCSS.add(t),this.objectCSS=new THREE.CSS3DObject(this.$el[0]),this.objectCSS.position.z=-1e3,this.webgl.sceneCSS.add(this.objectCSS)},focus:function(){},blur:function(){},exit:function(){console.log("webgl sceneCSS",this.webgl.sceneCSS),this.documents.forEach(function(t){t.objectCSS.parent.remove(t.objectCSS)}.bind(this))}});
},{"../../game-base":125,"./mapViewer":116,"./modelViewer":117,"./riddleViewer":119,"shared/namespace":175}],115:[function(require,module,exports){
var gamebase=require("../../game-base"),ns=require("shared/namespace");require("gsap");var WebGLBG=require("./webgl-bg"),NumberGrid=require("./numbergridPlanes"),Documents=require("./documents");module.exports=Backbone.View.extend({template:"access_intel_level3",className:"access_intel level3",winningSelections:null,currentSelections:[],initialize:function(e){_.extend(this,e),_.extend(gamebase,this),this.setElement(this.$el),this.$el.html(ns.templates[this.template]()),this.model=new Backbone.Model,this.webgl=e.webgl,this.$parent.append(this.$el),this.winningSelections=this.data.winningSelections,this.initCSS3D(),this.initMap(),this.windowWidth=$(window).width(),this.windowHeight=$(window).height()},initMap:function(){window.mapinitialized=function(){this.model.trigger("maps-ready"),this.model.set("maps-ready",!0)}.bind(this);var e=document.createElement("script");e.type="text/javascript",e.src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&callback=mapinitialized",document.body.appendChild(e)},handleFocusEvent:function(e){e===this.documents?this.numbergrid.blur():this.documents.blur()},handleAddSelection:function(e){this.currentSelections.indexOf(e)<0&&(this.currentSelections.push(e),this.checkWinningSelections())},handleRemoveSelection:function(e){var i=this.currentSelections.indexOf(e);i>-1&&(this.currentSelections.splice(i,1),this.checkWinningSelections())},checkWinningSelections:function(){if(this.currentSelections.length===this.winningSelections.length){var e=!1;this.currentSelections.forEach(function(i){this.winningSelections.indexOf(i)<0&&(e=!0)}.bind(this)),e||setTimeout(function(){this.completed=!0,this.trigger("completed",this)}.bind(this),500)}},handleMouseMove:function(e){var i=this.windowWidth/2,t=this.windowHeight/2,n=(e.clientX-i)/i,s=(e.clientY-t)/t;this.model.trigger("mousemove",{x:n,y:s})},bindEvents:function(){$(window).on("mousemove",this.handleMouseMove.bind(this)),this.model.on("focusing",this.handleFocusEvent.bind(this)),this.numbergrid.on("addSelection",this.handleAddSelection.bind(this)),this.numbergrid.on("removeSelection",this.handleRemoveSelection.bind(this)),this.webgl.events.on("webgl-update",this.webglUpdate.bind(this))},webglUpdate:function(){},createWebGLbg:function(){this.webglbg=new WebGLBG({webgl:this.webgl,local:this.model})},initCSS3D:function(){},createNumberGrid:function(){this.numbergrid=new NumberGrid({webgl:this.webgl,local:this.model,$el:this.$parent.find("canvas.numbergrid"),appModel:this.appModel})},createDocuments:function(){this.documents=new Documents({webgl:this.webgl,local:this.model,appModel:this.appModel,data:this.data.games,$canvas:this.$numbergrid,$el:this.$el})},enter:function(){this.createWebGLbg(),ns.audioProxy.triggerEvent("level3_servo_motors_start"),setTimeout(function(){this.createNumberGrid(),this.numbergrid.enter()}.bind(this),4e3),setTimeout(function(){this.$(".documents").addClass("entering"),this.createDocuments(),this.bindEvents()}.bind(this),7e3)},exit:function(e){this.clock.stop(),ns.audioProxy.triggerEvent("level3_servo_motors_end"),this.documents.exit(),this.webglbg.exit(),setTimeout(function(){this.numbergrid.exit()}.bind(this),1),setTimeout(function(){e()}.bind(this),6e3)},disableWebGl:function(){this.webglbg&&this.webglbg.disable()}});
},{"../../game-base":125,"./documents":114,"./numbergridPlanes":118,"./webgl-bg":120,"gsap":3,"shared/namespace":175}],116:[function(require,module,exports){
var Document=require("./document");module.exports=Document.extend({template:"access_intel_level3_mapviewer",className:"access_intel level3 mapviewer document",focused:!1,padding:1.25,init:function(){},buildMap:function(){if(this.local.get("maps-ready")){if(!this.mapBuilt){this.mapBuilt=!0;var e=new google.maps.LatLng(this.data.coords[0],this.data.coords[1]),s={center:e,zoom:15},t=new google.maps.Map(this.$(".container")[0],s),i=[{stylers:[{hue:"#911d1d"},{saturation:400}]},{featureType:"landscape",stylers:[{color:"#333333"}]},{elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{color:"#444444"}]},{featureType:"water",stylers:[{color:"#282828"}]},{featureType:"transit",stylers:[{color:"#444444"}]},{featureType:"poi",stylers:[{visibility:"simplified"},{color:"#666666"}]}];t.setOptions({styles:i});new google.maps.Marker({position:e,map:t});this.$(".container").addClass("show")}}else this.local.on("maps-ready",this.buildMap.bind(this))},showMap:function(){this.mapBuilt?this.$(".container").addClass("show"):this.buildMap()},hideMap:function(){this.$(".container").removeClass("show")},focus:function(){this.focused=!0,this.showMap()},blur:function(){this.focused=!1,this.hideMap()}});
},{"./document":113}],117:[function(require,module,exports){
function toRad(e){return Math.PI/180*e}function toDeg(e){return e*(180/Math.PI)}var Document=require("./document"),Controls=require("./controls");require("shared/lib/three.js-master/examples/js/loaders/OBJLoader"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader"),require("shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader"),THREE.GlowShader=require("shared/shaders/GlowShader"),THREE.BarrelBlurShader=require("shared/shaders/BarrelBlurShader");var paths=require("shared/paths");module.exports=Document.extend({template:"access_intel_level3_modelviewer",className:"access_intel level3 modelviewer document",focused:!1,height:600,width:800,offsetLeft:null,offsetTop:null,init:function(){},initWebGL:function(){this.camera=new THREE.PerspectiveCamera(75,this.$("canvas").width()/this.$("canvas").height(),1,1e4),this.camera.position.z=50,this.offsetLeft=$(this.el).offset().left,this.offsetTop=$(this.el).offset().top,this.controls=new Controls({object:this.camera,scene:this.scene,el:this.el,local:this.local,enabled:!0}),console.log(this.controls),this.controls.addEventListener("mousedown",this.handleMouseDown.bind(this)),this.controls.addEventListener("mousewheel",this.handleMouseWheel.bind(this)),this.controls.addEventListener("change",this.render.bind(this)),this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({canvas:this.$("canvas")[0],preserveDrawingBuffer:!0}),this.renderer.setSize(this.width,this.height),window.addEventListener("resize",this.onResize.bind(this),!1),this.onResize(),this.animate(),this.render(),this.webglLoaded=!0},handleMouseDown:function(e){this.mesh.updateMatrixWorld(!0);var s=e.event,t=new THREE.Raycaster,i=new THREE.Vector2,a=s.clientX-this.offsetLeft,r=s.clientY-this.offsetTop;i.x=a/this.width*2-1,i.y=2*-(r/this.height)+1,t.setFromCamera(i,this.camera);var h,o=t.intersectObjects(this.scene.children,!0);o.forEach(function(e){e.object._isBG||(h=!0)}),e.callback(h,s)},handleMouseWheel:function(e){var s=e.event,t=new THREE.Raycaster,i=new THREE.Vector2,a=s.clientX-this.offsetLeft,r=s.clientY-this.offsetTop;i.x=a/this.width*2-1,i.y=2*-(r/this.height)+1,t.setFromCamera(i,this.camera);var h=t.intersectObjects(this.scene.children,!0);e.callback(h[0].point,s)},createBG:function(){var e=paths.IMGS+"access-intel/modelviewer-bg.jpg",s=THREE.ImageUtils.loadTexture(e);s.wrapS=s.wrapT=THREE.RepeatWrapping,s.repeat.set(6,6);var t=new THREE.MeshBasicMaterial({map:s,side:THREE.BackSide});new THREE.MeshNormalMaterial({side:THREE.BackSide});this.bg=new THREE.Mesh(new THREE.SphereGeometry(4e3,60,40),t),this.bg.overdraw=!0,this.bg._isBG=!0,this.scene.add(this.bg)},loadObject:function(){loader=new THREE.JSONLoader;var e=paths.MODELS+"games/access-intel/"+this.data.file+".js";loader.load(e,function(e){this.mesh=new THREE.Mesh(e,new THREE.MeshBasicMaterial({wireframe:!0,wireframeLinewidth:2,color:16777215,opacity:.01,transparent:!0,blending:THREE.AdditiveBlending})),this.scene.add(this.mesh),this.render(),this.modelLoaded=!0,this.$("canvas").addClass("show"),this.addClue()}.bind(this))},addClue:function(){var e=new THREE.Object3D,s=new THREE.PlaneGeometry(50,50),t=(new THREE.BufferGeometry).fromGeometry(s),i=new THREE.MeshBasicMaterial({transparent:!0,opacity:0,side:THREE.DoubleSide}),a=paths.IMGS+"access-intel/numbergrid/_1.png",r=new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(a),transparent:!0,side:THREE.DoubleSide}),h=new THREE.Mesh(t,r);h.overdraw=!0,h.position.z=.5,e.add(h);var h=new THREE.Mesh(t,i);h.overdraw=!0,e.add(h);var a=paths.IMGS+"access-intel/numbergrid/_6.png",r=new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(a),transparent:!0,side:THREE.DoubleSide}),h=new THREE.Mesh(t,r);h.overdraw=!0,h.position.z=.5,h.position.x=50,e.add(h);var h=new THREE.Mesh(t,i);h.overdraw=!0,h.position.x=50,e.add(h);var o=(this.mesh.geometry.faces,this.mesh.geometry.vertices);this.mesh.updateMatrixWorld(!0);var n=new THREE.Vector3,d=new THREE.Quaternion,l=new THREE.Vector3;this.mesh.matrixWorld.decompose(n,d,l);var c=o[Math.round(Math.random()*(o.length-1))].clone();e.position.copy(c);var E=Math.round(6*Math.random()),m={x:0,y:0,z:0};switch(console.log(E),E){case 0:break;case 1:m.x=toRad(90);break;case 2:m.x=toRad(-90);break;case 3:m.y=toRad(180);break;case 4:m.y=toRad(90);break;case 5:m.y=toRad(-90)}e.rotation.set(m.x,m.y,m.z),this.scene.add(e)},onResize:function(){var e={};e.w=this.$("canvas").width(),e.h=this.$("canvas").height(),this.camera.aspect=e.w/e.h,this.camera.updateProjectionMatrix(),this.renderer.setSize(e.w,e.h),this.offsetLeft=$(this.el).offset().left,this.offsetTop=$(this.el).offset().top},animate:function(){requestAnimationFrame(this.animate.bind(this)),this.paused||this.trigger("webgl-update")},shaderTime:0,render:function(){this.paused||this.composer&&(this.composer.render(.1),this.shaderTime+=.1,this.passes.barrelBlur.uniforms.time.value=this.shaderTime)},hideModel:function(){console.log(this.mesh),this.mesh&&(this.mesh.visible=!1,this.bg.visible=!1),this.$("canvas").removeClass("show")},focus:function(){this.paused=!1,this.webglLoaded||(this.initWebGL(),this.createBG(),this.addEffects()),this.modelLoaded?(this.mesh.visible=!0,this.bg.visible=!0,this.$("canvas").addClass("show")):this.loadObject(),this.focused=!0,this.controls.enabled=!0},blur:function(){this.focused=!1,this.controls&&(this.controls.enabled=!1),this.hideModel(),this.paused=!0},addEffects:function(){this.composer=new THREE.EffectComposer(this.renderer),this.renderPass=new THREE.RenderPass(this.scene,this.camera),this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this.passes={},this.passes.glow=new THREE.ShaderPass(THREE.GlowShader),this.passes.tiltshift=new THREE.ShaderPass(THREE.VerticalTiltShiftShader),this.passes.barrelBlur=new THREE.ShaderPass(THREE.BarrelBlurShader),this.passes.glow.uniforms.amount.value=.4,this.passes.glow.uniforms.size.value=3.7,this.passes.glow.uniforms.darkness.value=.14,this.passes.tiltshift.uniforms.v.value=.005,this.passes.tiltshift.uniforms.r.value=.5,this.passes.barrelBlur.uniforms.amount.value=.01,this.composer=new THREE.EffectComposer(this.renderer),this.composer.addPass(this.renderPass),this.composer.addPass(this.passes.glow),this.composer.addPass(this.passes.tiltshift),this.composer.addPass(this.passes.barrelBlur),this.composer.addPass(this.copyPass),this.copyPass.renderToScreen=!0}});
},{"./controls":112,"./document":113,"shared/lib/three.js-master/examples/js/loaders/OBJLoader":161,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader":172,"shared/paths":176,"shared/shaders/BarrelBlurShader":177,"shared/shaders/GlowShader":182}],118:[function(require,module,exports){
require("shared/lib/three.js-master/examples/js/renderers/CSS3DRenderer"),require("shared/lib/three.js-master/examples/js/renderers/Projector"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader"),require("shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader"),require("shared/shaders/FilmShader.js"),THREE.GlowShader=require("shared/shaders/GlowShader"),THREE.BarrelBlurShader=require("shared/shaders/BarrelBlurShader");var gamebase=require("../../game-base"),ns=require("shared/namespace");module.exports=function(e){function t(){d=new THREE.EffectComposer(s),h=new THREE.RenderPass(l,c),h.clearAlpha=0,w=new THREE.ShaderPass(THREE.CopyShader),u={},u.glow=new THREE.ShaderPass(THREE.GlowShader),u.tiltshift=new THREE.ShaderPass(THREE.VerticalTiltShiftShader),u.barrelBlur=new THREE.ShaderPass(THREE.BarrelBlurShader),u.film=new THREE.ShaderPass(THREE.FilmShader),u.glow.uniforms.amount.value=.3,u.glow.uniforms.size.value=1,u.glow.uniforms.darkness.value=.1,u.tiltshift.uniforms.v.value=.001,u.tiltshift.uniforms.r.value=1,u.barrelBlur.uniforms.amount.value=.005,u.film.uniforms.sCount.value=1500,u.film.uniforms.sIntensity.value=.4,u.film.uniforms.nIntensity.value=.6,u.film.uniforms.grayscale.value=0,d=new THREE.EffectComposer(s),d.addPass(h),d.addPass(u.glow),d.addPass(u.film),d.addPass(w),w.renderToScreen=!0}function a(){var e={};e.w=window.innerWidth,e.h=window.innerHeight,c.aspect=e.w/e.h,c.updateProjectionMatrix(),s.setSize(e.w,e.h)}function i(){requestAnimationFrame(i),d.render(.1),B+=.1,u.barrelBlur.uniforms.time.value=B}var r=this;_.extend(r,gamebase),_.extend(r,e);var n,o,s,l,c,d,u,h,w,m,p=12,f=12,E=30,v=6,g=!0,T=[],y=[],b=new THREE.Vector2,R=new THREE.Raycaster,H=[],S=[[1,10,14,9,14,5,9,20,18,5,24,15],[1,10,20,14,5,6,21,11,14,8,9,2,9],[1,10,20,18,8,6,9,20,18,5,24,15],[1,10,8,14,8,6,9,20,18,5,24,15],[1,20,20,14,8,6,9,20,18,5,24,15],[1,10,20,14,8,6,9,13,17,21,11,14],[1,10,20,14,8,6,9,20,18,5,24,15],[1,10,20,14,8,6,9,20,18,5,24,15],[1,10,20,14,8,6,9,20,18,5,24,15],[1,10,20,14,8,6,9,20,18,5,24,15],[1,10,20,14,8,6,9,5,24,15,13,17],[1,10,20,14,8,6,9,20,18,5,24,15]],D=function(){x(),t(),C(),M(),L(),a(),i()},x=function(){c=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4),c.position.z=500,l=new THREE.Scene,s=new THREE.WebGLRenderer({canvas:r.$numbergrid[0],preserveDrawingBuffer:!0,alpha:!0}),s.setSize(window.innerWidth,window.innerHeight)},M=function(){for(var e=0;e<T.length;e++)for(var t=0;t<T[e].children.length;t++)H.push(T[e].children[t])},L=function(){$(r.webgl.css3dcanvas).on("mousedown",j),$(r.webgl.css3dcanvas).on("mousemove",P),r.local.on("mousemove",function(e){}),window.addEventListener("resize",a,!1)},P=function(e){if(!r.local.get("document-focused")){var t=$(r.webgl.css3dcanvas).width(),a=$(r.webgl.css3dcanvas).height();b.x=e.clientX/t*2-1,b.y=2*-(e.clientY/a)+1,R.setFromCamera(b,r.webgl.camera);var i=R.intersectObjects(H);if(i.length){if(i[0]&&i[0].object.userData.parent){var n=i[0].object.userData.parent;if(n.userData.selected)return;m&&!m.userData._selected&&(TweenLite.to(m.children[1].material,.8,{opacity:1,overwrite:!0}),TweenLite.to(m.children[0].material,.8,{opacity:.25,overwrite:!0})),m=n,n.userData._selected||(TweenLite.to(n.children[1].material,.4,{opacity:.4,overwrite:!0}),TweenLite.to(n.children[0].material,.4,{opacity:1,overwrite:!0}))}}else m&&!m.userData._selected&&(TweenLite.to(m.children[1].material,.8,{opacity:1,overwrite:!0}),TweenLite.to(m.children[0].material,.8,{opacity:.25,overwrite:!0}))}},j=function(e){if(!r.local.get("document-focused")){var t=$(r.webgl.css3dcanvas).width(),a=$(r.webgl.css3dcanvas).height();b.x=e.clientX/t*2-1,b.y=2*-(e.clientY/a)+1,R.setFromCamera(b,r.webgl.camera);var i=R.intersectObjects(H);if(i.length)if(g===!1)r.local.trigger("focusing",this),g=!0,r.focus();else if(i[0]&&i[0].object.userData.parent){var n=i[0].object.userData.parent;z(n),console.log("CLICKED")}}},z=function(e){ns.audioProxy.triggerEvent("grid_tile_click");var t=r.appModel.get("access_intel:inputs");t++,r.appModel.set("access_intel:inputs",t),console.log("LEVEL 3 INPUT"),e.userData._selected=!e.userData._selected;var a=e.children[1];if(e.userData._selected)a.material.color=new THREE.Color(10715139),TweenLite.to(e.position,.25,{z:4,onUpdate:function(){e.position.needsUpdate=!0}}),TweenLite.to(e.children[0].material,.25,{opacity:1,overwrite:!0}),TweenLite.to(e.children[1].material,.25,{opacity:.8,overwrite:!0}),y.push(e),r.trigger("addSelection",e.userData.rowcol);else{var i;a.material.color=new THREE.Color(2236962),y.forEach(function(t,a){t.id===e.id&&(i=a)}),y.splice(i,1),r.trigger("removeSelection",e.userData.rowcol),TweenLite.to(e.position,.25,{z:0,onUpdate:function(){e.position.needsUpdate=!0}}),TweenLite.to(e.children[0].material,.8,{opacity:.25,overwrite:!0})}},C=function(){function e(e){var t=new THREE.Object3D,i=S.length-1-Math.floor(e/p),r=e%f,o=S[i][r],s=new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("assets/imgs/access-intel/numbergrid/_"+o+".png"),transparent:!0,opacity:0}),l=new THREE.Mesh(a,s);l.overdraw=!0,l.position.z=.5,l.userData.parent=t,t.userData.rowcol=i+1+"_"+(r+1),t.add(l);var c=new THREE.MeshBasicMaterial({transparent:!0,opacity:0,color:2236962}),l=new THREE.Mesh(a,c);l.overdraw=!0,l.userData.parent=t,t.add(l),T.push(t),t.userData.position={x:r*(E+v),y:(S.length-1-i)*(E+v),z:0},t.position.x=t.userData.position.x,t.position.y=t.userData.position.y,t.position.z=t.userData.position.z,n.add(t)}o=new THREE.Object3D,o.position.x=0,o.position.y=0,o.position.z=0,l.add(o),n=new THREE.Object3D,n.position.x=-(f/2*E)-E/2-v/2,n.position.y=-(p/2*E),n.position.z=p/2*E-30,o.add(n);for(var t=new THREE.PlaneGeometry(E,E),a=(new THREE.BufferGeometry).fromGeometry(t),i=0;f*p>i;i++)e(i);r.webgl.events.on("webgl-update",function(){})},B=0;r.enter=function(){ns.audioProxy.triggerEvent("grid_animate_in"),T.forEach(function(e,t){var a=e.children[0],i=e.children[1],r={t:0};TweenLite.to(r,1.5,{t:1,delay:.015*t,onUpdate:function(){var e=Math.round(Math.random())*r.t*r.t;a.material.opacity=.25*e,i.material.opacity=e},onComplete:function(){a.material.opacity=.25,i.material.opacity=1}})})},r.blur=function(){},r.focus=function(){TweenLite.to(o.position,.7,{x:-200,z:20})},r.exit=function(){ns.audioProxy.triggerEvent("grid_animate_out"),TweenLite.to(u.glow.uniforms.amount,1,{value:2.5}),TweenLite.to(u.glow.uniforms.size,1,{value:20}),T.forEach(function(e,t){TweenLite.to(e.children[1].material.color,1.5,{r:0,g:0,b:0}),TweenLite.to(e.children[0].material,1.5,{opacity:.2,onUpdate:function(){e.children[1].material.opacity=e.children[0].material.opacity+.6}})}),setTimeout(function(){T.forEach(function(e,t){var a=Math.radians(4320*Math.random()-2160),i=Math.radians(4320*Math.random()-2160),r=Math.radians(4320*Math.random()-2160),n=e.position.x,o=e.position.y,s=e.position.z,l=e.position.x+200*Math.random()-100,c=e.position.y+300*Math.random()-150,d=e.position.z+1e3*Math.random()+600,u={t:0};TweenLite.to(u,17,{t:1,easing:Power4.easeIn,onUpdate:function(){e.position.x=u.t*(l-n)+n,e.position.y=u.t*(c-o)+o,e.position.z=u.t*(d-s)+s,e.rotation.x=u.t*a,e.rotation.y=u.t*i,e.rotation.z=u.t*r,e.position.needsUpdate=!0}})})},1500)},r.disable=function(){console.log("level1 webgl disable"),o.visible=!1},D()},Math.radians=function(e){return e*Math.PI/180},Math.degrees=function(e){return 180*e/Math.PI};
},{"../../game-base":125,"shared/lib/three.js-master/examples/js/renderers/CSS3DRenderer":168,"shared/lib/three.js-master/examples/js/renderers/Projector":169,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader":172,"shared/namespace":175,"shared/shaders/BarrelBlurShader":177,"shared/shaders/FilmShader.js":180,"shared/shaders/GlowShader":182}],119:[function(require,module,exports){
var Document=require("./document");module.exports=Document.extend({template:"access_intel_level3_riddleviewer",className:"access_intel level3 riddleviewer document",focused:!1,padding:1.25,init:function(){},buildRiddle:function(){this.$(".riddle").html(decodeURIComponent(this.data.content))},showRiddle:function(){this.riddleBuilt||this.buildRiddle()},hideRiddle:function(){},focus:function(){this.focused=!0,this.showRiddle()},blur:function(){this.focused=!1,this.hideRiddle()}});
},{"./document":113}],120:[function(require,module,exports){
var gamebase=require("../../game-base");module.exports=function(e){var t=this;_.extend(t,gamebase),_.extend(t,e);var n,o=200,i={height:window.innerHeight,width:window.innerWidth},a=1.6*Math.round(i.width/o),r=2.25*Math.round(i.height/o),l=10,s=a*r*l,u=[],c=new THREE.Object3D,w=function(){var e=t.webgl.passes;e.glow.uniforms.amount.value=5,e.glow.uniforms.size.value=1,e.barrelBlur.uniforms.amount.value=.0015,t.webgl.scene.add(c),d(),h(),f()},d=function(){t.webgl.events.on("webgl-update",v)},f=function(){function e(e){var t=new THREE.LineBasicMaterial({color:10066329,opacity:0,transparent:!0,blending:THREE.AdditiveBlending}),n=new THREE.Object3D;n.add(new THREE.Line(l,t)),c.add(n),n.position.x=e%a*o-a/2*o,n.position.y=Math.floor(e%(a*r)/a)*o-r/2*o,n.position.z=-Math.floor(e/(a*r))*o,u.push(n)}var t=o,n=[new THREE.Vector3(-t/2,t/2,-t/2),new THREE.Vector3(t/2,t/2,-t/2),new THREE.Vector3(t/2,t/2,t/2),new THREE.Vector3(-t/2,t/2,t/2),new THREE.Vector3(-t/2,-t/2,-t/2),new THREE.Vector3(t/2,-t/2,-t/2),new THREE.Vector3(t/2,-t/2,t/2),new THREE.Vector3(-t/2,-t/2,t/2)],i=n,l=new THREE.Geometry;l.vertices.push(i[0],i[4],i[7],i[3],i[0],i[1],i[2],i[6],i[5],i[4],i[5],i[1],i[2],i[3],i[7],i[6]);for(var w=0;s>w;w++)e(w);console.log(u[0]),setTimeout(function(){u[0].position.set(1,1,1)},2e3)},h=function(){setInterval(E,1)},E=function(){var e=u[Math.floor(Math.random()*u.length)];if(e){e.children[0].material.opacity=.14;var t=Math.round(Math.random())?1:-1,n=Math.radians(90)*t,o=Math.floor(3*Math.random()),i=1;0===o?(e.rotation.x=0,TweenLite.to(e.rotation,i,{x:n})):1===o?(e.rotation.y=0,TweenLite.to(e.rotation,i,{y:n})):2===o&&(e.rotation.z=0,TweenLite.to(e.rotation,i,{z:n})),setTimeout(function(){TweenLite.to(e.children[0].material,.85,{opacity:.038})},1700)}},g=0,v=function(){g++};t.exit=function(){n=!0;setTimeout(function(){u.forEach(function(e){TweenLite.to(e.children[0].material,8,{opacity:1,easing:Power2.easeIn,onComplete:function(){t.webgl.events.off("webgl-update",v),c.visible=!1;for(var e=u.length;e>0;e--)c.remove(u[e]);c.remove.cube}})});var e=t.webgl.passes;TweenLite.to(e.barrelBlur.uniforms.amount,8,{value:1.5,easing:Power2.easeIn})},1),setTimeout(function(){t.$top.find(".webgl").addClass("hide")},4e3)},t.disable=function(){console.log("level1 webgl disable"),t.webgl.events.off("webgl-update",v),c.visible=!1},w()},Math.radians=function(e){return e*Math.PI/180},Math.degrees=function(e){return 180*e/Math.PI};
},{"../../game-base":125}],121:[function(require,module,exports){
var gamebase=require("../game-base"),ns=require("shared/namespace"),Helminth=require("./helminth/helminth-main"),WebGL=require("./webgl"),flickerTransition=require("shared/flickertransition"),Level1=require("./level1/level1-main"),Level2=require("./level2/level2-main"),Level3=require("./level3/level3-main"),Story=require("./story"),Clock=require("../common/clock");module.exports=function(e){console.log("access_intel.constructor",e),_.extend(this,gamebase),_.extend(this,e);var n=this;this.appModel.set("forReview",!1);var l,t,i,o,a="access_intel",c={},r=0,s=function(){d(),console.log("COUNTDOWN",e.gameData[0].countdown),o=new Clock({$el:n.$el.find(".clock .time"),countdown:e.gameData[0].countdown,stayPositive:!0}),o.on("countdownComplete",x),n.appModel.set("access_intel:inputs",0),n.appModel.set("access_intel:skillpoints",0)},d=function(){n.$el=$(ns.templates[a]()),n.$parent.append(n.$el)},g=function(){l=new WebGL({parent:n.$el.find(".webgl")})},u=function(){_.each(c,function(e){e.on("completed",v)})},p=function(){t=n.$el.find(".levels");var i=new Level1({$parent:t,appModel:e.appModel,data:n.gameData[0].level1,idx:1,webgl:l,config:n.config});c.level1=i;var a=new Level2({$parent:t,appModel:e.appModel,data:n.gameData[0].level2,idx:2,webgl:l});c.level2=a;var r=new Level3({$parent:t,appModel:e.appModel,data:n.gameData[0].level3,idx:3,webgl:l,clock:o,$top:n.$el,$numbergrid:n.$el.find("canvas.numbergrid")});c.level3=r},v=function(e){r=e.idx+1,e.exit(function(){r>3?w():c["level"+r].enter()})},f=function(){WINDOW_INT=new Helminth({appModel:e.appModel,glitch:window.glitch}),e.appModel.on("helminth-take-over",m),e.appModel.on("helminth-killed",h),c["level"+r].disable()},m=function(){c["level"+r].disableWebGl()},h=function(){c["level"+r].reenableWebGl(),c["level"+r].reenable()},w=function(){l.pause(),c.level3.disableWebGl(),_.extend(e.config,{$el:n.$el.find(".finale")}),i=new Story(e.config),ns.audioProxy.triggerEvent("access_intel_end"),i.on("complete",function(){x(!0)}),n.$el.find(".clock").addClass("hide")},b=function(){var e;n.gameData[0].level2.contains.forEach(function(n){"locked_folder"===n.type&&(e=n)});var l=n.config.level1_codes[0].length+2,t=e.passcolor.length+1,i=n.gameData[0].level3.winningSelections.length,o=l+t+i,a=2*o,c=n.appModel.get("access_intel:inputs"),r=(a-c)/(a-o);return console.log("ACCURACY SCORE: ",r,o,c),console.log("LEVELS",l,t,i),Math.min(1,r)},M=function(){var e=n.appModel.get("access_intel:skillpoints"),l=n.config.range.skill.high,t=n.config.range.skill.low,i=(e-t)/(l-t);return console.log("SKILL SCORE: ",i,l,e),Math.min(1,i)},k=function(){var e=o.getTotalSeconds(),l=n.gameData[0].countdown-Math.abs(e),t=n.config.range.time.high,i=n.config.range.time.low,a=(l-i)/(t-i);return console.log("SPEED SCORE: ",a,t,l),Math.random()},x=function(e){var l={skill:M(),accuracy:b(),speed:k()};e?n.trigger("win",{score:l}):n.trigger("lose",{score:l}),ns.audioProxy.triggerEvent("access_intel_end")};n.enter=function(){g(),p(),u(),setTimeout(f,18e3),r=1,c.level1.enter(),setTimeout(function(){o.start()}.bind(this),2e3),setTimeout(function(){flickerTransition("in",function(){},$("#main"),0),n.$el.find("canvas.webgl").addClass("entering")},500),ns.audioProxy.triggerEvent("access_intel_start")},s()};
},{"../common/clock":124,"../game-base":125,"./helminth/helminth-main":94,"./level1/level1-main":103,"./level2/level2-main":109,"./level3/level3-main":115,"./story":122,"./webgl":123,"shared/flickertransition":155,"shared/namespace":175}],122:[function(require,module,exports){
var ScoreMeter=require("../../views/score-meter"),appModel=require("../../models/app-model"),ns=require("shared/namespace"),paths=require("shared/paths"),VIDEO_PATH=paths.VIDEOS,Story=Backbone.View.extend({template:"mission-story",initialize:function(e){console.log("Story",e),_.extend(this,e),this.render(e),this.setElement(this.el),this.$el.addClass("show");var i=new ScoreMeter({$parent:this.$(".play-btn"),max:100,value:75});this.$(".play-btn").css({opacity:1}),i.show(2),this.$("video").on("play",this.onVideoPlay.bind(this)),this.$("video").on("ended",this.onClickSkip.bind(this)),this.listenTo(appModel,"change:muted",function(){this.onChangeMuted()}),this.onChangeMuted(0)},onChangeMuted:function(e){var i=void 0!==e?e:.5,t=appModel.get("muted")?0:1;TweenLite.to(this.$("video"),i,{volume:t})},onVideoPlay:function(){this.$("video").css({opacity:1,visibility:"visible"}),this.$(".play-btn").css({opacity:0,visibility:"hidden"})},events:{"click video":"onClickSkip","click .play-btn":"onClickPlay"},onClickPlay:function(){this.$("video")[0].play()},onClickSkip:function(){this.exit(function(){this.trigger("complete")}.bind(this))},exit:function(e){this.$("video")[0].pause(),TweenLite.to(this.$el,.3,{autoAlpha:0,onComplete:function(){e()}})},render:function(e){console.log("RENDERZZZ",e),e.video=e.finale_video;var i=ns.templates[this.template];if(this.el=this.$el[0],i){var t=e||{};this.$el.html(i(t))}else console.warn("no template for this view:",this.template)},enter:function(e){this.$el.show(),e()},destroy:function(){this.remove()}});module.exports=Story;
},{"../../models/app-model":126,"../../views/score-meter":127,"shared/namespace":175,"shared/paths":176}],123:[function(require,module,exports){
require("shared/lib/three.js-master/examples/js/renderers/Projector"),require("shared/lib/three.js-master/examples/js/shaders/CopyShader"),require("shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader"),require("shared/shaders/FilmShader.js"),THREE.GlowShader=require("shared/shaders/GlowShader"),THREE.BarrelBlurShader=require("shared/shaders/BarrelBlurShader"),require("gsap"),module.exports=function(e){function r(){d=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4),d.position.z=500,t=new THREE.Scene,o=new THREE.WebGLRenderer({canvas:f,preserveDrawingBuffer:!0}),o.setSize(window.innerWidth,window.innerHeight),u=new THREE.Scene,l=new THREE.CSS3DRenderer,l.setSize(window.innerWidth,window.innerHeight),l.domElement.style.position="absolute",l.domElement.style.top=0,c.appendChild(l.domElement),window.addEventListener("resize",s,!1),s(),v(),n(),i()}function n(){h=new THREE.EffectComposer(o),w=new THREE.RenderPass(t,d),m=new THREE.ShaderPass(THREE.CopyShader),E={},E.glow=new THREE.ShaderPass(THREE.GlowShader),E.tiltshift=new THREE.ShaderPass(THREE.VerticalTiltShiftShader),E.barrelBlur=new THREE.ShaderPass(THREE.BarrelBlurShader),E.film=new THREE.ShaderPass(THREE.FilmShader),E.glow.uniforms.amount.value=.4,E.glow.uniforms.size.value=1,E.glow.uniforms.darkness.value=.1,E.tiltshift.uniforms.v.value=.001,E.tiltshift.uniforms.r.value=1,E.barrelBlur.uniforms.amount.value=.005,E.film.uniforms.sCount.value=1200,E.film.uniforms.sIntensity.value=.3,E.film.uniforms.nIntensity.value=.6,E.film.uniforms.grayscale.value=0,h=new THREE.EffectComposer(o),h.addPass(w),h.addPass(E.glow),h.addPass(E.tiltshift),h.addPass(E.barrelBlur),h.addPass(E.film),h.addPass(m),m.renderToScreen=!0}function s(){S.w=window.innerWidth,S.h=window.innerHeight,d.aspect=S.w/S.h,d.updateProjectionMatrix(),o.setSize(S.w,S.h),l.setSize(S.w,S.h)}function i(){T||(requestAnimationFrame(i),h.render(.1),H+=.1,E.barrelBlur.uniforms.time.value=H,l.render(u,d),p.trigger("webgl-update"))}function a(e){console.log("move camera"),TweenLite.to(d.position,e.time,{x:e.x,y:e.y,z:e.z,onUpdate:function(){d.position.needsUpdate=!0}})}var t,d,o,l,u,h,E,w,m,f=e.parent.find("canvas")[0],c=e.parent.find(".css")[0],p=_.extend({},Backbone.Events),S={},v=function(){var e=new THREE.PointLight(16777215,1,2e3);e.position.set(-100,170,350),t.add(e);var e=new THREE.PointLight(16777215,1,300);e.position.set(500,100,200),t.add(e);var e=new THREE.PointLight(7803153,1,1e4);e.position.set(-550,-150,200),t.add(e)},H=0,T=!1,R=function(){T=!0};return r(),{scene:t,sceneCSS:u,moveCamera:a,events:p,canvas:f,renderer:o,camera:d,css3dcanvas:c,passes:E,pause:R}};
},{"gsap":3,"shared/lib/three.js-master/examples/js/renderers/Projector":169,"shared/lib/three.js-master/examples/js/shaders/CopyShader":170,"shared/lib/three.js-master/examples/js/shaders/VerticalTiltShiftShader":172,"shared/shaders/BarrelBlurShader":177,"shared/shaders/FilmShader.js":180,"shared/shaders/GlowShader":182}],124:[function(require,module,exports){
var util=require("shared/utils/util"),ns=require("shared/namespace"),Clock=function(t){var n,e,a,i=t.$el,o=t.$wands,r=0,s=0,c=this,d=!1;_.extend(this,Backbone.Events),_.extend(this,{init:function(){i.html("00:00:00")},start:function(){console.log("Clock.start"),n=Date.now(),void 0!==t.countdown&&(n+=1e3*t.countdown),a=setInterval(function(){c.tick()},3e3),c.tickTock()},tickTock:function(){d||(window.requestAnimationFrame(c.tickTock),c.tick())},tick:function(){if(r=Date.now()-n+s,e=.001*r,void 0!==t.countdown&&e>0)return i.html("00:00:00"),c.trigger("countdownComplete"),void this.stop();var a=0>e?-1:1,o=1===a?Math.abs(Math.floor(e/60)):Math.abs(Math.ceil(e/60)),d=Math.abs(e%60),u=.1*Math.abs(r%1e3),l=[util.padInt(2,o),util.padInt(2,d),util.padInt(2,u)].join(":");-1!==a||t.stayPositive||(l="-"+l),i.html(l)},stop:function(){clearInterval(a),d=!0},warn:function(){i.removeClass("remove-warning-text").addClass("add-warning-text"),o.removeClass("remove-warning-div").addClass("add-warning-div"),setTimeout(function(){i.removeClass("add-warning-text").addClass("remove-warning-text"),o.removeClass("add-warning-div").addClass("remove-warning-div")},300)},addPenalty:function(t){c.setPenalty(s+t)},setPenalty:function(t){TweenMax.to({v:s},.9,{v:t,ease:Quart.easeOut,onUpdate:function(){s=_.round(this.target.v)}}),c.warn()},getPenalty:function(){return s},getTime:function(){return r},getTotalSeconds:function(){return e},getElement:function(){return i},getWands:function(){return o}}),this.tick=_.throttle(this.tick,1e3/24)};ns.Clock=Clock,module.exports=Clock;
},{"shared/namespace":175,"shared/utils/util":199}],125:[function(require,module,exports){
var gamebase=_.extend({load:function(e){console.warn("please implement the load method!",this),e()},enter:function(e){console.warn("please implement the enter method!",this),"function"==typeof e&&e()},exit:function(e){console.warn("please implement the exit method!",this),"function"==typeof e&&e()},destroy:function(){console.warn("please implement the destroy method!",this)}},Backbone.Events);module.exports=gamebase;
},{}],126:[function(require,module,exports){
var storage=require("shared/utils/storage"),ns=require("shared/namespace"),defaults={},appModel=new(Backbone.Model.extend({initialize:function(){this.set("muted",Boolean(storage.getItem("muted")))},events:{PRELOADER:{START:"preloader:start",STOP:"preloader:stop"},SECTION:{CHANGE:"section:change",ROUTE:"section:route"},HARD_ROUTE:"hard-route",FOOTER:{SHOW:"show",HIDE:"hide"},TR_ROTATE:"training-room:rotate",TR_FOCUS:"training-room:focus-tile"}}))(defaults);("dev"===window.env||null!==window.location.search.match("debug"))&&(window._appmodel=appModel),module.exports=appModel;
},{"shared/namespace":175,"shared/utils/storage":196}],127:[function(require,module,exports){
var orange=16698114,gray=5723991,ScoreMeter=function(e){function a(){var e=PIXI.CanvasRenderer;v=new e(n,n,{transparent:!0,resolution:window.devicePixelRatio||1,antialias:!0}),v.view.style.width=1*v.width/v.resolution+"px",v.view.style.height=1*v.height/v.resolution+"px",s.append(v.view),i.append(s),u=new PIXI.Container,u.addChild(x);for(var a=23;a>=0;a--){var o=I;a%5===0&&(o=P);var r=2*Math.PI*a/24-Math.PI/2,c=new PieDot(o,r,f,y);u.addChild(c.graphics),w.push(c)}for(var l=31;l>=0;l--){var h=2*Math.PI*Math.round(24*Math.random())/24-Math.PI/2,d=2*Math.PI*Math.round(24*Math.random())/24-Math.PI/2,p=new PieLine(h,d,y,f);u.addChild(p.graphics),M.push(p)}t()}function t(){g||(window.requestAnimationFrame(t),v.render(u))}var n=e.size||150,i=e.$parent,o=e.displayType||"percent",r=e.value,c=e.max,l=e.label,s=$('<div class="score-meter">'),h=$('<div class="text"></div>'),d=$('<div class="value">0</div>'),p=$('<div class="label">'+l+"</div>");"percent"===o&&d.addClass("percent"),h.append(d),h.append(p),s.append(h);var u,v,g=!1,P=3,I=2,w=[],M=[],f=.5*n-P-1,y=.5*n,x=new PIXI.Graphics;_.extend(this,{show:function(e){e=void 0!==e?e:4,t();var a={value:0};TweenLite.to(a,e,{value:1,ease:Power3.easeInOut,onUpdate:function(){var e=a.value*Math.PI*2*r/c-Math.PI/2;x.clear(),x.lineStyle(1.5,orange,.4),x.arc(.5*n,.5*n,f,-Math.PI/2,e);try{x.currentPath.shape.closed=!1}catch(t){console.log("bugggg")}x.lineStyle(1.5,orange,0),x.arc(.5*n,.5*n,f,e,-Math.PI/2,!0),d.html(Math.round(a.value*r)),w.forEach(function(a){a.angle<e?a.setColor(orange):a.setColor(5723991)}),M.forEach(function(a){a.angle1<e&&a.angle2<e?a.setOpacity(.1):a.setOpacity(0)})}})},hide:function(){g=!0}}),a()},PieDot=function(e,a,t,n){function i(){o.clear(),o.beginFill(r.color,.8),o.drawCircle(r.x,r.y,r.size),o.endFill()}var o=new PIXI.Graphics,r=this;_.extend(this,{color:gray,size:e,angle:a,x:Math.cos(a)*t+n,y:Math.sin(a)*t+n,setColor:function(e){this.color!==e&&(this.color=e,this.update())},graphics:o,update:i}),i()},PieLine=function(e,a,t,n){var i=new PIXI.Graphics,o=this,r=function(e){return new PIXI.Point(Math.cos(e)*n+t,Math.sin(e)*n+t)},c=function(){i.clear(),i.lineStyle(1.5,orange,o.opacity);var t=r(e),n=r(a);i.moveTo(t.x,t.y),i.lineTo(n.x,n.y)};_.extend(this,{angle1:e,angle2:a,graphics:i,update:c,opacity:0,setOpacity:function(e){TweenLite.to(this,.3,{opacity:e,onUpdate:function(){c()}})}}),c()};module.exports=ScoreMeter;
},{}],128:[function(require,module,exports){
module.exports="\nvoid main()\n{\n	vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n	gl_Position = projectionMatrix * mvPosition;\n}\n";
},{}],129:[function(require,module,exports){
module.exports="uniform vec3 color;\nuniform sampler2D map;\nuniform float invopacity;\nuniform float time;\n\nvarying vec2 vUv;\n\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n	return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n{\n	const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n					  0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n					 -0.577350269189626,  // -1.0 + 2.0 * C.x\n					  0.024390243902439); // 1.0 / 41.0\n	// First corner\n	vec2 i  = floor(v + dot(v, C.yy) );\n	vec2 x0 = v -   i + dot(i, C.xx);\n\n	// Other corners\n	vec2 i1;\n	//i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n	//i1.y = 1.0 - i1.x;\n	i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n	// x0 = x0 - 0.0 + 0.0 * C.xx ;\n	// x1 = x0 - i1 + 1.0 * C.xx ;\n	// x2 = x0 - 1.0 + 2.0 * C.xx ;\n	vec4 x12 = x0.xyxy + C.xxzz;\n	x12.xy -= i1;\n\n	// Permutations\n	i = mod289(i); // Avoid truncation effects in permutation\n	vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n		+ i.x + vec3(0.0, i1.x, 1.0 ));\n\n	vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n	m = m*m ;\n	m = m*m ;\n\n	// Gradients: 41 points uniformly over a line, mapped onto a diamond.\n	// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n	vec3 x = 2.0 * fract(p * C.www) - 1.0;\n	vec3 h = abs(x) - 0.5;\n	vec3 ox = floor(x + 0.5);\n	vec3 a0 = x - ox;\n\n	// Normalise gradients implicitly by scaling m\n	// Approximation of: m *= inversesqrt( a0*a0 + h*h );\n	m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n	// Compute final noise value at P\n	vec3 g;\n	g.x  = a0.x  * x0.x  + h.x  * x0.y;\n	g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n	return 130.0 * dot(m, g);\n}\n\nfloat rand(vec2 co){\n	return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n	vec4 mapColor = texture2D(map, vUv);\n	float n = snoise(-vUv.xy + time) - rand(vUv + time);\n	float o = clamp( (n * n), 0.4, 0.8 ) - invopacity;\n	float oc = clamp(o, 0.0, 0.75);\n	gl_FragColor = mapColor * vec4(color, oc);\n}\n";
},{}],130:[function(require,module,exports){
module.exports="uniform vec3 color;\nuniform float opacity;\n\nvoid main()\n{\n	gl_FragColor = vec4( color, opacity);\n}\n";
},{}],131:[function(require,module,exports){
module.exports="varying vec2 vUv;\n\nvoid main()\n{\n	vUv = uv;\n	vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n	gl_Position = projectionMatrix * mvPosition;\n}\n";
},{}],132:[function(require,module,exports){
module.exports='//\n// GLSL textureless classic 3D noise "cnoise",\n// with an RSL-style periodic variant "pnoise".\n// Author:  Stefan Gustavson (stefan.gustavson@liu.se)\n// Version: 2011-10-11\n//\n// Many thanks to Ian McEwan of Ashima Arts for the\n// ideas for permutation and gradient selection.\n//\n// Copyright (c) 2011 Stefan Gustavson. All rights reserved.\n// Distributed under the MIT license. See LICENSE file.\n// https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x)\n{\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x)\n{\n	return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x)\n{\n	return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n	return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nvec3 fade(vec3 t) {\n	return t*t*t*(t*(t*6.0-15.0)+10.0);\n}\n\n// Classic Perlin noise\nfloat cnoise(vec3 P)\n{\n	vec3 Pi0 = floor(P); // Integer part for indexing\n	vec3 Pi1 = Pi0 + vec3(1.0); // Integer part + 1\n	Pi0 = mod289(Pi0);\n	Pi1 = mod289(Pi1);\n	vec3 Pf0 = fract(P); // Fractional part for interpolation\n	vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n	vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n	vec4 iy = vec4(Pi0.yy, Pi1.yy);\n	vec4 iz0 = Pi0.zzzz;\n	vec4 iz1 = Pi1.zzzz;\n\n	vec4 ixy = permute(permute(ix) + iy);\n	vec4 ixy0 = permute(ixy + iz0);\n	vec4 ixy1 = permute(ixy + iz1);\n\n	vec4 gx0 = ixy0 * (1.0 / 7.0);\n	vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n	gx0 = fract(gx0);\n	vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n	vec4 sz0 = step(gz0, vec4(0.0));\n	gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n	gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n	vec4 gx1 = ixy1 * (1.0 / 7.0);\n	vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n	gx1 = fract(gx1);\n	vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n	vec4 sz1 = step(gz1, vec4(0.0));\n	gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n	gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n	vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n	vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n	vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n	vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n	vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n	vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n	vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n	vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n	vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n	g000 *= norm0.x;\n	g010 *= norm0.y;\n	g100 *= norm0.z;\n	g110 *= norm0.w;\n	vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n	g001 *= norm1.x;\n	g011 *= norm1.y;\n	g101 *= norm1.z;\n	g111 *= norm1.w;\n\n	float n000 = dot(g000, Pf0);\n	float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n	float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n	float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n	float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n	float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n	float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n	float n111 = dot(g111, Pf1);\n\n	vec3 fade_xyz = fade(Pf0);\n	vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n	vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n	float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n	return 2.2 * n_xyz;\n}\n\n// Classic Perlin noise, periodic variant\nfloat pnoise(vec3 P, vec3 rep)\n{\n	vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period\n	vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period\n	Pi0 = mod289(Pi0);\n	Pi1 = mod289(Pi1);\n	vec3 Pf0 = fract(P); // Fractional part for interpolation\n	vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0\n	vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n	vec4 iy = vec4(Pi0.yy, Pi1.yy);\n	vec4 iz0 = Pi0.zzzz;\n	vec4 iz1 = Pi1.zzzz;\n\n	vec4 ixy = permute(permute(ix) + iy);\n	vec4 ixy0 = permute(ixy + iz0);\n	vec4 ixy1 = permute(ixy + iz1);\n\n	vec4 gx0 = ixy0 * (1.0 / 7.0);\n	vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\n	gx0 = fract(gx0);\n	vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n	vec4 sz0 = step(gz0, vec4(0.0));\n	gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n	gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\n	vec4 gx1 = ixy1 * (1.0 / 7.0);\n	vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\n	gx1 = fract(gx1);\n	vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n	vec4 sz1 = step(gz1, vec4(0.0));\n	gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n	gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\n	vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n	vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n	vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n	vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n	vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n	vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n	vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n	vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\n	vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n	g000 *= norm0.x;\n	g010 *= norm0.y;\n	g100 *= norm0.z;\n	g110 *= norm0.w;\n	vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n	g001 *= norm1.x;\n	g011 *= norm1.y;\n	g101 *= norm1.z;\n	g111 *= norm1.w;\n\n	float n000 = dot(g000, Pf0);\n	float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n	float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n	float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n	float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n	float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n	float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n	float n111 = dot(g111, Pf1);\n\n	vec3 fade_xyz = fade(Pf0);\n	vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n	vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n	float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\n	return 2.2 * n_xyz;\n}\n';
},{}],133:[function(require,module,exports){
var noise=require("./ashima-classic-noise-3d.glsl"),vert=require("./explosion.vert"),frag=require("./explosion.frag"),paths=require("shared/paths");THREE.ImageUtils.crossOrigin="";var explosionTexture=THREE.ImageUtils.loadTexture(paths.IMGS+"clear-path/explosion2.png");explosionTexture.minFilter=THREE.NearestFilter;var ExplosionShader=function(){return{uniforms:{opacity:{type:"f",value:1},tExplosion:{type:"t",value:explosionTexture},time:{type:"f",value:0}},transparent:!0,vertexShader:noise+vert,fragmentShader:frag}};module.exports=ExplosionShader;
},{"./ashima-classic-noise-3d.glsl":132,"./explosion.frag":134,"./explosion.vert":135,"shared/paths":176}],134:[function(require,module,exports){
module.exports="varying float noise;\nuniform sampler2D tExplosion;\nuniform float opacity;\n\nfloat random( vec3 scale, float seed ){\n    return fract( sin( dot( gl_FragCoord.xyz + seed, scale ) ) * 43758.5453 + seed ) ;\n}\n\nvoid main() {\n\n    // get a random offset\n    float r = .01 * random( vec3( 12.9898, 78.233, 151.7182 ), 0.0 );\n    // lookup vertically in the texture, using noise and offset\n    // to get the right RGB colour\n    vec2 tPos = vec2( 0, noise + r );\n    vec4 color = texture2D( tExplosion, tPos );// * vec4(opacity);\n    // color.a *= opacity;\n\n    gl_FragColor = vec4( color.rgb, opacity );\n    // gl_FragColor.a = opacity;\n\n}\n";
},{}],135:[function(require,module,exports){
module.exports="varying float noise;\nuniform float time;\n\nfloat turbulence( vec3 p ) {\n    float w = 100.0;\n    float t = -.5;\n    for (float f = 1.0 ; f <= 10.0 ; f++ ){\n        float power = pow( 2.0, f );\n        t += abs( pnoise( vec3( power * p ), vec3( 10.0, 10.0, 10.0 ) ) / power );\n    }\n    return t;\n}\n\nvoid main() {\n\n    // add time to the noise parameters so it's animated\n    noise = 15.0 *  -.10 * turbulence( .5 * normal + time );\n    float b = -5.0 * pnoise( 0.05 * position + vec3( 2.0 * time ), vec3( 100.0 ) );\n    float displacement = - noise + b;\n\n    vec3 newPosition = position + normal * displacement;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n\n}\n";
},{}],136:[function(require,module,exports){
module.exports="#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform vec3 color;\nuniform float opacity;\n\n// varying float vScalarAlt;\n\nvoid main()\n{\n	gl_FragColor = vec4(color, opacity);\n	// gl_FragColor = vec4(color, opacity * vScalarAlt);\n}\n";
},{}],137:[function(require,module,exports){
module.exports="#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform float scalar1;\nuniform float scalar2;\nuniform float scalar3;\nuniform float scalar4;\nuniform float scalar5;\n\n// uniform float scalarAlt1;\n// uniform float scalarAlt2;\n// uniform float scalarAlt3;\n// uniform float scalarAlt4;\n// uniform float scalarAlt5;\n\nuniform float time;\n\nattribute float scalarIndex;\n// attribute float scalarAltIndex;\nattribute vec3 position2;\n\n// varying float vScalarAlt;\n\nvoid main()\n{\n	float scalar = 0.0;\n	if(scalarIndex < 0.5){\n		scalar = scalar1;\n	}else if(scalarIndex < 1.5){\n		scalar = scalar2;\n	}else if(scalarIndex < 2.5){\n		scalar = scalar3;\n	}else if(scalarIndex < 3.5){\n		scalar = scalar4;\n	}else{\n		scalar = scalar5;\n	}\n\n	// float scalarAlt = 0.0;\n	// if(scalarAltIndex < 0.5){\n	// 	scalarAlt = scalarAlt1;\n	// }else if(scalarAltIndex < 1.5){\n	// 	scalarAlt = scalarAlt2;\n	// }else if(scalarAltIndex < 2.5){\n	// 	scalarAlt = scalarAlt3;\n	// }else if(scalarAltIndex < 3.5){\n	// 	scalarAlt = scalarAlt4;\n	// }else{\n	// 	scalarAlt = scalarAlt5;\n	// }\n\n	// vScalarAlt = scalarAlt;\n\n	vec3 pos = mix(position, position2, scalar);\n\n	vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\n	gl_Position = projectionMatrix * mvPosition;\n}\n";
},{}],138:[function(require,module,exports){
module.exports="#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform vec3 color;\nuniform float opacity;\nuniform float amputated;\n\nvarying float vScalarAlt;\nvarying vec3 vPosition;\n\nvoid main()\n{\n	gl_FragColor = vec4(color, opacity * vScalarAlt);\n\n	if(amputated > 0.0 && vPosition.x >= -28.0 && vPosition.x <= -5.0 && vPosition.y >= -158.0 && vPosition.y <= -67.0)\n	{\n		discard;\n	}\n}\n";
},{}],139:[function(require,module,exports){
module.exports="#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform float scalar1;\nuniform float scalar2;\nuniform float scalar3;\nuniform float scalar4;\nuniform float scalar5;\n\nuniform float scalarAlt1;\nuniform float scalarAlt2;\nuniform float scalarAlt3;\nuniform float scalarAlt4;\nuniform float scalarAlt5;\n\nuniform float time;\n\nattribute float scalarIndex;\nattribute float scalarAltIndex;\nattribute vec3 offset;\n\nvarying float vScalarAlt;\nvarying vec3 vPosition;\n\n// //\n// // Description : Array and textureless GLSL 2D simplex noise function.\n// //      Author : Ian McEwan, Ashima Arts.\n// //  Maintainer : ijm\n// //     Lastmod : 20110822 (ijm)\n// //     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n// //               Distributed under the MIT License. See LICENSE file.\n// //               https://github.com/ashima/webgl-noise\n// //\n\n// vec3 mod289(vec3 x) {\n//     return x - floor(x * (1.0 / 289.0)) * 289.0;\n// }\n\n// vec2 mod289(vec2 x) {\n//     return x - floor(x * (1.0 / 289.0)) * 289.0;\n// }\n\n// vec3 permute(vec3 x) {\n//     return mod289(((x*34.0)+1.0)*x);\n// }\n\n// float snoise(vec2 v)\n// {\n//     const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n//                       0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n//                      -0.577350269189626,  // -1.0 + 2.0 * C.x\n//                       0.024390243902439); // 1.0 / 41.0\n//     // First corner\n//     vec2 i  = floor(v + dot(v, C.yy) );\n//     vec2 x0 = v -   i + dot(i, C.xx);\n\n//     // Other corners\n//     vec2 i1;\n//     //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n//     //i1.y = 1.0 - i1.x;\n//     i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n//     // x0 = x0 - 0.0 + 0.0 * C.xx ;\n//     // x1 = x0 - i1 + 1.0 * C.xx ;\n//     // x2 = x0 - 1.0 + 2.0 * C.xx ;\n//     vec4 x12 = x0.xyxy + C.xxzz;\n//     x12.xy -= i1;\n\n//     // Permutations\n//     i = mod289(i); // Avoid truncation effects in permutation\n//     vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n//         + i.x + vec3(0.0, i1.x, 1.0 ));\n\n//     vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n//     m = m*m ;\n//     m = m*m ;\n\n//     // Gradients: 41 points uniformly over a line, mapped onto a diamond.\n//     // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n//     vec3 x = 2.0 * fract(p * C.www) - 1.0;\n//     vec3 h = abs(x) - 0.5;\n//     vec3 ox = floor(x + 0.5);\n//     vec3 a0 = x - ox;\n\n//     // Normalise gradients implicitly by scaling m\n//     // Approximation of: m *= inversesqrt( a0*a0 + h*h );\n//     m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n//     // Compute final noise value at P\n//     vec3 g;\n//     g.x  = a0.x  * x0.x  + h.x  * x0.y;\n//     g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n//     return 130.0 * dot(m, g);\n// }\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n{\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n    // First corner\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n    // Other corners\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n\n    //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n    //   x1 = x0 - i1  + 1.0 * C.xxx;\n    //   x2 = x0 - i2  + 2.0 * C.xxx;\n    //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n\n    //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n    //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n\n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nvoid main()\n{\n	vPosition = position;\n\n	float scalar = 0.0;\n	if(scalarIndex < 0.5){\n		scalar = scalar1;\n	}else if(scalarIndex < 1.5){\n		scalar = scalar2;\n	}else if(scalarIndex < 2.5){\n		scalar = scalar3;\n	}else if(scalarIndex < 3.5){\n		scalar = scalar4;\n	}else{\n		scalar = scalar5;\n	}\n\n	float scalarAlt = 0.0;\n	if(scalarAltIndex < 0.5){\n		scalarAlt = scalarAlt1;\n	}else if(scalarAltIndex < 1.5){\n		scalarAlt = scalarAlt2;\n	}else if(scalarAltIndex < 2.5){\n		scalarAlt = scalarAlt3;\n	}else if(scalarAltIndex < 3.5){\n		scalarAlt = scalarAlt4;\n	}else{\n		scalarAlt = scalarAlt5;\n	}\n\n	vScalarAlt = scalarAlt;\n\n	vec3 pos = mix(position, position + offset + snoise(position + time) * scalar, scalar);\n\n	vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\n	gl_Position = projectionMatrix * mvPosition;\n}\n";
},{}],140:[function(require,module,exports){
module.exports="uniform vec3 color;\nuniform float opacity;\nuniform sampler2D map;\nuniform float amputated;\n\nvarying vec3 vPosition;\n\nvoid main()\n{\n	vec4 mapColor = texture2D(map, gl_PointCoord);\n	gl_FragColor = mapColor * vec4(color, opacity);\n\n	if(amputated > 0.0 && vPosition.x >= -28.0 && vPosition.x <= -5.0 && vPosition.y >= -158.0 && vPosition.y <= -67.0)\n	{\n		discard;\n	}\n}\n";
},{}],141:[function(require,module,exports){
module.exports="uniform float size;\nuniform float scalar1;\nuniform float scalar2;\nuniform float scalar3;\nuniform float scalar4;\nuniform float scalar5;\nuniform float time;\n\nattribute float index;\nattribute vec3 offset;\n\nvarying vec3 vPosition;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n{\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n    // First corner\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n    // Other corners\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n\n    //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n    //   x1 = x0 - i1  + 1.0 * C.xxx;\n    //   x2 = x0 - i2  + 2.0 * C.xxx;\n    //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n\n    //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n    //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n\n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nvoid main()\n{\n	vPosition = position;\n\n	float scalar = 0.0;\n\n	if(index < 0.5)\n	{\n		scalar = scalar1;\n	}\n	else if(index < 1.5)\n	{\n		scalar = scalar2;\n	}\n	else if(index < 2.5)\n	{\n		scalar = scalar3;\n	}\n	else if(index < 3.5)\n	{\n		scalar = scalar4;\n	}\n	else\n	{\n		scalar = scalar5;\n	}\n\n	vec3 pos = mix(position, position + offset + snoise(position + time) * scalar, scalar);\n\n	vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\n	float scale = 1000.0;\n	gl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n	gl_Position = projectionMatrix * mvPosition;\n}\n";
},{}],142:[function(require,module,exports){
module.exports="uniform vec3 color;\nuniform float opacity;\nuniform sampler2D map;\n\n// varying vec3 vPos;\n\nvoid main()\n{\n	vec4 mapColor = texture2D(map, gl_PointCoord);\n	// float opac = opacity;// - distance(vPos, vec3(0.0)) * 0.00005;\n	// float opac = opacity - abs(vPos.z) / 1000.0;\n	float opac = opacity;\n	gl_FragColor = mapColor * vec4(color, opac);\n}\n";
},{}],143:[function(require,module,exports){
module.exports="uniform float size;\nuniform float time;\n\n// varying vec3 vPos;\n\n\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n{\n    const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n    // First corner\n    vec2 i  = floor(v + dot(v, C.yy) );\n    vec2 x0 = v -   i + dot(i, C.xx);\n\n    // Other corners\n    vec2 i1;\n    //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n    //i1.y = 1.0 - i1.x;\n    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n    // x0 = x0 - 0.0 + 0.0 * C.xx ;\n    // x1 = x0 - i1 + 1.0 * C.xx ;\n    // x2 = x0 - 1.0 + 2.0 * C.xx ;\n    vec4 x12 = x0.xyxy + C.xxzz;\n    x12.xy -= i1;\n\n    // Permutations\n    i = mod289(i); // Avoid truncation effects in permutation\n    vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n        + i.x + vec3(0.0, i1.x, 1.0 ));\n\n    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n    m = m*m ;\n    m = m*m ;\n\n    // Gradients: 41 points uniformly over a line, mapped onto a diamond.\n    // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n    vec3 x = 2.0 * fract(p * C.www) - 1.0;\n    vec3 h = abs(x) - 0.5;\n    vec3 ox = floor(x + 0.5);\n    vec3 a0 = x - ox;\n\n    // Normalise gradients implicitly by scaling m\n    // Approximation of: m *= inversesqrt( a0*a0 + h*h );\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n    // Compute final noise value at P\n    vec3 g;\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\n    g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n    return 130.0 * dot(m, g);\n}\n\nvoid main()\n{\n	vec3 pos = position;\n\n	// pos *= 1.0 + snoise(position + time);// * 5000.0;\n\n	pos.x *= 1.0 + snoise(position.xx + time);\n	pos.y *= 1.0 + snoise(position.yy + time) * 3.0;\n	pos.z *= 1.0 + snoise(position.zz + time);\n\n	// vPos = pos;\n\n	vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\n	float scale = 1000.0;\n	// gl_PointSize = size;\n	gl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n	gl_Position = projectionMatrix * mvPosition;\n}\n";
},{}],144:[function(require,module,exports){
module.exports="// #extension GL_OES_standard_derivatives : enable\n\nuniform vec3 color;\n\n#ifndef USE_NORMALMAP\n    varying vec2 vUv;\n#endif\n\n#define PHONG\n#define ENVMAP_TYPE_CUBE\n#define ENVMAP_BLENDING_MULTIPLY\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n    return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n    return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n    float distance = dot( planeNormal, point-pointOnPlane );\n    return point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n    return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n    return pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n    if ( decayExponent > 0.0 ) {\n      return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n    }\n    return 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n    return pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n    return a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n    return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n    return a;\n#endif\n}\n\n#ifdef USE_COLOR\n\n    varying vec3 vColor;\n\n#endif\n\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n    varying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n    uniform sampler2D map;\n\n#endif\n#ifdef USE_ALPHAMAP\n\n    uniform sampler2D alphaMap;\n\n#endif\n\n#ifdef USE_LIGHTMAP\n\n    varying vec2 vUv2;\n    uniform sampler2D lightMap;\n\n#endif\n#ifdef USE_ENVMAP\n\n    uniform float reflectivity;\n    #ifdef ENVMAP_TYPE_CUBE\n        uniform samplerCube envMap;\n    #else\n        uniform sampler2D envMap;\n    #endif\n    uniform float flipEnvMap;\n\n    #if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n        uniform float refractionRatio;\n\n    #else\n\n        varying vec3 vReflect;\n\n    #endif\n\n#endif\n\n#ifdef USE_FOG\n\n    uniform vec3 fogColor;\n\n    #ifdef FOG_EXP2\n\n        uniform float fogDensity;\n\n    #else\n\n        uniform float fogNear;\n        uniform float fogFar;\n    #endif\n\n#endif\nuniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n    uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n    uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n    uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n    uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n    uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n    uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n    uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n    uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n    uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n    uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n    uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n    uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n    uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n    uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n    uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n    uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n    varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n    uniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n    varying vec3 vNormal;\n\n#endif\n\n#ifdef USE_SHADOWMAP\n\n    uniform sampler2D shadowMap[ MAX_SHADOWS ];\n    uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n    uniform float shadowDarkness[ MAX_SHADOWS ];\n    uniform float shadowBias[ MAX_SHADOWS ];\n\n    varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n    float unpackDepth( const in vec4 rgba_depth ) {\n\n        const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n        float depth = dot( rgba_depth, bit_shift );\n        return depth;\n\n    }\n\n#endif\n#ifdef USE_BUMPMAP\n\n    uniform sampler2D bumpMap;\n    uniform float bumpScale;\n\n    // Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n    // http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n    // Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n    vec2 dHdxy_fwd() {\n\n        vec2 dSTdx = dFdx( vUv );\n        vec2 dSTdy = dFdy( vUv );\n\n        float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n        float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n        float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n        return vec2( dBx, dBy );\n\n    }\n\n    vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n        vec3 vSigmaX = dFdx( surf_pos );\n        vec3 vSigmaY = dFdy( surf_pos );\n        vec3 vN = surf_norm;        // normalized\n\n        vec3 R1 = cross( vSigmaY, vN );\n        vec3 R2 = cross( vN, vSigmaX );\n\n        float fDet = dot( vSigmaX, R1 );\n\n        vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n        return normalize( abs( fDet ) * surf_norm - vGrad );\n\n    }\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n    uniform sampler2D normalMap;\n    uniform vec2 normalScale;\n\n    // Per-Pixel Tangent Space Normal Mapping\n    // http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n    vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n        vec3 q0 = dFdx( eye_pos.xyz );\n        vec3 q1 = dFdy( eye_pos.xyz );\n        vec2 st0 = dFdx( vUv.st );\n        vec2 st1 = dFdy( vUv.st );\n\n        vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n        vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n        vec3 N = normalize( surf_norm );\n\n        vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n        mapN.xy = normalScale * mapN.xy;\n        mat3 tsn = mat3( S, T, N );\n        return normalize( tsn * mapN );\n\n    }\n\n#endif\n\n#ifdef USE_SPECULARMAP\n\n    uniform sampler2D specularMap;\n\n#endif\n#ifdef USE_LOGDEPTHBUF\n\n    uniform float logDepthBufFC;\n\n    #ifdef USE_LOGDEPTHBUF_EXT\n\n        #extension GL_EXT_frag_depth : enable\n        varying float vFragDepth;\n\n    #endif\n\n#endif\n\n\nvoid main()\n{\n    vec3 outgoingLight = vec3( 0.0 ); // outgoing light does not have an alpha, the surface does\n    vec4 diffuseColor = vec4( diffuse, opacity );\n\n    #if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n    gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif\n#ifdef USE_MAP\n\n    vec4 texelColor = texture2D( map, vUv );\n\n    texelColor.xyz = inputToLinear( texelColor.xyz );\n\n    diffuseColor *= texelColor;\n\n#endif\n#ifdef USE_COLOR\n\n    diffuseColor.rgb *= vColor;\n\n#endif\n#ifdef USE_ALPHAMAP\n\n    diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n\n#ifdef ALPHATEST\n\n    if ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n    vec4 texelSpecular = texture2D( specularMap, vUv );\n    specularStrength = texelSpecular.r;\n\n#else\n\n    specularStrength = 1.0;\n\n#endif\n#ifndef FLAT_SHADED\n\n    vec3 normal = normalize( vNormal );\n\n    #ifdef DOUBLE_SIDED\n\n        normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n    #endif\n\n#else\n\n    vec3 fdx = dFdx( vViewPosition );\n    vec3 fdy = dFdy( vViewPosition );\n    vec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n    normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n    normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n    for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n        vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n        float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n        lVector = normalize( lVector );\n\n        // diffuse\n\n        float dotProduct = dot( normal, lVector );\n\n        #ifdef WRAP_AROUND\n\n            float pointDiffuseWeightFull = max( dotProduct, 0.0 );\n            float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n            vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n        #else\n\n            float pointDiffuseWeight = max( dotProduct, 0.0 );\n\n        #endif\n\n        totalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n                // specular\n\n        vec3 pointHalfVector = normalize( lVector + viewPosition );\n        float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n        float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n        float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n        vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n        totalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n    }\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n    for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n        vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n        float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n        lVector = normalize( lVector );\n\n        float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n        if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n            spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n            // diffuse\n\n            float dotProduct = dot( normal, lVector );\n\n            #ifdef WRAP_AROUND\n\n                float spotDiffuseWeightFull = max( dotProduct, 0.0 );\n                float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n                vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n            #else\n\n                float spotDiffuseWeight = max( dotProduct, 0.0 );\n\n            #endif\n\n            totalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n            // specular\n\n            vec3 spotHalfVector = normalize( lVector + viewPosition );\n            float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n            float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n            float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n            vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n            totalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n        }\n\n    }\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n    for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n        vec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n        // diffuse\n\n        float dotProduct = dot( normal, dirVector );\n\n        #ifdef WRAP_AROUND\n\n            float dirDiffuseWeightFull = max( dotProduct, 0.0 );\n            float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n            vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n        #else\n\n            float dirDiffuseWeight = max( dotProduct, 0.0 );\n\n        #endif\n\n        totalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n        // specular\n\n        vec3 dirHalfVector = normalize( dirVector + viewPosition );\n        float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n        float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n        /*\n        // fresnel term from skin shader\n        const float F0 = 0.128;\n\n        float base = 1.0 - dot( viewPosition, dirHalfVector );\n        float exponential = pow( base, 5.0 );\n\n        float fresnel = exponential + F0 * ( 1.0 - exponential );\n        */\n\n        /*\n        // fresnel term from fresnel shader\n        const float mFresnelBias = 0.08;\n        const float mFresnelScale = 0.3;\n        const float mFresnelPower = 5.0;\n\n        float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n        */\n\n        float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n        //      dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n        vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n        totalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n    }\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n    for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n        vec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n        // diffuse\n\n        float dotProduct = dot( normal, lVector );\n        float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n        vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n        totalDiffuseLight += hemiColor;\n\n        // specular (sky light)\n\n        vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n        float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n        float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n        // specular (ground light)\n\n        vec3 lVectorGround = -lVector;\n\n        vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n        float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n        float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n        float dotProductGround = dot( normal, lVectorGround );\n\n        float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n        vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n        vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n        totalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n    }\n\n#endif\n\n#ifdef METAL\n\n    outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n    outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n\n#ifdef USE_LIGHTMAP\n\n    outgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif\n#ifdef USE_ENVMAP\n\n    #if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n        vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n        // Transforming Normal Vectors with the Inverse Transformation\n        vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n        #ifdef ENVMAP_MODE_REFLECTION\n\n            vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n        #else\n\n            vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n        #endif\n\n    #else\n\n        vec3 reflectVec = vReflect;\n\n    #endif\n\n    #ifdef DOUBLE_SIDED\n        float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n    #else\n        float flipNormal = 1.0;\n    #endif\n\n    #ifdef ENVMAP_TYPE_CUBE\n        vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n    #elif defined( ENVMAP_TYPE_EQUIREC )\n        vec2 sampleUV;\n        sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n        sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n        vec4 envColor = texture2D( envMap, sampleUV );\n\n    #elif defined( ENVMAP_TYPE_SPHERE )\n        vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n        vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n    #endif\n\n    envColor.xyz = inputToLinear( envColor.xyz );\n\n    #ifdef ENVMAP_BLENDING_MULTIPLY\n\n        outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n    #elif defined( ENVMAP_BLENDING_MIX )\n\n        outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n    #elif defined( ENVMAP_BLENDING_ADD )\n\n        outgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n    #endif\n\n#endif\n\n#ifdef USE_SHADOWMAP\n\n    #ifdef SHADOWMAP_DEBUG\n\n        vec3 frustumColors[3];\n        frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n        frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n        frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n    #endif\n\n    #ifdef SHADOWMAP_CASCADE\n\n        int inFrustumCount = 0;\n\n    #endif\n\n    float fDepth;\n    vec3 shadowColor = vec3( 1.0 );\n\n    for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n        vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n                // if ( something && something ) breaks ATI OpenGL shader compiler\n                // if ( all( something, something ) ) using this instead\n\n        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n        bool inFrustum = all( inFrustumVec );\n\n                // don't shadow pixels outside of light frustum\n                // use just first frustum (for cascades)\n                // don't shadow pixels behind far plane of light frustum\n\n        #ifdef SHADOWMAP_CASCADE\n\n            inFrustumCount += int( inFrustum );\n            bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n        #else\n\n            bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n        #endif\n\n        bool frustumTest = all( frustumTestVec );\n\n        if ( frustumTest ) {\n\n            shadowCoord.z += shadowBias[ i ];\n\n            #if defined( SHADOWMAP_TYPE_PCF )\n\n                        // Percentage-close filtering\n                        // (9 pixel kernel)\n                        // http://fabiensanglard.net/shadowmappingPCF/\n\n                float shadow = 0.0;\n\n        /*\n                        // nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n                        // must enroll loop manually\n\n                for ( float y = -1.25; y <= 1.25; y += 1.25 )\n                    for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n                        vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n                                // doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n                                //vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n                        float fDepth = unpackDepth( rgbaDepth );\n\n                        if ( fDepth < shadowCoord.z )\n                            shadow += 1.0;\n\n                }\n\n                shadow /= 9.0;\n\n        */\n\n                const float shadowDelta = 1.0 / 9.0;\n\n                float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n                float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n                float dx0 = -1.25 * xPixelOffset;\n                float dy0 = -1.25 * yPixelOffset;\n                float dx1 = 1.25 * xPixelOffset;\n                float dy1 = 1.25 * yPixelOffset;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n            #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n                        // Percentage-close filtering\n                        // (9 pixel kernel)\n                        // http://fabiensanglard.net/shadowmappingPCF/\n\n                float shadow = 0.0;\n\n                float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n                float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n                float dx0 = -1.0 * xPixelOffset;\n                float dy0 = -1.0 * yPixelOffset;\n                float dx1 = 1.0 * xPixelOffset;\n                float dy1 = 1.0 * yPixelOffset;\n\n                mat3 shadowKernel;\n                mat3 depthKernel;\n\n                depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n                depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n                depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n                depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n                depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n                depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n                depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n                depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n                depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n                vec3 shadowZ = vec3( shadowCoord.z );\n                shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n                shadowKernel[0] *= vec3(0.25);\n\n                shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n                shadowKernel[1] *= vec3(0.25);\n\n                shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n                shadowKernel[2] *= vec3(0.25);\n\n                vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n                shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n                shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n                vec4 shadowValues;\n                shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n                shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n                shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n                shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n                shadow = dot( shadowValues, vec4( 1.0 ) );\n\n                shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n            #else\n\n                vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n                float fDepth = unpackDepth( rgbaDepth );\n\n                if ( fDepth < shadowCoord.z )\n\n        // spot with multiple shadows is darker\n\n                    shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n        // spot with multiple shadows has the same color as single shadow spot\n\n        //                  shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n            #endif\n\n        }\n\n\n        #ifdef SHADOWMAP_DEBUG\n\n            #ifdef SHADOWMAP_CASCADE\n\n                if ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n            #else\n\n                if ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n            #endif\n\n        #endif\n\n    }\n\n    // NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n    shadowColor = inputToLinear( shadowColor );\n\n    outgoingLight = outgoingLight * shadowColor;\n\n#endif\n\n\n    outgoingLight = linearToOutput( outgoingLight );\n\n#ifdef USE_FOG\n\n    #ifdef USE_LOGDEPTHBUF_EXT\n\n        float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n    #else\n\n        float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n    #endif\n\n    #ifdef FOG_EXP2\n\n        float fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n        fogFactor = whiteCompliment( fogFactor );\n\n    #else\n\n        float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n    #endif\n\n    outgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif\n\n	vec2 warningHack = vUv; // just to shut up the console warning\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a ) * vec4(color, 1.0);\n\n}\n";
},{}],145:[function(require,module,exports){
module.exports="#define PHONG\n\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n{\n    const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n    // First corner\n    vec2 i  = floor(v + dot(v, C.yy) );\n    vec2 x0 = v -   i + dot(i, C.xx);\n\n    // Other corners\n    vec2 i1;\n    //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n    //i1.y = 1.0 - i1.x;\n    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n    // x0 = x0 - 0.0 + 0.0 * C.xx ;\n    // x1 = x0 - i1 + 1.0 * C.xx ;\n    // x2 = x0 - 1.0 + 2.0 * C.xx ;\n    vec4 x12 = x0.xyxy + C.xxzz;\n    x12.xy -= i1;\n\n    // Permutations\n    i = mod289(i); // Avoid truncation effects in permutation\n    vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n        + i.x + vec3(0.0, i1.x, 1.0 ));\n\n    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n    m = m*m ;\n    m = m*m ;\n\n    // Gradients: 41 points uniformly over a line, mapped onto a diamond.\n    // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n    vec3 x = 2.0 * fract(p * C.www) - 1.0;\n    vec3 h = abs(x) - 0.5;\n    vec3 ox = floor(x + 0.5);\n    vec3 a0 = x - ox;\n\n    // Normalise gradients implicitly by scaling m\n    // Approximation of: m *= inversesqrt( a0*a0 + h*h );\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n    // Compute final noise value at P\n    vec3 g;\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\n    g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n    return 130.0 * dot(m, g);\n}\n\nuniform float time;\n\nvarying vec3 vViewPosition;\n// varying vec3 vOriginalPosition;\n// varying vec3 vPosition;\n\n#ifndef FLAT_SHADED\n\n   varying vec3 vNormal;\n\n#endif\n\n#ifndef USE_NORMALMAP\n    varying vec2 vUv;\n#endif\n\n#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n    return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n    return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n    float distance = dot( planeNormal, point-pointOnPlane );\n    return point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n    return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n    return pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n    if ( decayExponent > 0.0 ) {\n      return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n    }\n    return 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n    return pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n    return a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n    return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n    return a;\n#endif\n}\n\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n    varying vec2 vUv;\n    uniform vec4 offsetRepeat;\n\n#endif\n\n#ifdef USE_LIGHTMAP\n\n    varying vec2 vUv2;\n\n#endif\n#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n    varying vec3 vReflect;\n\n    uniform float refractionRatio;\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n    varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef USE_COLOR\n\n    varying vec3 vColor;\n\n#endif\n#ifdef USE_MORPHTARGETS\n\n    #ifndef USE_MORPHNORMALS\n\n    uniform float morphTargetInfluences[ 8 ];\n\n    #else\n\n    uniform float morphTargetInfluences[ 4 ];\n\n    #endif\n\n#endif\n#ifdef USE_SKINNING\n\n    uniform mat4 bindMatrix;\n    uniform mat4 bindMatrixInverse;\n\n    #ifdef BONE_TEXTURE\n\n        uniform sampler2D boneTexture;\n        uniform int boneTextureWidth;\n        uniform int boneTextureHeight;\n\n        mat4 getBoneMatrix( const in float i ) {\n\n            float j = i * 4.0;\n            float x = mod( j, float( boneTextureWidth ) );\n            float y = floor( j / float( boneTextureWidth ) );\n\n            float dx = 1.0 / float( boneTextureWidth );\n            float dy = 1.0 / float( boneTextureHeight );\n\n            y = dy * ( y + 0.5 );\n\n            vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n            vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n            vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n            vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n            mat4 bone = mat4( v1, v2, v3, v4 );\n\n            return bone;\n\n        }\n\n    #else\n\n        uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n        mat4 getBoneMatrix( const in float i ) {\n\n            mat4 bone = boneGlobalMatrices[ int(i) ];\n            return bone;\n\n        }\n\n    #endif\n\n#endif\n\n#ifdef USE_SHADOWMAP\n\n    varying vec4 vShadowCoord[ MAX_SHADOWS ];\n    uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif\n#ifdef USE_LOGDEPTHBUF\n\n    #ifdef USE_LOGDEPTHBUF_EXT\n\n        varying float vFragDepth;\n\n    #endif\n\n    uniform float logDepthBufFC;\n\n#endif\n\n\nvoid main()\n{\n    // vOriginalPosition = position;\n\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif\n#ifdef USE_LIGHTMAP\n\n    vUv2 = uv2;\n\n#endif\n#ifdef USE_COLOR\n\n    vColor.xyz = inputToLinear( color.xyz );\n\n#endif\n#ifdef USE_MORPHNORMALS\n\n    vec3 morphedNormal = vec3( 0.0 );\n\n    morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n    morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n    morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n    morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n    morphedNormal += normal;\n\n#endif\n#ifdef USE_SKINNING\n\n    mat4 boneMatX = getBoneMatrix( skinIndex.x );\n    mat4 boneMatY = getBoneMatrix( skinIndex.y );\n    mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n    mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n#ifdef USE_SKINNING\n\n    mat4 skinMatrix = mat4( 0.0 );\n    skinMatrix += skinWeight.x * boneMatX;\n    skinMatrix += skinWeight.y * boneMatY;\n    skinMatrix += skinWeight.z * boneMatZ;\n    skinMatrix += skinWeight.w * boneMatW;\n    skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n    #ifdef USE_MORPHNORMALS\n\n    vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n    #else\n\n    vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n    #endif\n\n#endif\n\n#ifdef USE_SKINNING\n\n    vec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n    vec3 objectNormal = morphedNormal;\n\n#else\n\n    vec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n    objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n\n\n\n    #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n       vNormal = normalize( transformedNormal );\n\n    #endif\n\n    #ifndef USE_NORMALMAP\n        vUv = uv;\n    #endif\n\n    // vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\n    // gl_Position = projectionMatrix * mvPosition;\n\n    #ifdef USE_MORPHTARGETS\n\n    vec3 morphed = vec3( 0.0 );\n    morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n    morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n    morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n    morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n    #ifndef USE_MORPHNORMALS\n\n    morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n    morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n    morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n    morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n    #endif\n\n    morphed += position;\n\n#endif\n#ifdef USE_SKINNING\n\n    #ifdef USE_MORPHTARGETS\n\n    vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n    #else\n\n    vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n    #endif\n\n    vec4 skinned = vec4( 0.0 );\n    skinned += boneMatX * skinVertex * skinWeight.x;\n    skinned += boneMatY * skinVertex * skinWeight.y;\n    skinned += boneMatZ * skinVertex * skinWeight.z;\n    skinned += boneMatW * skinVertex * skinWeight.w;\n    skinned  = bindMatrixInverse * skinned;\n\n#endif\n\n// additions for motion\n// vec3 pos = position;\n// pos.z *= 1.0 + (cos(scaleAngle + time) + 1.0);\n\nvec3 pos = position;\n\n// // pos += snoise(uv + time) * 10.0;\n// // pos *= 1.0 + (snoise(uv + time) * 0.1);\n// pos *= 1.0 + (snoise(pos.xz + time) * 0.5);\n\n#ifdef USE_SKINNING\n\n    vec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n    vec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n    // vPosition = pos;\n    vec4 mvPosition = modelViewMatrix * vec4( pos, 1.0 );\n    // vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n\n#ifdef USE_LOGDEPTHBUF\n\n    gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n    #ifdef USE_LOGDEPTHBUF_EXT\n\n        vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n        gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n    #endif\n\n#endif\n\n\n    vViewPosition = -mvPosition.xyz;\n\n    #if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n    #ifdef USE_SKINNING\n\n        vec4 worldPosition = modelMatrix * skinned;\n\n    #elif defined( USE_MORPHTARGETS )\n\n        vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n    #else\n\n        vec4 worldPosition = modelMatrix * vec4( pos, 1.0 );\n        // vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n    #endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n    vec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n    vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n    #ifdef ENVMAP_MODE_REFLECTION\n\n        vReflect = reflect( cameraToVertex, worldNormal );\n\n    #else\n\n        vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n    #endif\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n    vWorldPosition = worldPosition.xyz;\n\n#endif\n#ifdef USE_SHADOWMAP\n\n    for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n        vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n    }\n\n#endif\n}\n";
},{}],146:[function(require,module,exports){
module.exports="#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform vec3 color;\nuniform float globalOpacity;\n\nvarying float vOpacity;\n\nvoid main()\n{\n	gl_FragColor = vec4(color, vOpacity * globalOpacity);\n}\n";
},{}],147:[function(require,module,exports){
module.exports="#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform float time;\n// uniform float posScalar;\n\nattribute float posScalar;\nattribute float opacity;\nattribute float canMove;\n\nvarying float vOpacity;\n\n\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n{\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n    // First corner\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n    // Other corners\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n\n    //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n    //   x1 = x0 - i1  + 1.0 * C.xxx;\n    //   x2 = x0 - i2  + 2.0 * C.xxx;\n    //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n\n    //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n    //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n\n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nvoid main()\n{\n	vOpacity = opacity;\n\n	vec3 pos = position * posScalar;\n\n	if(canMove != 0.0)\n		pos += snoise(position + time);\n\n	vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n	gl_Position = projectionMatrix * mvPosition;\n}\n";
},{}],148:[function(require,module,exports){
module.exports="#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform vec3 color;\nuniform float opacity;\nuniform sampler2D map;\n\nvoid main()\n{\n	vec4 mapColor = texture2D(map, gl_PointCoord);\n	gl_FragColor = mapColor * vec4(color, opacity);\n}\n";
},{}],149:[function(require,module,exports){
module.exports="#ifdef GL_ES\n	precision highp float;\n#endif\n\nuniform float time;\nuniform float size;\n// uniform float posScalar;\n\nattribute float posScalar;\nattribute float canMove;\n\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n    return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n{\n    const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n    const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n    // First corner\n    vec3 i  = floor(v + dot(v, C.yyy) );\n    vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n    // Other corners\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min( g.xyz, l.zxy );\n    vec3 i2 = max( g.xyz, l.zxy );\n\n    //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n    //   x1 = x0 - i1  + 1.0 * C.xxx;\n    //   x2 = x0 - i2  + 2.0 * C.xxx;\n    //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n    vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n    // Permutations\n    i = mod289(i);\n    vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n    // Gradients: 7x7 points over a square, mapped onto an octahedron.\n    // The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n    float n_ = 0.142857142857; // 1.0/7.0\n    vec3  ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4( x.xy, y.xy );\n    vec4 b1 = vec4( x.zw, y.zw );\n\n    //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n    //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n    vec3 p0 = vec3(a0.xy,h.x);\n    vec3 p1 = vec3(a0.zw,h.y);\n    vec3 p2 = vec3(a1.xy,h.z);\n    vec3 p3 = vec3(a1.zw,h.w);\n\n    //Normalise gradients\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n    // Mix final noise value\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n}\n\nvoid main()\n{\n	vec3 pos = position * posScalar;\n\n	if(canMove != 0.0)\n		pos += snoise(position + time);\n\n	vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n	gl_PointSize = size;\n	gl_Position = projectionMatrix * mvPosition;\n}\n";
},{}],150:[function(require,module,exports){
module.exports="// #extension GL_OES_standard_derivatives : enable\n\nuniform vec3 color;\n\n#ifndef USE_NORMALMAP\n    varying vec2 vUv;\n#endif\n\n#define PHONG\n#define ENVMAP_TYPE_CUBE\n#define ENVMAP_BLENDING_MULTIPLY\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\nvarying float vUseOpacity;\n\n#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n    return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n    return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n    float distance = dot( planeNormal, point-pointOnPlane );\n    return point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n    return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n    return pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n    if ( decayExponent > 0.0 ) {\n      return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n    }\n    return 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n    return pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n    return a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n    return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n    return a;\n#endif\n}\n\n#ifdef USE_COLOR\n\n    varying vec3 vColor;\n\n#endif\n\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n    varying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n    uniform sampler2D map;\n\n#endif\n#ifdef USE_ALPHAMAP\n\n    uniform sampler2D alphaMap;\n\n#endif\n\n#ifdef USE_LIGHTMAP\n\n    varying vec2 vUv2;\n    uniform sampler2D lightMap;\n\n#endif\n#ifdef USE_ENVMAP\n\n    uniform float reflectivity;\n    #ifdef ENVMAP_TYPE_CUBE\n        uniform samplerCube envMap;\n    #else\n        uniform sampler2D envMap;\n    #endif\n    uniform float flipEnvMap;\n\n    #if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n        uniform float refractionRatio;\n\n    #else\n\n        varying vec3 vReflect;\n\n    #endif\n\n#endif\n\n#ifdef USE_FOG\n\n    uniform vec3 fogColor;\n\n    #ifdef FOG_EXP2\n\n        uniform float fogDensity;\n\n    #else\n\n        uniform float fogNear;\n        uniform float fogFar;\n    #endif\n\n#endif\nuniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n    uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n    uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n    uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n    uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n    uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n    uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n    uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n    uniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n    uniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n    uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n    uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n    uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n    uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n    uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n    uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n    uniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n    varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n    uniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n    varying vec3 vNormal;\n\n#endif\n\n#ifdef USE_SHADOWMAP\n\n    uniform sampler2D shadowMap[ MAX_SHADOWS ];\n    uniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n    uniform float shadowDarkness[ MAX_SHADOWS ];\n    uniform float shadowBias[ MAX_SHADOWS ];\n\n    varying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n    float unpackDepth( const in vec4 rgba_depth ) {\n\n        const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n        float depth = dot( rgba_depth, bit_shift );\n        return depth;\n\n    }\n\n#endif\n#ifdef USE_BUMPMAP\n\n    uniform sampler2D bumpMap;\n    uniform float bumpScale;\n\n    // Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n    // http://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n    // Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n    vec2 dHdxy_fwd() {\n\n        vec2 dSTdx = dFdx( vUv );\n        vec2 dSTdy = dFdy( vUv );\n\n        float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n        float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n        float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n        return vec2( dBx, dBy );\n\n    }\n\n    vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n        vec3 vSigmaX = dFdx( surf_pos );\n        vec3 vSigmaY = dFdy( surf_pos );\n        vec3 vN = surf_norm;        // normalized\n\n        vec3 R1 = cross( vSigmaY, vN );\n        vec3 R2 = cross( vN, vSigmaX );\n\n        float fDet = dot( vSigmaX, R1 );\n\n        vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n        return normalize( abs( fDet ) * surf_norm - vGrad );\n\n    }\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n    uniform sampler2D normalMap;\n    uniform vec2 normalScale;\n\n    // Per-Pixel Tangent Space Normal Mapping\n    // http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n    vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n        vec3 q0 = dFdx( eye_pos.xyz );\n        vec3 q1 = dFdy( eye_pos.xyz );\n        vec2 st0 = dFdx( vUv.st );\n        vec2 st1 = dFdy( vUv.st );\n\n        vec3 S = normalize( q0 * st1.t - q1 * st0.t );\n        vec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n        vec3 N = normalize( surf_norm );\n\n        vec3 mapN = texture2D( normalMap, mapOffset + (vUv * mapRepeat) ).xyz * 2.0 - 1.0;\n        mapN.xy = normalScale * mapN.xy;\n        mat3 tsn = mat3( S, T, N );\n        return normalize( tsn * mapN );\n\n    }\n\n#endif\n\n#ifdef USE_SPECULARMAP\n\n    uniform sampler2D specularMap;\n\n#endif\n#ifdef USE_LOGDEPTHBUF\n\n    uniform float logDepthBufFC;\n\n    #ifdef USE_LOGDEPTHBUF_EXT\n\n        #extension GL_EXT_frag_depth : enable\n        varying float vFragDepth;\n\n    #endif\n\n#endif\n\n\nvoid main()\n{\n    vec3 outgoingLight = vec3( 0.0 ); // outgoing light does not have an alpha, the surface does\n\n    float opac;\n    if(vUseOpacity < 0.5)\n    {\n    	opac = 1.0;\n    }\n    else\n    {\n    	opac = opacity;\n    }\n\n    vec4 diffuseColor = vec4( diffuse, opac );\n\n    #if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n    gl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif\n#ifdef USE_MAP\n\n    vec4 texelColor = texture2D( map, vUv );\n\n    texelColor.xyz = inputToLinear( texelColor.xyz );\n\n    diffuseColor *= texelColor;\n\n#endif\n#ifdef USE_COLOR\n\n    diffuseColor.rgb *= vColor;\n\n#endif\n#ifdef USE_ALPHAMAP\n\n    diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n\n#ifdef ALPHATEST\n\n    if ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n    vec4 texelSpecular = texture2D( specularMap, mapOffset + (vUv * mapRepeat) );\n    specularStrength = texelSpecular.r;\n\n#else\n\n    specularStrength = 1.0;\n\n#endif\n#ifndef FLAT_SHADED\n\n    vec3 normal = normalize( vNormal );\n\n    #ifdef DOUBLE_SIDED\n\n        normal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n    #endif\n\n#else\n\n    vec3 fdx = dFdx( vViewPosition );\n    vec3 fdy = dFdy( vViewPosition );\n    vec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef USE_NORMALMAP\n\n    normal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n    normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n    for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n        vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n        float attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n        lVector = normalize( lVector );\n\n        // diffuse\n\n        float dotProduct = dot( normal, lVector );\n\n        #ifdef WRAP_AROUND\n\n            float pointDiffuseWeightFull = max( dotProduct, 0.0 );\n            float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n            vec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n        #else\n\n            float pointDiffuseWeight = max( dotProduct, 0.0 );\n\n        #endif\n\n        totalDiffuseLight += pointLightColor[ i ] * pointDiffuseWeight * attenuation;\n\n                // specular\n\n        vec3 pointHalfVector = normalize( lVector + viewPosition );\n        float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n        float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n        float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n        vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n        totalSpecularLight += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * attenuation * specularNormalization;\n\n    }\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n    for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n        vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n        vec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n        float attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n        lVector = normalize( lVector );\n\n        float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n        if ( spotEffect > spotLightAngleCos[ i ] ) {\n\n            spotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n            // diffuse\n\n            float dotProduct = dot( normal, lVector );\n\n            #ifdef WRAP_AROUND\n\n                float spotDiffuseWeightFull = max( dotProduct, 0.0 );\n                float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n                vec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n            #else\n\n                float spotDiffuseWeight = max( dotProduct, 0.0 );\n\n            #endif\n\n            totalDiffuseLight += spotLightColor[ i ] * spotDiffuseWeight * attenuation * spotEffect;\n\n            // specular\n\n            vec3 spotHalfVector = normalize( lVector + viewPosition );\n            float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n            float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n            float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n            vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n            totalSpecularLight += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * attenuation * specularNormalization * spotEffect;\n\n        }\n\n    }\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n    for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n        vec3 dirVector = transformDirection( directionalLightDirection[ i ], viewMatrix );\n\n        // diffuse\n\n        float dotProduct = dot( normal, dirVector );\n\n        #ifdef WRAP_AROUND\n\n            float dirDiffuseWeightFull = max( dotProduct, 0.0 );\n            float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n            vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n        #else\n\n            float dirDiffuseWeight = max( dotProduct, 0.0 );\n\n        #endif\n\n        totalDiffuseLight += directionalLightColor[ i ] * dirDiffuseWeight;\n\n        // specular\n\n        vec3 dirHalfVector = normalize( dirVector + viewPosition );\n        float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n        float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n        /*\n        // fresnel term from skin shader\n        const float F0 = 0.128;\n\n        float base = 1.0 - dot( viewPosition, dirHalfVector );\n        float exponential = pow( base, 5.0 );\n\n        float fresnel = exponential + F0 * ( 1.0 - exponential );\n        */\n\n        /*\n        // fresnel term from fresnel shader\n        const float mFresnelBias = 0.08;\n        const float mFresnelScale = 0.3;\n        const float mFresnelPower = 5.0;\n\n        float fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n        */\n\n        float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n        //      dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n        vec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n        totalSpecularLight += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n    }\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n    for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n        vec3 lVector = transformDirection( hemisphereLightDirection[ i ], viewMatrix );\n\n        // diffuse\n\n        float dotProduct = dot( normal, lVector );\n        float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n        vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n        totalDiffuseLight += hemiColor;\n\n        // specular (sky light)\n\n        vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n        float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n        float hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n        // specular (ground light)\n\n        vec3 lVectorGround = -lVector;\n\n        vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n        float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n        float hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n        float dotProductGround = dot( normal, lVectorGround );\n\n        float specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n        vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n        vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n        totalSpecularLight += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n    }\n\n#endif\n\n#ifdef METAL\n\n    outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) * specular + totalSpecularLight + emissive;\n\n#else\n\n    outgoingLight += diffuseColor.rgb * ( totalDiffuseLight + ambientLightColor ) + totalSpecularLight + emissive;\n\n#endif\n\n#ifdef USE_LIGHTMAP\n\n    outgoingLight *= diffuseColor.xyz * texture2D( lightMap, vUv2 ).xyz;\n\n#endif\n#ifdef USE_ENVMAP\n\n    #if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n        vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n        // Transforming Normal Vectors with the Inverse Transformation\n        vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n        #ifdef ENVMAP_MODE_REFLECTION\n\n            vec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n        #else\n\n            vec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n        #endif\n\n    #else\n\n        vec3 reflectVec = vReflect;\n\n    #endif\n\n    #ifdef DOUBLE_SIDED\n        float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n    #else\n        float flipNormal = 1.0;\n    #endif\n\n    #ifdef ENVMAP_TYPE_CUBE\n        vec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n    #elif defined( ENVMAP_TYPE_EQUIREC )\n        vec2 sampleUV;\n        sampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n        sampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n        vec4 envColor = texture2D( envMap, sampleUV );\n\n    #elif defined( ENVMAP_TYPE_SPHERE )\n        vec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n        vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n    #endif\n\n    envColor.xyz = inputToLinear( envColor.xyz );\n\n    #ifdef ENVMAP_BLENDING_MULTIPLY\n\n        outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n    #elif defined( ENVMAP_BLENDING_MIX )\n\n        outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n    #elif defined( ENVMAP_BLENDING_ADD )\n\n        outgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n    #endif\n\n#endif\n\n#ifdef USE_SHADOWMAP\n\n    #ifdef SHADOWMAP_DEBUG\n\n        vec3 frustumColors[3];\n        frustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n        frustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n        frustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n    #endif\n\n    #ifdef SHADOWMAP_CASCADE\n\n        int inFrustumCount = 0;\n\n    #endif\n\n    float fDepth;\n    vec3 shadowColor = vec3( 1.0 );\n\n    for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n        vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n                // if ( something && something ) breaks ATI OpenGL shader compiler\n                // if ( all( something, something ) ) using this instead\n\n        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n        bool inFrustum = all( inFrustumVec );\n\n                // don't shadow pixels outside of light frustum\n                // use just first frustum (for cascades)\n                // don't shadow pixels behind far plane of light frustum\n\n        #ifdef SHADOWMAP_CASCADE\n\n            inFrustumCount += int( inFrustum );\n            bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n        #else\n\n            bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n        #endif\n\n        bool frustumTest = all( frustumTestVec );\n\n        if ( frustumTest ) {\n\n            shadowCoord.z += shadowBias[ i ];\n\n            #if defined( SHADOWMAP_TYPE_PCF )\n\n                        // Percentage-close filtering\n                        // (9 pixel kernel)\n                        // http://fabiensanglard.net/shadowmappingPCF/\n\n                float shadow = 0.0;\n\n        /*\n                        // nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n                        // must enroll loop manually\n\n                for ( float y = -1.25; y <= 1.25; y += 1.25 )\n                    for ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n                        vec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n                                // doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n                                //vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n                        float fDepth = unpackDepth( rgbaDepth );\n\n                        if ( fDepth < shadowCoord.z )\n                            shadow += 1.0;\n\n                }\n\n                shadow /= 9.0;\n\n        */\n\n                const float shadowDelta = 1.0 / 9.0;\n\n                float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n                float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n                float dx0 = -1.25 * xPixelOffset;\n                float dy0 = -1.25 * yPixelOffset;\n                float dx1 = 1.25 * xPixelOffset;\n                float dy1 = 1.25 * yPixelOffset;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n                if ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n                shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n            #elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n                        // Percentage-close filtering\n                        // (9 pixel kernel)\n                        // http://fabiensanglard.net/shadowmappingPCF/\n\n                float shadow = 0.0;\n\n                float xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n                float yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n                float dx0 = -1.0 * xPixelOffset;\n                float dy0 = -1.0 * yPixelOffset;\n                float dx1 = 1.0 * xPixelOffset;\n                float dy1 = 1.0 * yPixelOffset;\n\n                mat3 shadowKernel;\n                mat3 depthKernel;\n\n                depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n                depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n                depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n                depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n                depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n                depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n                depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n                depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n                depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n                vec3 shadowZ = vec3( shadowCoord.z );\n                shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n                shadowKernel[0] *= vec3(0.25);\n\n                shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n                shadowKernel[1] *= vec3(0.25);\n\n                shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n                shadowKernel[2] *= vec3(0.25);\n\n                vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n                shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n                shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n                vec4 shadowValues;\n                shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n                shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n                shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n                shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n                shadow = dot( shadowValues, vec4( 1.0 ) );\n\n                shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n            #else\n\n                vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n                float fDepth = unpackDepth( rgbaDepth );\n\n                if ( fDepth < shadowCoord.z )\n\n        // spot with multiple shadows is darker\n\n                    shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n        // spot with multiple shadows has the same color as single shadow spot\n\n        //                  shadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n            #endif\n\n        }\n\n\n        #ifdef SHADOWMAP_DEBUG\n\n            #ifdef SHADOWMAP_CASCADE\n\n                if ( inFrustum && inFrustumCount == 1 ) outgoingLight *= frustumColors[ i ];\n\n            #else\n\n                if ( inFrustum ) outgoingLight *= frustumColors[ i ];\n\n            #endif\n\n        #endif\n\n    }\n\n    // NOTE: I am unsure if this is correct in linear space.  -bhouston, Dec 29, 2014\n    shadowColor = inputToLinear( shadowColor );\n\n    outgoingLight = outgoingLight * shadowColor;\n\n#endif\n\n\n    outgoingLight = linearToOutput( outgoingLight );\n\n#ifdef USE_FOG\n\n    #ifdef USE_LOGDEPTHBUF_EXT\n\n        float depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n    #else\n\n        float depth = gl_FragCoord.z / gl_FragCoord.w;\n\n    #endif\n\n    #ifdef FOG_EXP2\n\n        float fogFactor = exp2( - square( fogDensity ) * square( depth ) * LOG2 );\n        fogFactor = whiteCompliment( fogFactor );\n\n    #else\n\n        float fogFactor = smoothstep( fogNear, fogFar, depth );\n\n    #endif\n\n    outgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif\n\n	vec2 warningHack = vUv; // just to shut up the console warning\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a ) * vec4(color, 1.0);\n\n}\n";
},{}],151:[function(require,module,exports){
module.exports="#define PHONG\n\nuniform float time;\nuniform float amplitude1;\nuniform float amplitude2;\nuniform float amplitude3;\n\nuniform float positionMix1;\nuniform float positionMix2;\nuniform float positionMix3;\n\nattribute vec3 positionAlt;\nattribute float positionMixIndex;\nattribute vec3 displacement;\nattribute float amplitudeIndex;\nattribute float useOpacity;\n\nvarying vec3 vViewPosition;\nvarying float vUseOpacity;\n// varying vec3 vOriginalPosition;\n// varying vec3 vPosition;\n\n#ifndef FLAT_SHADED\n\n   varying vec3 vNormal;\n\n#endif\n\n#ifndef USE_NORMALMAP\n    varying vec2 vUv;\n#endif\n\n#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\nfloat square( in float a ) { return a*a; }\nvec2  square( in vec2 a )  { return vec2( a.x*a.x, a.y*a.y ); }\nvec3  square( in vec3 a )  { return vec3( a.x*a.x, a.y*a.y, a.z*a.z ); }\nvec4  square( in vec4 a )  { return vec4( a.x*a.x, a.y*a.y, a.z*a.z, a.w*a.w ); }\nfloat saturate( in float a ) { return clamp( a, 0.0, 1.0 ); }\nvec2  saturate( in vec2 a )  { return clamp( a, 0.0, 1.0 ); }\nvec3  saturate( in vec3 a )  { return clamp( a, 0.0, 1.0 ); }\nvec4  saturate( in vec4 a )  { return clamp( a, 0.0, 1.0 ); }\nfloat average( in float a ) { return a; }\nfloat average( in vec2 a )  { return ( a.x + a.y) * 0.5; }\nfloat average( in vec3 a )  { return ( a.x + a.y + a.z) / 3.0; }\nfloat average( in vec4 a )  { return ( a.x + a.y + a.z + a.w) * 0.25; }\nfloat whiteCompliment( in float a ) { return saturate( 1.0 - a ); }\nvec2  whiteCompliment( in vec2 a )  { return saturate( vec2(1.0) - a ); }\nvec3  whiteCompliment( in vec3 a )  { return saturate( vec3(1.0) - a ); }\nvec4  whiteCompliment( in vec4 a )  { return saturate( vec4(1.0) - a ); }\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n    return normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n}\n// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n    return normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal) {\n    float distance = dot( planeNormal, point-pointOnPlane );\n    return point - distance * planeNormal;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n    return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n    return pointOnLine + lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) );\n}\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n    if ( decayExponent > 0.0 ) {\n      return pow( saturate( 1.0 - lightDistance / cutoffDistance ), decayExponent );\n    }\n    return 1.0;\n}\n\nvec3 inputToLinear( in vec3 a ) {\n#ifdef GAMMA_INPUT\n    return pow( a, vec3( float( GAMMA_FACTOR ) ) );\n#else\n    return a;\n#endif\n}\nvec3 linearToOutput( in vec3 a ) {\n#ifdef GAMMA_OUTPUT\n    return pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n#else\n    return a;\n#endif\n}\n\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n    varying vec2 vUv;\n    uniform vec4 offsetRepeat;\n\n#endif\n\n#ifdef USE_LIGHTMAP\n\n    varying vec2 vUv2;\n\n#endif\n#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n    varying vec3 vReflect;\n\n    uniform float refractionRatio;\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n    varying vec3 vWorldPosition;\n\n#endif\n\n#ifdef USE_COLOR\n\n    varying vec3 vColor;\n\n#endif\n#ifdef USE_MORPHTARGETS\n\n    #ifndef USE_MORPHNORMALS\n\n    uniform float morphTargetInfluences[ 8 ];\n\n    #else\n\n    uniform float morphTargetInfluences[ 4 ];\n\n    #endif\n\n#endif\n#ifdef USE_SKINNING\n\n    uniform mat4 bindMatrix;\n    uniform mat4 bindMatrixInverse;\n\n    #ifdef BONE_TEXTURE\n\n        uniform sampler2D boneTexture;\n        uniform int boneTextureWidth;\n        uniform int boneTextureHeight;\n\n        mat4 getBoneMatrix( const in float i ) {\n\n            float j = i * 4.0;\n            float x = mod( j, float( boneTextureWidth ) );\n            float y = floor( j / float( boneTextureWidth ) );\n\n            float dx = 1.0 / float( boneTextureWidth );\n            float dy = 1.0 / float( boneTextureHeight );\n\n            y = dy * ( y + 0.5 );\n\n            vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n            vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n            vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n            vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n            mat4 bone = mat4( v1, v2, v3, v4 );\n\n            return bone;\n\n        }\n\n    #else\n\n        uniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n        mat4 getBoneMatrix( const in float i ) {\n\n            mat4 bone = boneGlobalMatrices[ int(i) ];\n            return bone;\n\n        }\n\n    #endif\n\n#endif\n\n#ifdef USE_SHADOWMAP\n\n    varying vec4 vShadowCoord[ MAX_SHADOWS ];\n    uniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif\n#ifdef USE_LOGDEPTHBUF\n\n    #ifdef USE_LOGDEPTHBUF_EXT\n\n        varying float vFragDepth;\n\n    #endif\n\n    uniform float logDepthBufFC;\n\n#endif\n\n\nvoid main()\n{\n    // vOriginalPosition = position;\n    vUseOpacity = useOpacity;\n\n#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif\n#ifdef USE_LIGHTMAP\n\n    vUv2 = uv2;\n\n#endif\n#ifdef USE_COLOR\n\n    vColor.xyz = inputToLinear( color.xyz );\n\n#endif\n#ifdef USE_MORPHNORMALS\n\n    vec3 morphedNormal = vec3( 0.0 );\n\n    morphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n    morphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n    morphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n    morphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n    morphedNormal += normal;\n\n#endif\n#ifdef USE_SKINNING\n\n    mat4 boneMatX = getBoneMatrix( skinIndex.x );\n    mat4 boneMatY = getBoneMatrix( skinIndex.y );\n    mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n    mat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n#ifdef USE_SKINNING\n\n    mat4 skinMatrix = mat4( 0.0 );\n    skinMatrix += skinWeight.x * boneMatX;\n    skinMatrix += skinWeight.y * boneMatY;\n    skinMatrix += skinWeight.z * boneMatZ;\n    skinMatrix += skinWeight.w * boneMatW;\n    skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n    #ifdef USE_MORPHNORMALS\n\n    vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n    #else\n\n    vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n    #endif\n\n#endif\n\n#ifdef USE_SKINNING\n\n    vec3 objectNormal = skinnedNormal.xyz;\n\n#elif defined( USE_MORPHNORMALS )\n\n    vec3 objectNormal = morphedNormal;\n\n#else\n\n    vec3 objectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n    objectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n\n\n\n    #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n       vNormal = normalize( transformedNormal );\n\n    #endif\n\n    #ifndef USE_NORMALMAP\n        vUv = uv;\n    #endif\n\n    // vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\n    // gl_Position = projectionMatrix * mvPosition;\n\n    #ifdef USE_MORPHTARGETS\n\n    vec3 morphed = vec3( 0.0 );\n    morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n    morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n    morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n    morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n    #ifndef USE_MORPHNORMALS\n\n    morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n    morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n    morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n    morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n    #endif\n\n    morphed += position;\n\n#endif\n#ifdef USE_SKINNING\n\n    #ifdef USE_MORPHTARGETS\n\n    vec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n    #else\n\n    vec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n    #endif\n\n    vec4 skinned = vec4( 0.0 );\n    skinned += boneMatX * skinVertex * skinWeight.x;\n    skinned += boneMatY * skinVertex * skinWeight.y;\n    skinned += boneMatZ * skinVertex * skinWeight.z;\n    skinned += boneMatW * skinVertex * skinWeight.w;\n    skinned  = bindMatrixInverse * skinned;\n\n#endif\n\n// additions for motion\n// vec3 pos = position;\n// pos.z *= 1.0 + (cos(scaleAngle + time) + 1.0);\n\nfloat amplitude = 0.0;\nif(amplitudeIndex < 0.5)\n{\n	amplitude = amplitude1;\n}\nelse if(amplitudeIndex < 1.5)\n{\n	amplitude = amplitude2;\n}\nelse if(amplitudeIndex < 2.5)\n{\n	amplitude = amplitude3;\n}\n// vec3 pos = position * (1.0 + (amplitude * displacement));\n\nfloat positionMix = 0.0;\nif(positionMixIndex < 0.5)\n{\n	positionMix = positionMix1;\n}\nelse if(positionMixIndex < 1.5)\n{\n	positionMix = positionMix2;\n}\nelse if(positionMixIndex < 2.5)\n{\n	positionMix = positionMix3;\n}\nvec3 pos = mix(position, positionAlt, positionMix) * (1.0 + (amplitude * displacement));\n\n#ifdef USE_SKINNING\n\n    vec4 mvPosition = modelViewMatrix * skinned;\n\n#elif defined( USE_MORPHTARGETS )\n    vec4 mvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#else\n    // vPosition = pos;\n    vec4 mvPosition = modelViewMatrix * vec4( pos, 1.0 );\n    // vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n\n#ifdef USE_LOGDEPTHBUF\n\n    gl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n    #ifdef USE_LOGDEPTHBUF_EXT\n\n        vFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n        gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n    #endif\n\n#endif\n\n\n    vViewPosition = -mvPosition.xyz;\n\n    #if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n    #ifdef USE_SKINNING\n\n        vec4 worldPosition = modelMatrix * skinned;\n\n    #elif defined( USE_MORPHTARGETS )\n\n        vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n    #else\n\n        vec4 worldPosition = modelMatrix * vec4( pos, 1.0 );\n        // vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n    #endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n    vec3 worldNormal = transformDirection( objectNormal, modelMatrix );\n\n    vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n    #ifdef ENVMAP_MODE_REFLECTION\n\n        vReflect = reflect( cameraToVertex, worldNormal );\n\n    #else\n\n        vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n    #endif\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n    vWorldPosition = worldPosition.xyz;\n\n#endif\n#ifdef USE_SHADOWMAP\n\n    for( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n        vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n    }\n\n#endif\n}\n";
},{}],152:[function(require,module,exports){
module.exports="uniform vec3 color;\nuniform vec3 color2;\nuniform vec3 color3;\nuniform float warningColorMix;\nuniform float correctColorMix;\nuniform sampler2D map;\nuniform vec2 mapRepeat;\nuniform float opacity;\nuniform float time;\nuniform float timeInc;\n\nvarying vec2 vUv;\n\n//\n// Description : Array and textureless GLSL 2D simplex noise function.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n    return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n    return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v)\n{\n    const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)\n                     -0.577350269189626,  // -1.0 + 2.0 * C.x\n                      0.024390243902439); // 1.0 / 41.0\n    // First corner\n    vec2 i  = floor(v + dot(v, C.yy) );\n    vec2 x0 = v -   i + dot(i, C.xx);\n\n    // Other corners\n    vec2 i1;\n    //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0\n    //i1.y = 1.0 - i1.x;\n    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n    // x0 = x0 - 0.0 + 0.0 * C.xx ;\n    // x1 = x0 - i1 + 1.0 * C.xx ;\n    // x2 = x0 - 1.0 + 2.0 * C.xx ;\n    vec4 x12 = x0.xyxy + C.xxzz;\n    x12.xy -= i1;\n\n    // Permutations\n    i = mod289(i); // Avoid truncation effects in permutation\n    vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))\n        + i.x + vec3(0.0, i1.x, 1.0 ));\n\n    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n    m = m*m ;\n    m = m*m ;\n\n    // Gradients: 41 points uniformly over a line, mapped onto a diamond.\n    // The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)\n\n    vec3 x = 2.0 * fract(p * C.www) - 1.0;\n    vec3 h = abs(x) - 0.5;\n    vec3 ox = floor(x + 0.5);\n    vec3 a0 = x - ox;\n\n    // Normalise gradients implicitly by scaling m\n    // Approximation of: m *= inversesqrt( a0*a0 + h*h );\n    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n    // Compute final noise value at P\n    vec3 g;\n    g.x  = a0.x  * x0.x  + h.x  * x0.y;\n    g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n    return 130.0 * dot(m, g);\n}\n\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n	vec4 mapColor = texture2D(map, vUv * mapRepeat);\n	// vec4 mapColor = texture2D(map, vec2(vUv.x + time * 0.1, vUv.y) * mapRepeat);\n\n	float n = snoise(-vUv.xy + time) - rand(vUv + time);\n\n	vec3 c = mix(mix(color, color2, warningColorMix), color3, correctColorMix);\n	gl_FragColor = mapColor * vec4(c, opacity + (n * opacity));\n	// gl_FragColor = mapColor * vec4(mix(color, color2, warningColorMix), opacity + (n * opacity));\n}\n";
},{}],153:[function(require,module,exports){
arguments[4][131][0].apply(exports,arguments)
},{"dup":131}],154:[function(require,module,exports){
"document"in self&&("classList"in document.createElement("_")?!function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;i>n;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}t=null}():!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],s=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},a=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},c=function(t,e){if(""===e)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(t,e)},l=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,s=n.length;s>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=l[n]=[],f=function(){return new l(this)};if(a[n]=Error[n],u.item=function(t){return this[t]||null},u.contains=function(t){return t+="",-1!==c(this,t)},u.add=function(){var t,e=arguments,n=0,i=e.length,s=!1;do t=e[n]+"",-1===c(this,t)&&(this.push(t),s=!0);while(++n<i);s&&this._updateClassName()},u.remove=function(){var t,e,n=arguments,i=0,s=n.length,r=!1;do for(t=n[i]+"",e=c(this,t);-1!==e;)this.splice(e,1),r=!0,e=c(this,t);while(++i<s);r&&this._updateClassName()},u.toggle=function(t,e){t+="";var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},u.toString=function(){return this.join(" ")},s.defineProperty){var h={get:f,enumerable:!0,configurable:!0};try{s.defineProperty(i,e,h)}catch(g){-2146823252===g.number&&(h.enumerable=!1,s.defineProperty(i,e,h))}}else s[n].__defineGetter__&&i.__defineGetter__(e,f)}}(self));
},{}],155:[function(require,module,exports){
var FlickerTransition=function(e,n,o,t){function i(){u?("in"===e&&s.remove(),n()):setTimeout(i,f+.5)}o||(o=document.body),o.appendChild||(o=o[0]),"undefined"==typeof t&&(t=1e8);var a=100,d=Math.ceil(window.innerWidth/a),r=Math.ceil(window.innerHeight/a),s=$("<div>");s.css({position:"absolute",top:0,left:0});for(var c=d*r-1;c>=0;c--){var p=$('<div class="blackboxes-flicker">').css({position:"absolute",top:Math.floor(c/d)*a+"px",left:c%d*a+"px",backgroundColor:"black",width:a+"px",height:a+"px",zIndex:t});s.append(p)}o.appendChild(s[0]);var l=.5,f=.5,h={};"in"===e?(h={start:1,end:0},f=.7):h={start:0,end:1};var u=!1;s.find("div").each(function(e,n){var o=window.RoughEase.ease.config({strength:2,points:10});TweenLite.fromTo(n,f,{opacity:h.start},{opacity:h.end,delay:Math.random()*l,ease:o,onUpdate:function(){u=!1},onComplete:function(){u=!0}})}),setTimeout(i,f+.5)};module.exports=FlickerTransition;
},{}],156:[function(require,module,exports){
var EdgeHelper=function(e,r,t){t=void 0!==t?t:1;var o,a=Math.cos(THREE.Math.degToRad(t)),i=[0,0],c={},f=function(e,r){return e-r},n=["a","b","c"],E=new THREE.BufferGeometry;e.geometry instanceof THREE.BufferGeometry?(o=new THREE.Geometry,o.fromBufferGeometry(e.geometry)):o=e.geometry.clone(),o.mergeVertices(),o.computeFaceNormals();for(var v=o.vertices,d=o.faces,m=0,l=0,p=d.length;p>l;l++)for(var s=d[l],u=0;3>u;u++){i[0]=s[n[u]],i[1]=s[n[(u+1)%3]],i.sort(f);var y=i.toString();void 0===c[y]?(c[y]={vert1:i[0],vert2:i[1],face1:l,face2:void 0},m++):c[y].face2=l}var H=new Float32Array(2*m*3),g=0;for(var y in c){var R=c[y];if(void 0===R.face2||d[R.face1].normal.dot(d[R.face2].normal)<=a){var T=v[R.vert1];H[g++]=T.x,H[g++]=T.y,H[g++]=T.z,T=v[R.vert2],H[g++]=T.x,H[g++]=T.y,H[g++]=T.z}}E.addAttribute("position",new THREE.BufferAttribute(H,3)),THREE.Line.call(this,E,r,THREE.LinePieces),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1};EdgeHelper.prototype=Object.create(THREE.Line.prototype),EdgeHelper.prototype.constructor=EdgeHelper,module.exports=EdgeHelper;
},{}],157:[function(require,module,exports){
var ImprovedNoise=function(){function r(r){return r*r*r*(r*(6*r-15)+10)}function n(r,n,o){return n+r*(o-n)}function o(r,n,o,e){var t=15&r,u=8>t?n:o,i=4>t?o:12==t||14==t?n:e;return(0==(1&t)?u:-u)+(0==(2&t)?i:-i)}for(var e=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],t=0;256>t;t++)e[256+t]=e[t];return{noise:function(t,u,i){var v=~~t,f=~~u,a=~~i,c=255&v,s=255&f,d=255&a;t-=v,u-=f,i-=a;var m=t-1,p=u-1,I=i-1,N=r(t),l=r(u),x=r(i),b=e[c]+s,g=e[b]+d,h=e[b+1]+d,j=e[c+1]+s,k=e[j]+d,q=e[j+1]+d;return n(x,n(l,n(N,o(e[g],t,u,i),o(e[k],m,u,i)),n(N,o(e[h],t,p,i),o(e[q],m,p,i))),n(l,n(N,o(e[g+1],t,u,I),o(e[k+1],m,u,i-1)),n(N,o(e[h+1],t,p,I),o(e[q+1],m,p,I))))}}};module.exports=ImprovedNoise;
},{}],158:[function(require,module,exports){
var OIMO={REVISION:"DEV.1.1.2a"};OIMO.SHAPE_SPHERE=1,OIMO.SHAPE_BOX=2,OIMO.WORLD_SCALE=100,OIMO.INV_SCALE=.01,OIMO.TO_RAD=Math.PI/180,OIMO.TwoPI=2*Math.PI,OIMO.nextID=0;var OIMO_ARRAY_TYPE;OIMO_ARRAY_TYPE||(OIMO_ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array),OIMO.World=function(i,t,s,h){this.timeStep=i||1/60,this.numIterations=s||8;var e=t||2;switch(e){case 1:this.broadPhase=new OIMO.BruteForceBroadPhase;break;case 2:default:this.broadPhase=new OIMO.SAPBroadPhase;break;case 3:this.broadPhase=new OIMO.DBVTBroadPhase}this.enableRandomizer=!0,this.isNoStat=h||!1,this.rigidBodies=null,this.numRigidBodies=0,this.contacts=null,this.unusedContacts=null,this.numContacts=0,this.numContactPoints=0,this.joints=null,this.numJoints=0,this.numIslands=0,this.gravity=new OIMO.Vec3(0,-9.80665,0),this.performance=null,this.isNoStat||(this.performance=new OIMO.Performance(this));var a=3;this.detectors=[],this.detectors.length=a;for(var o=a;o--;)this.detectors[o]=[],this.detectors[o].length=a;this.detectors[OIMO.SHAPE_SPHERE][OIMO.SHAPE_SPHERE]=new OIMO.SphereSphereCollisionDetector,this.detectors[OIMO.SHAPE_SPHERE][OIMO.SHAPE_BOX]=new OIMO.SphereBoxCollisionDetector(!1),this.detectors[OIMO.SHAPE_BOX][OIMO.SHAPE_SPHERE]=new OIMO.SphereBoxCollisionDetector(!0),this.detectors[OIMO.SHAPE_BOX][OIMO.SHAPE_BOX]=new OIMO.BoxBoxCollisionDetector,this.randX=65535,this.randA=98765,this.randB=123456789,this.maxIslandRigidBodies=64,this.islandRigidBodies=[],this.islandRigidBodies.length=this.maxIslandRigidBodies,this.islandStack=[],this.islandStack.length=this.maxIslandRigidBodies,this.maxIslandConstraints=128,this.islandConstraints=[],this.islandConstraints.length=this.maxIslandConstraints},OIMO.World.prototype={constructor:OIMO.World,clear:function(){for(this.randX=65535;null!==this.joints;)this.removeJoint(this.joints);for(;null!==this.contacts;)this.removeContact(this.contacts);for(;null!==this.rigidBodies;)this.removeRigidBody(this.rigidBodies);OIMO.nextID=0},addRigidBody:function(i){if(i.parent)throw new Error("It is not possible to be added to more than one world one of the rigid body");i.parent=this,i.awake();for(var t=i.shapes;null!==t;t=t.next)this.addShape(t);null!==this.rigidBodies&&((this.rigidBodies.prev=i).next=this.rigidBodies),this.rigidBodies=i,this.numRigidBodies++},removeRigidBody:function(i){var t=i;if(t.parent===this){t.awake();for(var s=t.jointLink;null!=s;){var h=s.joint;s=s.next,this.removeJoint(h)}for(var e=i.shapes;null!==e;e=e.next)this.removeShape(e);var a=t.prev,o=t.next;null!==a&&(a.next=o),null!==o&&(o.prev=a),this.rigidBodies==t&&(this.rigidBodies=o),t.prev=null,t.next=null,t.parent=null,this.numRigidBodies--}},getByName:function(i){for(var t=null,s=this.rigidBodies;null!==s;)" "!==s.name&&s.name===i&&(t=s),s=s.next;for(var h=this.joints;null!==h;)""!==h.name&&h.name===i&&(t=h),h=h.next;return t},addShape:function(i){if(!i.parent||!i.parent.parent)throw new Error("It is not possible to be added alone to shape world");i.proxy=this.broadPhase.createProxy(i),i.updateProxy(),this.broadPhase.addProxy(i.proxy)},removeShape:function(i){this.broadPhase.removeProxy(i.proxy),i.proxy=null},addJoint:function(i){if(i.parent)throw new Error("It is not possible to be added to more than one world one of the joint");null!=this.joints&&((this.joints.prev=i).next=this.joints),this.joints=i,i.parent=this,this.numJoints++,i.awake(),i.attach()},removeJoint:function(i){var t=i,s=t.prev,h=t.next;null!==s&&(s.next=h),null!==h&&(h.prev=s),this.joints==t&&(this.joints=h),t.prev=null,t.next=null,this.numJoints--,t.awake(),t.detach(),t.parent=null},worldscale:function(i){OIMO.WORLD_SCALE=i||100,OIMO.INV_SCALE=1/OIMO.WORLD_SCALE},step:function(){var i,t,s,h;this.isNoStat||(i=Date.now());for(var e=this.rigidBodies;null!==e;)e.addedToIsland=!1,e.sleeping&&(e.linearVelocity.testZero()||e.position.testDiff(e.sleepPosition)||e.orientation.testDiff(e.sleepOrientation))&&e.awake(),e=e.next;this.isNoStat||(t=Date.now()),this.broadPhase.detectPairs();for(var a=this.broadPhase.pairs,o=this.broadPhase.numPairs,n=o;n--;){var l,r,m=a[n];m.shape1.id<m.shape2.id?(l=m.shape1,r=m.shape2):(l=m.shape2,r=m.shape1);var c;c=l.numContacts<r.numContacts?l.contactLink:r.contactLink;for(var x=!1;c;){var p=c.contact;if(p.shape1==l&&p.shape2==r){p.persisting=!0,x=!0;break}c=c.next}x||this.addContact(l,r)}for(this.isNoStat||(s=Date.now(),this.performance.broadPhaseTime=s-t),this.numContactPoints=0,p=this.contacts;null!==p;){if(!p.persisting){var u=p.shape1.aabb,y=p.shape2.aabb;if(u.minX>y.maxX||u.maxX<y.minX||u.minY>y.maxY||u.maxY<y.minY||u.minZ>y.maxZ||u.maxZ<y.minZ){var d=p.next;this.removeContact(p),p=d;continue}}var O=p.body1,N=p.body2;(O.isDynamic&&!O.sleeping||N.isDynamic&&!N.sleeping)&&p.updateManifold(),this.numContactPoints+=p.manifold.numPoints,p.persisting=!1,p.constraint.addedToIsland=!1,p=p.next}this.isNoStat||(h=Date.now(),this.performance.narrowPhaseTime=h-s);var M,I,v=1/this.timeStep;for(M=this.joints;null!==M;M=M.next)M.addedToIsland=!1;this.maxIslandRigidBodies<this.numRigidBodies&&(this.maxIslandRigidBodies=this.numRigidBodies<<1,this.islandRigidBodies=[],this.islandStack=[],this.islandRigidBodies.length=this.maxIslandRigidBodies,this.islandStack.length=this.maxIslandRigidBodies);var z=this.numJoints+this.numContacts;this.maxIslandConstraints<z&&(this.maxIslandConstraints=z<<1,this.islandConstraints=[],this.islandConstraints.length=this.maxIslandConstraints),t=Date.now(),this.numIslands=0;for(var f=this.rigidBodies;null!==f;f=f.next)if(!(f.addedToIsland||f.isStatic||f.sleeping))if(f.isLonely())f.isDynamic&&f.linearVelocity.addTime(this.gravity,this.timeStep),this.calSleep(f)?(f.sleepTime+=this.timeStep,f.sleepTime>.5?f.sleep():f.updatePosition(this.timeStep)):(f.sleepTime=0,f.updatePosition(this.timeStep)),this.numIslands++;else{var b=0,A=0,k=1;this.islandStack[0]=f,f.addedToIsland=!0;do if(e=this.islandStack[--k],this.islandStack[k]=null,e.sleeping=!1,this.islandRigidBodies[b++]=e,!e.isStatic){for(var g=e.contactLink;null!==g;g=g.next){var p=g.contact;if(I=p.constraint,!I.addedToIsland&&p.touching){this.islandConstraints[A++]=I,I.addedToIsland=!0;var d=g.body;d.addedToIsland||(this.islandStack[k++]=d,d.addedToIsland=!0)}}for(var S=e.jointLink;null!==S;S=S.next)I=S.joint,I.addedToIsland||(this.islandConstraints[A++]=I,I.addedToIsland=!0,d=S.body,!d.addedToIsland&&d.isDynamic&&(this.islandStack[k++]=d,d.addedToIsland=!0))}while(0!=k);for(var w=(new OIMO.Vec3).addTime(this.gravity,this.timeStep),L=b;L--;)e=this.islandRigidBodies[L],e.isDynamic&&e.linearVelocity.addEqual(w);if(this.enableRandomizer)for(L=A;L--;)if(0!==L){var P=(this.randX=this.randX*this.randA+this.randB&2147483647)/2147483648*L|0;I=this.islandConstraints[L],this.islandConstraints[L]=this.islandConstraints[P],this.islandConstraints[P]=I}for(L=A;L--;)this.islandConstraints[L].preSolve(this.timeStep,v);for(var V=this.numIterations;V--;)for(L=A;L--;)this.islandConstraints[L].solve();for(L=A;L--;)this.islandConstraints[L].postSolve(),this.islandConstraints[L]=null;var T=10;for(L=b;L--;)e=this.islandRigidBodies[L],this.calSleep(e)?(e.sleepTime+=this.timeStep,e.sleepTime<T&&(T=e.sleepTime)):(e.sleepTime=0,T=0);if(T>.5)for(L=b;L--;)this.islandRigidBodies[L].sleep(),this.islandRigidBodies[L]=null;else for(L=b;L--;)this.islandRigidBodies[L].updatePosition(this.timeStep),this.islandRigidBodies[L]=null;this.numIslands++}this.isNoStat||(s=Date.now(),this.performance.solvingTime=s-t,s=Date.now(),this.performance.upfps(),this.performance.totalTime=s-i,this.performance.updatingTime=this.performance.totalTime-(this.performance.broadPhaseTime+this.performance.narrowPhaseTime+this.performance.solvingTime))},addContact:function(i,t){var s;null!==this.unusedContacts?(s=this.unusedContacts,this.unusedContacts=this.unusedContacts.next):s=new OIMO.Contact,s.attach(i,t),s.detector=this.detectors[i.type][t.type],this.contacts&&((this.contacts.prev=s).next=this.contacts),this.contacts=s,this.numContacts++},removeContact:function(i){var t=i.prev,s=i.next;s&&(s.prev=t),t&&(t.next=s),this.contacts==i&&(this.contacts=s),i.prev=null,i.next=null,i.detach(),i.next=this.unusedContacts,this.unusedContacts=i,this.numContacts--},checkContact:function(i,t){for(var s,h,e=this.contacts;null!==e;){if(s=e.body1.name||" ",h=e.body2.name||" ",s==i&&h==t||h==i&&s==t)return e.touching?!0:!1;e=e.next}return!1},calSleep:function(i){return i.allowSleep?i.linearVelocity.len()>.04?!1:i.angularVelocity.len()>.25?!1:!0:!1}},OIMO.RigidBody=function(i,t,s,h,e,a,o){var n=h||0,l=e||0,r=a||0,m=o||0,c=i||0,x=t||0,p=s||0;this.name=" ",this.BODY_DYNAMIC=1,this.BODY_STATIC=2,this.MAX_SHAPES=64,this.prev=null,this.next=null,this.type=0,this.massInfo=new OIMO.MassInfo,this.position=new OIMO.Vec3(c,x,p),this.newPosition=new OIMO.Vec3(0,0,0),this.controlPos=!1,this.newOrientation=new OIMO.Quat,this.newRotation=new OIMO.Vec3(0,0,0),this.currentRotation=new OIMO.Vec3(0,0,0),this.controlRot=!1,this.controlRotInTime=!1,this.orientation=this.rotationAxisToQuad(n,l,r,m),this.linearVelocity=new OIMO.Vec3,this.angularVelocity=new OIMO.Vec3,this.matrix=new OIMO.Mat44,this.parent=null,this.contactLink=null,this.numContacts=0,this.shapes=null,this.numShapes=0,this.jointLink=null,this.numJoints=0,this.sleepPosition=new OIMO.Vec3,this.sleepOrientation=new OIMO.Quat,this.isStatic=!1,this.isDynamic=!1,this.rotation=new OIMO.Mat33,this.mass=NaN,this.inverseMass=NaN,this.inverseInertia=new OIMO.Mat33,this.localInertia=new OIMO.Mat33,this.inverseLocalInertia=new OIMO.Mat33,this.addedToIsland=!1,this.allowSleep=!0,this.sleepTime=0,this.sleeping=!1},OIMO.RigidBody.prototype={constructor:OIMO.RigidBody,addShape:function(i){if(i.parent)throw new Error("It is not possible that you add to the multi-rigid body the shape of one");null!=this.shapes&&((this.shapes.prev=i).next=this.shapes),this.shapes=i,i.parent=this,this.parent&&this.parent.addShape(i),this.numShapes++},removeShape:function(i){var t=i;if(t.parent==this){var s=t.prev,h=t.next;null!=s&&(s.next=h),null!=h&&(h.prev=s),this.shapes==t&&(this.shapes=h),t.prev=null,t.next=null,t.parent=null,this.parent&&this.parent.removeShape(t),this.numShapes--}},setupMass:function(i,t){var s=void 0!==t?t:!0,h=i||this.BODY_DYNAMIC;this.type=h,this.isDynamic=h==this.BODY_DYNAMIC,this.isStatic=h==this.BODY_STATIC,this.mass=0,this.localInertia.init(0,0,0,0,0,0,0,0,0);for(var e=this.localInertia.elements,a=new OIMO.Mat33,o=new OIMO.Vec3,n=this.shapes;null!=n;n=n.next){n.calculateMassInfo(this.massInfo);var l=this.massInfo.mass,r=n.relativePosition.x,m=n.relativePosition.y,c=n.relativePosition.z;o.addScale(n.relativePosition,l),this.mass+=l,this.rotateInertia(n.relativeRotation,this.massInfo.inertia,a),this.localInertia.addEqual(a),e[0]+=l*(m*m+c*c),e[4]+=l*(r*r+c*c),e[8]+=l*(r*r+m*m);var x=l*r*m,p=l*m*c,u=l*c*r;e[1]-=x,e[3]-=x,e[2]-=p,e[6]-=p,e[5]-=u,e[7]-=u}if(this.inverseMass=1/this.mass,o.scaleEqual(this.inverseMass),s){for(this.position.addEqual(o),n=this.shapes;null!=n;n=n.next)n.relativePosition.subEqual(o);r=o.x,m=o.y,c=o.z,e[0]-=this.mass*(m*m+c*c),e[4]-=this.mass*(r*r+c*c),e[8]-=this.mass*(r*r+m*m),x=this.mass*r*m,p=this.mass*m*c,u=this.mass*c*r,e[1]+=x,e[3]+=x,e[2]+=p,e[6]+=p,e[5]+=u,e[7]+=u}this.inverseLocalInertia.invert(this.localInertia),h==this.BODY_STATIC&&(this.inverseMass=0,this.inverseLocalInertia.init(0,0,0,0,0,0,0,0,0)),this.syncShapes(),this.awake()},awake:function(){if(this.allowSleep&&this.sleeping){this.sleeping=!1,this.sleepTime=0;for(var i=this.contactLink;null!=i;)i.body.sleepTime=0,i.body.sleeping=!1,i=i.next;for(var t=this.jointLink;null!=t;)t.body.sleepTime=0,t.body.sleeping=!1,t=t.next;for(var s=this.shapes;null!=s;s=s.next)s.updateProxy()}},sleep:function(){if(this.allowSleep&&!this.sleeping){this.linearVelocity.init(),this.angularVelocity.init(),this.sleepPosition.copy(this.position),this.sleepOrientation.copy(this.orientation),this.sleepTime=0,this.sleeping=!0;for(var i=this.shapes;null!=i;i=i.next)i.updateProxy()}},isLonely:function(){return 0==this.numJoints&&0==this.numContacts},updatePosition:function(i){switch(this.type){case this.BODY_STATIC:this.linearVelocity.init(),this.angularVelocity.init(),this.controlPos&&(this.position.copy(this.newPosition),this.controlPos=!1),this.controlRot&&(this.orientation.copy(this.newOrientation),this.controlRot=!1);break;case this.BODY_DYNAMIC:this.controlPos&&(this.angularVelocity.init(),this.linearVelocity.init(),this.linearVelocity.x=(this.newPosition.x-this.position.x)/i,this.linearVelocity.y=(this.newPosition.y-this.position.y)/i,this.linearVelocity.z=(this.newPosition.z-this.position.z)/i,this.controlPos=!1),this.controlRot&&(this.angularVelocity.init(),this.orientation.copy(this.newOrientation),this.controlRot=!1),this.position.addTime(this.linearVelocity,i),this.orientation.addTime(this.angularVelocity,i);break;default:throw new Error("Invalid type.")}this.syncShapes()},rotateInertia:function(i,t,s){var h=i.elements,e=t.elements,a=h[0],o=h[3],n=h[6],l=h[1],r=h[4],m=h[7],c=h[2],x=h[5],p=h[8],u=e[0],y=e[3],d=e[6],O=e[1],N=e[4],M=e[7],I=e[2],v=e[5],z=e[8],f=a*u+l*y+c*d,b=a*O+l*N+c*M,A=a*I+l*v+c*z,k=o*u+r*y+x*d,g=o*O+r*N+x*M,S=o*I+r*v+x*z,w=n*u+m*y+p*d,L=n*O+m*N+p*M,P=n*I+m*v+p*z,V=s.elements;V[0]=f*a+b*l+A*c,V[1]=f*o+b*r+A*x,V[2]=f*n+b*m+A*p,V[3]=k*a+g*l+S*c,V[4]=k*o+g*r+S*x,V[5]=k*n+g*m+S*p,V[6]=w*a+L*l+P*c,V[7]=w*o+L*r+P*x,V[8]=w*n+L*m+P*p},syncShapes:function(){var i=this.orientation.s,t=this.orientation.x,s=this.orientation.y,h=this.orientation.z,e=2*t,a=2*s,o=2*h,n=t*e,l=s*a,r=h*o,m=t*a,c=s*o,x=t*o,p=i*e,u=i*a,y=i*o,d=this.rotation.elements;d[0]=1-l-r,d[1]=m-y,d[2]=x+u,d[3]=m+y,d[4]=1-n-r,d[5]=c-p,d[6]=x-u,d[7]=c+p,d[8]=1-n-l,this.rotateInertia(this.rotation,this.inverseLocalInertia,this.inverseInertia);for(var O=this.shapes;null!=O;O=O.next)O.position.mul(this.position,O.relativePosition,this.rotation),O.rotation.mul(O.relativeRotation,this.rotation),O.updateProxy()},applyImpulse:function(i,t){this.linearVelocity.addScale(t,this.inverseMass);var s=new OIMO.Vec3;s.sub(i,this.position).cross(s,t).mulMat(this.inverseInertia,s),this.angularVelocity.addEqual(s)},rotationVectToQuad:function(i){var t=OIMO.EulerToAxis(i.x*OIMO.TO_RAD,i.y*OIMO.TO_RAD,i.z*OIMO.TO_RAD);return this.rotationAxisToQuad(t[0],t[1],t[2],t[3])},rotationAxisToQuad:function(i,t,s,h){var e=t*t+s*s+h*h;e>0&&(e=1/Math.sqrt(e),t*=e,s*=e,h*=e);var a=Math.sin(.5*i),o=Math.cos(.5*i);return new OIMO.Quat(o,a*t,a*s,a*h)},setPosition:function(i){this.newPosition.init(i.x*OIMO.INV_SCALE,i.y*OIMO.INV_SCALE,i.z*OIMO.INV_SCALE),this.controlPos=!0},setQuaternion:function(i){this.newOrientation.init(i.w,i.x,i.y,i.z),this.controlRot=!0},setRotation:function(i){this.newOrientation=this.rotationVectToQuad(i),this.controlRot=!0},resetPosition:function(i,t,s){this.linearVelocity.init(),this.angularVelocity.init(),this.position.init(i*OIMO.INV_SCALE,t*OIMO.INV_SCALE,s*OIMO.INV_SCALE),this.awake()},resetQuaternion:function(i){this.angularVelocity.init(),this.orientation=new OIMO.Quat(i.w,i.x,i.y,i.z),this.awake()},resetRotation:function(i,t,s){this.angularVelocity.init(),this.orientation=this.rotationVectToQuad(new OIMO.Vec3(i,t,s)),this.awake()},getPosition:function(){return(new OIMO.Vec3).scale(this.position,OIMO.WORLD_SCALE)},getRotation:function(){return(new OIMO.Euler).setFromRotationMatrix(this.rotation)},getQuaternion:function(){return(new OIMO.Quaternion).setFromRotationMatrix(this.rotation)},getMatrix:function(){var i,t,s=this.matrix.elements;return this.sleeping?s[15]=1:(i=this.rotation.elements,s[0]=i[0],s[1]=i[3],s[2]=i[6],s[3]=0,s[4]=i[1],s[5]=i[4],s[6]=i[7],s[7]=0,s[8]=i[2],s[9]=i[5],s[10]=i[8],s[11]=0,t=this.position,s[12]=t.x*OIMO.WORLD_SCALE,s[13]=t.y*OIMO.WORLD_SCALE,s[14]=t.z*OIMO.WORLD_SCALE,s[15]=0),s}},OIMO.Body=function(i){var t=i||{};if(t.world){this.parent=t.world,this.name=t.name||"";var s=t.move||!1,h=t.noSleep||!1,e=t.pos||[0,0,0];e=e.map(function(i){return i*OIMO.INV_SCALE});var a=t.size||[1,1,1];a=a.map(function(i){return i*OIMO.INV_SCALE});var o=t.rot||[0,0,0];o=o.map(function(i){return i*OIMO.TO_RAD});for(var n=[],l=0;l<o.length/3;l++){var r=OIMO.EulerToAxis(o[l+0],o[l+1],o[l+2]);n.push(r[0]),n.push(r[1]),n.push(r[2]),n.push(r[3])}var m=t.sc||new OIMO.ShapeConfig;t.config&&(m.density=t.config[0]||1,m.friction=t.config[1]||.4,m.restitution=t.config[2]||.2,m.belongsTo=t.config[3]||1,m.collidesWith=t.config[4]||4294967295),t.massPos&&(t.massPos=t.massPos.map(function(i){return i*OIMO.INV_SCALE}),m.relativePosition.init(t.massPos[0],t.massPos[1],t.massPos[2])),t.massRot&&(t.massRot=t.massRot.map(function(i){return i*OIMO.TO_RAD}),m.relativeRotation=OIMO.EulerToMatrix(t.massRot[0],t.massRot[1],t.massRot[2])),this.body=new OIMO.RigidBody(e[0],e[1],e[2],n[0],n[1],n[2],n[3]);var c=[],x=t.type||"box";"string"==typeof x&&(x=[x]);for(var p,u,l=0;l<x.length;l++){switch(p=3*l,u=4*l,x[l]){case"sphere":c[l]=new OIMO.SphereShape(m,a[p+0]);break;case"cylinder":c[l]=new OIMO.BoxShape(m,a[p+0],a[p+1],a[p+2]);break;case"box":c[l]=new OIMO.BoxShape(m,a[p+0],a[p+1],a[p+2])}this.body.addShape(c[l]),l>0&&(c[l].relativePosition=new OIMO.Vec3(e[p+0],e[p+1],e[p+2]),n[u+0]&&(c[l].relativeRotation=[n[u+0],n[u+1],n[u+2],n[u+3]]))}s?(t.massPos||t.massRot?this.body.setupMass(1,!1):this.body.setupMass(1,!0),h?this.body.allowSleep=!1:this.body.allowSleep=!0):this.body.setupMass(2),this.body.name=this.name,this.sleeping=this.body.sleeping,this.parent.addRigidBody(this.body)}},OIMO.Body.prototype={constructor:OIMO.Body,setPosition:function(i){this.body.setPosition(i)},setQuaternion:function(i){this.body.setQuaternion(i)},setRotation:function(i){this.body.setRotation(i)},getPosition:function(){return this.body.getPosition()},getRotation:function(){return this.body.getRotation()},getQuaternion:function(){return this.body.getQuaternion()},getMatrix:function(){return this.body.getMatrix()},getSleep:function(){return this.body.sleeping},resetPosition:function(i,t,s){this.body.resetPosition(i,t,s)},resetRotation:function(i,t,s){this.body.resetRotation(i,t,s)},awake:function(){this.body.awake()},remove:function(){this.parent.removeRigidBody(this.body)},checkContact:function(i){this.parent.checkContact(this.name,i)}},OIMO.Link=function(i){var t=i||{};if(t.world){this.parent=t.world,this.name=t.name||"";var s=t.type||"jointHinge",h=t.axe1||[1,0,0],e=t.axe2||[1,0,0],a=t.pos1||[0,0,0],o=t.pos2||[0,0,0];a=a.map(function(i){return i*OIMO.INV_SCALE}),o=o.map(function(i){return i*OIMO.INV_SCALE});var n,l;"jointDistance"===s?(n=t.min||0,l=t.max||10,n*=OIMO.INV_SCALE,l*=OIMO.INV_SCALE):(n=t.min||57.29578,l=t.max||0,n*=OIMO.TO_RAD,l*=OIMO.TO_RAD);var r=t.limit||null,m=t.spring||null,c=t.motor||null,x=new OIMO.JointConfig;switch(x.allowCollision=t.collision||!1,x.localAxis1.init(h[0],h[1],h[2]),x.localAxis2.init(e[0],e[1],e[2]),x.localAnchorPoint1.init(a[0],a[1],a[2]),x.localAnchorPoint2.init(o[0],o[1],o[2]),("string"==typeof t.body1||t.body1 instanceof String)&&(t.body1=t.world.getByName(t.body1)),("string"==typeof t.body2||t.body2 instanceof String)&&(t.body2=t.world.getByName(t.body2)),x.body1=t.body1,x.body2=t.body2,s){case"jointDistance":this.joint=new OIMO.DistanceJoint(x,n,l),null!==m&&this.joint.limitMotor.setSpring(m[0],m[1]),null!==c&&this.joint.limitMotor.setSpring(c[0],c[1]);break;case"jointHinge":this.joint=new OIMO.HingeJoint(x,n,l),null!==m&&this.joint.limitMotor.setSpring(m[0],m[1]),null!==c&&this.joint.limitMotor.setSpring(c[0],c[1]);break;case"jointPrisme":this.joint=new OIMO.PrismaticJoint(x,n,l);break;case"jointSlide":this.joint=new OIMO.SliderJoint(x,n,l);break;case"jointBall":this.joint=new OIMO.BallAndSocketJoint(x);break;case"jointWheel":this.joint=new OIMO.WheelJoint(x),null!==r&&this.joint.rotationalLimitMotor1.setLimit(r[0],r[1]),null!==m&&this.joint.rotationalLimitMotor1.setSpring(m[0],m[1]),null!==c&&this.joint.rotationalLimitMotor1.setSpring(c[0],c[1])}this.joint.name=this.name,this.parent.addJoint(this.joint)}},OIMO.Link.prototype={constructor:OIMO.Link,getPosition:function(){return this.joint.getPosition()},getMatrix:function(){return this.joint.getMatrix()},remove:function(){this.parent.removeJoint(this.joint)},awake:function(){this.joint.awake()}},OIMO.Performance=function(i){this.parent=i,this.infos=new OIMO_ARRAY_TYPE(13),this.f=[0,0,0],this.fps=0,this.broadPhaseTime=0,this.narrowPhaseTime=0,this.solvingTime=0,this.updatingTime=0,this.totalTime=0},OIMO.Performance.prototype={upfps:function(){this.f[1]=Date.now(),this.f[1]-1e3>this.f[0]&&(this.f[0]=this.f[1],this.fps=this.f[2],this.f[2]=0),this.f[2]++},show:function(){var i=["Oimo.js DEV.1.1.2a<br><br>","FPS: "+this.fps+" fps<br><br>","rigidbody "+this.parent.numRigidBodies+"<br>","contact &nbsp;&nbsp;"+this.parent.numContacts+"<br>","paircheck "+this.parent.broadPhase.numPairChecks+"<br>","contact &nbsp;&nbsp;"+this.parent.numContactPoints+"<br>","island &nbsp;&nbsp;&nbsp;"+this.parent.numIslands+"<br><br>","Time in ms <br>","broad-phase &nbsp;"+this.broadPhaseTime+"<br>","narrow-phase "+this.narrowPhaseTime+"<br>","solving &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+this.solvingTime+"<br>","updating &nbsp;&nbsp;&nbsp;&nbsp;"+this.updatingTime+"<br>","total &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+this.totalTime].join("\n");return i},toArray:function(){return this.infos[0]=this.parent.broadPhase.types,this.infos[1]=this.parent.numRigidBodies,this.infos[2]=this.parent.numContacts,this.infos[3]=this.parent.broadPhase.numPairChecks,this.infos[4]=this.parent.numContactPoints,this.infos[5]=this.parent.numIslands,this.infos[6]=this.broadPhaseTime,this.infos[7]=this.narrowPhaseTime,this.infos[8]=this.solvingTime,this.infos[9]=this.updatingTime,this.infos[10]=this.totalTime,this.infos[11]=this.fps,this.infos}},OIMO.Mat44=function(i,t,s,h,e,a,o,n,l,r,m,c,x,p,u,y){this.elements=new OIMO_ARRAY_TYPE(16);var d=this.elements;d[0]=void 0!==i?i:1,d[4]=t||0,d[8]=s||0,d[12]=h||0,d[1]=e||0,d[5]=void 0!==a?a:1,d[9]=o||0,d[13]=n||0,d[2]=l||0,d[6]=r||0,d[10]=void 0!==m?m:1,d[14]=c||0,d[3]=x||0,d[7]=p||0,d[11]=u||0,d[15]=void 0!==y?y:1},OIMO.Mat44.prototype={constructor:OIMO.Mat44,set:function(i,t,s,h,e,a,o,n,l,r,m,c,x,p,u,y){var d=this.elements;return d[0]=i,d[4]=t,d[8]=s,d[12]=h,d[1]=e,d[5]=a,d[9]=o,d[13]=n,d[2]=l,d[6]=r,d[10]=m,d[14]=c,d[3]=x,d[7]=p,d[11]=u,d[15]=y,this}},OIMO.Mat33=function(i,t,s,h,e,a,o,n,l){this.elements=new OIMO_ARRAY_TYPE(9);this.elements;this.init(void 0!==i?i:1,t||0,s||0,h||0,void 0!==e?e:1,a||0,o||0,n||0,void 0!==l?l:1)},OIMO.Mat33.prototype={constructor:OIMO.Mat33,init:function(i,t,s,h,e,a,o,n,l){var r=this.elements;return r[0]=i,r[1]=t,r[2]=s,r[3]=h,r[4]=e,r[5]=a,r[6]=o,r[7]=n,r[8]=l,this},add:function(i,t){var s=this.elements,h=i.elements,e=t.elements;return s[0]=h[0]+e[0],s[1]=h[1]+e[1],s[2]=h[2]+e[2],s[3]=h[3]+e[3],s[4]=h[4]+e[4],s[5]=h[5]+e[5],s[6]=h[6]+e[6],s[7]=h[7]+e[7],s[8]=h[8]+e[8],this},addEqual:function(i){var t=this.elements,s=i.elements;return t[0]+=s[0],t[1]+=s[1],t[2]+=s[2],t[3]+=s[3],t[4]+=s[4],t[5]+=s[5],t[6]+=s[6],t[7]+=s[7],t[8]+=s[8],this},sub:function(i,t){var s=this.elements,h=i.elements,e=t.elements;return s[0]=h[0]-e[0],s[1]=h[1]-e[1],s[2]=h[2]-e[2],s[3]=h[3]-e[3],s[4]=h[4]-e[4],s[5]=h[5]-e[5],s[6]=h[6]-e[6],s[7]=h[7]-e[7],s[8]=h[8]-e[8],this},subEqual:function(i){var t=this.elements,s=i.elements;return t[0]-=s[0],t[1]-=s[1],t[2]-=s[2],t[3]-=s[3],t[4]-=s[4],t[5]-=s[5],t[6]-=s[6],t[7]-=s[7],t[8]-=s[8],this},scale:function(i,t){var s=this.elements,h=i.elements;return s[0]=h[0]*t,s[1]=h[1]*t,s[2]=h[2]*t,s[3]=h[3]*t,s[4]=h[4]*t,s[5]=h[5]*t,s[6]=h[6]*t,s[7]=h[7]*t,s[8]=h[8]*t,this},scaleEqual:function(i){var t=this.elements;return t[0]*=i,t[1]*=i,t[2]*=i,t[3]*=i,t[4]*=i,t[5]*=i,t[6]*=i,t[7]*=i,t[8]*=i,this},mul:function(i,t){var s=this.elements,h=i.elements,e=t.elements,a=h[0],o=h[3],n=h[6],l=h[1],r=h[4],m=h[7],c=h[2],x=h[5],p=h[8],u=e[0],y=e[3],d=e[6],O=e[1],N=e[4],M=e[7],I=e[2],v=e[5],z=e[8];return s[0]=a*u+l*y+c*d,s[1]=a*O+l*N+c*M,s[2]=a*I+l*v+c*z,s[3]=o*u+r*y+x*d,s[4]=o*O+r*N+x*M,s[5]=o*I+r*v+x*z,s[6]=n*u+m*y+p*d,s[7]=n*O+m*N+p*M,s[8]=n*I+m*v+p*z,this},mulScale:function(i,t,s,h,e){var a=e||!1,o=this.elements,n=i.elements;return a?(o[0]=t*n[0],o[1]=t*n[1],o[2]=t*n[2],o[3]=s*n[3],o[4]=s*n[4],o[5]=s*n[5],o[6]=h*n[6],o[7]=h*n[7],o[8]=h*n[8]):(o[0]=n[0]*t,o[1]=n[1]*s,o[2]=n[2]*h,o[3]=n[3]*t,o[4]=n[4]*s,o[5]=n[5]*h,o[6]=n[6]*t,o[7]=n[7]*s,o[8]=n[8]*h),this},mulRotate:function(i,t,s,h,e,a){var o=a||!1,n=Math.sin(t),l=Math.cos(t),r=1-l,m=s*s*r+l,c=s*h*r-e*n,x=s*e*r+h*n,p=h*s*r+e*n,u=h*h*r+l,y=h*e*r-s*n,d=e*s*r-h*n,O=e*h*r+s*n,N=e*e*r+l,M=i.elements,I=M[0],v=M[3],z=M[6],f=M[1],b=M[4],A=M[7],k=M[2],g=M[5],S=M[8],w=this.elements;return o?(w[0]=m*I+c*v+x*z,w[1]=m*f+c*b+x*A,w[2]=m*k+c*g+x*S,w[3]=p*I+u*v+y*z,w[4]=p*f+u*b+y*A,w[5]=p*k+u*g+y*S,w[6]=d*I+O*v+N*z,w[7]=d*f+O*b+N*A,w[8]=d*k+O*g+N*S):(w[0]=I*m+f*p+k*d,w[1]=I*c+f*u+k*O,w[2]=I*x+f*y+k*N,w[3]=v*m+b*p+g*d,w[4]=v*c+b*u+g*O,w[5]=v*x+b*y+g*N,w[6]=z*m+A*p+S*d,w[7]=z*c+A*u+S*O,w[8]=z*x+A*y+S*N),this},transpose:function(i){var t=this.elements,s=i.elements;return t[0]=s[0],t[1]=s[3],t[2]=s[6],t[3]=s[1],t[4]=s[4],t[5]=s[7],t[6]=s[2],t[7]=s[5],t[8]=s[8],this},setQuat:function(i){var t=this.elements,s=2*i.x,h=2*i.y,e=2*i.z,a=i.x*s,o=i.y*h,n=i.z*e,l=i.x*h,r=i.y*e,m=i.x*e,c=i.s*s,x=i.s*h,p=i.s*e;return t[0]=1-o-n,t[1]=l-p,t[2]=m+x,t[3]=l+p,t[4]=1-a-n,t[5]=r-c,t[6]=m-x,t[7]=r+c,t[8]=1-a-o,this},invert:function(i){var t=this.elements,s=i.elements,h=s[0],e=s[3],a=s[6],o=s[1],n=s[4],l=s[7],r=s[2],m=s[5],c=s[8],x=n*c-l*m,p=l*r-o*c,u=o*m-n*r,y=h*x+e*p+a*u;return 0!=y&&(y=1/y),t[0]=y*x,t[1]=y*p,t[2]=y*u,t[3]=y*(m*a-e*c),t[4]=y*(h*c-r*a),t[5]=y*(r*e-h*m),t[6]=y*(e*l-n*a),t[7]=y*(o*a-h*l),t[8]=y*(h*n-o*e),this},copy:function(i){var t=this.elements,s=i.elements;return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],this},toEuler:function(){function i(i){return Math.min(Math.max(i,-1),1)}var t=this.elements,s=t[0],h=t[3],e=t[6],a=(t[1],t[4]),o=t[7],n=(t[2],t[5]),l=t[8],r=new OIMO.Vec3;new OIMO.Quat;return r.y=Math.asin(i(e)),Math.abs(e)<.99999?(r.x=Math.atan2(-o,l),r.z=Math.atan2(-h,s)):(r.x=Math.atan2(n,a),r.z=0),r},clone:function(){var i=this.elements;return new OIMO.Mat33(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},toString:function(){var i=this.elements,t="Mat33|"+i[0].toFixed(4)+", "+i[1].toFixed(4)+", "+i[2].toFixed(4)+"|\n     |"+i[3].toFixed(4)+", "+i[4].toFixed(4)+", "+i[5].toFixed(4)+"|\n     |"+i[6].toFixed(4)+", "+i[7].toFixed(4)+", "+i[8].toFixed(4)+"|";return t}},OIMO.Quat=function(i,t,s,h){this.s=void 0!==i?i:1,this.x=t||0,this.y=s||0,this.z=h||0},OIMO.Quat.prototype={constructor:OIMO.Quat,init:function(i,t,s,h){return this.s=void 0!==i?i:1,this.x=t||0,this.y=s||0,this.z=h||0,this},add:function(i,t){return this.s=i.s+t.s,this.x=i.x+t.x,this.y=i.y+t.y,this.z=i.z+t.z,this},addTime:function(i,t){var s=i.x,h=i.y,e=i.z,a=this.s,o=this.x,n=this.y,l=this.z;t*=.5;var r=(-s*o-h*n-e*l)*t,m=(s*a+h*l-e*n)*t,c=(-s*l+h*a+e*o)*t,x=(s*n-h*o+e*a)*t;a+=r,o+=m,n+=c,l+=x;var p=1/Math.sqrt(a*a+o*o+n*n+l*l);return this.s=a*p,this.x=o*p,this.y=n*p,this.z=l*p,this},sub:function(i,t){return this.s=i.s-t.s,this.x=i.x-t.x,this.y=i.y-t.y,this.z=i.z-t.z,this},scale:function(i,t){return this.s=i.s*t,this.x=i.x*t,this.y=i.y*t,this.z=i.z*t,this},mul:function(i,t){var s=i.x,h=i.y,e=i.z,a=i.s,o=t.x,n=t.y,l=t.z,r=t.s;return this.x=s*r+a*o+h*l-e*n,this.y=h*r+a*n+e*o-s*l,this.z=e*r+a*l+s*n-h*o,this.s=a*r-s*o-h*n-e*l,this},arc:function(i,t){var s=i.x,h=i.y,e=i.z,a=t.x,o=t.y,n=t.z,l=s*a+h*o+e*n;if(-1==l)return a=h*s-e*e,o=-e*h-s*s,n=s*e+h*h,l=1/Math.sqrt(a*a+o*o+n*n),this.s=0,this.x=a*l,this.y=o*l,this.z=n*l,this;var r=h*n-e*o,m=e*a-s*n,c=s*o-h*a;return this.s=Math.sqrt(.5*(1+l)),l=.5/this.s,this.x=r*l,this.y=m*l,this.z=c*l,this},normalize:function(i){var t=Math.sqrt(i.s*i.s+i.x*i.x+i.y*i.y+i.z*i.z);return t>0&&(t=1/t),this.s=i.s*t,this.x=i.x*t,this.y=i.y*t,this.z=i.z*t,this},invert:function(i){return this.s=i.s,this.x=-i.x,this.y=-i.y,this.z=-i.z,this},length:function(){return Math.sqrt(this.s*this.s+this.x*this.x+this.y*this.y+this.z*this.z)},copy:function(i){return this.s=i.s,this.x=i.x,this.y=i.y,this.z=i.z,this},testDiff:function(i){return this.s!==i.s||this.x!==i.x||this.y!==i.y||this.z!==i.z?!0:!1},clone:function(i){return new OIMO.Quat(this.s,this.x,this.y,this.z)},toString:function(){return"Quat["+this.s.toFixed(4)+", ("+this.x.toFixed(4)+", "+this.y.toFixed(4)+", "+this.z.toFixed(4)+")]"}},OIMO.Quaternion=function(i,t,s,h){this.x=i||0,this.y=t||0,this.z=s||0,this.w=void 0!==h?h:1},OIMO.Quaternion.prototype={constructor:OIMO.Quaternion,setFromRotationMatrix:function(i){var t,s=i.elements,h=s[0],e=s[1],a=s[2],o=s[3],n=s[4],l=s[5],r=s[6],m=s[7],c=s[8],x=h+n+c;return x>0?(t=.5/Math.sqrt(x+1),this.w=.25/t,this.x=(m-l)*t,this.y=(a-r)*t,this.z=(o-e)*t):h>n&&h>c?(t=2*Math.sqrt(1+h-n-c),this.w=(m-l)/t,this.x=.25*t,this.y=(e+o)/t,this.z=(a+r)/t):n>c?(t=2*Math.sqrt(1+n-h-c),this.w=(a-r)/t,this.x=(e+o)/t,this.y=.25*t,this.z=(l+m)/t):(t=2*Math.sqrt(1+c-h-n),this.w=(o-e)/t,this.x=(a+r)/t,this.y=(l+m)/t,this.z=.25*t),this}},OIMO.Vec3=function(i,t,s){this.x=i||0,this.y=t||0,this.z=s||0},OIMO.Vec3.prototype={constructor:OIMO.Vec3,init:function(i,t,s){return this.x=i||0,this.y=t||0,this.z=s||0,this},set:function(i,t,s){return this.x=i,this.y=t,this.z=s,this},add:function(i,t){return this.x=i.x+t.x,this.y=i.y+t.y,this.z=i.z+t.z,this},addEqual:function(i){return this.x+=i.x,this.y+=i.y,this.z+=i.z,this},addTime:function(i,t){return this.x+=i.x*t,this.y+=i.y*t,this.z+=i.z*t,this},sub:function(i,t){return this.x=i.x-t.x,this.y=i.y-t.y,this.z=i.z-t.z,this},subEqual:function(i){return this.x-=i.x,this.y-=i.y,this.z-=i.z,this},addScale:function(i,t){return this.x+=i.x*t,this.y+=i.y*t,this.z+=i.z*t,this},scale:function(i,t){return this.x=i.x*t,this.y=i.y*t,this.z=i.z*t,this},scaleEqual:function(i){return this.x*=i,this.y*=i,this.z*=i,this},dot:function(i){return this.x*i.x+this.y*i.y+this.z*i.z},cross:function(i,t){var s=i.x,h=i.y,e=i.z,a=t.x,o=t.y,n=t.z;return this.x=h*n-e*o,this.y=e*a-s*n,this.z=s*o-h*a,this},mul:function(i,t,s){var h=s.elements;return this.x=i.x+t.x*h[0]+t.y*h[1]+t.z*h[2],this.y=i.y+t.x*h[3]+t.y*h[4]+t.z*h[5],this.z=i.z+t.x*h[6]+t.y*h[7]+t.z*h[8],this},mulMat:function(i,t){var s=i.elements,h=s[0]*t.x+s[1]*t.y+s[2]*t.z,e=s[3]*t.x+s[4]*t.y+s[5]*t.z,a=s[6]*t.x+s[7]*t.y+s[8]*t.z;return this.x=h,this.y=e,this.z=a,this},normalize:function(i){var t=i.x,s=i.y,h=i.z,e=t*t+s*s+h*h;return e>0&&(e=1/Math.sqrt(e),this.x=t*e,this.y=s*e,this.z=h*e),this},invert:function(i){return this.x=-i.x,this.y=-i.y,this.z=-i.z,this},length:function(){var i=this.x,t=this.y,s=this.z;return Math.sqrt(i*i+t*t+s*s)},len:function(){var i=this.x,t=this.y,s=this.z;return i*i+t*t+s*s},copy:function(i){return this.x=i.x,this.y=i.y,this.z=i.z,this},applyQuaternion:function(i){var t=this.x,s=this.y,h=this.z,e=i.x,a=i.y,o=i.z,n=i.s,l=n*t+a*h-o*s,r=n*s+o*t-e*h,m=n*h+e*s-a*t,c=-e*t-a*s-o*h;return this.x=l*n+c*-e+r*-o-m*-a,this.y=r*n+c*-a+m*-e-l*-o,this.z=m*n+c*-o+l*-a-r*-e,this},testZero:function(){return 0!==this.x||0!==this.y||0!==this.z?!0:!1},testDiff:function(i){return this.x!==i.x||this.y!==i.y||this.z!==i.z?!0:!1},clone:function(){return new OIMO.Vec3(this.x,this.y,this.z)},toString:function(){return"Vec3["+this.x.toFixed(4)+", "+this.y.toFixed(4)+", "+this.z.toFixed(4)+"]"}},OIMO.Euler=function(i,t,s,h){this._x=i||0,this._y=t||0,this._z=s||0,this._order=h||OIMO.Euler.DefaultOrder},OIMO.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],OIMO.Euler.DefaultOrder="XYZ",OIMO.clamp=function(i,t,s){return t>i?t:i>s?s:i},OIMO.Euler.prototype={constructor:OIMO.Euler,_x:0,_y:0,_z:0,_order:OIMO.Euler.DefaultOrder,get x(){return this._x},set x(i){this._x=i,this.onChangeCallback()},get y(){return this._y},set y(i){this._y=i,this.onChangeCallback()},get z(){return this._z},set z(i){this._z=i,this.onChangeCallback()},get order(){return this._order},set order(i){this._order=i,this.onChangeCallback()},set:function(i,t,s,h){return this._x=i,this._y=t,this._z=s,this._order=h||this._order,
this.onChangeCallback(),this},copy:function(i){return this._x=i._x,this._y=i._y,this._z=i._z,this._order=i._order,this.onChangeCallback(),this},setFromRotationMatrix:function(i,t){var s=OIMO.clamp,h=i.elements,e=h[0],a=h[1],o=h[2],n=h[3],l=h[4],r=h[5],m=h[6],c=h[7],x=h[8];return t=t||this._order,"XYZ"===t?(this._y=Math.asin(s(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-r,x),this._z=Math.atan2(-a,e)):(this._x=Math.atan2(c,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-s(r,-1,1)),Math.abs(r)<.99999?(this._y=Math.atan2(o,x),this._z=Math.atan2(n,l)):(this._y=Math.atan2(-m,e),this._z=0)):"ZXY"===t?(this._x=Math.asin(s(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(-m,x),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(n,e))):"ZYX"===t?(this._y=Math.asin(-s(m,-1,1)),Math.abs(m)<.99999?(this._x=Math.atan2(c,x),this._z=Math.atan2(n,e)):(this._x=0,this._z=Math.atan2(-a,l))):"YZX"===t?(this._z=Math.asin(s(n,-1,1)),Math.abs(n)<.99999?(this._x=Math.atan2(-r,l),this._y=Math.atan2(-m,e)):(this._x=0,this._y=Math.atan2(o,x))):"XZY"===t?(this._z=Math.asin(-s(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(c,l),this._y=Math.atan2(o,e)):(this._x=Math.atan2(-r,x),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,this.onChangeCallback(),this},setFromQuaternion:function(i,t,s){var h=OIMO.clamp,e=i.x*i.x,a=i.y*i.y,o=i.z*i.z,n=i.s*i.s;return t=t||this._order,"XYZ"===t?(this._x=Math.atan2(2*(i.x*i.s-i.y*i.z),n-e-a+o),this._y=Math.asin(h(2*(i.x*i.z+i.y*i.s),-1,1)),this._z=Math.atan2(2*(i.z*i.s-i.x*i.y),n+e-a-o)):"YXZ"===t?(this._x=Math.asin(h(2*(i.x*i.s-i.y*i.z),-1,1)),this._y=Math.atan2(2*(i.x*i.z+i.y*i.s),n-e-a+o),this._z=Math.atan2(2*(i.x*i.y+i.z*i.s),n-e+a-o)):"ZXY"===t?(this._x=Math.asin(h(2*(i.x*i.s+i.y*i.z),-1,1)),this._y=Math.atan2(2*(i.y*i.s-i.z*i.x),n-e-a+o),this._z=Math.atan2(2*(i.z*i.s-i.x*i.y),n-e+a-o)):"ZYX"===t?(this._x=Math.atan2(2*(i.x*i.s+i.z*i.y),n-e-a+o),this._y=Math.asin(h(2*(i.y*i.s-i.x*i.z),-1,1)),this._z=Math.atan2(2*(i.x*i.y+i.z*i.s),n+e-a-o)):"YZX"===t?(this._x=Math.atan2(2*(i.x*i.s-i.z*i.y),n-e+a-o),this._y=Math.atan2(2*(i.y*i.s-i.x*i.z),n+e-a-o),this._z=Math.asin(h(2*(i.x*i.y+i.z*i.s),-1,1))):"XZY"===t?(this._x=Math.atan2(2*(i.x*i.s+i.y*i.z),n-e+a-o),this._y=Math.atan2(2*(i.x*i.z+i.y*i.s),n+e-a-o),this._z=Math.asin(h(2*(i.z*i.s-i.x*i.y),-1,1))):console.warn("OIMO.Euler: .setFromQuaternion() given unsupported order: "+t),this._order=t,s!==!1&&this.onChangeCallback(),this},reorder:function(){var i=new OIMO.Quat;return function(t){i.setFromEuler(this),this.setFromQuaternion(i,t)}}(),equals:function(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._order===this._order},fromArray:function(i){return this._x=i[0],this._y=i[1],this._z=i[2],void 0!==i[3]&&(this._order=i[3]),this.onChangeCallback(),this},toArray:function(){return[this._x,this._y,this._z,this._order]},onChange:function(i){return this.onChangeCallback=i,this},onChangeCallback:function(){},clone:function(){return new OIMO.Euler(this._x,this._y,this._z,this._order)}},OIMO.EulerToAxis=function(i,t,s){var h=Math.cos(.5*t),e=Math.sin(.5*t),a=Math.cos(.5*s),o=Math.sin(.5*s),n=Math.cos(.5*i),l=Math.sin(.5*i),r=h*a,m=e*o,c=r*n-m*l,x=r*l+m*n,p=e*a*n+h*o*l,u=h*o*n-e*a*l,y=2*Math.acos(c),d=x*x+p*p+u*u;return.001>d?(x=1,p=u=0):(d=Math.sqrt(d),x/=d,p/=d,u/=d),[y,x,p,u]},OIMO.EulerToMatrix=function(i,t,s){var h=Math.cos(t),e=Math.sin(t),a=Math.cos(s),o=Math.sin(s),n=Math.cos(i),l=Math.sin(i),r=new OIMO.Mat33,m=r.elements;return m[0]=h*a,m[1]=e*l-h*o*n,m[2]=h*o*l+e*n,m[3]=o,m[4]=a*n,m[5]=-a*l,m[6]=-e*a,m[7]=e*o*n+h*l,m[8]=-e*o*l+h*n,r},OIMO.MatrixToEuler=function(i){var t,s,h,e=i.elements;return e[3]>.998?(s=Math.atan2(e[2],e[8]),h=Math.PI/2,t=0):e[3]<-.998?(s=Math.atan2(e[2],e[8]),h=-Math.PI/2,t=0):(s=Math.atan2(-e[6],e[0]),t=Math.atan2(-e[5],e[4]),h=Math.asin(e[3])),[t,s,h]},OIMO.unwrapDegrees=function(i){return i%=360,i>180&&(i-=360),-180>i&&(i+=360),i},OIMO.unwrapRadian=function(i){return i%=OIMO.TwoPI,i>Math.PI&&(i-=OIMO.TwoPI),i<-Math.PI&&(i+=OIMO.TwoPI),i},OIMO.Distance3d=function(i,t){var s=t[0]-i[0],h=t[1]-i[1],e=t[2]-i[2];return Math.sqrt(s*s+h*h+e*e)},OIMO.Constraint=function(){this.parent=null,this.body1=null,this.body2=null,this.addedToIsland=!1},OIMO.Constraint.prototype={constructor:OIMO.Constraint,preSolve:function(i,t){throw new Error("Inheritance error.")},solve:function(){throw new Error("Inheritance error.")},postSolve:function(){throw new Error("Inheritance error.")}},OIMO.Joint=function(i){OIMO.Constraint.call(this),this.name="",this.JOINT_DISTANCE=1,this.JOINT_BALL_AND_SOCKET=2,this.JOINT_HINGE=3,this.JOINT_WHEEL=4,this.JOINT_SLIDER=5,this.JOINT_PRISMATIC=6,this.type=0,this.prev=null,this.next=null,this.body1=i.body1,this.body2=i.body2,this.localAnchorPoint1=(new OIMO.Vec3).copy(i.localAnchorPoint1),this.localAnchorPoint2=(new OIMO.Vec3).copy(i.localAnchorPoint2),this.relativeAnchorPoint1=new OIMO.Vec3,this.relativeAnchorPoint2=new OIMO.Vec3,this.anchorPoint1=new OIMO.Vec3,this.anchorPoint2=new OIMO.Vec3,this.allowCollision=i.allowCollision,this.b1Link=new OIMO.JointLink(this),this.b2Link=new OIMO.JointLink(this),this.matrix=new OIMO.Mat44},OIMO.Joint.prototype=Object.create(OIMO.Constraint.prototype),OIMO.Joint.prototype.updateAnchorPoints=function(){var i=this.body1.position,t=this.body2.position,s=this.body1.rotation.elements,h=this.body2.rotation.elements,e=this.localAnchorPoint1.x,a=this.localAnchorPoint1.y,o=this.localAnchorPoint1.z,n=this.localAnchorPoint2.x,l=this.localAnchorPoint2.y,r=this.localAnchorPoint2.z,m=e*s[0]+a*s[1]+o*s[2],c=e*s[3]+a*s[4]+o*s[5],x=e*s[6]+a*s[7]+o*s[8],p=n*h[0]+l*h[1]+r*h[2],u=n*h[3]+l*h[4]+r*h[5],y=n*h[6]+l*h[7]+r*h[8];this.relativeAnchorPoint1.x=m,this.relativeAnchorPoint1.y=c,this.relativeAnchorPoint1.z=x,this.relativeAnchorPoint2.x=p,this.relativeAnchorPoint2.y=u,this.relativeAnchorPoint2.z=y;var d=m+i.x,O=c+i.y,N=x+i.z,M=p+t.x,I=u+t.y,v=y+t.z;this.anchorPoint1.x=d,this.anchorPoint1.y=O,this.anchorPoint1.z=N,this.anchorPoint2.x=M,this.anchorPoint2.y=I,this.anchorPoint2.z=v},OIMO.Joint.prototype.attach=function(){this.b1Link.body=this.body2,this.b2Link.body=this.body1,null!=this.body1.jointLink?(this.b1Link.next=this.body1.jointLink).prev=this.b1Link:this.b1Link.next=null,this.body1.jointLink=this.b1Link,this.body1.numJoints++,null!=this.body2.jointLink?(this.b2Link.next=this.body2.jointLink).prev=this.b2Link:this.b2Link.next=null,this.body2.jointLink=this.b2Link,this.body2.numJoints++},OIMO.Joint.prototype.detach=function(){var i=this.b1Link.prev,t=this.b1Link.next;null!=i&&(i.next=t),null!=t&&(t.prev=i),this.body1.jointLink==this.b1Link&&(this.body1.jointLink=t),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.body=null,this.body1.numJoints--,i=this.b2Link.prev,t=this.b2Link.next,null!=i&&(i.next=t),null!=t&&(t.prev=i),this.body2.jointLink==this.b2Link&&(this.body2.jointLink=t),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.body=null,this.body2.numJoints--,this.b1Link.body=null,this.b2Link.body=null},OIMO.Joint.prototype.awake=function(){this.body1.awake(),this.body2.awake()},OIMO.Joint.prototype.preSolve=function(i,t){},OIMO.Joint.prototype.solve=function(){},OIMO.Joint.prototype.postSolve=function(){},OIMO.Joint.prototype.getPosition=function(){var i=(new OIMO.Vec3).scale(this.anchorPoint1,OIMO.WORLD_SCALE),t=(new OIMO.Vec3).scale(this.anchorPoint2,OIMO.WORLD_SCALE);return[i,t]},OIMO.Joint.prototype.getMatrix=function(){var i=this.matrix.elements,t=this.anchorPoint1,s=this.anchorPoint2;return i[0]=t.x*OIMO.WORLD_SCALE,i[1]=t.y*OIMO.WORLD_SCALE,i[2]=t.z*OIMO.WORLD_SCALE,i[3]=0,i[4]=s.x*OIMO.WORLD_SCALE,i[5]=s.y*OIMO.WORLD_SCALE,i[6]=s.z*OIMO.WORLD_SCALE,i[7]=0,i},OIMO.JointConfig=function(){this.body1=null,this.body2=null,this.localAnchorPoint1=new OIMO.Vec3,this.localAnchorPoint2=new OIMO.Vec3,this.localAxis1=new OIMO.Vec3,this.localAxis2=new OIMO.Vec3,this.allowCollision=!1},OIMO.JointLink=function(i){this.prev=null,this.next=null,this.body=null,this.joint=i},OIMO.LimitMotor=function(i,t){this.axis=i,this.angle=0,t?this.lowerLimit=0:this.lowerLimit=1,this.upperLimit=0,this.motorSpeed=0,this.maxMotorForce=0,this.frequency=0,this.dampingRatio=0},OIMO.LimitMotor.prototype={constructor:OIMO.LimitMotor,setLimit:function(i,t){this.lowerLimit=i,this.upperLimit=t},setMotor:function(i,t){this.motorSpeed=i,this.maxMotorForce=t},setSpring:function(i,t){this.frequency=i,this.dampingRatio=t}},OIMO.BallAndSocketJoint=function(i){OIMO.Joint.call(this,i),this.type=this.JOINT_BALL_AND_SOCKET,this.lc=new OIMO.LinearConstraint(this)},OIMO.BallAndSocketJoint.prototype=Object.create(OIMO.Joint.prototype),OIMO.BallAndSocketJoint.prototype.preSolve=function(i,t){this.updateAnchorPoints(),this.lc.preSolve(i,t)},OIMO.BallAndSocketJoint.prototype.solve=function(){this.lc.solve()},OIMO.BallAndSocketJoint.prototype.postSolve=function(){},OIMO.DistanceJoint=function(i,t,s){OIMO.Joint.call(this,i),this.type=this.JOINT_DISTANCE,this.normal=new OIMO.Vec3,this.limitMotor=new OIMO.LimitMotor(this.normal,!0),this.limitMotor.lowerLimit=t,this.limitMotor.upperLimit=s,this.t=new OIMO.TranslationalConstraint(this,this.limitMotor)},OIMO.DistanceJoint.prototype=Object.create(OIMO.Joint.prototype),OIMO.DistanceJoint.prototype.preSolve=function(i,t){this.updateAnchorPoints();var s=this.anchorPoint2.x-this.anchorPoint1.x,h=this.anchorPoint2.y-this.anchorPoint1.y,e=this.anchorPoint2.z-this.anchorPoint1.z,a=Math.sqrt(s*s+h*h+e*e);a>0&&(a=1/a),this.normal.init(s*a,h*a,e*a),this.t.preSolve(i,t)},OIMO.DistanceJoint.prototype.solve=function(){this.t.solve()},OIMO.DistanceJoint.prototype.postSolve=function(){},OIMO.HingeJoint=function(i,t,s){OIMO.Joint.call(this,i),this.type=this.JOINT_HINGE,this.localAxis1=(new OIMO.Vec3).normalize(i.localAxis1),this.localAxis2=(new OIMO.Vec3).normalize(i.localAxis2);var h;this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAngAxis1X=this.localAxis1Y*this.localAxis1X-this.localAxis1Z*this.localAxis1Z,this.localAngAxis1Y=-this.localAxis1Z*this.localAxis1Y-this.localAxis1X*this.localAxis1X,this.localAngAxis1Z=this.localAxis1X*this.localAxis1Z+this.localAxis1Y*this.localAxis1Y,h=1/Math.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=h,this.localAngAxis1Y*=h,this.localAngAxis1Z*=h,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z;var e=(new OIMO.Mat33).setQuat((new OIMO.Quat).arc(this.localAxis1,this.localAxis2)),a=e.elements;this.localAngAxis2X=this.localAngAxis1X*a[0]+this.localAngAxis1Y*a[1]+this.localAngAxis1Z*a[2],this.localAngAxis2Y=this.localAngAxis1X*a[3]+this.localAngAxis1Y*a[4]+this.localAngAxis1Z*a[5],this.localAngAxis2Z=this.localAngAxis1X*a[6]+this.localAngAxis1Y*a[7]+this.localAngAxis1Z*a[8],this.nor=new OIMO.Vec3,this.tan=new OIMO.Vec3,this.bin=new OIMO.Vec3,this.limitMotor=new OIMO.LimitMotor(this.nor,!1),this.limitMotor.lowerLimit=t,this.limitMotor.upperLimit=s,this.lc=new OIMO.LinearConstraint(this),this.r3=new OIMO.Rotational3Constraint(this,this.limitMotor,new OIMO.LimitMotor(this.tan,!0),new OIMO.LimitMotor(this.bin,!0))},OIMO.HingeJoint.prototype=Object.create(OIMO.Joint.prototype),OIMO.HingeJoint.prototype.preSolve=function(i,t){var s,h,e,a;this.updateAnchorPoints(),s=this.body1.rotation.elements;var o=this.localAxis1X*s[0]+this.localAxis1Y*s[1]+this.localAxis1Z*s[2],n=this.localAxis1X*s[3]+this.localAxis1Y*s[4]+this.localAxis1Z*s[5],l=this.localAxis1X*s[6]+this.localAxis1Y*s[7]+this.localAxis1Z*s[8],r=this.localAngAxis1X*s[0]+this.localAngAxis1Y*s[1]+this.localAngAxis1Z*s[2],m=this.localAngAxis1X*s[3]+this.localAngAxis1Y*s[4]+this.localAngAxis1Z*s[5],c=this.localAngAxis1X*s[6]+this.localAngAxis1Y*s[7]+this.localAngAxis1Z*s[8];s=this.body2.rotation.elements;var x=this.localAxis2X*s[0]+this.localAxis2Y*s[1]+this.localAxis2Z*s[2],p=this.localAxis2X*s[3]+this.localAxis2Y*s[4]+this.localAxis2Z*s[5],u=this.localAxis2X*s[6]+this.localAxis2Y*s[7]+this.localAxis2Z*s[8],y=this.localAngAxis2X*s[0]+this.localAngAxis2Y*s[1]+this.localAngAxis2Z*s[2],d=this.localAngAxis2X*s[3]+this.localAngAxis2Y*s[4]+this.localAngAxis2Z*s[5],O=this.localAngAxis2X*s[6]+this.localAngAxis2Y*s[7]+this.localAngAxis2Z*s[8],N=o*this.body2.inverseMass+x*this.body1.inverseMass,M=n*this.body2.inverseMass+p*this.body1.inverseMass,I=l*this.body2.inverseMass+u*this.body1.inverseMass;h=Math.sqrt(N*N+M*M+I*I),h>0&&(h=1/h),N*=h,M*=h,I*=h;var v=M*N-I*I,z=-I*M-N*N,f=N*I+M*M;h=1/Math.sqrt(v*v+z*z+f*f),v*=h,z*=h,f*=h;var b=M*f-I*z,A=I*v-N*f,k=N*z-M*v;this.nor.init(N,M,I),this.tan.init(v,z,f),this.bin.init(b,A,k),0>N*(m*O-c*d)+M*(c*y-r*O)+I*(r*d-m*y)?this.limitMotor.angle=-this.acosClamp(r*y+m*d+c*O):this.limitMotor.angle=this.acosClamp(r*y+m*d+c*O),h=n*u-l*p,e=l*x-o*u,a=o*p-n*x,this.r3.limitMotor2.angle=v*h+z*e+f*a,this.r3.limitMotor3.angle=b*h+A*e+k*a,this.r3.preSolve(i,t),this.lc.preSolve(i,t)},OIMO.HingeJoint.prototype.solve=function(){this.r3.solve(),this.lc.solve()},OIMO.HingeJoint.prototype.postSolve=function(){},OIMO.HingeJoint.prototype.acosClamp=function(i){return i>1?0:-1>i?Math.PI:Math.acos(i)},OIMO.PrismaticJoint=function(i,t,s){OIMO.Joint.call(this,i),this.type=this.JOINT_PRISMATIC,this.localAxis1=(new OIMO.Vec3).normalize(i.localAxis1),this.localAxis2=(new OIMO.Vec3).normalize(i.localAxis2),this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z,this.nor=new OIMO.Vec3,this.tan=new OIMO.Vec3,this.bin=new OIMO.Vec3,this.ac=new OIMO.AngularConstraint(this,(new OIMO.Quat).arc(this.localAxis1,this.localAxis2)),this.limitMotor=new OIMO.LimitMotor(this.nor,!0),this.limitMotor.lowerLimit=t,this.limitMotor.upperLimit=s,this.t3=new OIMO.Translational3Constraint(this,this.limitMotor,new OIMO.LimitMotor(this.tan,!0),new OIMO.LimitMotor(this.bin,!0))},OIMO.PrismaticJoint.prototype=Object.create(OIMO.Joint.prototype),OIMO.PrismaticJoint.prototype.preSolve=function(i,t){var s,h;this.updateAnchorPoints(),s=this.body1.rotation.elements;var e=this.localAxis1X*s[0]+this.localAxis1Y*s[1]+this.localAxis1Z*s[2],a=this.localAxis1X*s[3]+this.localAxis1Y*s[4]+this.localAxis1Z*s[5],o=this.localAxis1X*s[6]+this.localAxis1Y*s[7]+this.localAxis1Z*s[8];s=this.body2.rotation.elements;var n=this.localAxis2X*s[0]+this.localAxis2Y*s[1]+this.localAxis2Z*s[2],l=this.localAxis2X*s[3]+this.localAxis2Y*s[4]+this.localAxis2Z*s[5],r=this.localAxis2X*s[6]+this.localAxis2Y*s[7]+this.localAxis2Z*s[8],m=e*this.body2.inverseMass+n*this.body1.inverseMass,c=a*this.body2.inverseMass+l*this.body1.inverseMass,x=o*this.body2.inverseMass+r*this.body1.inverseMass;h=Math.sqrt(m*m+c*c+x*x),h>0&&(h=1/h),m*=h,c*=h,x*=h;var p=c*m-x*x,u=-x*c-m*m,y=m*x+c*c;h=1/Math.sqrt(p*p+u*u+y*y),p*=h,u*=h,y*=h;var d=c*y-x*u,O=x*p-m*y,N=m*u-c*p;this.nor.init(m,c,x),this.tan.init(p,u,y),this.bin.init(d,O,N),this.ac.preSolve(i,t),this.t3.preSolve(i,t)},OIMO.PrismaticJoint.prototype.solve=function(){this.ac.solve(),this.t3.solve()},OIMO.PrismaticJoint.prototype.postSolve=function(){},OIMO.SliderJoint=function(i,t,s){OIMO.Joint.call(this,i),this.type=this.JOINT_SLIDER,this.localAxis1=(new OIMO.Vec3).normalize(i.localAxis1),this.localAxis2=(new OIMO.Vec3).normalize(i.localAxis2);var h;this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAngAxis1X=this.localAxis1Y*this.localAxis1X-this.localAxis1Z*this.localAxis1Z,this.localAngAxis1Y=-this.localAxis1Z*this.localAxis1Y-this.localAxis1X*this.localAxis1X,this.localAngAxis1Z=this.localAxis1X*this.localAxis1Z+this.localAxis1Y*this.localAxis1Y,h=1/Math.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=h,this.localAngAxis1Y*=h,this.localAngAxis1Z*=h,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z;var e=(new OIMO.Mat33).setQuat((new OIMO.Quat).arc(this.localAxis1,this.localAxis2)),a=e.elements;this.localAngAxis2X=this.localAngAxis1X*a[0]+this.localAngAxis1Y*a[1]+this.localAngAxis1Z*a[2],this.localAngAxis2Y=this.localAngAxis1X*a[3]+this.localAngAxis1Y*a[4]+this.localAngAxis1Z*a[5],this.localAngAxis2Z=this.localAngAxis1X*a[6]+this.localAngAxis1Y*a[7]+this.localAngAxis1Z*a[8],this.nor=new OIMO.Vec3,this.tan=new OIMO.Vec3,this.bin=new OIMO.Vec3,this.rotationalLimitMotor=new OIMO.LimitMotor(this.nor,!1),this.r3=new OIMO.Rotational3Constraint(this,this.rotationalLimitMotor,new OIMO.LimitMotor(this.tan,!0),new OIMO.LimitMotor(this.bin,!0)),this.translationalLimitMotor=new OIMO.LimitMotor(this.nor,!0),this.translationalLimitMotor.lowerLimit=t,this.translationalLimitMotor.upperLimit=s,this.t3=new OIMO.Translational3Constraint(this,this.translationalLimitMotor,new OIMO.LimitMotor(this.tan,!0),new OIMO.LimitMotor(this.bin,!0))},OIMO.SliderJoint.prototype=Object.create(OIMO.Joint.prototype),OIMO.SliderJoint.prototype.preSolve=function(i,t){var s,h,e,a;this.updateAnchorPoints(),s=this.body1.rotation.elements;var o=this.localAxis1X*s[0]+this.localAxis1Y*s[1]+this.localAxis1Z*s[2],n=this.localAxis1X*s[3]+this.localAxis1Y*s[4]+this.localAxis1Z*s[5],l=this.localAxis1X*s[6]+this.localAxis1Y*s[7]+this.localAxis1Z*s[8],r=this.localAngAxis1X*s[0]+this.localAngAxis1Y*s[1]+this.localAngAxis1Z*s[2],m=this.localAngAxis1X*s[3]+this.localAngAxis1Y*s[4]+this.localAngAxis1Z*s[5],c=this.localAngAxis1X*s[6]+this.localAngAxis1Y*s[7]+this.localAngAxis1Z*s[8];s=this.body2.rotation.elements;var x=this.localAxis2X*s[0]+this.localAxis2Y*s[1]+this.localAxis2Z*s[2],p=this.localAxis2X*s[3]+this.localAxis2Y*s[4]+this.localAxis2Z*s[5],u=this.localAxis2X*s[6]+this.localAxis2Y*s[7]+this.localAxis2Z*s[8],y=this.localAngAxis2X*s[0]+this.localAngAxis2Y*s[1]+this.localAngAxis2Z*s[2],d=this.localAngAxis2X*s[3]+this.localAngAxis2Y*s[4]+this.localAngAxis2Z*s[5],O=this.localAngAxis2X*s[6]+this.localAngAxis2Y*s[7]+this.localAngAxis2Z*s[8],N=o*this.body2.inverseMass+x*this.body1.inverseMass,M=n*this.body2.inverseMass+p*this.body1.inverseMass,I=l*this.body2.inverseMass+u*this.body1.inverseMass;h=Math.sqrt(N*N+M*M+I*I),h>0&&(h=1/h),N*=h,M*=h,I*=h;var v=M*N-I*I,z=-I*M-N*N,f=N*I+M*M;h=1/Math.sqrt(v*v+z*z+f*f),v*=h,z*=h,f*=h;var b=M*f-I*z,A=I*v-N*f,k=N*z-M*v;this.nor.init(N,M,I),this.tan.init(v,z,f),this.bin.init(b,A,k),0>N*(m*O-c*d)+M*(c*y-r*O)+I*(r*d-m*y)?this.rotationalLimitMotor.angle=-this.acosClamp(r*y+m*d+c*O):this.rotationalLimitMotor.angle=this.acosClamp(r*y+m*d+c*O),h=n*u-l*p,e=l*x-o*u,a=o*p-n*x,this.r3.limitMotor2.angle=v*h+z*e+f*a,this.r3.limitMotor3.angle=b*h+A*e+k*a,this.r3.preSolve(i,t),this.t3.preSolve(i,t)},OIMO.SliderJoint.prototype.solve=function(){this.r3.solve(),this.t3.solve()},OIMO.SliderJoint.prototype.postSolve=function(){},OIMO.SliderJoint.prototype.acosClamp=function(i){return i>1?0:-1>i?Math.PI:Math.acos(i)},OIMO.WheelJoint=function(i){OIMO.Joint.call(this,i),this.type=this.JOINT_WHEEL,this.localAxis1=(new OIMO.Vec3).normalize(i.localAxis1),this.localAxis2=(new OIMO.Vec3).normalize(i.localAxis2);var t;this.localAxis1X=this.localAxis1.x,this.localAxis1Y=this.localAxis1.y,this.localAxis1Z=this.localAxis1.z,this.localAxis2X=this.localAxis2.x,this.localAxis2Y=this.localAxis2.y,this.localAxis2Z=this.localAxis2.z;var s=this.localAxis1X*this.localAxis2X+this.localAxis1Y*this.localAxis2Y+this.localAxis1Z*this.localAxis2Z;if(s>-1&&1>s)this.localAngAxis1X=this.localAxis2X-s*this.localAxis1X,this.localAngAxis1Y=this.localAxis2Y-s*this.localAxis1Y,this.localAngAxis1Z=this.localAxis2Z-s*this.localAxis1Z,this.localAngAxis2X=this.localAxis1X-s*this.localAxis2X,this.localAngAxis2Y=this.localAxis1Y-s*this.localAxis2Y,this.localAngAxis2Z=this.localAxis1Z-s*this.localAxis2Z,t=1/Math.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=t,this.localAngAxis1Y*=t,this.localAngAxis1Z*=t,t=1/Math.sqrt(this.localAngAxis2X*this.localAngAxis2X+this.localAngAxis2Y*this.localAngAxis2Y+this.localAngAxis2Z*this.localAngAxis2Z),this.localAngAxis2X*=t,this.localAngAxis2Y*=t,this.localAngAxis2Z*=t;else{this.localAngAxis1X=this.localAxis1Y*this.localAxis1X-this.localAxis1Z*this.localAxis1Z,this.localAngAxis1Y=-this.localAxis1Z*this.localAxis1Y-this.localAxis1X*this.localAxis1X,this.localAngAxis1Z=this.localAxis1X*this.localAxis1Z+this.localAxis1Y*this.localAxis1Y,t=1/Math.sqrt(this.localAngAxis1X*this.localAngAxis1X+this.localAngAxis1Y*this.localAngAxis1Y+this.localAngAxis1Z*this.localAngAxis1Z),this.localAngAxis1X*=t,this.localAngAxis1Y*=t,this.localAngAxis1Z*=t;var h=(new OIMO.Mat33).setQuat((new OIMO.Quat).arc(this.localAxis1,this.localAxis2)),e=h.elements;this.localAngAxis2X=this.localAngAxis1X*e[0]+this.localAngAxis1Y*e[1]+this.localAngAxis1Z*e[2],this.localAngAxis2Y=this.localAngAxis1X*e[3]+this.localAngAxis1Y*e[4]+this.localAngAxis1Z*e[5],this.localAngAxis2Z=this.localAngAxis1X*e[6]+this.localAngAxis1Y*e[7]+this.localAngAxis1Z*e[8]}this.nor=new OIMO.Vec3,this.tan=new OIMO.Vec3,this.bin=new OIMO.Vec3,this.translationalLimitMotor=new OIMO.LimitMotor(this.tan,!0),this.translationalLimitMotor.frequency=8,this.translationalLimitMotor.dampingRatio=1,this.rotationalLimitMotor1=new OIMO.LimitMotor(this.tan,!1),this.rotationalLimitMotor2=new OIMO.LimitMotor(this.bin,!1),this.t3=new OIMO.Translational3Constraint(this,new OIMO.LimitMotor(this.nor,!0),this.translationalLimitMotor,new OIMO.LimitMotor(this.bin,!0)),this.t3.weight=1,this.r3=new OIMO.Rotational3Constraint(this,new OIMO.LimitMotor(this.nor,!0),this.rotationalLimitMotor1,this.rotationalLimitMotor2)},OIMO.WheelJoint.prototype=Object.create(OIMO.Joint.prototype),OIMO.WheelJoint.prototype.preSolve=function(i,t){var s,h;this.updateAnchorPoints(),s=this.body1.rotation.elements;var e=this.localAxis1X*s[0]+this.localAxis1Y*s[1]+this.localAxis1Z*s[2],a=this.localAxis1X*s[3]+this.localAxis1Y*s[4]+this.localAxis1Z*s[5],o=this.localAxis1X*s[6]+this.localAxis1Y*s[7]+this.localAxis1Z*s[8],n=this.localAngAxis1X*s[0]+this.localAngAxis1Y*s[1]+this.localAngAxis1Z*s[2],l=this.localAngAxis1X*s[3]+this.localAngAxis1Y*s[4]+this.localAngAxis1Z*s[5],r=this.localAngAxis1X*s[6]+this.localAngAxis1Y*s[7]+this.localAngAxis1Z*s[8];s=this.body2.rotation.elements;var m=this.localAxis2X*s[0]+this.localAxis2Y*s[1]+this.localAxis2Z*s[2],c=this.localAxis2X*s[3]+this.localAxis2Y*s[4]+this.localAxis2Z*s[5],x=this.localAxis2X*s[6]+this.localAxis2Y*s[7]+this.localAxis2Z*s[8],p=this.localAngAxis2X*s[0]+this.localAngAxis2Y*s[1]+this.localAngAxis2Z*s[2],u=this.localAngAxis2X*s[3]+this.localAngAxis2Y*s[4]+this.localAngAxis2Z*s[5],y=this.localAngAxis2X*s[6]+this.localAngAxis2Y*s[7]+this.localAngAxis2Z*s[8];this.r3.limitMotor1.angle=e*m+a*c+o*x,0>e*(l*x-r*c)+a*(r*m-n*x)+o*(n*c-l*m)?this.rotationalLimitMotor1.angle=-this.acosClamp(n*m+l*c+r*x):this.rotationalLimitMotor1.angle=this.acosClamp(n*m+l*c+r*x),0>m*(u*o-y*a)+c*(y*e-p*o)+x*(p*a-u*e)?this.rotationalLimitMotor2.angle=this.acosClamp(p*e+u*a+y*o):this.rotationalLimitMotor2.angle=-this.acosClamp(p*e+u*a+y*o);var d=c*o-x*a,O=x*e-m*o,N=m*a-c*e;h=Math.sqrt(d*d+O*O+N*N),h>0&&(h=1/h),d*=h,O*=h,N*=h;var M=O*x-N*c,I=N*m-d*x,v=d*c-O*m;h=Math.sqrt(M*M+I*I+v*v),h>0&&(h=1/h),M*=h,I*=h,v*=h;var z=a*N-o*O,f=o*d-e*N,b=e*O-a*d;h=Math.sqrt(z*z+f*f+b*b),h>0&&(h=1/h),z*=h,f*=h,b*=h,this.nor.init(d,O,N),this.tan.init(M,I,v),this.bin.init(z,f,b),this.r3.preSolve(i,t),this.t3.preSolve(i,t)},OIMO.WheelJoint.prototype.solve=function(){this.r3.solve(),this.t3.solve()},OIMO.WheelJoint.prototype.postSolve=function(){},OIMO.WheelJoint.prototype.acosClamp=function(i){return i>1?0:-1>i?Math.PI:Math.acos(i)},OIMO.AngularConstraint=function(i,t){this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.velx=NaN,this.vely=NaN,this.velz=NaN,this.joint=i,this.targetOrientation=(new OIMO.Quat).invert(t),this.relativeOrientation=new OIMO.Quat,this.b1=i.body1,this.b2=i.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.impx=0,this.impy=0,this.impz=0},OIMO.AngularConstraint.prototype={constructor:OIMO.AngularConstraint,preSolve:function(i,t){var s=this.i1.elements,h=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=h[0],this.i2e01=h[1],this.i2e02=h[2],this.i2e10=h[3],this.i2e11=h[4],this.i2e12=h[5],this.i2e20=h[6],this.i2e21=h[7],this.i2e22=h[8];var e=this.i1e00+this.i2e00,a=this.i1e01+this.i2e01,o=this.i1e02+this.i2e02,n=this.i1e10+this.i2e10,l=this.i1e11+this.i2e11,r=this.i1e12+this.i2e12,m=this.i1e20+this.i2e20,c=this.i1e21+this.i2e21,x=this.i1e22+this.i2e22,p=1/(e*(l*x-c*r)+n*(c*o-a*x)+m*(a*r-l*o));this.d00=(l*x-r*c)*p,this.d01=(o*c-a*x)*p,this.d02=(a*r-o*l)*p,this.d10=(r*m-n*x)*p,this.d11=(e*x-o*m)*p,this.d12=(o*n-e*r)*p,this.d20=(n*c-l*m)*p,this.d21=(a*m-e*c)*p,this.d22=(e*l-a*n)*p,this.relativeOrientation.invert(this.b1.orientation),this.relativeOrientation.mul(this.targetOrientation,this.relativeOrientation),this.relativeOrientation.mul(this.b2.orientation,this.relativeOrientation),p=2*this.relativeOrientation.s,this.velx=this.relativeOrientation.x*p,this.vely=this.relativeOrientation.y*p,this.velz=this.relativeOrientation.z*p;var u=Math.sqrt(this.velx*this.velx+this.vely*this.vely+this.velz*this.velz);u>.02?(u=(.02-u)/u*t*.05,this.velx*=u,this.vely*=u,this.velz*=u):(this.velx=0,this.vely=0,this.velz=0),this.a1.x+=this.impx*this.i1e00+this.impy*this.i1e01+this.impz*this.i1e02,this.a1.y+=this.impx*this.i1e10+this.impy*this.i1e11+this.impz*this.i1e12,this.a1.z+=this.impx*this.i1e20+this.impy*this.i1e21+this.impz*this.i1e22,this.a2.x-=this.impx*this.i2e00+this.impy*this.i2e01+this.impz*this.i2e02,this.a2.y-=this.impx*this.i2e10+this.impy*this.i2e11+this.impz*this.i2e12,this.a2.z-=this.impx*this.i2e20+this.impy*this.i2e21+this.impz*this.i2e22},solve:function(){var i=this.a2.x-this.a1.x-this.velx,t=this.a2.y-this.a1.y-this.vely,s=this.a2.z-this.a1.z-this.velz,h=i*this.d00+t*this.d01+s*this.d02,e=i*this.d10+t*this.d11+s*this.d12,a=i*this.d20+t*this.d21+s*this.d22;this.impx+=h,this.impy+=e,this.impz+=a,this.a1.x+=h*this.i1e00+e*this.i1e01+a*this.i1e02,this.a1.y+=h*this.i1e10+e*this.i1e11+a*this.i1e12,this.a1.z+=h*this.i1e20+e*this.i1e21+a*this.i1e22,this.a2.x-=h*this.i2e00+e*this.i2e01+a*this.i2e02,this.a2.y-=h*this.i2e10+e*this.i2e11+a*this.i2e12,this.a2.z-=h*this.i2e20+e*this.i2e21+a*this.i2e22}},OIMO.LinearConstraint=function(i){this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.ax1x=NaN,this.ax1y=NaN,this.ax1z=NaN,this.ay1x=NaN,this.ay1y=NaN,this.ay1z=NaN,this.az1x=NaN,this.az1y=NaN,this.az1z=NaN,this.ax2x=NaN,this.ax2y=NaN,this.ax2z=NaN,this.ay2x=NaN,this.ay2y=NaN,this.ay2z=NaN,this.az2x=NaN,this.az2y=NaN,this.az2z=NaN,this.vel=NaN,this.velx=NaN,this.vely=NaN,this.velz=NaN,this.joint=i,this.r1=i.relativeAnchorPoint1,this.r2=i.relativeAnchorPoint2,this.p1=i.anchorPoint1,this.p2=i.anchorPoint2,this.b1=i.body1,this.b2=i.body2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.impx=0,this.impy=0,this.impz=0},OIMO.LinearConstraint.prototype={constructor:OIMO.LinearConstraint,preSolve:function(i,t){this.r1x=this.r1.x,this.r1y=this.r1.y,this.r1z=this.r1.z,this.r2x=this.r2.x,this.r2y=this.r2.y,this.r2z=this.r2.z,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var s=this.i1.elements,h=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=h[0],this.i2e01=h[1],this.i2e02=h[2],this.i2e10=h[3],this.i2e11=h[4],this.i2e12=h[5],this.i2e20=h[6],this.i2e21=h[7],this.i2e22=h[8],this.ax1x=this.r1z*this.i1e01+-this.r1y*this.i1e02,this.ax1y=this.r1z*this.i1e11+-this.r1y*this.i1e12,this.ax1z=this.r1z*this.i1e21+-this.r1y*this.i1e22,this.ay1x=-this.r1z*this.i1e00+this.r1x*this.i1e02,this.ay1y=-this.r1z*this.i1e10+this.r1x*this.i1e12,this.ay1z=-this.r1z*this.i1e20+this.r1x*this.i1e22,this.az1x=this.r1y*this.i1e00+-this.r1x*this.i1e01,this.az1y=this.r1y*this.i1e10+-this.r1x*this.i1e11,this.az1z=this.r1y*this.i1e20+-this.r1x*this.i1e21,this.ax2x=this.r2z*this.i2e01+-this.r2y*this.i2e02,this.ax2y=this.r2z*this.i2e11+-this.r2y*this.i2e12,this.ax2z=this.r2z*this.i2e21+-this.r2y*this.i2e22,this.ay2x=-this.r2z*this.i2e00+this.r2x*this.i2e02,this.ay2y=-this.r2z*this.i2e10+this.r2x*this.i2e12,this.ay2z=-this.r2z*this.i2e20+this.r2x*this.i2e22,this.az2x=this.r2y*this.i2e00+-this.r2x*this.i2e01,this.az2y=this.r2y*this.i2e10+-this.r2x*this.i2e11,this.az2z=this.r2y*this.i2e20+-this.r2x*this.i2e21;var e=this.m1+this.m2,a=0,o=0,n=0,l=e,r=0,m=0,c=0,x=e;e+=this.i1e11*this.r1z*this.r1z-(this.i1e21+this.i1e12)*this.r1y*this.r1z+this.i1e22*this.r1y*this.r1y,a+=(this.i1e20*this.r1y+this.i1e12*this.r1x)*this.r1z-this.i1e10*this.r1z*this.r1z-this.i1e22*this.r1x*this.r1y,o+=(this.i1e10*this.r1y-this.i1e11*this.r1x)*this.r1z-this.i1e20*this.r1y*this.r1y+this.i1e21*this.r1x*this.r1y,n+=(this.i1e02*this.r1y+this.i1e21*this.r1x)*this.r1z-this.i1e01*this.r1z*this.r1z-this.i1e22*this.r1x*this.r1y,l+=this.i1e00*this.r1z*this.r1z-(this.i1e20+this.i1e02)*this.r1x*this.r1z+this.i1e22*this.r1x*this.r1x,r+=(this.i1e01*this.r1x-this.i1e00*this.r1y)*this.r1z-this.i1e21*this.r1x*this.r1x+this.i1e20*this.r1x*this.r1y,m+=(this.i1e01*this.r1y-this.i1e11*this.r1x)*this.r1z-this.i1e02*this.r1y*this.r1y+this.i1e12*this.r1x*this.r1y,c+=(this.i1e10*this.r1x-this.i1e00*this.r1y)*this.r1z-this.i1e12*this.r1x*this.r1x+this.i1e02*this.r1x*this.r1y,x+=this.i1e00*this.r1y*this.r1y-(this.i1e10+this.i1e01)*this.r1x*this.r1y+this.i1e11*this.r1x*this.r1x,e+=this.i2e11*this.r2z*this.r2z-(this.i2e21+this.i2e12)*this.r2y*this.r2z+this.i2e22*this.r2y*this.r2y,a+=(this.i2e20*this.r2y+this.i2e12*this.r2x)*this.r2z-this.i2e10*this.r2z*this.r2z-this.i2e22*this.r2x*this.r2y,o+=(this.i2e10*this.r2y-this.i2e11*this.r2x)*this.r2z-this.i2e20*this.r2y*this.r2y+this.i2e21*this.r2x*this.r2y,n+=(this.i2e02*this.r2y+this.i2e21*this.r2x)*this.r2z-this.i2e01*this.r2z*this.r2z-this.i2e22*this.r2x*this.r2y,l+=this.i2e00*this.r2z*this.r2z-(this.i2e20+this.i2e02)*this.r2x*this.r2z+this.i2e22*this.r2x*this.r2x,r+=(this.i2e01*this.r2x-this.i2e00*this.r2y)*this.r2z-this.i2e21*this.r2x*this.r2x+this.i2e20*this.r2x*this.r2y,m+=(this.i2e01*this.r2y-this.i2e11*this.r2x)*this.r2z-this.i2e02*this.r2y*this.r2y+this.i2e12*this.r2x*this.r2y,c+=(this.i2e10*this.r2x-this.i2e00*this.r2y)*this.r2z-this.i2e12*this.r2x*this.r2x+this.i2e02*this.r2x*this.r2y,x+=this.i2e00*this.r2y*this.r2y-(this.i2e10+this.i2e01)*this.r2x*this.r2y+this.i2e11*this.r2x*this.r2x;var p=1/(e*(l*x-c*r)+n*(c*o-a*x)+m*(a*r-l*o));this.d00=(l*x-r*c)*p,this.d01=(o*c-a*x)*p,this.d02=(a*r-o*l)*p,this.d10=(r*m-n*x)*p,this.d11=(e*x-o*m)*p,this.d12=(o*n-e*r)*p,this.d20=(n*c-l*m)*p,this.d21=(a*m-e*c)*p,this.d22=(e*l-a*n)*p,
this.velx=this.p2.x-this.p1.x,this.vely=this.p2.y-this.p1.y,this.velz=this.p2.z-this.p1.z;var u=Math.sqrt(this.velx*this.velx+this.vely*this.vely+this.velz*this.velz);u>.005?(u=(.005-u)/u*t*.05,this.velx*=u,this.vely*=u,this.velz*=u):(this.velx=0,this.vely=0,this.velz=0),this.impx*=.95,this.impy*=.95,this.impz*=.95,this.l1.x+=this.impx*this.m1,this.l1.y+=this.impy*this.m1,this.l1.z+=this.impz*this.m1,this.a1.x+=this.impx*this.ax1x+this.impy*this.ay1x+this.impz*this.az1x,this.a1.y+=this.impx*this.ax1y+this.impy*this.ay1y+this.impz*this.az1y,this.a1.z+=this.impx*this.ax1z+this.impy*this.ay1z+this.impz*this.az1z,this.l2.x-=this.impx*this.m2,this.l2.y-=this.impy*this.m2,this.l2.z-=this.impz*this.m2,this.a2.x-=this.impx*this.ax2x+this.impy*this.ay2x+this.impz*this.az2x,this.a2.y-=this.impx*this.ax2y+this.impy*this.ay2y+this.impz*this.az2y,this.a2.z-=this.impx*this.ax2z+this.impy*this.ay2z+this.impz*this.az2z},solve:function(){var i=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y-this.velx,t=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z-this.vely,s=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x-this.velz,h=i*this.d00+t*this.d01+s*this.d02,e=i*this.d10+t*this.d11+s*this.d12,a=i*this.d20+t*this.d21+s*this.d22;this.impx+=h,this.impy+=e,this.impz+=a,this.l1.x+=h*this.m1,this.l1.y+=e*this.m1,this.l1.z+=a*this.m1,this.a1.x+=h*this.ax1x+e*this.ay1x+a*this.az1x,this.a1.y+=h*this.ax1y+e*this.ay1y+a*this.az1y,this.a1.z+=h*this.ax1z+e*this.ay1z+a*this.az1z,this.l2.x-=h*this.m2,this.l2.y-=e*this.m2,this.l2.z-=a*this.m2,this.a2.x-=h*this.ax2x+e*this.ay2x+a*this.az2x,this.a2.y-=h*this.ax2y+e*this.ay2y+a*this.az2y,this.a2.z-=h*this.ax2z+e*this.ay2z+a*this.az2z}},OIMO.Rotational3Constraint=function(i,t,s,h){this.cfm1=NaN,this.cfm2=NaN,this.cfm3=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=t,this.limitMotor2=s,this.limitMotor3=h,this.b1=i.body1,this.b2=i.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0},OIMO.Rotational3Constraint.prototype={constructor:OIMO.Rotational3Constraint,preSolve:function(i,t){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0;var s=this.i1.elements,h=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=h[0],this.i2e01=h[1],this.i2e02=h[2],this.i2e10=h[3],this.i2e11=h[4],this.i2e12=h[5],this.i2e20=h[6],this.i2e21=h[7],this.i2e22=h[8];var e=this.limitMotor1.frequency,a=this.limitMotor2.frequency,o=this.limitMotor3.frequency,n=e>0,l=a>0,r=o>0,m=this.lowerLimit1<=this.upperLimit1,c=this.lowerLimit2<=this.upperLimit2,x=this.lowerLimit3<=this.upperLimit3,p=this.limitMotor1.angle;m?(this.lowerLimit1==this.upperLimit1?(0!=this.limitState1&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-p):p<this.lowerLimit1?(-1!=this.limitState1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-p):p>this.upperLimit1?(1!=this.limitState1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-p):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),n||(this.limitVelocity1>.02?this.limitVelocity1-=.02:this.limitVelocity1<-.02?this.limitVelocity1+=.02:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0);var u=this.limitMotor2.angle;c?(this.lowerLimit2==this.upperLimit2?(0!=this.limitState2&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-u):u<this.lowerLimit2?(-1!=this.limitState2&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-u):u>this.upperLimit2?(1!=this.limitState2&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-u):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),l||(this.limitVelocity2>.02?this.limitVelocity2-=.02:this.limitVelocity2<-.02?this.limitVelocity2+=.02:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0);var y=this.limitMotor3.angle;if(x?(this.lowerLimit3==this.upperLimit3?(0!=this.limitState3&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-y):y<this.lowerLimit3?(-1!=this.limitState3&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-y):y>this.upperLimit3?(1!=this.limitState3&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-y):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),r||(this.limitVelocity3>.02?this.limitVelocity3-=.02:this.limitVelocity3<-.02?this.limitVelocity3+=.02:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(0!=this.limitState1||n)?this.maxMotorImpulse1=this.maxMotorForce1*i:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(0!=this.limitState2||l)?this.maxMotorImpulse2=this.maxMotorForce2*i:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(0!=this.limitState3||r)?this.maxMotorImpulse3=this.maxMotorForce3*i:(this.motorImpulse3=0,this.maxMotorImpulse3=0),this.a1x1=this.ax1*this.i1e00+this.ay1*this.i1e01+this.az1*this.i1e02,this.a1y1=this.ax1*this.i1e10+this.ay1*this.i1e11+this.az1*this.i1e12,this.a1z1=this.ax1*this.i1e20+this.ay1*this.i1e21+this.az1*this.i1e22,this.a2x1=this.ax1*this.i2e00+this.ay1*this.i2e01+this.az1*this.i2e02,this.a2y1=this.ax1*this.i2e10+this.ay1*this.i2e11+this.az1*this.i2e12,this.a2z1=this.ax1*this.i2e20+this.ay1*this.i2e21+this.az1*this.i2e22,this.a1x2=this.ax2*this.i1e00+this.ay2*this.i1e01+this.az2*this.i1e02,this.a1y2=this.ax2*this.i1e10+this.ay2*this.i1e11+this.az2*this.i1e12,this.a1z2=this.ax2*this.i1e20+this.ay2*this.i1e21+this.az2*this.i1e22,this.a2x2=this.ax2*this.i2e00+this.ay2*this.i2e01+this.az2*this.i2e02,this.a2y2=this.ax2*this.i2e10+this.ay2*this.i2e11+this.az2*this.i2e12,this.a2z2=this.ax2*this.i2e20+this.ay2*this.i2e21+this.az2*this.i2e22,this.a1x3=this.ax3*this.i1e00+this.ay3*this.i1e01+this.az3*this.i1e02,this.a1y3=this.ax3*this.i1e10+this.ay3*this.i1e11+this.az3*this.i1e12,this.a1z3=this.ax3*this.i1e20+this.ay3*this.i1e21+this.az3*this.i1e22,this.a2x3=this.ax3*this.i2e00+this.ay3*this.i2e01+this.az3*this.i2e02,this.a2y3=this.ax3*this.i2e10+this.ay3*this.i2e11+this.az3*this.i2e12,this.a2z3=this.ax3*this.i2e20+this.ay3*this.i2e21+this.az3*this.i2e22,this.k00=this.ax1*(this.a1x1+this.a2x1)+this.ay1*(this.a1y1+this.a2y1)+this.az1*(this.a1z1+this.a2z1),this.k01=this.ax1*(this.a1x2+this.a2x2)+this.ay1*(this.a1y2+this.a2y2)+this.az1*(this.a1z2+this.a2z2),this.k02=this.ax1*(this.a1x3+this.a2x3)+this.ay1*(this.a1y3+this.a2y3)+this.az1*(this.a1z3+this.a2z3),this.k10=this.ax2*(this.a1x1+this.a2x1)+this.ay2*(this.a1y1+this.a2y1)+this.az2*(this.a1z1+this.a2z1),this.k11=this.ax2*(this.a1x2+this.a2x2)+this.ay2*(this.a1y2+this.a2y2)+this.az2*(this.a1z2+this.a2z2),this.k12=this.ax2*(this.a1x3+this.a2x3)+this.ay2*(this.a1y3+this.a2y3)+this.az2*(this.a1z3+this.a2z3),this.k20=this.ax3*(this.a1x1+this.a2x1)+this.ay3*(this.a1y1+this.a2y1)+this.az3*(this.a1z1+this.a2z1),this.k21=this.ax3*(this.a1x2+this.a2x2)+this.ay3*(this.a1y2+this.a2y2)+this.az3*(this.a1z2+this.a2z2),this.k22=this.ax3*(this.a1x3+this.a2x3)+this.ay3*(this.a1y3+this.a2y3)+this.az3*(this.a1z3+this.a2z3),this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,n&&2!=this.limitState1){var d=6.2831853*e,O=d*d*i,N=t/(O+2*this.limitMotor1.dampingRatio*d);this.cfm1=this.kv00*N,this.limitVelocity1*=O*N}else this.cfm1=0,this.limitVelocity1*=.05*t;l&&2!=this.limitState2?(d=6.2831853*a,O=d*d*i,N=t/(O+2*this.limitMotor2.dampingRatio*d),this.cfm2=this.kv11*N,this.limitVelocity2*=O*N):(this.cfm2=0,this.limitVelocity2*=.05*t),r&&2!=this.limitState3?(d=6.2831853*o,O=d*d*i,N=t/(O+2*this.limitMotor3.dampingRatio*d),this.cfm3=this.kv22*N,this.limitVelocity3*=O*N):(this.cfm3=0,this.limitVelocity3*=.05*t),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var M=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*M,this.d01=(this.k02*this.k21-this.k01*this.k22)*M,this.d02=(this.k01*this.k12-this.k02*this.k11)*M,this.d10=(this.k12*this.k20-this.k10*this.k22)*M,this.d11=(this.k00*this.k22-this.k02*this.k20)*M,this.d12=(this.k02*this.k10-this.k00*this.k12)*M,this.d20=(this.k10*this.k21-this.k11*this.k20)*M,this.d21=(this.k01*this.k20-this.k00*this.k21)*M,this.d22=(this.k00*this.k11-this.k01*this.k10)*M,this.limitImpulse1*=.95,this.motorImpulse1*=.95,this.limitImpulse2*=.95,this.motorImpulse2*=.95,this.limitImpulse3*=.95,this.motorImpulse3*=.95;var I=this.limitImpulse1+this.motorImpulse1,v=this.limitImpulse2+this.motorImpulse2,z=this.limitImpulse3+this.motorImpulse3;this.a1.x+=I*this.a1x1+v*this.a1x2+z*this.a1x3,this.a1.y+=I*this.a1y1+v*this.a1y2+z*this.a1y3,this.a1.z+=I*this.a1z1+v*this.a1z2+z*this.a1z3,this.a2.x-=I*this.a2x1+v*this.a2x2+z*this.a2x3,this.a2.y-=I*this.a2y1+v*this.a2y2+z*this.a2y3,this.a2.z-=I*this.a2z1+v*this.a2z2+z*this.a2z3},solve_:function(){var i=this.a2.x-this.a1.x,t=this.a2.y-this.a1.y,s=this.a2.z-this.a1.z;this.limitVelocity3=30;var h=i*this.ax1+t*this.ay1+s*this.az1-this.limitVelocity1,e=i*this.ax2+t*this.ay2+s*this.az2-this.limitVelocity2,a=i*this.ax3+t*this.ay3+s*this.az3-this.limitVelocity3,o=h*this.d00+e*this.d01+a*this.d02,n=h*this.d10+e*this.d11+a*this.d12,l=h*this.d20+e*this.d21+a*this.d22;this.limitImpulse1+=o,this.limitImpulse2+=n,this.limitImpulse3+=l,this.a1.x+=o*this.a1x1+n*this.a1x2+l*this.a1x3,this.a1.y+=o*this.a1y1+n*this.a1y2+l*this.a1y3,this.a1.z+=o*this.a1z1+n*this.a1z2+l*this.a1z3,this.a2.x-=o*this.a2x1+n*this.a2x2+l*this.a2x3,this.a2.y-=o*this.a2y1+n*this.a2y2+l*this.a2y3,this.a2.z-=o*this.a2z1+n*this.a2z2+l*this.a2z3},solve:function(){var i=this.a2.x-this.a1.x,t=this.a2.y-this.a1.y,s=this.a2.z-this.a1.z,h=i*this.ax1+t*this.ay1+s*this.az1,e=i*this.ax2+t*this.ay2+s*this.az2,a=i*this.ax3+t*this.ay3+s*this.az3,o=this.motorImpulse1,n=this.motorImpulse2,l=this.motorImpulse3,r=0,m=0,c=0;this.enableMotor1&&(r=(h-this.motorSpeed1)*this.dv00,this.motorImpulse1+=r,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),r=this.motorImpulse1-o),this.enableMotor2&&(m=(e-this.motorSpeed2)*this.dv11,this.motorImpulse2+=m,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),m=this.motorImpulse2-n),this.enableMotor3&&(c=(a-this.motorSpeed3)*this.dv22,this.motorImpulse3+=c,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),c=this.motorImpulse3-l),h+=r*this.kv00+m*this.k01+c*this.k02,e+=r*this.k10+m*this.kv11+c*this.k12,a+=r*this.k20+m*this.k21+c*this.kv22,h-=this.limitVelocity1+this.limitImpulse1*this.cfm1,e-=this.limitVelocity2+this.limitImpulse2*this.cfm2,a-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var x=this.limitImpulse1,p=this.limitImpulse2,u=this.limitImpulse3,y=h*this.d00+e*this.d01+a*this.d02,d=h*this.d10+e*this.d11+a*this.d12,O=h*this.d20+e*this.d21+a*this.d22;this.limitImpulse1+=y,this.limitImpulse2+=d,this.limitImpulse3+=O;var N=0;(2==this.limitState1||this.limitImpulse1*this.limitState1<0)&&(y=-x,e+=y*this.k10,a+=y*this.k20,N|=1),(2==this.limitState2||this.limitImpulse2*this.limitState2<0)&&(d=-p,h+=d*this.k01,a+=d*this.k21,N|=2),(2==this.limitState3||this.limitImpulse3*this.limitState3<0)&&(O=-u,h+=O*this.k02,e+=O*this.k12,N|=4);var M;switch(N){case 1:M=1/(this.k11*this.k22-this.k12*this.k21),d=(this.k22*e+-this.k12*a)*M,O=(-this.k21*e+this.k11*a)*M;break;case 2:M=1/(this.k00*this.k22-this.k02*this.k20),y=(this.k22*h+-this.k02*a)*M,O=(-this.k20*h+this.k00*a)*M;break;case 3:O=a/this.k22;break;case 4:M=1/(this.k00*this.k11-this.k01*this.k10),y=(this.k11*h+-this.k01*e)*M,d=(-this.k10*h+this.k00*e)*M;break;case 5:d=e/this.k11;break;case 6:y=h/this.k00}this.limitImpulse1=y+x,this.limitImpulse2=d+p,this.limitImpulse3=O+u;var I=r+y,v=m+d,z=c+O;this.a1.x+=I*this.a1x1+v*this.a1x2+z*this.a1x3,this.a1.y+=I*this.a1y1+v*this.a1y2+z*this.a1y3,this.a1.z+=I*this.a1z1+v*this.a1z2+z*this.a1z3,this.a2.x-=I*this.a2x1+v*this.a2x2+z*this.a2x3,this.a2.y-=I*this.a2y1+v*this.a2y2+z*this.a2y3,this.a2.z-=I*this.a2z1+v*this.a2z2+z*this.a2z3,i=this.a2.x-this.a1.x,t=this.a2.y-this.a1.y,s=this.a2.z-this.a1.z,e=i*this.ax2+t*this.ay2+s*this.az2}},OIMO.RotationalConstraint=function(i,t){this.cfm=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.motorDenom=NaN,this.invMotorDenom=NaN,this.invDenom=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.a1x=NaN,this.a1y=NaN,this.a1z=NaN,this.a2x=NaN,this.a2y=NaN,this.a2z=NaN,this.enableLimit=!1,this.lowerLimit=NaN,this.upperLimit=NaN,this.limitVelocity=NaN,this.limitState=0,this.enableMotor=!1,this.motorSpeed=NaN,this.maxMotorForce=NaN,this.maxMotorImpulse=NaN,this.limitMotor=t,this.b1=i.body1,this.b2=i.body2,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse=0,this.motorImpulse=0},OIMO.RotationalConstraint.prototype={constructor:OIMO.RotationalConstraint,preSolve:function(i,t){this.ax=this.limitMotor.axis.x,this.ay=this.limitMotor.axis.y,this.az=this.limitMotor.axis.z,this.lowerLimit=this.limitMotor.lowerLimit,this.upperLimit=this.limitMotor.upperLimit,this.motorSpeed=this.limitMotor.motorSpeed,this.maxMotorForce=this.limitMotor.maxMotorForce,this.enableMotor=this.maxMotorForce>0;var s=this.i1.elements,h=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=h[0],this.i2e01=h[1],this.i2e02=h[2],this.i2e10=h[3],this.i2e11=h[4],this.i2e12=h[5],this.i2e20=h[6],this.i2e21=h[7],this.i2e22=h[8];var e=this.limitMotor.frequency,a=e>0,o=this.lowerLimit<=this.upperLimit,n=this.limitMotor.angle;if(o?(this.lowerLimit==this.upperLimit?(0!=this.limitState&&(this.limitState=0,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-n):n<this.lowerLimit?(-1!=this.limitState&&(this.limitState=-1,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-n):n>this.upperLimit?(1!=this.limitState&&(this.limitState=1,this.limitImpulse=0),this.limitVelocity=this.upperLimit-n):(this.limitState=2,this.limitImpulse=0,this.limitVelocity=0),a||(this.limitVelocity>.02?this.limitVelocity-=.02:this.limitVelocity<-.02?this.limitVelocity+=.02:this.limitVelocity=0)):(this.limitState=2,this.limitImpulse=0),this.enableMotor&&(0!=this.limitState||a)?this.maxMotorImpulse=this.maxMotorForce*i:(this.motorImpulse=0,this.maxMotorImpulse=0),this.a1x=this.ax*this.i1e00+this.ay*this.i1e01+this.az*this.i1e02,this.a1y=this.ax*this.i1e10+this.ay*this.i1e11+this.az*this.i1e12,this.a1z=this.ax*this.i1e20+this.ay*this.i1e21+this.az*this.i1e22,this.a2x=this.ax*this.i2e00+this.ay*this.i2e01+this.az*this.i2e02,this.a2y=this.ax*this.i2e10+this.ay*this.i2e11+this.az*this.i2e12,this.a2z=this.ax*this.i2e20+this.ay*this.i2e21+this.az*this.i2e22,this.motorDenom=this.ax*(this.a1x+this.a2x)+this.ay*(this.a1y+this.a2y)+this.az*(this.a1z+this.a2z),this.invMotorDenom=1/this.motorDenom,a&&2!=this.limitState){var l=6.2831853*e,r=l*l*i,m=t/(r+2*this.limitMotor.dampingRatio*l);this.cfm=this.motorDenom*m,this.limitVelocity*=r*m}else this.cfm=0,this.limitVelocity*=.05*t;this.invDenom=1/(this.motorDenom+this.cfm),this.limitImpulse*=.95,this.motorImpulse*=.95;var c=this.limitImpulse+this.motorImpulse;this.a1.x+=c*this.a1x,this.a1.y+=c*this.a1y,this.a1.z+=c*this.a1z,this.a2.x-=c*this.a2x,this.a2.y-=c*this.a2y,this.a2.z-=c*this.a2z},solve:function(){var i,t=this.ax*(this.a2.x-this.a1.x)+this.ay*(this.a2.y-this.a1.y)+this.az*(this.a2.z-this.a1.z);if(this.enableMotor){i=(t-this.motorSpeed)*this.invMotorDenom;var s=this.motorImpulse;this.motorImpulse+=i,this.motorImpulse>this.maxMotorImpulse?this.motorImpulse=this.maxMotorImpulse:this.motorImpulse<-this.maxMotorImpulse&&(this.motorImpulse=-this.maxMotorImpulse),i=this.motorImpulse-s,t-=i*this.motorDenom}else i=0;var h;if(2!=this.limitState){h=(t-this.limitVelocity-this.limitImpulse*this.cfm)*this.invDenom;var e=this.limitImpulse;this.limitImpulse+=h,this.limitImpulse*this.limitState<0&&(this.limitImpulse=0),h=this.limitImpulse-e}else h=0;var a=h+i;this.a1.x+=a*this.a1x,this.a1.y+=a*this.a1y,this.a1.z+=a*this.a1z,this.a2.x-=a*this.a2x,this.a2.y-=a*this.a2y,this.a2.z-=a*this.a2z}},OIMO.Translational3Constraint=function(i,t,s,h){this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.ax1=NaN,this.ay1=NaN,this.az1=NaN,this.ax2=NaN,this.ay2=NaN,this.az2=NaN,this.ax3=NaN,this.ay3=NaN,this.az3=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x1=NaN,this.t1y1=NaN,this.t1z1=NaN,this.t2x1=NaN,this.t2y1=NaN,this.t2z1=NaN,this.l1x1=NaN,this.l1y1=NaN,this.l1z1=NaN,this.l2x1=NaN,this.l2y1=NaN,this.l2z1=NaN,this.a1x1=NaN,this.a1y1=NaN,this.a1z1=NaN,this.a2x1=NaN,this.a2y1=NaN,this.a2z1=NaN,this.t1x2=NaN,this.t1y2=NaN,this.t1z2=NaN,this.t2x2=NaN,this.t2y2=NaN,this.t2z2=NaN,this.l1x2=NaN,this.l1y2=NaN,this.l1z2=NaN,this.l2x2=NaN,this.l2y2=NaN,this.l2z2=NaN,this.a1x2=NaN,this.a1y2=NaN,this.a1z2=NaN,this.a2x2=NaN,this.a2y2=NaN,this.a2z2=NaN,this.t1x3=NaN,this.t1y3=NaN,this.t1z3=NaN,this.t2x3=NaN,this.t2y3=NaN,this.t2z3=NaN,this.l1x3=NaN,this.l1y3=NaN,this.l1z3=NaN,this.l2x3=NaN,this.l2y3=NaN,this.l2z3=NaN,this.a1x3=NaN,this.a1y3=NaN,this.a1z3=NaN,this.a2x3=NaN,this.a2y3=NaN,this.a2z3=NaN,this.lowerLimit1=NaN,this.upperLimit1=NaN,this.limitVelocity1=NaN,this.limitState1=0,this.enableMotor1=!1,this.motorSpeed1=NaN,this.maxMotorForce1=NaN,this.maxMotorImpulse1=NaN,this.lowerLimit2=NaN,this.upperLimit2=NaN,this.limitVelocity2=NaN,this.limitState2=0,this.enableMotor2=!1,this.motorSpeed2=NaN,this.maxMotorForce2=NaN,this.maxMotorImpulse2=NaN,this.lowerLimit3=NaN,this.upperLimit3=NaN,this.limitVelocity3=NaN,this.limitState3=0,this.enableMotor3=!1,this.motorSpeed3=NaN,this.maxMotorForce3=NaN,this.maxMotorImpulse3=NaN,this.k00=NaN,this.k01=NaN,this.k02=NaN,this.k10=NaN,this.k11=NaN,this.k12=NaN,this.k20=NaN,this.k21=NaN,this.k22=NaN,this.kv00=NaN,this.kv11=NaN,this.kv22=NaN,this.dv00=NaN,this.dv11=NaN,this.dv22=NaN,this.d00=NaN,this.d01=NaN,this.d02=NaN,this.d10=NaN,this.d11=NaN,this.d12=NaN,this.d20=NaN,this.d21=NaN,this.d22=NaN,this.limitMotor1=t,this.limitMotor2=s,this.limitMotor3=h,this.b1=i.body1,this.b2=i.body2,this.p1=i.anchorPoint1,this.p2=i.anchorPoint2,this.r1=i.relativeAnchorPoint1,this.r2=i.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse1=0,this.motorImpulse1=0,this.limitImpulse2=0,this.motorImpulse2=0,this.limitImpulse3=0,this.motorImpulse3=0,this.cfm1=0,this.cfm2=0,this.cfm3=0,this.weight=-1},OIMO.Translational3Constraint.prototype={constructor:OIMO.Translational3Constraint,preSolve:function(i,t){this.ax1=this.limitMotor1.axis.x,this.ay1=this.limitMotor1.axis.y,this.az1=this.limitMotor1.axis.z,this.ax2=this.limitMotor2.axis.x,this.ay2=this.limitMotor2.axis.y,this.az2=this.limitMotor2.axis.z,this.ax3=this.limitMotor3.axis.x,this.ay3=this.limitMotor3.axis.y,this.az3=this.limitMotor3.axis.z,this.lowerLimit1=this.limitMotor1.lowerLimit,this.upperLimit1=this.limitMotor1.upperLimit,this.motorSpeed1=this.limitMotor1.motorSpeed,this.maxMotorForce1=this.limitMotor1.maxMotorForce,this.enableMotor1=this.maxMotorForce1>0,this.lowerLimit2=this.limitMotor2.lowerLimit,this.upperLimit2=this.limitMotor2.upperLimit,this.motorSpeed2=this.limitMotor2.motorSpeed,this.maxMotorForce2=this.limitMotor2.maxMotorForce,this.enableMotor2=this.maxMotorForce2>0,this.lowerLimit3=this.limitMotor3.lowerLimit,this.upperLimit3=this.limitMotor3.upperLimit,this.motorSpeed3=this.limitMotor3.motorSpeed,this.maxMotorForce3=this.limitMotor3.maxMotorForce,this.enableMotor3=this.maxMotorForce3>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var s=this.i1.elements,h=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=h[0],this.i2e01=h[1],this.i2e02=h[2],this.i2e10=h[3],this.i2e11=h[4],this.i2e12=h[5],this.i2e20=h[6],this.i2e21=h[7],this.i2e22=h[8];var e=this.p2.x-this.p1.x,a=this.p2.y-this.p1.y,o=this.p2.z-this.p1.z,n=e*this.ax1+a*this.ay1+o*this.az1,l=e*this.ax2+a*this.ay2+o*this.az2,r=e*this.ax3+a*this.ay3+o*this.az3,m=this.limitMotor1.frequency,c=this.limitMotor2.frequency,x=this.limitMotor3.frequency,p=m>0,u=c>0,y=x>0,d=this.lowerLimit1<=this.upperLimit1,O=this.lowerLimit2<=this.upperLimit2,N=this.lowerLimit3<=this.upperLimit3;(p&&n>20||-20>n)&&(p=!1),(u&&l>20||-20>l)&&(u=!1),(y&&r>20||-20>r)&&(y=!1),d?(this.lowerLimit1==this.upperLimit1?(0!=this.limitState1&&(this.limitState1=0,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-n,p||(n=this.lowerLimit1)):n<this.lowerLimit1?(-1!=this.limitState1&&(this.limitState1=-1,this.limitImpulse1=0),this.limitVelocity1=this.lowerLimit1-n,p||(n=this.lowerLimit1)):n>this.upperLimit1?(1!=this.limitState1&&(this.limitState1=1,this.limitImpulse1=0),this.limitVelocity1=this.upperLimit1-n,p||(n=this.upperLimit1)):(this.limitState1=2,this.limitImpulse1=0,this.limitVelocity1=0),p||(this.limitVelocity1>.005?this.limitVelocity1-=.005:this.limitVelocity1<-.005?this.limitVelocity1+=.005:this.limitVelocity1=0)):(this.limitState1=2,this.limitImpulse1=0),O?(this.lowerLimit2==this.upperLimit2?(0!=this.limitState2&&(this.limitState2=0,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-l,u||(l=this.lowerLimit2)):l<this.lowerLimit2?(-1!=this.limitState2&&(this.limitState2=-1,this.limitImpulse2=0),this.limitVelocity2=this.lowerLimit2-l,u||(l=this.lowerLimit2)):l>this.upperLimit2?(1!=this.limitState2&&(this.limitState2=1,this.limitImpulse2=0),this.limitVelocity2=this.upperLimit2-l,u||(l=this.upperLimit2)):(this.limitState2=2,this.limitImpulse2=0,this.limitVelocity2=0),u||(this.limitVelocity2>.005?this.limitVelocity2-=.005:this.limitVelocity2<-.005?this.limitVelocity2+=.005:this.limitVelocity2=0)):(this.limitState2=2,this.limitImpulse2=0),N?(this.lowerLimit3==this.upperLimit3?(0!=this.limitState3&&(this.limitState3=0,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-r,y||(r=this.lowerLimit3)):r<this.lowerLimit3?(-1!=this.limitState3&&(this.limitState3=-1,this.limitImpulse3=0),this.limitVelocity3=this.lowerLimit3-r,y||(r=this.lowerLimit3)):r>this.upperLimit3?(1!=this.limitState3&&(this.limitState3=1,this.limitImpulse3=0),this.limitVelocity3=this.upperLimit3-r,y||(r=this.upperLimit3)):(this.limitState3=2,this.limitImpulse3=0,this.limitVelocity3=0),y||(this.limitVelocity3>.005?this.limitVelocity3-=.005:this.limitVelocity3<-.005?this.limitVelocity3+=.005:this.limitVelocity3=0)):(this.limitState3=2,this.limitImpulse3=0),this.enableMotor1&&(0!=this.limitState1||p)?this.maxMotorImpulse1=this.maxMotorForce1*i:(this.motorImpulse1=0,this.maxMotorImpulse1=0),this.enableMotor2&&(0!=this.limitState2||u)?this.maxMotorImpulse2=this.maxMotorForce2*i:(this.motorImpulse2=0,this.maxMotorImpulse2=0),this.enableMotor3&&(0!=this.limitState3||y)?this.maxMotorImpulse3=this.maxMotorForce3*i:(this.motorImpulse3=0,this.maxMotorImpulse3=0);var M=n*this.ax1+l*this.ax2+r*this.ax2,I=n*this.ay1+l*this.ay2+r*this.ay2,v=n*this.az1+l*this.az2+r*this.az2,z=this.m2/(this.m1+this.m2);this.weight>=0&&(z=this.weight);var f=1-z;this.r1x=this.r1.x+M*z,this.r1y=this.r1.y+I*z,this.r1z=this.r1.z+v*z,this.r2x=this.r2.x-M*f,this.r2y=this.r2.y-I*f,this.r2z=this.r2.z-v*f,this.t1x1=this.r1y*this.az1-this.r1z*this.ay1,this.t1y1=this.r1z*this.ax1-this.r1x*this.az1,this.t1z1=this.r1x*this.ay1-this.r1y*this.ax1,this.t2x1=this.r2y*this.az1-this.r2z*this.ay1,this.t2y1=this.r2z*this.ax1-this.r2x*this.az1,this.t2z1=this.r2x*this.ay1-this.r2y*this.ax1,this.l1x1=this.ax1*this.m1,this.l1y1=this.ay1*this.m1,this.l1z1=this.az1*this.m1,this.l2x1=this.ax1*this.m2,this.l2y1=this.ay1*this.m2,this.l2z1=this.az1*this.m2,this.a1x1=this.t1x1*this.i1e00+this.t1y1*this.i1e01+this.t1z1*this.i1e02,this.a1y1=this.t1x1*this.i1e10+this.t1y1*this.i1e11+this.t1z1*this.i1e12,this.a1z1=this.t1x1*this.i1e20+this.t1y1*this.i1e21+this.t1z1*this.i1e22,this.a2x1=this.t2x1*this.i2e00+this.t2y1*this.i2e01+this.t2z1*this.i2e02,this.a2y1=this.t2x1*this.i2e10+this.t2y1*this.i2e11+this.t2z1*this.i2e12,this.a2z1=this.t2x1*this.i2e20+this.t2y1*this.i2e21+this.t2z1*this.i2e22,this.t1x2=this.r1y*this.az2-this.r1z*this.ay2,this.t1y2=this.r1z*this.ax2-this.r1x*this.az2,this.t1z2=this.r1x*this.ay2-this.r1y*this.ax2,this.t2x2=this.r2y*this.az2-this.r2z*this.ay2,this.t2y2=this.r2z*this.ax2-this.r2x*this.az2,this.t2z2=this.r2x*this.ay2-this.r2y*this.ax2,this.l1x2=this.ax2*this.m1,this.l1y2=this.ay2*this.m1,this.l1z2=this.az2*this.m1,this.l2x2=this.ax2*this.m2,this.l2y2=this.ay2*this.m2,this.l2z2=this.az2*this.m2,this.a1x2=this.t1x2*this.i1e00+this.t1y2*this.i1e01+this.t1z2*this.i1e02,this.a1y2=this.t1x2*this.i1e10+this.t1y2*this.i1e11+this.t1z2*this.i1e12,this.a1z2=this.t1x2*this.i1e20+this.t1y2*this.i1e21+this.t1z2*this.i1e22,this.a2x2=this.t2x2*this.i2e00+this.t2y2*this.i2e01+this.t2z2*this.i2e02,this.a2y2=this.t2x2*this.i2e10+this.t2y2*this.i2e11+this.t2z2*this.i2e12,this.a2z2=this.t2x2*this.i2e20+this.t2y2*this.i2e21+this.t2z2*this.i2e22,this.t1x3=this.r1y*this.az3-this.r1z*this.ay3,this.t1y3=this.r1z*this.ax3-this.r1x*this.az3,this.t1z3=this.r1x*this.ay3-this.r1y*this.ax3,this.t2x3=this.r2y*this.az3-this.r2z*this.ay3,this.t2y3=this.r2z*this.ax3-this.r2x*this.az3,this.t2z3=this.r2x*this.ay3-this.r2y*this.ax3,this.l1x3=this.ax3*this.m1,this.l1y3=this.ay3*this.m1,this.l1z3=this.az3*this.m1,this.l2x3=this.ax3*this.m2,this.l2y3=this.ay3*this.m2,this.l2z3=this.az3*this.m2,this.a1x3=this.t1x3*this.i1e00+this.t1y3*this.i1e01+this.t1z3*this.i1e02,this.a1y3=this.t1x3*this.i1e10+this.t1y3*this.i1e11+this.t1z3*this.i1e12,this.a1z3=this.t1x3*this.i1e20+this.t1y3*this.i1e21+this.t1z3*this.i1e22,this.a2x3=this.t2x3*this.i2e00+this.t2y3*this.i2e01+this.t2z3*this.i2e02,this.a2y3=this.t2x3*this.i2e10+this.t2y3*this.i2e11+this.t2z3*this.i2e12,this.a2z3=this.t2x3*this.i2e20+this.t2y3*this.i2e21+this.t2z3*this.i2e22;var b=this.m1+this.m2;if(this.k00=(this.ax1*this.ax1+this.ay1*this.ay1+this.az1*this.az1)*b,this.k01=(this.ax1*this.ax2+this.ay1*this.ay2+this.az1*this.az2)*b,this.k02=(this.ax1*this.ax3+this.ay1*this.ay3+this.az1*this.az3)*b,this.k10=(this.ax2*this.ax1+this.ay2*this.ay1+this.az2*this.az1)*b,this.k11=(this.ax2*this.ax2+this.ay2*this.ay2+this.az2*this.az2)*b,this.k12=(this.ax2*this.ax3+this.ay2*this.ay3+this.az2*this.az3)*b,this.k20=(this.ax3*this.ax1+this.ay3*this.ay1+this.az3*this.az1)*b,this.k21=(this.ax3*this.ax2+this.ay3*this.ay2+this.az3*this.az2)*b,this.k22=(this.ax3*this.ax3+this.ay3*this.ay3+this.az3*this.az3)*b,this.k00+=this.t1x1*this.a1x1+this.t1y1*this.a1y1+this.t1z1*this.a1z1,this.k01+=this.t1x1*this.a1x2+this.t1y1*this.a1y2+this.t1z1*this.a1z2,this.k02+=this.t1x1*this.a1x3+this.t1y1*this.a1y3+this.t1z1*this.a1z3,this.k10+=this.t1x2*this.a1x1+this.t1y2*this.a1y1+this.t1z2*this.a1z1,this.k11+=this.t1x2*this.a1x2+this.t1y2*this.a1y2+this.t1z2*this.a1z2,this.k12+=this.t1x2*this.a1x3+this.t1y2*this.a1y3+this.t1z2*this.a1z3,this.k20+=this.t1x3*this.a1x1+this.t1y3*this.a1y1+this.t1z3*this.a1z1,this.k21+=this.t1x3*this.a1x2+this.t1y3*this.a1y2+this.t1z3*this.a1z2,this.k22+=this.t1x3*this.a1x3+this.t1y3*this.a1y3+this.t1z3*this.a1z3,this.k00+=this.t2x1*this.a2x1+this.t2y1*this.a2y1+this.t2z1*this.a2z1,this.k01+=this.t2x1*this.a2x2+this.t2y1*this.a2y2+this.t2z1*this.a2z2,this.k02+=this.t2x1*this.a2x3+this.t2y1*this.a2y3+this.t2z1*this.a2z3,this.k10+=this.t2x2*this.a2x1+this.t2y2*this.a2y1+this.t2z2*this.a2z1,this.k11+=this.t2x2*this.a2x2+this.t2y2*this.a2y2+this.t2z2*this.a2z2,this.k12+=this.t2x2*this.a2x3+this.t2y2*this.a2y3+this.t2z2*this.a2z3,this.k20+=this.t2x3*this.a2x1+this.t2y3*this.a2y1+this.t2z3*this.a2z1,this.k21+=this.t2x3*this.a2x2+this.t2y3*this.a2y2+this.t2z3*this.a2z2,this.k22+=this.t2x3*this.a2x3+this.t2y3*this.a2y3+this.t2z3*this.a2z3,this.kv00=this.k00,this.kv11=this.k11,this.kv22=this.k22,this.dv00=1/this.kv00,this.dv11=1/this.kv11,this.dv22=1/this.kv22,p&&2!=this.limitState1){var A=6.2831853*m,k=A*A*i,g=t/(k+2*this.limitMotor1.dampingRatio*A);this.cfm1=this.kv00*g,this.limitVelocity1*=k*g}else this.cfm1=0,this.limitVelocity1*=.05*t;u&&2!=this.limitState2?(A=6.2831853*c,k=A*A*i,g=t/(k+2*this.limitMotor2.dampingRatio*A),this.cfm2=this.kv11*g,this.limitVelocity2*=k*g):(this.cfm2=0,this.limitVelocity2*=.05*t),y&&2!=this.limitState3?(A=6.2831853*x,
k=A*A*i,g=t/(k+2*this.limitMotor3.dampingRatio*A),this.cfm3=this.kv22*g,this.limitVelocity3*=k*g):(this.cfm3=0,this.limitVelocity3*=.05*t),this.k00+=this.cfm1,this.k11+=this.cfm2,this.k22+=this.cfm3;var S=1/(this.k00*(this.k11*this.k22-this.k21*this.k12)+this.k10*(this.k21*this.k02-this.k01*this.k22)+this.k20*(this.k01*this.k12-this.k11*this.k02));this.d00=(this.k11*this.k22-this.k12*this.k21)*S,this.d01=(this.k02*this.k21-this.k01*this.k22)*S,this.d02=(this.k01*this.k12-this.k02*this.k11)*S,this.d10=(this.k12*this.k20-this.k10*this.k22)*S,this.d11=(this.k00*this.k22-this.k02*this.k20)*S,this.d12=(this.k02*this.k10-this.k00*this.k12)*S,this.d20=(this.k10*this.k21-this.k11*this.k20)*S,this.d21=(this.k01*this.k20-this.k00*this.k21)*S,this.d22=(this.k00*this.k11-this.k01*this.k10)*S;var w=this.limitImpulse1+this.motorImpulse1,L=this.limitImpulse2+this.motorImpulse2,P=this.limitImpulse3+this.motorImpulse3;this.l1.x+=w*this.l1x1+L*this.l1x2+P*this.l1x3,this.l1.y+=w*this.l1y1+L*this.l1y2+P*this.l1y3,this.l1.z+=w*this.l1z1+L*this.l1z2+P*this.l1z3,this.a1.x+=w*this.a1x1+L*this.a1x2+P*this.a1x3,this.a1.y+=w*this.a1y1+L*this.a1y2+P*this.a1y3,this.a1.z+=w*this.a1z1+L*this.a1z2+P*this.a1z3,this.l2.x-=w*this.l2x1+L*this.l2x2+P*this.l2x3,this.l2.y-=w*this.l2y1+L*this.l2y2+P*this.l2y3,this.l2.z-=w*this.l2z1+L*this.l2z2+P*this.l2z3,this.a2.x-=w*this.a2x1+L*this.a2x2+P*this.a2x3,this.a2.y-=w*this.a2y1+L*this.a2y2+P*this.a2y3,this.a2.z-=w*this.a2z1+L*this.a2z2+P*this.a2z3},solve:function(){var i=this.l2.x-this.l1.x+this.a2.y*this.r2z-this.a2.z*this.r2y-this.a1.y*this.r1z+this.a1.z*this.r1y,t=this.l2.y-this.l1.y+this.a2.z*this.r2x-this.a2.x*this.r2z-this.a1.z*this.r1x+this.a1.x*this.r1z,s=this.l2.z-this.l1.z+this.a2.x*this.r2y-this.a2.y*this.r2x-this.a1.x*this.r1y+this.a1.y*this.r1x,h=i*this.ax1+t*this.ay1+s*this.az1,e=i*this.ax2+t*this.ay2+s*this.az2,a=i*this.ax3+t*this.ay3+s*this.az3,o=this.motorImpulse1,n=this.motorImpulse2,l=this.motorImpulse3,r=0,m=0,c=0;this.enableMotor1&&(r=(h-this.motorSpeed1)*this.dv00,this.motorImpulse1+=r,this.motorImpulse1>this.maxMotorImpulse1?this.motorImpulse1=this.maxMotorImpulse1:this.motorImpulse1<-this.maxMotorImpulse1&&(this.motorImpulse1=-this.maxMotorImpulse1),r=this.motorImpulse1-o),this.enableMotor2&&(m=(e-this.motorSpeed2)*this.dv11,this.motorImpulse2+=m,this.motorImpulse2>this.maxMotorImpulse2?this.motorImpulse2=this.maxMotorImpulse2:this.motorImpulse2<-this.maxMotorImpulse2&&(this.motorImpulse2=-this.maxMotorImpulse2),m=this.motorImpulse2-n),this.enableMotor3&&(c=(a-this.motorSpeed3)*this.dv22,this.motorImpulse3+=c,this.motorImpulse3>this.maxMotorImpulse3?this.motorImpulse3=this.maxMotorImpulse3:this.motorImpulse3<-this.maxMotorImpulse3&&(this.motorImpulse3=-this.maxMotorImpulse3),c=this.motorImpulse3-l),h+=r*this.kv00+m*this.k01+c*this.k02,e+=r*this.k10+m*this.kv11+c*this.k12,a+=r*this.k20+m*this.k21+c*this.kv22,h-=this.limitVelocity1+this.limitImpulse1*this.cfm1,e-=this.limitVelocity2+this.limitImpulse2*this.cfm2,a-=this.limitVelocity3+this.limitImpulse3*this.cfm3;var x=this.limitImpulse1,p=this.limitImpulse2,u=this.limitImpulse3,y=h*this.d00+e*this.d01+a*this.d02,d=h*this.d10+e*this.d11+a*this.d12,O=h*this.d20+e*this.d21+a*this.d22;this.limitImpulse1+=y,this.limitImpulse2+=d,this.limitImpulse3+=O;var N=0;(2==this.limitState1||this.limitImpulse1*this.limitState1<0)&&(y=-x,e+=y*this.k10,a+=y*this.k20,N|=1),(2==this.limitState2||this.limitImpulse2*this.limitState2<0)&&(d=-p,h+=d*this.k01,a+=d*this.k21,N|=2),(2==this.limitState3||this.limitImpulse3*this.limitState3<0)&&(O=-u,h+=O*this.k02,e+=O*this.k12,N|=4);var M;switch(N){case 1:M=1/(this.k11*this.k22-this.k12*this.k21),d=(this.k22*e+-this.k12*a)*M,O=(-this.k21*e+this.k11*a)*M;break;case 2:M=1/(this.k00*this.k22-this.k02*this.k20),y=(this.k22*h+-this.k02*a)*M,O=(-this.k20*h+this.k00*a)*M;break;case 3:O=a/this.k22;break;case 4:M=1/(this.k00*this.k11-this.k01*this.k10),y=(this.k11*h+-this.k01*e)*M,d=(-this.k10*h+this.k00*e)*M;break;case 5:d=e/this.k11;break;case 6:y=h/this.k00}this.limitImpulse1=x+y,this.limitImpulse2=p+d,this.limitImpulse3=u+O;var I=r+y,v=m+d,z=c+O;this.l1.x+=I*this.l1x1+v*this.l1x2+z*this.l1x3,this.l1.y+=I*this.l1y1+v*this.l1y2+z*this.l1y3,this.l1.z+=I*this.l1z1+v*this.l1z2+z*this.l1z3,this.a1.x+=I*this.a1x1+v*this.a1x2+z*this.a1x3,this.a1.y+=I*this.a1y1+v*this.a1y2+z*this.a1y3,this.a1.z+=I*this.a1z1+v*this.a1z2+z*this.a1z3,this.l2.x-=I*this.l2x1+v*this.l2x2+z*this.l2x3,this.l2.y-=I*this.l2y1+v*this.l2y2+z*this.l2y3,this.l2.z-=I*this.l2z1+v*this.l2z2+z*this.l2z3,this.a2.x-=I*this.a2x1+v*this.a2x2+z*this.a2x3,this.a2.y-=I*this.a2y1+v*this.a2y2+z*this.a2y3,this.a2.z-=I*this.a2z1+v*this.a2z2+z*this.a2z3}},OIMO.TranslationalConstraint=function(i,t){this.cfm=NaN,this.m1=NaN,this.m2=NaN,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.motorDenom=NaN,this.invMotorDenom=NaN,this.invDenom=NaN,this.ax=NaN,this.ay=NaN,this.az=NaN,this.r1x=NaN,this.r1y=NaN,this.r1z=NaN,this.r2x=NaN,this.r2y=NaN,this.r2z=NaN,this.t1x=NaN,this.t1y=NaN,this.t1z=NaN,this.t2x=NaN,this.t2y=NaN,this.t2z=NaN,this.l1x=NaN,this.l1y=NaN,this.l1z=NaN,this.l2x=NaN,this.l2y=NaN,this.l2z=NaN,this.a1x=NaN,this.a1y=NaN,this.a1z=NaN,this.a2x=NaN,this.a2y=NaN,this.a2z=NaN,this.lowerLimit=NaN,this.upperLimit=NaN,this.limitVelocity=NaN,this.limitState=0,this.enableMotor=!1,this.motorSpeed=NaN,this.maxMotorForce=NaN,this.maxMotorImpulse=NaN,this.limitMotor=t,this.b1=i.body1,this.b2=i.body2,this.p1=i.anchorPoint1,this.p2=i.anchorPoint2,this.r1=i.relativeAnchorPoint1,this.r2=i.relativeAnchorPoint2,this.l1=this.b1.linearVelocity,this.l2=this.b2.linearVelocity,this.a1=this.b1.angularVelocity,this.a2=this.b2.angularVelocity,this.i1=this.b1.inverseInertia,this.i2=this.b2.inverseInertia,this.limitImpulse=0,this.motorImpulse=0},OIMO.TranslationalConstraint.prototype={constructor:OIMO.TranslationalConstraint,preSolve:function(i,t){this.ax=this.limitMotor.axis.x,this.ay=this.limitMotor.axis.y,this.az=this.limitMotor.axis.z,this.lowerLimit=this.limitMotor.lowerLimit,this.upperLimit=this.limitMotor.upperLimit,this.motorSpeed=this.limitMotor.motorSpeed,this.maxMotorForce=this.limitMotor.maxMotorForce,this.enableMotor=this.maxMotorForce>0,this.m1=this.b1.inverseMass,this.m2=this.b2.inverseMass;var s=this.i1.elements,h=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=h[0],this.i2e01=h[1],this.i2e02=h[2],this.i2e10=h[3],this.i2e11=h[4],this.i2e12=h[5],this.i2e20=h[6],this.i2e21=h[7],this.i2e22=h[8];var e=this.p2.x-this.p1.x,a=this.p2.y-this.p1.y,o=this.p2.z-this.p1.z,n=e*this.ax+a*this.ay+o*this.az,l=this.limitMotor.frequency,r=l>0,m=this.lowerLimit<=this.upperLimit;(r&&n>20||-20>n)&&(r=!1),m?(this.lowerLimit==this.upperLimit?(0!=this.limitState&&(this.limitState=0,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-n,r||(n=this.lowerLimit)):n<this.lowerLimit?(-1!=this.limitState&&(this.limitState=-1,this.limitImpulse=0),this.limitVelocity=this.lowerLimit-n,r||(n=this.lowerLimit)):n>this.upperLimit?(1!=this.limitState&&(this.limitState=1,this.limitImpulse=0),this.limitVelocity=this.upperLimit-n,r||(n=this.upperLimit)):(this.limitState=2,this.limitImpulse=0,this.limitVelocity=0),r||(this.limitVelocity>.005?this.limitVelocity-=.005:this.limitVelocity<-.005?this.limitVelocity+=.005:this.limitVelocity=0)):(this.limitState=2,this.limitImpulse=0),this.enableMotor&&(0!=this.limitState||r)?this.maxMotorImpulse=this.maxMotorForce*i:(this.motorImpulse=0,this.maxMotorImpulse=0);var c=n*this.ax,x=n*this.ay,p=n*this.az,u=this.m1/(this.m1+this.m2),y=1-u;if(this.r1x=this.r1.x+c*u,this.r1y=this.r1.y+x*u,this.r1z=this.r1.z+p*u,this.r2x=this.r2.x-c*y,this.r2y=this.r2.y-x*y,this.r2z=this.r2.z-p*y,this.t1x=this.r1y*this.az-this.r1z*this.ay,this.t1y=this.r1z*this.ax-this.r1x*this.az,this.t1z=this.r1x*this.ay-this.r1y*this.ax,this.t2x=this.r2y*this.az-this.r2z*this.ay,this.t2y=this.r2z*this.ax-this.r2x*this.az,this.t2z=this.r2x*this.ay-this.r2y*this.ax,this.l1x=this.ax*this.m1,this.l1y=this.ay*this.m1,this.l1z=this.az*this.m1,this.l2x=this.ax*this.m2,this.l2y=this.ay*this.m2,this.l2z=this.az*this.m2,this.a1x=this.t1x*this.i1e00+this.t1y*this.i1e01+this.t1z*this.i1e02,this.a1y=this.t1x*this.i1e10+this.t1y*this.i1e11+this.t1z*this.i1e12,this.a1z=this.t1x*this.i1e20+this.t1y*this.i1e21+this.t1z*this.i1e22,this.a2x=this.t2x*this.i2e00+this.t2y*this.i2e01+this.t2z*this.i2e02,this.a2y=this.t2x*this.i2e10+this.t2y*this.i2e11+this.t2z*this.i2e12,this.a2z=this.t2x*this.i2e20+this.t2y*this.i2e21+this.t2z*this.i2e22,this.motorDenom=this.m1+this.m2+this.ax*(this.a1y*this.r1z-this.a1z*this.r1y+this.a2y*this.r2z-this.a2z*this.r2y)+this.ay*(this.a1z*this.r1x-this.a1x*this.r1z+this.a2z*this.r2x-this.a2x*this.r2z)+this.az*(this.a1x*this.r1y-this.a1y*this.r1x+this.a2x*this.r2y-this.a2y*this.r2x),this.invMotorDenom=1/this.motorDenom,r&&2!=this.limitState){var d=6.2831853*l,O=d*d*i,N=t/(O+2*this.limitMotor.dampingRatio*d);this.cfm=this.motorDenom*N,this.limitVelocity*=O*N}else this.cfm=0,this.limitVelocity*=.05*t;this.invDenom=1/(this.motorDenom+this.cfm);var M=this.limitImpulse+this.motorImpulse;this.l1.x+=M*this.l1x,this.l1.y+=M*this.l1y,this.l1.z+=M*this.l1z,this.a1.x+=M*this.a1x,this.a1.y+=M*this.a1y,this.a1.z+=M*this.a1z,this.l2.x-=M*this.l2x,this.l2.y-=M*this.l2y,this.l2.z-=M*this.l2z,this.a2.x-=M*this.a2x,this.a2.y-=M*this.a2y,this.a2.z-=M*this.a2z},solve:function(){var i,t=this.ax*(this.l2.x-this.l1.x)+this.ay*(this.l2.y-this.l1.y)+this.az*(this.l2.z-this.l1.z)+this.t2x*this.a2.x-this.t1x*this.a1.x+this.t2y*this.a2.y-this.t1y*this.a1.y+this.t2z*this.a2.z-this.t1z*this.a1.z;if(this.enableMotor){i=(t-this.motorSpeed)*this.invMotorDenom;var s=this.motorImpulse;this.motorImpulse+=i,this.motorImpulse>this.maxMotorImpulse?this.motorImpulse=this.maxMotorImpulse:this.motorImpulse<-this.maxMotorImpulse&&(this.motorImpulse=-this.maxMotorImpulse),i=this.motorImpulse-s,t-=i*this.motorDenom}else i=0;var h;if(2!=this.limitState){h=(t-this.limitVelocity-this.limitImpulse*this.cfm)*this.invDenom;var e=this.limitImpulse;this.limitImpulse+=h,this.limitImpulse*this.limitState<0&&(this.limitImpulse=0),h=this.limitImpulse-e}else h=0;var a=h+i;this.l1.x+=a*this.l1x,this.l1.y+=a*this.l1y,this.l1.z+=a*this.l1z,this.a1.x+=a*this.a1x,this.a1.y+=a*this.a1y,this.a1.z+=a*this.a1z,this.l2.x-=a*this.l2x,this.l2.y-=a*this.l2y,this.l2.z-=a*this.l2z,this.a2.x-=a*this.a2x,this.a2.y-=a*this.a2y,this.a2.z-=a*this.a2z}},OIMO.Contact=function(){this.shape1=null,this.shape2=null,this.body1=null,this.body2=null,this.prev=null,this.next=null,this.persisting=!1,this.sleeping=!1,this.detector=null,this.constraint=null,this.touching=!1,this.b1Link=new OIMO.ContactLink(this),this.b2Link=new OIMO.ContactLink(this),this.s1Link=new OIMO.ContactLink(this),this.s2Link=new OIMO.ContactLink(this),this.manifold=new OIMO.ContactManifold,this.buffer=[],this.buffer.length=4,this.buffer[0]=new OIMO.ImpulseDataBuffer,this.buffer[1]=new OIMO.ImpulseDataBuffer,this.buffer[2]=new OIMO.ImpulseDataBuffer,this.buffer[3]=new OIMO.ImpulseDataBuffer,this.points=this.manifold.points,this.constraint=new OIMO.ContactConstraint(this.manifold)},OIMO.Contact.prototype={constructor:OIMO.Contact,mixRestitution:function(i,t){return Math.sqrt(i*t)},mixFriction:function(i,t){return Math.sqrt(i*t)},updateManifold:function(){this.constraint.restitution=this.mixRestitution(this.shape1.restitution,this.shape2.restitution),this.constraint.friction=this.mixFriction(this.shape1.friction,this.shape2.friction);for(var i=this.manifold.numPoints,t=i;t--;){var s=this.buffer[t],h=this.points[t];s.lp1X=h.localPoint1.x,s.lp1Y=h.localPoint1.y,s.lp1Z=h.localPoint1.z,s.lp2X=h.localPoint2.x,s.lp2Y=h.localPoint2.y,s.lp2Z=h.localPoint2.z,s.impulse=h.normalImpulse}this.manifold.numPoints=0,this.detector.detectCollision(this.shape1,this.shape2,this.manifold);var e=this.manifold.numPoints;if(0==e)return void(this.touching=!1);for(this.touching=!0,t=e;t--;){h=this.points[t];for(var a=h.localPoint1.x,o=h.localPoint1.y,n=h.localPoint1.z,l=h.localPoint2.x,r=h.localPoint2.y,m=h.localPoint2.z,c=-1,x=4e-4,p=i;p--;){s=this.buffer[p];var u=s.lp1X-a,y=s.lp1Y-o,d=s.lp1Z-n,O=u*u+y*y+d*d;u=s.lp2X-l,y=s.lp2Y-r,d=s.lp2Z-m;var N=u*u+y*y+d*d;N>O?x>O&&(x=O,c=p):x>N&&(x=N,c=p)}if(-1!=c){var M=this.buffer[c];this.buffer[c]=this.buffer[--i],this.buffer[i]=M,h.normalImpulse=M.impulse,h.warmStarted=!0}else h.normalImpulse=0,h.warmStarted=!1}},attach:function(i,t){this.shape1=i,this.shape2=t,this.body1=i.parent,this.body2=t.parent,this.manifold.body1=this.body1,this.manifold.body2=this.body2,this.constraint.body1=this.body1,this.constraint.body2=this.body2,this.constraint.attach(),this.s1Link.shape=t,this.s1Link.body=this.body2,this.s2Link.shape=i,this.s2Link.body=this.body1,null!=i.contactLink?(this.s1Link.next=i.contactLink).prev=this.s1Link:this.s1Link.next=null,i.contactLink=this.s1Link,i.numContacts++,null!=t.contactLink?(this.s2Link.next=t.contactLink).prev=this.s2Link:this.s2Link.next=null,t.contactLink=this.s2Link,t.numContacts++,this.b1Link.shape=t,this.b1Link.body=this.body2,this.b2Link.shape=i,this.b2Link.body=this.body1,null!=this.body1.contactLink?(this.b1Link.next=this.body1.contactLink).prev=this.b1Link:this.b1Link.next=null,this.body1.contactLink=this.b1Link,this.body1.numContacts++,null!=this.body2.contactLink?(this.b2Link.next=this.body2.contactLink).prev=this.b2Link:this.b2Link.next=null,this.body2.contactLink=this.b2Link,this.body2.numContacts++,this.prev=null,this.next=null,this.persisting=!0,this.sleeping=this.body1.sleeping&&this.body2.sleeping,this.manifold.numPoints=0},detach:function(){var i=this.s1Link.prev,t=this.s1Link.next;null!==i&&(i.next=t),null!==t&&(t.prev=i),this.shape1.contactLink==this.s1Link&&(this.shape1.contactLink=t),this.s1Link.prev=null,this.s1Link.next=null,this.s1Link.shape=null,this.s1Link.body=null,this.shape1.numContacts--,i=this.s2Link.prev,t=this.s2Link.next,null!==i&&(i.next=t),null!==t&&(t.prev=i),this.shape2.contactLink==this.s2Link&&(this.shape2.contactLink=t),this.s2Link.prev=null,this.s2Link.next=null,this.s2Link.shape=null,this.s2Link.body=null,this.shape2.numContacts--,i=this.b1Link.prev,t=this.b1Link.next,null!==i&&(i.next=t),null!==t&&(t.prev=i),this.body1.contactLink==this.b1Link&&(this.body1.contactLink=t),this.b1Link.prev=null,this.b1Link.next=null,this.b1Link.shape=null,this.b1Link.body=null,this.body1.numContacts--,i=this.b2Link.prev,t=this.b2Link.next,null!==i&&(i.next=t),null!==t&&(t.prev=i),this.body2.contactLink==this.b2Link&&(this.body2.contactLink=t),this.b2Link.prev=null,this.b2Link.next=null,this.b2Link.shape=null,this.b2Link.body=null,this.body2.numContacts--,this.manifold.body1=null,this.manifold.body2=null,this.constraint.body1=null,this.constraint.body2=null,this.constraint.detach(),this.shape1=null,this.shape2=null,this.body1=null,this.body2=null}},OIMO.ContactConstraint=function(i){OIMO.Constraint.call(this),this.manifold=i,this.restitution=NaN,this.friction=NaN,this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null,this.i1e00=NaN,this.i1e01=NaN,this.i1e02=NaN,this.i1e10=NaN,this.i1e11=NaN,this.i1e12=NaN,this.i1e20=NaN,this.i1e21=NaN,this.i1e22=NaN,this.i2e00=NaN,this.i2e01=NaN,this.i2e02=NaN,this.i2e10=NaN,this.i2e11=NaN,this.i2e12=NaN,this.i2e20=NaN,this.i2e21=NaN,this.i2e22=NaN,this.m1=NaN,this.m2=NaN,this.num=0,this.ps=i.points,this.cs=new OIMO.ContactPointDataBuffer,this.cs.next=new OIMO.ContactPointDataBuffer,this.cs.next.next=new OIMO.ContactPointDataBuffer,this.cs.next.next.next=new OIMO.ContactPointDataBuffer},OIMO.ContactConstraint.prototype=Object.create(OIMO.Constraint.prototype),OIMO.ContactConstraint.prototype.attach=function(){this.p1=this.body1.position,this.p2=this.body2.position,this.lv1=this.body1.linearVelocity,this.av1=this.body1.angularVelocity,this.lv2=this.body2.linearVelocity,this.av2=this.body2.angularVelocity,this.i1=this.body1.inverseInertia,this.i2=this.body2.inverseInertia},OIMO.ContactConstraint.prototype.detach=function(){this.p1=null,this.p2=null,this.lv1=null,this.lv2=null,this.av1=null,this.av2=null,this.i1=null,this.i2=null},OIMO.ContactConstraint.prototype.preSolve=function(i,t){this.m1=this.body1.inverseMass,this.m2=this.body2.inverseMass;var s=this.i1.elements,h=this.i2.elements;this.i1e00=s[0],this.i1e01=s[1],this.i1e02=s[2],this.i1e10=s[3],this.i1e11=s[4],this.i1e12=s[5],this.i1e20=s[6],this.i1e21=s[7],this.i1e22=s[8],this.i2e00=h[0],this.i2e01=h[1],this.i2e02=h[2],this.i2e10=h[3],this.i2e11=h[4],this.i2e12=h[5],this.i2e20=h[6],this.i2e21=h[7],this.i2e22=h[8];var e=this.p1.x,a=this.p1.y,o=this.p1.z,n=this.p2.x,l=this.p2.y,r=this.p2.z,m=this.m1+this.m2;this.num=this.manifold.numPoints;for(var c=this.cs,x=0;x<this.num;x++){var p,u,y,d,O,N,M=this.ps[x];p=M.position.x,u=M.position.y,y=M.position.z;var I=p-e,v=u-a,z=y-o,f=p-n,b=u-l,A=y-r;c.rp1X=I,c.rp1Y=v,c.rp1Z=z,c.rp2X=f,c.rp2Y=b,c.rp2Z=A,c.norImp=M.normalImpulse,c.tanImp=M.tangentImpulse,c.binImp=M.binormalImpulse;var k=M.normal.x,g=M.normal.y,S=M.normal.z,w=this.lv2.x+this.av2.y*A-this.av2.z*b-(this.lv1.x+this.av1.y*z-this.av1.z*v),L=this.lv2.y+this.av2.z*f-this.av2.x*A-(this.lv1.y+this.av1.z*I-this.av1.x*z),P=this.lv2.z+this.av2.x*b-this.av2.y*f-(this.lv1.z+this.av1.x*v-this.av1.y*I),V=k*w+g*L+S*P,T=w-V*k,Y=L-V*g,X=P-V*S,C=T*T+Y*Y+X*X;C>.04?C=1/Math.sqrt(C):(T=g*k-S*S,Y=-S*g-k*k,X=k*S+g*g,C=1/Math.sqrt(T*T+Y*Y+X*X)),T*=C,Y*=C,X*=C;var Z=g*X-S*Y,D=S*T-k*X,_=k*Y-g*T;c.norX=k,c.norY=g,c.norZ=S,c.tanX=T,c.tanY=Y,c.tanZ=X,c.binX=Z,c.binY=D,c.binZ=_,c.norU1X=k*this.m1,c.norU1Y=g*this.m1,c.norU1Z=S*this.m1,c.norU2X=k*this.m2,c.norU2Y=g*this.m2,c.norU2Z=S*this.m2,c.tanU1X=T*this.m1,c.tanU1Y=Y*this.m1,c.tanU1Z=X*this.m1,c.tanU2X=T*this.m2,c.tanU2Y=Y*this.m2,c.tanU2Z=X*this.m2,c.binU1X=Z*this.m1,c.binU1Y=D*this.m1,c.binU1Z=_*this.m1,c.binU2X=Z*this.m2,c.binU2Y=D*this.m2,c.binU2Z=_*this.m2;var B=v*S-z*g,E=z*k-I*S,R=I*g-v*k,U=b*S-A*g,j=A*k-f*S,J=f*g-b*k,F=v*X-z*Y,q=z*T-I*X,Q=I*Y-v*T,W=b*X-A*Y,H=A*T-f*X,G=f*Y-b*T,K=v*_-z*D,$=z*Z-I*_,ii=I*D-v*Z,ti=b*_-A*D,si=A*Z-f*_,hi=f*D-b*Z,ei=B*this.i1e00+E*this.i1e01+R*this.i1e02,ai=B*this.i1e10+E*this.i1e11+R*this.i1e12,oi=B*this.i1e20+E*this.i1e21+R*this.i1e22,ni=U*this.i2e00+j*this.i2e01+J*this.i2e02,li=U*this.i2e10+j*this.i2e11+J*this.i2e12,ri=U*this.i2e20+j*this.i2e21+J*this.i2e22,mi=F*this.i1e00+q*this.i1e01+Q*this.i1e02,ci=F*this.i1e10+q*this.i1e11+Q*this.i1e12,xi=F*this.i1e20+q*this.i1e21+Q*this.i1e22,pi=W*this.i2e00+H*this.i2e01+G*this.i2e02,ui=W*this.i2e10+H*this.i2e11+G*this.i2e12,yi=W*this.i2e20+H*this.i2e21+G*this.i2e22,di=K*this.i1e00+$*this.i1e01+ii*this.i1e02,Oi=K*this.i1e10+$*this.i1e11+ii*this.i1e12,Ni=K*this.i1e20+$*this.i1e21+ii*this.i1e22,Mi=ti*this.i2e00+si*this.i2e01+hi*this.i2e02,Ii=ti*this.i2e10+si*this.i2e11+hi*this.i2e12,vi=ti*this.i2e20+si*this.i2e21+hi*this.i2e22;c.norT1X=B,c.norT1Y=E,c.norT1Z=R,c.tanT1X=F,c.tanT1Y=q,c.tanT1Z=Q,c.binT1X=K,c.binT1Y=$,c.binT1Z=ii,c.norT2X=U,c.norT2Y=j,c.norT2Z=J,c.tanT2X=W,c.tanT2Y=H,c.tanT2Z=G,c.binT2X=ti,c.binT2Y=si,c.binT2Z=hi,c.norTU1X=ei,c.norTU1Y=ai,c.norTU1Z=oi,c.tanTU1X=mi,c.tanTU1Y=ci,c.tanTU1Z=xi,c.binTU1X=di,c.binTU1Y=Oi,c.binTU1Z=Ni,c.norTU2X=ni,c.norTU2Y=li,c.norTU2Z=ri,c.tanTU2X=pi,c.tanTU2Y=ui,c.tanTU2Z=yi,c.binTU2X=Mi,c.binTU2Y=Ii,c.binTU2Z=vi,p=B*this.i1e00+E*this.i1e01+R*this.i1e02,u=B*this.i1e10+E*this.i1e11+R*this.i1e12,y=B*this.i1e20+E*this.i1e21+R*this.i1e22,d=u*z-y*v,O=y*I-p*z,N=p*v-u*I,p=U*this.i2e00+j*this.i2e01+J*this.i2e02,u=U*this.i2e10+j*this.i2e11+J*this.i2e12,y=U*this.i2e20+j*this.i2e21+J*this.i2e22,d+=u*A-y*b,O+=y*f-p*A,N+=p*b-u*f;var zi=1/(m+k*d+g*O+S*N);p=F*this.i1e00+q*this.i1e01+Q*this.i1e02,u=F*this.i1e10+q*this.i1e11+Q*this.i1e12,y=F*this.i1e20+q*this.i1e21+Q*this.i1e22,d=u*z-y*v,O=y*I-p*z,N=p*v-u*I,p=W*this.i2e00+H*this.i2e01+G*this.i2e02,u=W*this.i2e10+H*this.i2e11+G*this.i2e12,y=W*this.i2e20+H*this.i2e21+G*this.i2e22,d+=u*A-y*b,O+=y*f-p*A,N+=p*b-u*f;var fi=1/(m+T*d+Y*O+X*N);p=K*this.i1e00+$*this.i1e01+ii*this.i1e02,u=K*this.i1e10+$*this.i1e11+ii*this.i1e12,y=K*this.i1e20+$*this.i1e21+ii*this.i1e22,d=u*z-y*v,O=y*I-p*z,N=p*v-u*I,p=ti*this.i2e00+si*this.i2e01+hi*this.i2e02,u=ti*this.i2e10+si*this.i2e11+hi*this.i2e12,y=ti*this.i2e20+si*this.i2e21+hi*this.i2e22,d+=u*A-y*b,O+=y*f-p*A,N+=p*b-u*f;var bi=1/(m+Z*d+D*O+_*N);if(c.norDen=zi,c.tanDen=fi,c.binDen=bi,M.warmStarted){var Ai=M.normalImpulse;this.lv1.x+=c.norU1X*Ai,this.lv1.y+=c.norU1Y*Ai,this.lv1.z+=c.norU1Z*Ai,this.av1.x+=ei*Ai,this.av1.y+=ai*Ai,this.av1.z+=oi*Ai,this.lv2.x-=c.norU2X*Ai,this.lv2.y-=c.norU2Y*Ai,this.lv2.z-=c.norU2Z*Ai,this.av2.x-=ni*Ai,this.av2.y-=li*Ai,this.av2.z-=ri*Ai,c.norImp=Ai,c.tanImp=0,c.binImp=0,V=0}else c.norImp=0,c.tanImp=0,c.binImp=0;V>-1&&(V=0);var ki=this.restitution*-V,gi=-(M.penetration+.005)*t*.05;gi>ki&&(ki=gi),c.norTar=ki,c.last=x==this.num-1,c=c.next}},OIMO.ContactConstraint.prototype.solve=function(){for(var i=this.lv1.x,t=this.lv1.y,s=this.lv1.z,h=this.lv2.x,e=this.lv2.y,a=this.lv2.z,o=this.av1.x,n=this.av1.y,l=this.av1.z,r=this.av2.x,m=this.av2.y,c=this.av2.z,x=this.cs;;){var p,u,y,d,O,N=x.norImp,M=x.tanImp,I=x.binImp,v=-N*this.friction,z=h-i,f=e-t,b=a-s;O=z*x.tanX+f*x.tanY+b*x.tanZ+r*x.tanT2X+m*x.tanT2Y+c*x.tanT2Z-o*x.tanT1X-n*x.tanT1Y-l*x.tanT1Z,p=M,u=O*x.tanDen,M+=u,O=z*x.binX+f*x.binY+b*x.binZ+r*x.binT2X+m*x.binT2Y+c*x.binT2Z-o*x.binT1X-n*x.binT1Y-l*x.binT1Z,y=I,d=O*x.binDen,I+=d;var A=M*M+I*I;if(A>v*v&&(A=v/Math.sqrt(A),M*=A,I*=A),u=M-p,d=I-y,i+=x.tanU1X*u+x.binU1X*d,t+=x.tanU1Y*u+x.binU1Y*d,s+=x.tanU1Z*u+x.binU1Z*d,o+=x.tanTU1X*u+x.binTU1X*d,n+=x.tanTU1Y*u+x.binTU1Y*d,l+=x.tanTU1Z*u+x.binTU1Z*d,h-=x.tanU2X*u+x.binU2X*d,e-=x.tanU2Y*u+x.binU2Y*d,a-=x.tanU2Z*u+x.binU2Z*d,r-=x.tanTU2X*u+x.binTU2X*d,m-=x.tanTU2Y*u+x.binTU2Y*d,c-=x.tanTU2Z*u+x.binTU2Z*d,O=(h-i)*x.norX+(e-t)*x.norY+(a-s)*x.norZ+r*x.norT2X+m*x.norT2Y+c*x.norT2Z-o*x.norT1X-n*x.norT1Y-l*x.norT1Z,p=N,u=(O-x.norTar)*x.norDen,N+=u,N>0&&(N=0),u=N-p,i+=x.norU1X*u,t+=x.norU1Y*u,s+=x.norU1Z*u,o+=x.norTU1X*u,n+=x.norTU1Y*u,l+=x.norTU1Z*u,h-=x.norU2X*u,e-=x.norU2Y*u,a-=x.norU2Z*u,r-=x.norTU2X*u,m-=x.norTU2Y*u,c-=x.norTU2Z*u,x.norImp=N,x.tanImp=M,x.binImp=I,x.last)break;x=x.next}this.lv1.x=i,this.lv1.y=t,this.lv1.z=s,this.lv2.x=h,this.lv2.y=e,this.lv2.z=a,this.av1.x=o,this.av1.y=n,this.av1.z=l,this.av2.x=r,this.av2.y=m,this.av2.z=c},OIMO.ContactConstraint.prototype.postSolve=function(){for(var i=this.cs,t=this.num;t--;){var s=this.ps[t];s.normal.x=i.norX,s.normal.y=i.norY,s.normal.z=i.norZ,s.tangent.x=i.tanX,s.tangent.y=i.tanY,s.tangent.z=i.tanZ,s.binormal.x=i.binX,s.binormal.y=i.binY,s.binormal.z=i.binZ,s.normalImpulse=i.norImp,s.tangentImpulse=i.tanImp,s.binormalImpulse=i.binImp,s.normalDenominator=i.norDen,s.tangentDenominator=i.tanDen,s.binormalDenominator=i.binDen,i=i.next}},OIMO.ContactLink=function(i){this.prev=null,this.next=null,this.shape=null,this.body=null,this.contact=i},OIMO.ContactManifold=function(){this.body1=null,this.body2=null,this.numPoints=0,this.points=[],this.points.length=4,this.points[0]=new OIMO.ManifoldPoint,this.points[1]=new OIMO.ManifoldPoint,this.points[2]=new OIMO.ManifoldPoint,this.points[3]=new OIMO.ManifoldPoint},OIMO.ContactManifold.prototype={constructor:OIMO.ContactManifold,reset:function(i,t){this.body1=i.parent,this.body2=t.parent,this.numPoints=0},addPoint:function(i,t,s,h,e,a,o,n){var l=this.points[this.numPoints++];l.position.x=i,l.position.y=t,l.position.z=s;var r=this.body1.rotation,m=i-this.body1.position.x,c=t-this.body1.position.y,x=s-this.body1.position.z,p=r.elements;l.localPoint1.x=m*p[0]+c*p[3]+x*p[6],l.localPoint1.y=m*p[1]+c*p[4]+x*p[7],l.localPoint1.z=m*p[2]+c*p[5]+x*p[8],r=this.body2.rotation,m=i-this.body2.position.x,c=t-this.body2.position.y,x=s-this.body2.position.z,l.localPoint2.x=m*p[0]+c*p[3]+x*p[6],l.localPoint2.y=m*p[1]+c*p[4]+x*p[7],l.localPoint2.z=m*p[2]+c*p[5]+x*p[8],l.normalImpulse=0,n?(l.normal.x=-h,l.normal.y=-e,l.normal.z=-a):(l.normal.x=h,l.normal.y=e,l.normal.z=a),l.penetration=o,l.warmStarted=!1}},OIMO.ContactPointDataBuffer=function(){this.norX=NaN,this.norY=NaN,this.norZ=NaN,this.tanX=NaN,this.tanY=NaN,this.tanZ=NaN,this.binX=NaN,this.binY=NaN,this.binZ=NaN,this.rp1X=NaN,this.rp1Y=NaN,this.rp1Z=NaN,this.rp2X=NaN,this.rp2Y=NaN,this.rp2Z=NaN,this.norU1X=NaN,this.norU1Y=NaN,this.norU1Z=NaN,this.norU2X=NaN,this.norU2Y=NaN,this.norU2Z=NaN,this.tanU1X=NaN,this.tanU1Y=NaN,this.tanU1Z=NaN,this.tanU2X=NaN,this.tanU2Y=NaN,this.tanU2Z=NaN,this.binU1X=NaN,this.binU1Y=NaN,this.binU1Z=NaN,this.binU2X=NaN,this.binU2Y=NaN,this.binU2Z=NaN,this.norT1X=NaN,this.norT1Y=NaN,this.norT1Z=NaN,this.norT2X=NaN,this.norT2Y=NaN,this.norT2Z=NaN,this.tanT1X=NaN,this.tanT1Y=NaN,this.tanT1Z=NaN,this.tanT2X=NaN,this.tanT2Y=NaN,this.tanT2Z=NaN,this.binT1X=NaN,this.binT1Y=NaN,this.binT1Z=NaN,this.binT2X=NaN,this.binT2Y=NaN,this.binT2Z=NaN,this.norTU1X=NaN,this.norTU1Y=NaN,this.norTU1Z=NaN,this.norTU2X=NaN,this.norTU2Y=NaN,this.norTU2Z=NaN,this.tanTU1X=NaN,this.tanTU1Y=NaN,this.tanTU1Z=NaN,this.tanTU2X=NaN,this.tanTU2Y=NaN,this.tanTU2Z=NaN,this.binTU1X=NaN,this.binTU1Y=NaN,this.binTU1Z=NaN,this.binTU2X=NaN,this.binTU2Y=NaN,this.binTU2Z=NaN,this.norImp=NaN,this.tanImp=NaN,this.binImp=NaN,this.norDen=NaN,this.tanDen=NaN,this.binDen=NaN,this.norTar=NaN,this.next=null,this.last=!1},OIMO.ImpulseDataBuffer=function(){this.lp1X=NaN,this.lp1Y=NaN,this.lp1Z=NaN,this.lp2X=NaN,this.lp2Y=NaN,this.lp2Z=NaN,this.impulse=NaN},OIMO.ManifoldPoint=function(){this.warmStarted=!1,this.position=new OIMO.Vec3,this.localPoint1=new OIMO.Vec3,this.localPoint2=new OIMO.Vec3,this.normal=new OIMO.Vec3,this.tangent=new OIMO.Vec3,this.binormal=new OIMO.Vec3,this.normalImpulse=0,this.tangentImpulse=0,this.binormalImpulse=0,this.normalDenominator=0,this.tangentDenominator=0,this.binormalDenominator=0,this.penetration=0},OIMO.MassInfo=function(){this.mass=0,this.inertia=new OIMO.Mat33},OIMO.Shape=function(i){this.id=OIMO.nextID++,this.prev=null,this.next=null,this.type=0,this.proxy=null,this.parent=null,this.contactLink=null,this.numContacts=0,this.position=new OIMO.Vec3,this.rotation=new OIMO.Mat33,this.relativePosition=(new OIMO.Vec3).copy(i.relativePosition),this.relativeRotation=(new OIMO.Mat33).copy(i.relativeRotation),this.aabb=new OIMO.AABB,this.density=i.density,this.friction=i.friction,this.restitution=i.restitution,this.belongsTo=i.belongsTo,this.collidesWith=i.collidesWith},OIMO.Shape.prototype={constructor:OIMO.Shape,calculateMassInfo:function(i){throw new Error("Inheritance error.")},updateProxy:function(){throw new Error("Inheritance error.")}},OIMO.ShapeConfig=function(){this.relativePosition=new OIMO.Vec3,this.relativeRotation=new OIMO.Mat33,this.friction=.4,this.restitution=.2,this.density=1,this.belongsTo=1,this.collidesWith=4294967295},OIMO.BoxShape=function(i,t,s,h){OIMO.Shape.call(this,i),this.width=t,this.height=s,this.depth=h,this.halfWidth=.5*t,this.halfHeight=.5*s,this.halfDepth=.5*h,this.dimentions=new OIMO_ARRAY_TYPE(18),this.elements=new OIMO_ARRAY_TYPE(24),this.type=OIMO.SHAPE_BOX},OIMO.BoxShape.prototype=Object.create(OIMO.Shape.prototype),OIMO.BoxShape.prototype.calculateMassInfo=function(i){var t=this.width*this.height*this.depth*this.density;i.mass=t,i.inertia.init(t*(this.height*this.height+this.depth*this.depth)/12,0,0,0,t*(this.width*this.width+this.depth*this.depth)/12,0,0,0,t*(this.width*this.width+this.height*this.height)/12)},OIMO.BoxShape.prototype.updateProxy=function(){var i=this.rotation.elements,t=this.dimentions;t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],t[9]=i[0]*this.halfWidth,t[10]=i[3]*this.halfWidth,t[11]=i[6]*this.halfWidth,t[12]=i[1]*this.halfHeight,t[13]=i[4]*this.halfHeight,t[14]=i[7]*this.halfHeight,t[15]=i[2]*this.halfDepth,t[16]=i[5]*this.halfDepth,t[17]=i[8]*this.halfDepth;var s=t[9],h=t[10],e=t[11],a=t[12],o=t[13],n=t[14],l=t[15],r=t[16],m=t[17],c=this.position.x,x=this.position.y,p=this.position.z,u=this.elements;u[0]=c+s+a+l,u[1]=x+h+o+r,u[2]=p+e+n+m,u[3]=c+s+a-l,u[4]=x+h+o-r,u[5]=p+e+n-m,u[6]=c+s-a+l,u[7]=x+h-o+r,u[8]=p+e-n+m,u[9]=c+s-a-l,u[10]=x+h-o-r,u[11]=p+e-n-m,u[12]=c-s+a+l,u[13]=x-h+o+r,u[14]=p-e+n+m,u[15]=c-s+a-l,u[16]=x-h+o-r,u[17]=p-e+n-m,u[18]=c-s-a+l,u[19]=x-h-o+r,u[20]=p-e-n+m,u[21]=c-s-a-l,u[22]=x-h-o-r,u[23]=p-e-n-m;var y=t[9]<0?-t[9]:t[9],d=t[10]<0?-t[10]:t[10],O=t[11]<0?-t[11]:t[11];y=t[12]<0?y-t[12]:y+t[12],d=t[13]<0?d-t[13]:d+t[13],O=t[14]<0?O-t[14]:O+t[14],y=t[15]<0?y-t[15]:y+t[15],d=t[16]<0?d-t[16]:d+t[16],O=t[17]<0?O-t[17]:O+t[17],this.aabb.init(this.position.x-y-.005,this.position.x+y+.005,this.position.y-d-.005,this.position.y+d+.005,this.position.z-O-.005,this.position.z+O+.005),null!==this.proxy&&this.proxy.update()},OIMO.SphereShape=function(i,t){OIMO.Shape.call(this,i),this.radius=t,this.type=OIMO.SHAPE_SPHERE},OIMO.SphereShape.prototype=Object.create(OIMO.Shape.prototype),OIMO.SphereShape.prototype.calculateMassInfo=function(i){var t=4/3*Math.PI*this.radius*this.radius*this.radius*this.density;i.mass=t;var s=t*this.radius*this.radius*2/5;i.inertia.init(s,0,0,0,s,0,0,0,s)},OIMO.SphereShape.prototype.updateProxy=function(){this.aabb.init(this.position.x-this.radius-.005,this.position.x+this.radius+.005,this.position.y-this.radius-.005,this.position.y+this.radius+.005,this.position.z-this.radius-.005,this.position.z+this.radius+.005),null!==this.proxy&&this.proxy.update()},OIMO.CollisionDetector=function(){this.flip=!1},OIMO.CollisionDetector.prototype={constructor:OIMO.CollisionDetector,detectCollision:function(i,t,s){throw new Error("Inheritance error.")}},OIMO.BoxBoxCollisionDetector=function(){OIMO.CollisionDetector.call(this),this.clipVertices1=new OIMO_ARRAY_TYPE(24),this.clipVertices2=new OIMO_ARRAY_TYPE(24),this.used=new OIMO_ARRAY_TYPE(8),this.INF=1/0},OIMO.BoxBoxCollisionDetector.prototype=Object.create(OIMO.CollisionDetector.prototype),OIMO.BoxBoxCollisionDetector.prototype.detectCollision=function(i,t,s){var h,e;i.id<t.id?(h=i,e=t):(h=t,e=i);var a,o,n,l,r,m,c,x,p,u,y,d,O,N,M,I,v,z,f,b,A,k,g,S,w,L,P,V,T,Y,X,C,Z,D,_,B,E=h.elements,R=e.elements,U=h.dimentions,j=e.dimentions,J=h.position,F=e.position,q=J.x,Q=J.y,W=J.z,H=F.x,G=F.y,K=F.z,$=H-q,ii=G-Q,ti=K-W,si=h.halfWidth,hi=h.halfHeight,ei=h.halfDepth,ai=e.halfWidth,oi=e.halfHeight,ni=e.halfDepth,li=U[0],ri=U[1],mi=U[2],ci=U[3],xi=U[4],pi=U[5],ui=U[6],yi=U[7],di=U[8],Oi=U[9],Ni=U[10],Mi=U[11],Ii=U[12],vi=U[13],zi=U[14],fi=U[15],bi=U[16],Ai=U[17],ki=j[0],gi=j[1],Si=j[2],wi=j[3],Li=j[4],Pi=j[5],Vi=j[6],Ti=j[7],Yi=j[8],Xi=j[9],Ci=j[10],Zi=j[11],Di=j[12],_i=j[13],Bi=j[14],Ei=j[15],Ri=j[16],Ui=j[17],ji=ri*Si-mi*gi,Ji=mi*ki-li*Si,Fi=li*gi-ri*ki,qi=ri*Pi-mi*Li,Qi=mi*wi-li*Pi,Wi=li*Li-ri*wi,Hi=ri*Yi-mi*Ti,Gi=mi*Vi-li*Yi,Ki=li*Ti-ri*Vi,$i=xi*Si-pi*gi,it=pi*ki-ci*Si,tt=ci*gi-xi*ki,st=xi*Pi-pi*Li,ht=pi*wi-ci*Pi,et=ci*Li-xi*wi,at=xi*Yi-pi*Ti,ot=pi*Vi-ci*Yi,nt=ci*Ti-xi*Vi,lt=yi*Si-di*gi,rt=di*ki-ui*Si,mt=ui*gi-yi*ki,ct=yi*Pi-di*Li,xt=di*wi-ui*Pi,pt=ui*Li-yi*wi,ut=yi*Yi-di*Ti,yt=di*Vi-ui*Yi,dt=ui*Ti-yi*Vi,Ot=!1,Nt=!1,Mt=!1,It=!1,vt=!1,zt=!1,ft=!1,bt=!1,At=!1;if(X=li*$+ri*ii+mi*ti,a=X>0,a||(X=-X),C=si,D=li*ki+ri*gi+mi*Si,_=li*wi+ri*Li+mi*Pi,B=li*Vi+ri*Ti+mi*Yi,0>D&&(D=-D),0>_&&(_=-_),0>B&&(B=-B),Z=D*ai+_*oi+B*ni,I=X-C-Z,!(I>0||(X=ci*$+xi*ii+pi*ti,o=X>0,o||(X=-X),C=hi,D=ci*ki+xi*gi+pi*Si,_=ci*wi+xi*Li+pi*Pi,B=ci*Vi+xi*Ti+pi*Yi,0>D&&(D=-D),0>_&&(_=-_),0>B&&(B=-B),Z=D*ai+_*oi+B*ni,v=X-C-Z,v>0||(X=ui*$+yi*ii+di*ti,n=X>0,n||(X=-X),C=ei,D=ui*ki+yi*gi+di*Si,_=ui*wi+yi*Li+di*Pi,B=ui*Vi+yi*Ti+di*Yi,0>D&&(D=-D),0>_&&(_=-_),0>B&&(B=-B),Z=D*ai+_*oi+B*ni,z=X-C-Z,z>0||(X=ki*$+gi*ii+Si*ti,l=X>0,l||(X=-X),D=ki*li+gi*ri+Si*mi,_=ki*ci+gi*xi+Si*pi,B=ki*ui+gi*yi+Si*di,0>D&&(D=-D),0>_&&(_=-_),0>B&&(B=-B),C=D*si+_*hi+B*ei,Z=ai,f=1*(X-C-Z),f>0||(X=wi*$+Li*ii+Pi*ti,r=X>0,r||(X=-X),D=wi*li+Li*ri+Pi*mi,_=wi*ci+Li*xi+Pi*pi,
B=wi*ui+Li*yi+Pi*di,0>D&&(D=-D),0>_&&(_=-_),0>B&&(B=-B),C=D*si+_*hi+B*ei,Z=oi,b=1*(X-C-Z),b>0||(X=Vi*$+Ti*ii+Yi*ti,m=X>0,m||(X=-X),D=Vi*li+Ti*ri+Yi*mi,_=Vi*ci+Ti*xi+Yi*pi,B=Vi*ui+Ti*yi+Yi*di,0>D&&(D=-D),0>_&&(_=-_),0>B&&(B=-B),C=D*si+_*hi+B*ei,Z=ni,A=1*(X-C-Z),A>0))))))){if(X=ji*ji+Ji*Ji+Fi*Fi,X>1e-5){if(X=1/Math.sqrt(X),ji*=X,Ji*=X,Fi*=X,X=ji*$+Ji*ii+Fi*ti,c=X>0,c||(X=-X),D=ji*ci+Ji*xi+Fi*pi,_=ji*ui+Ji*yi+Fi*di,0>D&&(D=-D),0>_&&(_=-_),C=D*hi+_*ei,D=ji*wi+Ji*Li+Fi*Pi,_=ji*Vi+Ji*Ti+Fi*Yi,0>D&&(D=-D),0>_&&(_=-_),Z=D*oi+_*ni,k=X-C-Z,k>0)return}else c=!1,k=0,Ot=!0;if(X=qi*qi+Qi*Qi+Wi*Wi,X>1e-5){if(X=1/Math.sqrt(X),qi*=X,Qi*=X,Wi*=X,X=qi*$+Qi*ii+Wi*ti,x=X>0,x||(X=-X),D=qi*ci+Qi*xi+Wi*pi,_=qi*ui+Qi*yi+Wi*di,0>D&&(D=-D),0>_&&(_=-_),C=D*hi+_*ei,D=qi*ki+Qi*gi+Wi*Si,_=qi*Vi+Qi*Ti+Wi*Yi,0>D&&(D=-D),0>_&&(_=-_),Z=D*ai+_*ni,g=X-C-Z,g>0)return}else x=!1,g=0,Nt=!0;if(X=Hi*Hi+Gi*Gi+Ki*Ki,X>1e-5){if(X=1/Math.sqrt(X),Hi*=X,Gi*=X,Ki*=X,X=Hi*$+Gi*ii+Ki*ti,p=X>0,p||(X=-X),D=Hi*ci+Gi*xi+Ki*pi,_=Hi*ui+Gi*yi+Ki*di,0>D&&(D=-D),0>_&&(_=-_),C=D*hi+_*ei,D=Hi*ki+Gi*gi+Ki*Si,_=Hi*wi+Gi*Li+Ki*Pi,0>D&&(D=-D),0>_&&(_=-_),Z=D*ai+_*oi,S=X-C-Z,S>0)return}else p=!1,S=0,Mt=!0;if(X=$i*$i+it*it+tt*tt,X>1e-5){if(X=1/Math.sqrt(X),$i*=X,it*=X,tt*=X,X=$i*$+it*ii+tt*ti,u=X>0,u||(X=-X),D=$i*li+it*ri+tt*mi,_=$i*ui+it*yi+tt*di,0>D&&(D=-D),0>_&&(_=-_),C=D*si+_*ei,D=$i*wi+it*Li+tt*Pi,_=$i*Vi+it*Ti+tt*Yi,0>D&&(D=-D),0>_&&(_=-_),Z=D*oi+_*ni,w=X-C-Z,w>0)return}else u=!1,w=0,It=!0;if(X=st*st+ht*ht+et*et,X>1e-5){if(X=1/Math.sqrt(X),st*=X,ht*=X,et*=X,X=st*$+ht*ii+et*ti,y=X>0,y||(X=-X),D=st*li+ht*ri+et*mi,_=st*ui+ht*yi+et*di,0>D&&(D=-D),0>_&&(_=-_),C=D*si+_*ei,D=st*ki+ht*gi+et*Si,_=st*Vi+ht*Ti+et*Yi,0>D&&(D=-D),0>_&&(_=-_),Z=D*ai+_*ni,L=X-C-Z,L>0)return}else y=!1,L=0,vt=!0;if(X=at*at+ot*ot+nt*nt,X>1e-5){if(X=1/Math.sqrt(X),at*=X,ot*=X,nt*=X,X=at*$+ot*ii+nt*ti,d=X>0,d||(X=-X),D=at*li+ot*ri+nt*mi,_=at*ui+ot*yi+nt*di,0>D&&(D=-D),0>_&&(_=-_),C=D*si+_*ei,D=at*ki+ot*gi+nt*Si,_=at*wi+ot*Li+nt*Pi,0>D&&(D=-D),0>_&&(_=-_),Z=D*ai+_*oi,P=X-C-Z,P>0)return}else d=!1,P=0,zt=!0;if(X=lt*lt+rt*rt+mt*mt,X>1e-5){if(X=1/Math.sqrt(X),lt*=X,rt*=X,mt*=X,X=lt*$+rt*ii+mt*ti,O=X>0,O||(X=-X),D=lt*li+rt*ri+mt*mi,_=lt*ci+rt*xi+mt*pi,0>D&&(D=-D),0>_&&(_=-_),C=D*si+_*hi,D=lt*wi+rt*Li+mt*Pi,_=lt*Vi+rt*Ti+mt*Yi,0>D&&(D=-D),0>_&&(_=-_),Z=D*oi+_*ni,V=X-C-Z,V>0)return}else O=!1,V=0,ft=!0;if(X=ct*ct+xt*xt+pt*pt,X>1e-5){if(X=1/Math.sqrt(X),ct*=X,xt*=X,pt*=X,X=ct*$+xt*ii+pt*ti,N=X>0,N||(X=-X),D=ct*li+xt*ri+pt*mi,_=ct*ci+xt*xi+pt*pi,0>D&&(D=-D),0>_&&(_=-_),C=D*si+_*hi,D=ct*ki+xt*gi+pt*Si,_=ct*Vi+xt*Ti+pt*Yi,0>D&&(D=-D),0>_&&(_=-_),Z=D*ai+_*ni,T=X-C-Z,T>0)return}else N=!1,T=0,bt=!0;if(X=ut*ut+yt*yt+dt*dt,X>1e-5){if(X=1/Math.sqrt(X),ut*=X,yt*=X,dt*=X,X=ut*$+yt*ii+dt*ti,M=X>0,M||(X=-X),D=ut*li+yt*ri+dt*mi,_=ut*ci+yt*xi+dt*pi,0>D&&(D=-D),0>_&&(_=-_),C=D*si+_*hi,D=ut*ki+yt*gi+dt*Si,_=ut*wi+yt*Li+dt*Pi,0>D&&(D=-D),0>_&&(_=-_),Z=D*ai+_*oi,Y=X-C-Z,Y>0)return}else M=!1,Y=0,At=!0;var kt=I,gt=I,St=0,wt=a;v>gt&&(kt=v,gt=v,St=1,wt=o),z>gt&&(kt=z,gt=z,St=2,wt=n),f>gt&&(kt=f,gt=f,St=3,wt=l),b>gt&&(kt=b,gt=b,St=4,wt=r),A>gt&&(kt=A,gt=A,St=5,wt=m),k-.01>gt&&!Ot&&(kt=k,gt=k-.01,St=6,wt=c),g-.01>gt&&!Nt&&(kt=g,gt=g-.01,St=7,wt=x),S-.01>gt&&!Mt&&(kt=S,gt=S-.01,St=8,wt=p),w-.01>gt&&!It&&(kt=w,gt=w-.01,St=9,wt=u),L-.01>gt&&!vt&&(kt=L,gt=L-.01,St=10,wt=y),P-.01>gt&&!zt&&(kt=P,gt=P-.01,St=11,wt=d),V-.01>gt&&!ft&&(kt=V,gt=V-.01,St=12,wt=O),T-.01>gt&&!bt&&(kt=T,gt=T-.01,St=13,wt=N),Y-.01>gt&&!At&&(kt=Y,St=14,wt=M);var Lt=0,Pt=0,Vt=0,Tt=0,Yt=0,Xt=0,Ct=0,Zt=0,Dt=0,_t=0,Bt=0,Et=0,Rt=0,Ut=0,jt=0,Jt=0,Ft=0,qt=0,Qt=!1;0==St?(wt?(_t=q+Oi,Bt=Q+Ni,Et=W+Mi,Lt=li,Pt=ri,Vt=mi):(_t=q-Oi,Bt=Q-Ni,Et=W-Mi,Lt=-li,Pt=-ri,Vt=-mi),Rt=Ii,Ut=vi,jt=zi,Tt=-ci,Yt=-xi,Xt=-pi,Jt=fi,Ft=bi,qt=Ai,Ct=-ui,Zt=-yi,Dt=-di):1==St?(wt?(_t=q+Ii,Bt=Q+vi,Et=W+zi,Lt=ci,Pt=xi,Vt=pi):(_t=q-Ii,Bt=Q-vi,Et=W-zi,Lt=-ci,Pt=-xi,Vt=-pi),Rt=Oi,Ut=Ni,jt=Mi,Tt=-li,Yt=-ri,Xt=-mi,Jt=fi,Ft=bi,qt=Ai,Ct=-ui,Zt=-yi,Dt=-di):2==St?(wt?(_t=q+fi,Bt=Q+bi,Et=W+Ai,Lt=ui,Pt=yi,Vt=di):(_t=q-fi,Bt=Q-bi,Et=W-Ai,Lt=-ui,Pt=-yi,Vt=-di),Rt=Oi,Ut=Ni,jt=Mi,Tt=-li,Yt=-ri,Xt=-mi,Jt=Ii,Ft=vi,qt=zi,Ct=-ci,Zt=-xi,Dt=-pi):3==St?(Qt=!0,wt?(_t=H-Xi,Bt=G-Ci,Et=K-Zi,Lt=-ki,Pt=-gi,Vt=-Si):(_t=H+Xi,Bt=G+Ci,Et=K+Zi,Lt=ki,Pt=gi,Vt=Si),Rt=Di,Ut=_i,jt=Bi,Tt=-wi,Yt=-Li,Xt=-Pi,Jt=Ei,Ft=Ri,qt=Ui,Ct=-Vi,Zt=-Ti,Dt=-Yi):4==St?(Qt=!0,wt?(_t=H-Di,Bt=G-_i,Et=K-Bi,Lt=-wi,Pt=-Li,Vt=-Pi):(_t=H+Di,Bt=G+_i,Et=K+Bi,Lt=wi,Pt=Li,Vt=Pi),Rt=Xi,Ut=Ci,jt=Zi,Tt=-ki,Yt=-gi,Xt=-Si,Jt=Ei,Ft=Ri,qt=Ui,Ct=-Vi,Zt=-Ti,Dt=-Yi):5==St?(Qt=!0,wt?(_t=H-Ei,Bt=G-Ri,Et=K-Ui,Lt=-Vi,Pt=-Ti,Vt=-Yi):(_t=H+Ei,Bt=G+Ri,Et=K+Ui,Lt=Vi,Pt=Ti,Vt=Yi),Rt=Xi,Ut=Ci,jt=Zi,Tt=-ki,Yt=-gi,Xt=-Si,Jt=Di,Ft=_i,qt=Bi,Ct=-wi,Zt=-Li,Dt=-Pi):6==St?(Lt=ji,Pt=Ji,Vt=Fi,Tt=li,Yt=ri,Xt=mi,Ct=ki,Zt=gi,Dt=Si):7==St?(Lt=qi,Pt=Qi,Vt=Wi,Tt=li,Yt=ri,Xt=mi,Ct=wi,Zt=Li,Dt=Pi):8==St?(Lt=Hi,Pt=Gi,Vt=Ki,Tt=li,Yt=ri,Xt=mi,Ct=Vi,Zt=Ti,Dt=Yi):9==St?(Lt=$i,Pt=it,Vt=tt,Tt=ci,Yt=xi,Xt=pi,Ct=ki,Zt=gi,Dt=Si):10==St?(Lt=st,Pt=ht,Vt=et,Tt=ci,Yt=xi,Xt=pi,Ct=wi,Zt=Li,Dt=Pi):11==St?(Lt=at,Pt=ot,Vt=nt,Tt=ci,Yt=xi,Xt=pi,Ct=Vi,Zt=Ti,Dt=Yi):12==St?(Lt=lt,Pt=rt,Vt=mt,Tt=ui,Yt=yi,Xt=di,Ct=ki,Zt=gi,Dt=Si):13==St?(Lt=ct,Pt=xt,Vt=pt,Tt=ui,Yt=yi,Xt=di,Ct=wi,Zt=Li,Dt=Pi):14==St&&(Lt=ut,Pt=yt,Vt=dt,Tt=ui,Yt=yi,Xt=di,Ct=Vi,Zt=Ti,Dt=Yi);if(St>5){wt||(Lt=-Lt,Pt=-Pt,Vt=-Vt);var Wt,Ht,Gt,Kt,$t,is,ts,ss,hs,es,as;is=E[0],ts=E[1],ss=E[2],Ht=Lt*is+Pt*ts+Vt*ss,Gt=E[3],Kt=E[4],$t=E[5],Wt=Lt*Gt+Pt*Kt+Vt*$t,Wt>Ht&&(Ht=Wt,is=Gt,ts=Kt,ss=$t),Gt=E[6],Kt=E[7],$t=E[8],Wt=Lt*Gt+Pt*Kt+Vt*$t,Wt>Ht&&(Ht=Wt,is=Gt,ts=Kt,ss=$t),Gt=E[9],Kt=E[10],$t=E[11],Wt=Lt*Gt+Pt*Kt+Vt*$t,Wt>Ht&&(Ht=Wt,is=Gt,ts=Kt,ss=$t),Gt=E[12],Kt=E[13],$t=E[14],Wt=Lt*Gt+Pt*Kt+Vt*$t,Wt>Ht&&(Ht=Wt,is=Gt,ts=Kt,ss=$t),Gt=E[15],Kt=E[16],$t=E[17],Wt=Lt*Gt+Pt*Kt+Vt*$t,Wt>Ht&&(Ht=Wt,is=Gt,ts=Kt,ss=$t),Gt=E[18],Kt=E[19],$t=E[20],Wt=Lt*Gt+Pt*Kt+Vt*$t,Wt>Ht&&(Ht=Wt,is=Gt,ts=Kt,ss=$t),Gt=E[21],Kt=E[22],$t=E[23],Wt=Lt*Gt+Pt*Kt+Vt*$t,Wt>Ht&&(Ht=Wt,is=Gt,ts=Kt,ss=$t),hs=R[0],es=R[1],as=R[2],Ht=Lt*hs+Pt*es+Vt*as,Gt=R[3],Kt=R[4],$t=R[5],Wt=Lt*Gt+Pt*Kt+Vt*$t,Ht>Wt&&(Ht=Wt,hs=Gt,es=Kt,as=$t),Gt=R[6],Kt=R[7],$t=R[8],Wt=Lt*Gt+Pt*Kt+Vt*$t,Ht>Wt&&(Ht=Wt,hs=Gt,es=Kt,as=$t),Gt=R[9],Kt=R[10],$t=R[11],Wt=Lt*Gt+Pt*Kt+Vt*$t,Ht>Wt&&(Ht=Wt,hs=Gt,es=Kt,as=$t),Gt=R[12],Kt=R[13],$t=R[14],Wt=Lt*Gt+Pt*Kt+Vt*$t,Ht>Wt&&(Ht=Wt,hs=Gt,es=Kt,as=$t),Gt=R[15],Kt=R[16],$t=R[17],Wt=Lt*Gt+Pt*Kt+Vt*$t,Ht>Wt&&(Ht=Wt,hs=Gt,es=Kt,as=$t),Gt=R[18],Kt=R[19],$t=R[20],Wt=Lt*Gt+Pt*Kt+Vt*$t,Ht>Wt&&(Ht=Wt,hs=Gt,es=Kt,as=$t),Gt=R[21],Kt=R[22],$t=R[23],Wt=Lt*Gt+Pt*Kt+Vt*$t,Ht>Wt&&(Ht=Wt,hs=Gt,es=Kt,as=$t),Gt=hs-is,Kt=es-ts,$t=as-ss,D=Tt*Ct+Yt*Zt+Xt*Dt;var os=(Gt*(Tt-Ct*D)+Kt*(Yt-Zt*D)+$t*(Xt-Dt*D))/(1-D*D);return void s.addPoint(is+Tt*os+Lt*kt*.5,ts+Yt*os+Pt*kt*.5,ss+Xt*os+Vt*kt*.5,Lt,Pt,Vt,kt,!1)}var ns,ls,rs,ms,cs,xs,ps,us,ys,ds,Os,Ns,Ms=1,Is=0,vs=0;Qt?(Is=li*Lt+ri*Pt+mi*Vt,Ms>Is&&(Ms=Is,vs=0),Ms>-Is&&(Ms=-Is,vs=1),Is=ci*Lt+xi*Pt+pi*Vt,Ms>Is&&(Ms=Is,vs=2),Ms>-Is&&(Ms=-Is,vs=3),Is=ui*Lt+yi*Pt+di*Vt,Ms>Is&&(Ms=Is,vs=4),Ms>-Is&&(Ms=-Is,vs=5),0==vs?(ns=E[0],ls=E[1],rs=E[2],ms=E[6],cs=E[7],xs=E[8],ps=E[9],us=E[10],ys=E[11],ds=E[3],Os=E[4],Ns=E[5]):1==vs?(ns=E[15],ls=E[16],rs=E[17],ms=E[21],cs=E[22],xs=E[23],ps=E[18],us=E[19],ys=E[20],ds=E[12],Os=E[13],Ns=E[14]):2==vs?(ns=E[12],ls=E[13],rs=E[14],ms=E[0],cs=E[1],xs=E[2],ps=E[3],us=E[4],ys=E[5],ds=E[15],Os=E[16],Ns=E[17]):3==vs?(ns=E[21],ls=E[22],rs=E[23],ms=E[9],cs=E[10],xs=E[11],ps=E[6],us=E[7],ys=E[8],ds=E[18],Os=E[19],Ns=E[20]):4==vs?(ns=E[12],ls=E[13],rs=E[14],ms=E[18],cs=E[19],xs=E[20],ps=E[6],us=E[7],ys=E[8],ds=E[0],Os=E[1],Ns=E[2]):5==vs&&(ns=E[3],ls=E[4],rs=E[5],ms=E[6],cs=E[7],xs=E[8],ps=E[21],us=E[22],ys=E[23],ds=E[15],Os=E[16],Ns=E[17])):(Is=ki*Lt+gi*Pt+Si*Vt,Ms>Is&&(Ms=Is,vs=0),Ms>-Is&&(Ms=-Is,vs=1),Is=wi*Lt+Li*Pt+Pi*Vt,Ms>Is&&(Ms=Is,vs=2),Ms>-Is&&(Ms=-Is,vs=3),Is=Vi*Lt+Ti*Pt+Yi*Vt,Ms>Is&&(Ms=Is,vs=4),Ms>-Is&&(Ms=-Is,vs=5),0==vs?(ns=R[0],ls=R[1],rs=R[2],ms=R[6],cs=R[7],xs=R[8],ps=R[9],us=R[10],ys=R[11],ds=R[3],Os=R[4],Ns=R[5]):1==vs?(ns=R[15],ls=R[16],rs=R[17],ms=R[21],cs=R[22],xs=R[23],ps=R[18],us=R[19],ys=R[20],ds=R[12],Os=R[13],Ns=R[14]):2==vs?(ns=R[12],ls=R[13],rs=R[14],ms=R[0],cs=R[1],xs=R[2],ps=R[3],us=R[4],ys=R[5],ds=R[15],Os=R[16],Ns=R[17]):3==vs?(ns=R[21],ls=R[22],rs=R[23],ms=R[9],cs=R[10],xs=R[11],ps=R[6],us=R[7],ys=R[8],ds=R[18],Os=R[19],Ns=R[20]):4==vs?(ns=R[12],ls=R[13],rs=R[14],ms=R[18],cs=R[19],xs=R[20],ps=R[6],us=R[7],ys=R[8],ds=R[0],Os=R[1],Ns=R[2]):5==vs&&(ns=R[3],ls=R[4],rs=R[5],ms=R[9],cs=R[10],xs=R[11],ps=R[21],us=R[22],ys=R[23],ds=R[15],Os=R[16],Ns=R[17]));var zs,fs,bs,As,ks,gs,Ss,ws,Ls;this.clipVertices1[0]=ns,this.clipVertices1[1]=ls,this.clipVertices1[2]=rs,this.clipVertices1[3]=ms,this.clipVertices1[4]=cs,this.clipVertices1[5]=xs,this.clipVertices1[6]=ps,this.clipVertices1[7]=us,this.clipVertices1[8]=ys,this.clipVertices1[9]=ds,this.clipVertices1[10]=Os,this.clipVertices1[11]=Ns,fs=0,As=this.clipVertices1[9],ks=this.clipVertices1[10],gs=this.clipVertices1[11],D=(As-_t-Rt)*Tt+(ks-Bt-Ut)*Yt+(gs-Et-jt)*Xt;for(var Ps=0;4>Ps;Ps++)bs=3*Ps,Ss=this.clipVertices1[bs],ws=this.clipVertices1[bs+1],Ls=this.clipVertices1[bs+2],_=(Ss-_t-Rt)*Tt+(ws-Bt-Ut)*Yt+(Ls-Et-jt)*Xt,D>0?_>0?(bs=3*fs,fs++,this.clipVertices2[bs]=Ss,this.clipVertices2[bs+1]=ws,this.clipVertices2[bs+2]=Ls):(bs=3*fs,fs++,os=D/(D-_),this.clipVertices2[bs]=As+(Ss-As)*os,this.clipVertices2[bs+1]=ks+(ws-ks)*os,this.clipVertices2[bs+2]=gs+(Ls-gs)*os):_>0&&(bs=3*fs,fs++,os=D/(D-_),this.clipVertices2[bs]=As+(Ss-As)*os,this.clipVertices2[bs+1]=ks+(ws-ks)*os,this.clipVertices2[bs+2]=gs+(Ls-gs)*os,bs=3*fs,fs++,this.clipVertices2[bs]=Ss,this.clipVertices2[bs+1]=ws,this.clipVertices2[bs+2]=Ls),As=Ss,ks=ws,gs=Ls,D=_;if(zs=fs,0!=zs){for(fs=0,bs=3*(zs-1),As=this.clipVertices2[bs],ks=this.clipVertices2[bs+1],gs=this.clipVertices2[bs+2],D=(As-_t-Jt)*Ct+(ks-Bt-Ft)*Zt+(gs-Et-qt)*Dt,Ps=0;zs>Ps;Ps++)bs=3*Ps,Ss=this.clipVertices2[bs],ws=this.clipVertices2[bs+1],Ls=this.clipVertices2[bs+2],_=(Ss-_t-Jt)*Ct+(ws-Bt-Ft)*Zt+(Ls-Et-qt)*Dt,D>0?_>0?(bs=3*fs,fs++,this.clipVertices1[bs]=Ss,this.clipVertices1[bs+1]=ws,this.clipVertices1[bs+2]=Ls):(bs=3*fs,fs++,os=D/(D-_),this.clipVertices1[bs]=As+(Ss-As)*os,this.clipVertices1[bs+1]=ks+(ws-ks)*os,this.clipVertices1[bs+2]=gs+(Ls-gs)*os):_>0&&(bs=3*fs,fs++,os=D/(D-_),this.clipVertices1[bs]=As+(Ss-As)*os,this.clipVertices1[bs+1]=ks+(ws-ks)*os,this.clipVertices1[bs+2]=gs+(Ls-gs)*os,bs=3*fs,fs++,this.clipVertices1[bs]=Ss,this.clipVertices1[bs+1]=ws,this.clipVertices1[bs+2]=Ls),As=Ss,ks=ws,gs=Ls,D=_;if(zs=fs,0!=zs){for(fs=0,bs=3*(zs-1),As=this.clipVertices1[bs],ks=this.clipVertices1[bs+1],gs=this.clipVertices1[bs+2],D=(As-_t+Rt)*-Tt+(ks-Bt+Ut)*-Yt+(gs-Et+jt)*-Xt,Ps=0;zs>Ps;Ps++)bs=3*Ps,Ss=this.clipVertices1[bs],ws=this.clipVertices1[bs+1],Ls=this.clipVertices1[bs+2],_=(Ss-_t+Rt)*-Tt+(ws-Bt+Ut)*-Yt+(Ls-Et+jt)*-Xt,D>0?_>0?(bs=3*fs,fs++,this.clipVertices2[bs]=Ss,this.clipVertices2[bs+1]=ws,this.clipVertices2[bs+2]=Ls):(bs=3*fs,fs++,os=D/(D-_),this.clipVertices2[bs]=As+(Ss-As)*os,this.clipVertices2[bs+1]=ks+(ws-ks)*os,this.clipVertices2[bs+2]=gs+(Ls-gs)*os):_>0&&(bs=3*fs,fs++,os=D/(D-_),this.clipVertices2[bs]=As+(Ss-As)*os,this.clipVertices2[bs+1]=ks+(ws-ks)*os,this.clipVertices2[bs+2]=gs+(Ls-gs)*os,bs=3*fs,fs++,this.clipVertices2[bs]=Ss,this.clipVertices2[bs+1]=ws,this.clipVertices2[bs+2]=Ls),As=Ss,ks=ws,gs=Ls,D=_;if(zs=fs,0!=zs){for(fs=0,bs=3*(zs-1),As=this.clipVertices2[bs],ks=this.clipVertices2[bs+1],gs=this.clipVertices2[bs+2],D=(As-_t+Jt)*-Ct+(ks-Bt+Ft)*-Zt+(gs-Et+qt)*-Dt,Ps=0;zs>Ps;Ps++)bs=3*Ps,Ss=this.clipVertices2[bs],ws=this.clipVertices2[bs+1],Ls=this.clipVertices2[bs+2],_=(Ss-_t+Jt)*-Ct+(ws-Bt+Ft)*-Zt+(Ls-Et+qt)*-Dt,D>0?_>0?(bs=3*fs,fs++,this.clipVertices1[bs]=Ss,this.clipVertices1[bs+1]=ws,this.clipVertices1[bs+2]=Ls):(bs=3*fs,fs++,os=D/(D-_),this.clipVertices1[bs]=As+(Ss-As)*os,this.clipVertices1[bs+1]=ks+(ws-ks)*os,this.clipVertices1[bs+2]=gs+(Ls-gs)*os):_>0&&(bs=3*fs,fs++,os=D/(D-_),this.clipVertices1[bs]=As+(Ss-As)*os,this.clipVertices1[bs+1]=ks+(ws-ks)*os,this.clipVertices1[bs+2]=gs+(Ls-gs)*os,bs=3*fs,fs++,this.clipVertices1[bs]=Ss,this.clipVertices1[bs+1]=ws,this.clipVertices1[bs+2]=Ls),As=Ss,ks=ws,gs=Ls,D=_;if(zs=fs,Qt){var Vs=h;h=e,e=Vs}if(0!=zs){var Ts=h!=i;if(zs>4){As=.25*(ns+ms+ps+ds),ks=.25*(ls+cs+us+Os),gs=.25*(rs+xs+ys+Ns),Tt=ns-As,Yt=ls-ks,Xt=rs-gs,Ct=ms-As,Zt=cs-ks,Dt=xs-gs;var Ys=0,Xs=0,Cs=0,Zs=0,Ds=-this.INF;for(Ms=this.INF,Ps=0;zs>Ps;Ps++)this.used[Ps]=!1,bs=3*Ps,As=this.clipVertices1[bs],ks=this.clipVertices1[bs+1],gs=this.clipVertices1[bs+2],Is=As*Tt+ks*Yt+gs*Xt,Ms>Is&&(Ms=Is,Ys=Ps),Is>Ds&&(Ds=Is,Cs=Ps);for(this.used[Ys]=!0,this.used[Cs]=!0,Ds=-this.INF,Ms=this.INF,Ps=0;zs>Ps;Ps++)this.used[Ps]||(bs=3*Ps,As=this.clipVertices1[bs],ks=this.clipVertices1[bs+1],gs=this.clipVertices1[bs+2],Is=As*Ct+ks*Zt+gs*Dt,Ms>Is&&(Ms=Is,Xs=Ps),Is>Ds&&(Ds=Is,Zs=Ps));bs=3*Ys,As=this.clipVertices1[bs],ks=this.clipVertices1[bs+1],gs=this.clipVertices1[bs+2],Is=(As-_t)*Lt+(ks-Bt)*Pt+(gs-Et)*Vt,0>Is&&s.addPoint(As,ks,gs,Lt,Pt,Vt,Is,Ts),bs=3*Xs,As=this.clipVertices1[bs],ks=this.clipVertices1[bs+1],gs=this.clipVertices1[bs+2],Is=(As-_t)*Lt+(ks-Bt)*Pt+(gs-Et)*Vt,0>Is&&s.addPoint(As,ks,gs,Lt,Pt,Vt,Is,Ts),bs=3*Cs,As=this.clipVertices1[bs],ks=this.clipVertices1[bs+1],gs=this.clipVertices1[bs+2],Is=(As-_t)*Lt+(ks-Bt)*Pt+(gs-Et)*Vt,0>Is&&s.addPoint(As,ks,gs,Lt,Pt,Vt,Is,Ts),bs=3*Zs,As=this.clipVertices1[bs],ks=this.clipVertices1[bs+1],gs=this.clipVertices1[bs+2],Is=(As-_t)*Lt+(ks-Bt)*Pt+(gs-Et)*Vt,0>Is&&s.addPoint(As,ks,gs,Lt,Pt,Vt,Is,Ts)}else for(Ps=0;zs>Ps;Ps++)bs=3*Ps,As=this.clipVertices1[bs],ks=this.clipVertices1[bs+1],gs=this.clipVertices1[bs+2],Is=(As-_t)*Lt+(ks-Bt)*Pt+(gs-Et)*Vt,0>Is&&s.addPoint(As,ks,gs,Lt,Pt,Vt,Is,Ts)}}}}}},OIMO.SphereBoxCollisionDetector=function(i){OIMO.CollisionDetector.call(this),this.flip=i},OIMO.SphereBoxCollisionDetector.prototype=Object.create(OIMO.CollisionDetector.prototype),OIMO.SphereBoxCollisionDetector.prototype.detectCollision=function(i,t,s){var h,e;this.flip?(h=t,e=i):(h=i,e=t);var a,o,n,l,r,m=e.dimentions,c=h.position,x=c.x,p=c.y,u=c.z,y=e.position,d=y.x,O=y.y,N=y.z,M=h.radius,I=e.halfWidth,v=e.halfHeight,z=e.halfDepth,f=x-d,b=p-O,A=u-N,k=m[0]*f+m[1]*b+m[2]*A,g=m[3]*f+m[4]*b+m[5]*A,S=m[6]*f+m[7]*b+m[8]*A,w=0;k>I?k=I:-I>k?k=-I:w=1,g>v?g=v:-v>g?g=-v:w|=2,S>z?S=z:-z>S?S=-z:w|=4,7==w?(f=0>k?I+k:I-k,b=0>g?v+g:v-g,A=0>S?z+S:z-S,b>f?A>f?(l=f-I,0>k?(k=-I,f=m[0],b=m[1],A=m[2]):(k=I,f=-m[0],b=-m[1],A=-m[2])):(l=A-z,0>S?(S=-z,f=m[6],b=m[7],A=m[8]):(S=z,f=-m[6],b=-m[7],A=-m[8])):A>b?(l=b-v,0>g?(g=-v,f=m[3],b=m[4],A=m[5]):(g=v,f=-m[3],b=-m[4],A=-m[5])):(l=A-z,0>S?(S=-z,f=m[6],b=m[7],A=m[8]):(S=z,f=-m[6],b=-m[7],A=-m[8])),a=d+k*m[0]+g*m[3]+S*m[6],o=O+k*m[1]+g*m[4]+S*m[7],n=N+k*m[2]+g*m[5]+S*m[8],s.addPoint(x+M*f,p+M*b,u+M*A,f,b,A,l-M,this.flip)):(a=d+k*m[0]+g*m[3]+S*m[6],o=O+k*m[1]+g*m[4]+S*m[7],n=N+k*m[2]+g*m[5]+S*m[8],f=a-c.x,b=o-c.y,A=n-c.z,l=f*f+b*b+A*A,l>0&&M*M>l&&(l=Math.sqrt(l),r=1/l,f*=r,b*=r,A*=r,s.addPoint(x+M*f,p+M*b,u+M*A,f,b,A,l-M,this.flip)))},OIMO.SphereSphereCollisionDetector=function(){OIMO.CollisionDetector.call(this)},OIMO.SphereSphereCollisionDetector.prototype=Object.create(OIMO.CollisionDetector.prototype),OIMO.SphereSphereCollisionDetector.prototype.detectCollision=function(i,t,s){var h=i,e=t,a=h.position,o=e.position,n=o.x-a.x,l=o.y-a.y,r=o.z-a.z,m=n*n+l*l+r*r,c=h.radius,x=e.radius,p=c+x;if(m>0&&p*p>m){m=Math.sqrt(m);var u=1/m;n*=u,l*=u,r*=u,s.addPoint(a.x+n*c,a.y+l*c,a.z+r*c,n,l,r,m-p,!1)}},OIMO.AABB=function(i,t,s,h,e,a){this.minX=i||0,this.maxX=t||0,this.minY=s||0,this.maxY=h||0,this.minZ=e||0,this.maxZ=a||0},OIMO.AABB.prototype={constructor:OIMO.AABB,init:function(i,t,s,h,e,a){this.minX=i,this.maxX=t,this.minY=s,this.maxY=h,this.minZ=e,this.maxZ=a},combine:function(i,t){this.minX=i.minX<t.minX?i.minX:t.minX,this.maxX=i.maxX>t.maxX?i.maxX:t.maxX,this.minY=i.minY<t.minY?i.minY:t.minY,this.maxY=i.maxY>t.maxY?i.maxY:t.maxY,this.minZ=i.minZ<t.minZ?i.minZ:t.minZ,this.maxZ=i.maxZ>t.maxZ?i.maxZ:t.maxZ},surfaceArea:function(){var i=this.maxY-this.minY,t=this.maxZ-this.minZ;return 2*((this.maxX-this.minX)*(i+t)+i*t)},intersectsWithPoint:function(i,t,s){return i>=this.minX&&i<=this.maxX&&t>=this.minY&&t<=this.maxY&&s>=this.minZ&&s<=this.maxZ}},OIMO.Proxy=function(i){this.shape=i,this.aabb=i.aabb},OIMO.Proxy.prototype={constructor:OIMO.Proxy,update:function(){throw new Error("Inheritance error.")}},OIMO.BasicProxy=function(i){OIMO.Proxy.call(this,i)},OIMO.BasicProxy.prototype=Object.create(OIMO.Proxy.prototype),OIMO.BasicProxy.prototype.update=function(){},OIMO.BroadPhase=function(){this.types=0,this.numPairChecks=0,this.numPairs=0,this.bufferSize=256,this.pairs=[],this.pairs.length=this.bufferSize;for(var i=this.bufferSize;i--;)this.pairs[i]=new OIMO.Pair},OIMO.BroadPhase.prototype={constructor:OIMO.BroadPhase,createProxy:function(i){throw new Error("Inheritance error.")},addProxy:function(i){throw new Error("Inheritance error.")},removeProxy:function(i){throw new Error("Inheritance error.")},isAvailablePair:function(i,t){var s=i.parent,h=t.parent;if(s==h||!s.isDynamic&&!h.isDynamic||0==(i.belongsTo&t.collidesWith)||0==(t.belongsTo&i.collidesWith))return!1;var e;for(e=s.numJoints<h.numJoints?s.jointLink:h.jointLink;null!=e;){var a=e.joint;if(!a.allowCollision&&(a.body1==s&&a.body2==h||a.body1==h&&a.body2==s))return!1;e=e.next}return!0},detectPairs:function(){for(;this.numPairs>0;){var i=this.pairs[--this.numPairs];i.shape1=null,i.shape2=null}this.numPairChecks=0,this.collectPairs()},collectPairs:function(){throw new Error("Inheritance error.")},addPair:function(i,t){if(this.numPairs==this.bufferSize){var s=this.bufferSize<<1,h=[];h.length=this.bufferSize;for(var e=0,a=this.bufferSize;a>e;e++)h[e]=this.pairs[e];for(e=this.newBufferSize,e=this.bufferSize,a=s;a>e;e++)h[e]=new OIMO.Pair;this.pairs=h,this.bufferSize=s}var o=this.pairs[this.numPairs++];o.shape1=i,o.shape2=t}},OIMO.BruteForceBroadPhase=function(){OIMO.BroadPhase.call(this),this.types=1,this.numProxies=0,this.maxProxies=256,this.proxies=[],this.proxies.length=256},OIMO.BruteForceBroadPhase.prototype=Object.create(OIMO.BroadPhase.prototype),OIMO.BruteForceBroadPhase.prototype.createProxy=function(i){return new OIMO.BasicProxy(i)},OIMO.BruteForceBroadPhase.prototype.addProxy=function(i){if(this.numProxies==this.maxProxies){this.maxProxies*=2;var t=[];t.length=this.maxProxies;for(var s=this.numProxies;s--;)t[s]=this.proxies[s];this.proxies=t}this.proxies[this.numProxies++]=i},OIMO.BruteForceBroadPhase.prototype.removeProxy=function(i){for(var t=this.numProxies;t--;)if(this.proxies[t]==i)return this.proxies[t]=this.proxies[--this.numProxies],void(this.proxies[this.numProxies]=null)},OIMO.BruteForceBroadPhase.prototype.collectPairs=function(){this.numPairChecks=this.numProxies*(this.numProxies-1)>>1;for(var i=this.numProxies;i--;)for(var t=this.proxies[i],s=t.aabb,h=t.shape,e=this.numProxies;e--;)if(e!==i){var a=this.proxies[e],o=a.aabb,n=a.shape;if(s.maxX<o.minX||s.minX>o.maxX||s.maxY<o.minY||s.minY>o.maxY||s.maxZ<o.minZ||s.minZ>o.maxZ||!this.isAvailablePair(h,n))continue;this.addPair(h,n)}},OIMO.Pair=function(){this.shape1=null,this.shape2=null},OIMO.SAPAxis=function(){this.numElements=0,this.bufferSize=256,this.elements=[],this.elements.length=this.bufferSize,this.stack=new OIMO_ARRAY_TYPE(64)},OIMO.SAPAxis.prototype={constructor:OIMO.SAPAxis,addElements:function(i,t){if(this.numElements+2>=this.bufferSize){this.bufferSize*=2;for(var s=[],h=this.numElements;h--;)s[h]=this.elements[h]}this.elements[this.numElements++]=i,this.elements[this.numElements++]=t},removeElements:function(i,t){for(var s=-1,h=-1,e=0,a=this.numElements;a>e;e++){var o=this.elements[e];if(o==i||o==t){if(-1!=s){h=e;break}s=e}}for(e=s+1,a=h;a>e;e++)this.elements[e-1]=this.elements[e];for(e=h+1,a=this.numElements;a>e;e++)this.elements[e-2]=this.elements[e];this.elements[--this.numElements]=null,this.elements[--this.numElements]=null},sort:function(){for(var i=0,t=1;this.numElements>>t!=0;)t++;t=t*this.numElements>>2,i=0;for(var s=!1,h=this.elements,e=1,a=this.numElements;a>e;e++){var o=h[e],n=o.value,l=h[e-1];if(l.value>n){var r=e;do{if(h[r]=l,0==--r)break;l=h[r-1]}while(l.value>n);if(h[r]=o,i+=e-r,i>t){s=!0;break}}}if(s){i=2;var m=this.stack;for(m[0]=0,m[1]=this.numElements-1;i>0;){var c=m[--i],x=m[--i],p=c-x;if(p>16){var u=x+Math.floor(.5*p);for(o=h[u],h[u]=h[c],h[c]=o,n=o.value,e=x-1,r=c;;){var y,d;do y=h[++e];while(y.value<n);do d=h[--r];while(n<d.value&&r!=x);if(e>=r)break;h[e]=d,h[r]=y}h[c]=h[e],h[e]=o,e-x>c-e?(m[i++]=x,m[i++]=e-1,m[i++]=e+1,m[i++]=c):(m[i++]=e+1,m[i++]=c,m[i++]=x,m[i++]=e-1)}else for(e=x+1;c>=e;e++)if(o=h[e],n=o.value,l=h[e-1],l.value>n){r=e;do{if(h[r]=l,0==--r)break;l=h[r-1]}while(l.value>n);h[r]=o}}}},calculateTestCount:function(){for(var i=1,t=0,s=1,h=this.numElements;h>s;s++)this.elements[s].max?i--:(t+=i,i++);return t}},OIMO.SAPBroadPhase=function(){OIMO.BroadPhase.call(this),this.types=2,this.numElementsD=0,this.numElementsS=0,this.axesD=[],this.axesS=[],this.axesD.length=3,this.axesS.length=3,this.axesD[0]=new OIMO.SAPAxis,this.axesD[1]=new OIMO.SAPAxis,this.axesD[2]=new OIMO.SAPAxis,this.axesS[0]=new OIMO.SAPAxis,this.axesS[1]=new OIMO.SAPAxis,this.axesS[2]=new OIMO.SAPAxis,this.index1=0,this.index2=1},OIMO.SAPBroadPhase.prototype=Object.create(OIMO.BroadPhase.prototype),OIMO.SAPBroadPhase.prototype.createProxy=function(i){return new OIMO.SAPProxy(this,i)},OIMO.SAPBroadPhase.prototype.addProxy=function(i){var t=i;t.isDynamic()?(this.axesD[0].addElements(t.min[0],t.max[0]),this.axesD[1].addElements(t.min[1],t.max[1]),this.axesD[2].addElements(t.min[2],t.max[2]),t.belongsTo=1,this.numElementsD+=2):(this.axesS[0].addElements(t.min[0],t.max[0]),this.axesS[1].addElements(t.min[1],t.max[1]),this.axesS[2].addElements(t.min[2],t.max[2]),t.belongsTo=2,this.numElementsS+=2)},OIMO.SAPBroadPhase.prototype.removeProxy=function(i){var t=i;if(0!=t.belongsTo){switch(t.belongsTo){case 1:this.axesD[0].removeElements(t.min[0],t.max[0]),this.axesD[1].removeElements(t.min[1],t.max[1]),this.axesD[2].removeElements(t.min[2],t.max[2]),this.numElementsD-=2;break;case 2:this.axesS[0].removeElements(t.min[0],t.max[0]),this.axesS[1].removeElements(t.min[1],t.max[1]),this.axesS[2].removeElements(t.min[2],t.max[2]),this.numElementsS-=2}t.belongsTo=0}},OIMO.SAPBroadPhase.prototype.collectPairs=function(){if(0!=this.numElementsD){var i=this.axesD[this.index1],t=this.axesD[this.index2];i.sort(),t.sort();var s,h,e=i.calculateTestCount(),a=t.calculateTestCount();a>=e?(t=this.axesS[this.index1],t.sort(),s=i.elements,h=t.elements):(i=this.axesS[this.index2],i.sort(),s=t.elements,h=i.elements,this.index1^=this.index2,this.index2^=this.index1,this.index1^=this.index2);for(var o,n,l=0,r=0;l<this.numElementsD;){var m,c;if(r==this.numElementsS)m=s[l],c=!0,l++;else{var x=s[l],p=h[r];x.value<p.value?(m=x,c=!0,l++):(m=p,c=!1,r++)}if(m.max){var u=m.pair;if(c){if(u==o){o=o.pair;continue}m=o}else{if(u==n){n=n.pair;continue}m=n}do{if(I=m.pair,I===u){m.pair=I.pair;break}m=I}while(null!==m)}else{for(var y=m.proxy.shape,d=m.min1.value,O=m.max1.value,N=m.min2.value,M=m.max2.value,I=o;null!=I;I=I.pair){var v=I.proxy.shape;this.numPairChecks++,d>I.max1.value||O<I.min1.value||N>I.max2.value||M<I.min2.value||!this.isAvailablePair(y,v)||this.addPair(y,v)}if(c){for(I=n;null!=I;I=I.pair)v=I.proxy.shape,this.numPairChecks++,d>I.max1.value||O<I.min1.value||N>I.max2.value||M<I.min2.value||!this.isAvailablePair(y,v)||this.addPair(y,v);m.pair=o,o=m}else m.pair=n,n=m}}this.index2=3^(this.index1|this.index2)}},OIMO.SAPElement=function(i,t){this.proxy=i,this.pair=null,this.min1=null,this.max1=null,this.min2=null,this.max2=null,this.max=t,this.value=0},OIMO.SAPProxy=function(i,t){OIMO.Proxy.call(this,t),this.belongsTo=0,this.max=[],this.min=[],this.sap=i,this.min[0]=new OIMO.SAPElement(this,!1),this.max[0]=new OIMO.SAPElement(this,!0),this.min[1]=new OIMO.SAPElement(this,!1),this.max[1]=new OIMO.SAPElement(this,!0),this.min[2]=new OIMO.SAPElement(this,!1),this.max[2]=new OIMO.SAPElement(this,!0),this.max[0].pair=this.min[0],this.max[1].pair=this.min[1],this.max[2].pair=this.min[2],this.min[0].min1=this.min[1],this.min[0].max1=this.max[1],this.min[0].min2=this.min[2],this.min[0].max2=this.max[2],this.min[1].min1=this.min[0],this.min[1].max1=this.max[0],this.min[1].min2=this.min[2],this.min[1].max2=this.max[2],this.min[2].min1=this.min[0],this.min[2].max1=this.max[0],this.min[2].min2=this.min[1],this.min[2].max2=this.max[1]},OIMO.SAPProxy.prototype=Object.create(OIMO.Proxy.prototype),OIMO.SAPProxy.prototype.isDynamic=function(){var i=this.shape.parent;return i.isDynamic&&!i.sleeping},OIMO.SAPProxy.prototype.update=function(){this.min[0].value=this.aabb.minX,this.max[0].value=this.aabb.maxX,this.min[1].value=this.aabb.minY,this.max[1].value=this.aabb.maxY,this.min[2].value=this.aabb.minZ,this.max[2].value=this.aabb.maxZ,(1==this.belongsTo&&!this.isDynamic()||2==this.belongsTo&&this.isDynamic())&&(this.sap.removeProxy(this),this.sap.addProxy(this))},OIMO.DBVT=function(){this.root=null,this.freeNodes=[],this.freeNodes.length=16384,this.numFreeNodes=0,this.aabb=new OIMO.AABB},OIMO.DBVT.prototype={constructor:OIMO.DBVT,moveLeaf:function(i){this.deleteLeaf(i),this.insertLeaf(i)},insertLeaf:function(i){if(null==this.root)return void(this.root=i);for(var t,s,h=i.aabb,e=this.root;null==e.proxy;){var a=e.child1,o=e.child2,n=e.aabb,l=a.aabb,r=o.aabb;t=n.surfaceArea(),this.aabb.combine(h,n),s=this.aabb.surfaceArea();var m=2*s,c=2*(s-t),x=c;this.aabb.combine(h,l),x+=null!=a.proxy?this.aabb.surfaceArea():this.aabb.surfaceArea()-l.surfaceArea();var p=c;if(this.aabb.combine(h,r),p+=null!=o.proxy?this.aabb.surfaceArea():this.aabb.surfaceArea()-r.surfaceArea(),p>x){if(x>m)break;e=a}else{if(p>m)break;e=o}}var u,y=e.parent;u=this.numFreeNodes>0?this.freeNodes[--this.numFreeNodes]:new OIMO.DBVTNode,u.parent=y,u.child1=i,u.child2=e,u.aabb.combine(i.aabb,e.aabb),u.height=e.height+1,e.parent=u,i.parent=u,e==this.root?this.root=u:y.child1==e?y.child1=u:y.child2=u;do u=this.balance(u),this.fix(u),u=u.parent;while(null!=u)},getBalance:function(i){return null!=i.proxy?0:i.child1.height-i.child2.height},print:function(i,t,s){var h=null==i.proxy;h&&(s=this.print(i.child1,t+1,s));for(var e=2*t;e>=0;e--)s+=" ";return s+=(h?this.getBalance(i):"["+i.proxy.aabb.minX+"]")+"\n",h&&(s=this.print(i.child2,t+1,s)),s},deleteLeaf:function(i){if(i==this.root)return void(this.root=null);var t,s=i.parent;if(t=s.child1==i?s.child2:s.child1,s==this.root)return this.root=t,void(t.parent=null);var h=s.parent;t.parent=h,h.child1==s?h.child1=t:h.child2=t,this.numFreeNodes<16384&&(this.freeNodes[this.numFreeNodes++]=s);do h=this.balance(h),this.fix(h),h=h.parent;while(null!=h)},balance:function(i){var t=i.height;if(2>t)return i;var s,h=i.parent,e=i.child1,a=i.child2,o=e.height,n=a.height,l=o-n;if(l>1){var r=e.child1,m=e.child2,c=r.height,x=m.height;return c>x?(e.child2=i,i.parent=e,i.child1=m,m.parent=i,i.aabb.combine(m.aabb,a.aabb),s=x-n,i.height=x-(s&s>>31)+1,e.aabb.combine(r.aabb,i.aabb),s=c-t,e.height=c-(s&s>>31)+1):(e.child1=i,i.parent=e,i.child1=r,r.parent=i,i.aabb.combine(r.aabb,a.aabb),s=c-n,i.height=c-(s&s>>31)+1,e.aabb.combine(i.aabb,m.aabb),s=t-x,e.height=t-(s&s>>31)+1),null!=h?h.child1==i?h.child1=e:h.child2=e:this.root=e,e.parent=h,e}if(-1>l){var p=a.child1,u=a.child2,y=p.height,d=u.height;return y>d?(a.child2=i,i.parent=a,i.child2=u,u.parent=i,i.aabb.combine(e.aabb,u.aabb),s=o-d,i.height=o-(s&s>>31)+1,a.aabb.combine(p.aabb,i.aabb),s=y-t,a.height=y-(s&s>>31)+1):(a.child1=i,i.parent=a,i.child2=p,p.parent=i,i.aabb.combine(e.aabb,p.aabb),s=o-y,i.height=o-(s&s>>31)+1,a.aabb.combine(i.aabb,u.aabb),s=t-d,a.height=t-(s&s>>31)+1),null!=h?h.child1==i?h.child1=a:h.child2=a:this.root=a,a.parent=h,a}return i},fix:function(i){var t=i.child1,s=i.child2;i.aabb.combine(t.aabb,s.aabb);var h=t.height,e=s.height;e>h?i.height=e+1:i.height=h+1}},OIMO.DBVTBroadPhase=function(){OIMO.BroadPhase.call(this),this.types=3,this.numLeaves=0,this.maxLeaves=0,this.tree=new OIMO.DBVT,this.maxStack=256,this.stack=[],this.stack.length=this.maxStack,this.maxLeaves=256,this.leaves=[],this.leaves.length=this.maxLeaves},OIMO.DBVTBroadPhase.prototype=Object.create(OIMO.BroadPhase.prototype),OIMO.DBVTBroadPhase.prototype.createProxy=function(i){return new OIMO.DBVTProxy(i)},OIMO.DBVTBroadPhase.prototype.addProxy=function(i){var t=i;if(this.tree.insertLeaf(t.leaf),this.numLeaves==this.maxLeaves){this.maxLeaves*=2;var s=[];s.length=this.maxLeaves;for(var h=0;h<this.numLeaves;h++)s[h]=this.leaves[h];this.leaves=s}this.leaves[this.numLeaves++]=t.leaf},OIMO.DBVTBroadPhase.prototype.removeProxy=function(i){var t=i;this.tree.deleteLeaf(t.leaf);for(var s=0;s<this.numLeaves;s++)if(this.leaves[s]==t.leaf)return this.leaves[s]=this.leaves[--this.numLeaves],void(this.leaves[this.numLeaves]=null)},OIMO.DBVTBroadPhase.prototype.collectPairs=function(){if(!(this.numLeaves<2))for(var i=0;i<this.numLeaves;i++){var t=this.leaves[i],s=t.proxy.aabb,h=t.aabb;if(s.minX<h.minX||s.maxX>h.maxX||s.minY<h.minY||s.maxY>h.maxY||s.minZ<h.minZ||s.maxZ>h.maxZ){var e=.1;this.tree.deleteLeaf(t),h.minX=s.minX-e,h.maxX=s.maxX+e,h.minY=s.minY-e,h.maxY=s.maxY+e,h.minZ=s.minZ-e,h.maxZ=s.maxZ+e,this.tree.insertLeaf(t),this.collide(t,this.tree.root)}}},OIMO.DBVTBroadPhase.prototype.collide=function(i,t){var s=2;for(this.stack[0]=i,this.stack[1]=t;s>0;){var h=this.stack[--s],e=this.stack[--s],a=null!=h.proxy,o=null!=e.proxy;if(this.numPairChecks++,a&&o){var n=h.proxy.shape,l=e.proxy.shape,r=n.aabb,m=l.aabb;if(n==l||r.maxX<m.minX||r.minX>m.maxX||r.maxY<m.minY||r.minY>m.maxY||r.maxZ<m.minZ||r.minZ>m.maxZ||!this.isAvailablePair(n,l))continue;this.addPair(n,l)}else{if(r=h.aabb,m=e.aabb,r.maxX<m.minX||r.minX>m.maxX||r.maxY<m.minY||r.minY>m.maxY||r.maxZ<m.minZ||r.minZ>m.maxZ)continue;if(s+4>=this.maxStack){this.maxStack*=2;var c=[];c.length=this.maxStack;for(var x=0;s>x;x++)c[x]=this.stack[x];this.stack=c}o||!a&&h.aabb.surfaceArea()>e.aabb.surfaceArea()?(this.stack[s++]=h.child1,this.stack[s++]=e,this.stack[s++]=h.child2,this.stack[s++]=e):(this.stack[s++]=h,this.stack[s++]=e.child1,this.stack[s++]=h,this.stack[s++]=e.child2)}}},OIMO.DBVTNode=function(){this.child1=null,this.child2=null,this.parent=null,this.proxy=null,this.height=0,this.aabb=new OIMO.AABB},OIMO.DBVTProxy=function(i){OIMO.Proxy.call(this,i),this.leaf=new OIMO.DBVTNode,this.leaf.proxy=this},OIMO.DBVTProxy.prototype=Object.create(OIMO.Proxy.prototype),OIMO.DBVTProxy.prototype.update=function(){},window.OIMO=OIMO;
},{}],159:[function(require,module,exports){
THREE.OrbitControls=function(t,e){function o(){return 2*Math.PI/60/60*p.autoRotateSpeed}function n(){return Math.pow(.95,p.zoomSpeed)}function a(t){if(p.enabled!==!1){if(t.preventDefault(),t.button===p.mouseButtons.ORBIT){if(p.noRotate===!0)return;C=k.ROTATE,b.set(t.clientX,t.clientY)}else if(t.button===p.mouseButtons.ZOOM){if(p.noZoom===!0)return;C=k.DOLLY,H.set(t.clientX,t.clientY)}else if(t.button===p.mouseButtons.PAN){if(p.noPan===!0)return;C=k.PAN,y.set(t.clientX,t.clientY)}C!==k.NONE&&(document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",s,!1),p.dispatchEvent(I))}}function i(t){if(p.enabled!==!1){t.preventDefault();var e=p.domElement===document?p.domElement.body:p.domElement;if(console.log(e.clientHeight),C===k.ROTATE){if(p.noRotate===!0)return;f.set(t.clientX,t.clientY),T.subVectors(f,b),p.rotateLeft(2*Math.PI*T.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*T.y/e.clientHeight*p.rotateSpeed),b.copy(f)}else if(C===k.DOLLY){if(p.noZoom===!0)return;M.set(t.clientX,t.clientY),P.subVectors(M,H),P.y>0?p.dollyIn():P.y<0&&p.dollyOut(),H.copy(M)}else if(C===k.PAN){if(p.noPan===!0)return;O.set(t.clientX,t.clientY),v.subVectors(O,y),p.pan(v.x,v.y),y.copy(O)}C!==k.NONE&&p.update()}}function s(){p.enabled!==!1&&(document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",s,!1),p.dispatchEvent(S),C=k.NONE)}function c(t){if(p.enabled!==!1&&p.noZoom!==!0&&C===k.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?p.dollyOut():0>e&&p.dollyIn(),p.update(),p.dispatchEvent(I),p.dispatchEvent(S)}}function r(t){if(p.enabled!==!1&&p.noKeys!==!0&&p.noPan!==!0)switch(t.keyCode){case p.keys.UP:p.pan(0,p.keyPanSpeed),p.update();break;case p.keys.BOTTOM:p.pan(0,-p.keyPanSpeed),p.update();break;case p.keys.LEFT:p.pan(p.keyPanSpeed,0),p.update();break;case p.keys.RIGHT:p.pan(-p.keyPanSpeed,0),p.update()}}function h(t){if(p.enabled!==!1){switch(t.touches.length){case 1:if(p.noRotate===!0)return;C=k.TOUCH_ROTATE,b.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(p.noZoom===!0)return;C=k.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+o*o);H.set(0,n);break;case 3:if(p.noPan===!0)return;C=k.TOUCH_PAN,y.set(t.touches[0].pageX,t.touches[0].pageY);break;default:C=k.NONE}C!==k.NONE&&p.dispatchEvent(I)}}function u(t){if(p.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=p.domElement===document?p.domElement.body:p.domElement;switch(t.touches.length){case 1:if(p.noRotate===!0)return;if(C!==k.TOUCH_ROTATE)return;f.set(t.touches[0].pageX,t.touches[0].pageY),T.subVectors(f,b),p.rotateLeft(2*Math.PI*T.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*T.y/e.clientHeight*p.rotateSpeed),b.copy(f),p.update();break;case 2:if(p.noZoom===!0)return;if(C!==k.TOUCH_DOLLY)return;var o=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,a=Math.sqrt(o*o+n*n);M.set(0,a),P.subVectors(M,H),P.y>0?p.dollyOut():P.y<0&&p.dollyIn(),H.copy(M),p.update();break;case 3:if(p.noPan===!0)return;if(C!==k.TOUCH_PAN)return;O.set(t.touches[0].pageX,t.touches[0].pageY),v.subVectors(O,y),p.pan(v.x,v.y),y.copy(O),p.update();break;default:C=k.NONE}}}function d(){p.enabled!==!1&&(p.dispatchEvent(S),C=k.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var l,m,p=this,E=1e-6,b=new THREE.Vector2,f=new THREE.Vector2,T=new THREE.Vector2,y=new THREE.Vector2,O=new THREE.Vector2,v=new THREE.Vector2,g=new THREE.Vector3,R=new THREE.Vector3,H=new THREE.Vector2,M=new THREE.Vector2,P=new THREE.Vector2,j=0,N=0,L=1,w=new THREE.Vector3,A=new THREE.Vector3,x=new THREE.Quaternion,k={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},C=k.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var V=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),z=V.clone().inverse(),D={type:"change"},I={type:"start"},S={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=o()),N-=t},this.rotateUp=function(t){void 0===t&&(t=o()),j-=t},this.panLeft=function(t){var e=this.object.matrix.elements;g.set(e[0],e[1],e[2]),g.multiplyScalar(-t),w.add(g)},this.panUp=function(t){var e=this.object.matrix.elements;g.set(e[4],e[5],e[6]),g.multiplyScalar(t),w.add(g)},this.pan=function(t,e){var o=p.domElement===document?p.domElement.body:p.domElement;if(p.object instanceof THREE.PerspectiveCamera){var n=p.object.position,a=n.clone().sub(p.target),i=a.length();i*=Math.tan(p.object.fov/2*Math.PI/180),p.panLeft(2*t*i/o.clientHeight),p.panUp(2*e*i/o.clientHeight)}else p.object instanceof THREE.OrthographicCamera?(p.panLeft(t*(p.object.right-p.object.left)/o.clientWidth),p.panUp(e*(p.object.top-p.object.bottom)/o.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=n()),p.object instanceof THREE.PerspectiveCamera?L/=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),p.object.updateProjectionMatrix(),p.dispatchEvent(D)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=n()),p.object instanceof THREE.PerspectiveCamera?L*=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),p.object.updateProjectionMatrix(),p.dispatchEvent(D)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var t=this.object.position;R.copy(t).sub(this.target),R.applyQuaternion(V),l=Math.atan2(R.x,R.z),m=Math.atan2(Math.sqrt(R.x*R.x+R.z*R.z),R.y),this.autoRotate&&C===k.NONE&&this.rotateLeft(o()),l+=N,m+=j,l=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,l)),m=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,m)),m=Math.max(E,Math.min(Math.PI-E,m));var e=R.length()*L;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(w),R.x=e*Math.sin(m)*Math.sin(l),R.y=e*Math.cos(m),R.z=e*Math.sin(m)*Math.cos(l),R.applyQuaternion(z),t.copy(this.target).add(R),this.object.lookAt(this.target),N=0,j=0,L=1,w.set(0,0,0),(A.distanceToSquared(this.object.position)>E||8*(1-x.dot(this.object.quaternion))>E)&&(this.dispatchEvent(D),A.copy(this.object.position),x.copy(this.object.quaternion))},this.reset=function(){C=k.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(D),this.update()},this.getPolarAngle=function(){return m},this.getAzimuthalAngle=function(){return l},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mousewheel",c,!1),this.domElement.addEventListener("DOMMouseScroll",c,!1),this.domElement.addEventListener("touchstart",h,!1),this.domElement.addEventListener("touchend",d,!1),this.domElement.addEventListener("touchmove",u,!1),window.addEventListener("keydown",r,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;
},{}],160:[function(require,module,exports){
THREE.OBJExporter=function(){},THREE.OBJExporter.prototype={constructor:THREE.OBJExporter,parse:function(r){var e="",t=0,a=0,n=0,o=function(r){var o=0,v=0,f=0,c=r.geometry;if(c instanceof THREE.Geometry){e+="o "+r.name+"\n";for(var s=0,x=c.vertices.length;x>s;s++){var l=c.vertices[s].clone();l.applyMatrix4(r.matrixWorld),e+="v "+l.x+" "+l.y+" "+l.z+"\n",o++}for(var s=0,x=c.faceVertexUvs[0].length;x>s;s++)for(var i=c.faceVertexUvs[0][s],E=0;E<i.length;E++){var p=i[E];l.applyMatrix4(r.matrixWorld),e+="vt "+p.x+" "+p.y+"\n",v++}for(var s=0,x=c.faces.length;x>s;s++)for(var y=c.faces[s].vertexNormals,E=0;E<y.length;E++){var g=y[E];e+="vn "+g.x+" "+g.y+" "+g.z+"\n",f++}for(var s=0,E=1,x=c.faces.length;x>s;s++,E+=3){var h=c.faces[s];e+="f ",e+=t+h.a+1+"/"+(a+E)+"/"+(n+E)+" ",e+=t+h.b+1+"/"+(a+E+1)+"/"+(n+E+1)+" ",e+=t+h.c+1+"/"+(a+E+2)+"/"+(n+E+2)+"\n"}}t+=o,a+=v,n+=f};return r.traverse(o),e}};
},{}],161:[function(require,module,exports){
THREE.OBJLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(e,t,r,n){var a=this,d=new THREE.XHRLoader(a.manager);d.setCrossOrigin(this.crossOrigin),d.load(e,function(e){t(a.parse(e))},r,n)},parse:function(e){function t(e){var t=parseInt(e);return 3*(t>=0?t-1:t+m.length/3)}function r(e){var t=parseInt(e);return 3*(t>=0?t-1:t+E.length/3)}function n(e){var t=parseInt(e);return 2*(t>=0?t-1:t+c.length/2)}function a(e,t,r){l.vertices.push(m[e],m[e+1],m[e+2],m[t],m[t+1],m[t+2],m[r],m[r+1],m[r+2])}function d(e,t,r){l.normals.push(E[e],E[e+1],E[e+2],E[t],E[t+1],E[t+2],E[r],E[r+1],E[r+2])}function o(e,t,r){l.uvs.push(c[e],c[e+1],c[t],c[t+1],c[r],c[r+1])}function s(e,s,i,l,u,v,m,E,c,f,p,h){var g,H=t(e),R=t(s),T=t(i);void 0===l?a(H,R,T):(g=t(l),a(H,R,g),a(R,T,g)),void 0!==u&&(H=n(u),R=n(v),T=n(m),void 0===l?o(H,R,T):(g=n(E),o(H,R,g),o(R,T,g))),void 0!==c&&(H=r(c),R=r(f),T=r(p),void 0===l?d(H,R,T):(g=r(h),d(H,R,g),d(R,T,g)))}console.time("OBJLoader");var i,l,u,v=[];/^o /gm.test(e)===!1&&(l={vertices:[],normals:[],uvs:[]},u={name:""},i={name:"",geometry:l,material:u},v.push(i));for(var m=[],E=[],c=[],f=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,p=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,h=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,g=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,H=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,R=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,T=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,b=e.split("\n"),w=0;w<b.length;w++){var F=b[w];F=F.trim();var A;0!==F.length&&"#"!==F.charAt(0)&&(null!==(A=f.exec(F))?m.push(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3])):null!==(A=p.exec(F))?E.push(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3])):null!==(A=h.exec(F))?c.push(parseFloat(A[1]),parseFloat(A[2])):null!==(A=g.exec(F))?s(A[1],A[2],A[3],A[4]):null!==(A=H.exec(F))?s(A[2],A[5],A[8],A[11],A[3],A[6],A[9],A[12]):null!==(A=R.exec(F))?s(A[2],A[6],A[10],A[14],A[3],A[7],A[11],A[15],A[4],A[8],A[12],A[16]):null!==(A=T.exec(F))?s(A[2],A[5],A[8],A[11],void 0,void 0,void 0,void 0,A[3],A[6],A[9],A[12]):/^o /.test(F)?(l={vertices:[],normals:[],uvs:[]},u={name:""},i={name:F.substring(2).trim(),geometry:l,material:u},v.push(i)):/^g /.test(F)||(/^usemtl /.test(F)?u.name=F.substring(7).trim():/^mtllib /.test(F)||/^s /.test(F)))}for(var B=new THREE.Object3D,w=0,y=v.length;y>w;w++){i=v[w],l=i.geometry;var L=new THREE.BufferGeometry;L.addAttribute("position",new THREE.BufferAttribute(new Float32Array(l.vertices),3)),l.normals.length>0&&L.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(l.normals),3)),l.uvs.length>0&&L.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(l.uvs),2)),u=new THREE.MeshLambertMaterial,u.name=i.material.name;var O=new THREE.Mesh(L,u);O.name=i.name,B.add(O)}return console.timeEnd("OBJLoader"),B}};
},{}],162:[function(require,module,exports){
THREE.ExplodeModifier=function(){},THREE.ExplodeModifier.prototype.modify=function(e){for(var c=[],o=0,t=e.faces.length;t>o;o++){var i=c.length,r=e.faces[o],s=r.a,n=r.b,f=r.c,l=e.vertices[s],p=e.vertices[n],a=e.vertices[f];c.push(l.clone()),c.push(p.clone()),c.push(a.clone()),r.a=i,r.b=i+1,r.c=i+2}e.vertices=c,delete e.__tmpVertices};
},{}],163:[function(require,module,exports){
THREE.EffectComposer=function(e,r){if(this.renderer=e,void 0===r){var t=e.getPixelRatio(),s=Math.floor(e.context.canvas.width/t)||1,i=Math.floor(e.context.canvas.height/t)||1,a={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1};r=new THREE.WebGLRenderTarget(s,i,a)}this.renderTarget1=r,this.renderTarget2=r.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},THREE.EffectComposer.prototype={swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e)},insertPass:function(e,r){this.passes.splice(r,0,e)},render:function(e){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var r,t,s=!1,i=this.passes.length;for(t=0;i>t;t++)if(r=this.passes[t],r.enabled){if(r.render(this.renderer,this.writeBuffer,this.readBuffer,e,s),r.needsSwap){if(s){var a=this.renderer.context;a.stencilFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.stencilFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}r instanceof THREE.MaskPass?s=!0:r instanceof THREE.ClearMaskPass&&(s=!1)}},reset:function(e){if(void 0===e){e=this.renderTarget1.clone();var r=this.renderer.getPixelRatio();e.width=Math.floor(this.renderer.context.canvas.width/r),e.height=Math.floor(this.renderer.context.canvas.height/r)}this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,r){var t=this.renderTarget1.clone();t.width=e,t.height=r,this.reset(t)}};
},{}],164:[function(require,module,exports){
THREE.GlitchPass=function(t){void 0===THREE.DigitalGlitch&&console.error("THREE.GlitchPass relies on THREE.DigitalGlitch");var e=THREE.DigitalGlitch;this.uniforms=THREE.UniformsUtils.clone(e.uniforms),void 0==t&&(t=64),this.uniforms.tDisp.value=this.generateHeightmap(t),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),console.log(this.material),this.enabled=!0,this.renderToScreen=!1,this.needsSwap=!0,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad),this.goWild=!1,this.curF=0,this.generateTrigger()},THREE.GlitchPass.prototype={render:function(t,e,a,i){this.uniforms.tDiffuse.value=a,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=THREE.Math.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=THREE.Math.randFloat(-1,1),this.uniforms.seed_y.value=THREE.Math.randFloat(-1,1),this.uniforms.distortion_x.value=THREE.Math.randFloat(0,1),this.uniforms.distortion_y.value=THREE.Math.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=THREE.Math.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=THREE.Math.randFloat(0,1),this.uniforms.distortion_y.value=THREE.Math.randFloat(0,1),this.uniforms.seed_x.value=THREE.Math.randFloat(-.3,.3),this.uniforms.seed_y.value=THREE.Math.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,!1)},generateTrigger:function(){this.randX=THREE.Math.randInt(120,240)},generateHeightmap:function(t){var e=new Float32Array(t*t*3);console.log(t);for(var a=t*t,i=0;a>i;i++){var r=THREE.Math.randFloat(0,1);e[3*i+0]=r,e[3*i+1]=r,e[3*i+2]=r}var s=new THREE.DataTexture(e,t,t,THREE.RGBFormat,THREE.FloatType);return console.log(s),console.log(t),s.minFilter=THREE.NearestFilter,s.magFilter=THREE.NearestFilter,s.needsUpdate=!0,s.flipY=!1,s}};
},{}],165:[function(require,module,exports){
THREE.MaskPass=function(e,s){this.scene=e,this.camera=s,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype={render:function(e,s,t,a){var n=e.context;n.colorMask(!1,!1,!1,!1),n.depthMask(!1);var i,r;this.inverse?(i=0,r=1):(i=1,r=0),n.enable(n.STENCIL_TEST),n.stencilOp(n.REPLACE,n.REPLACE,n.REPLACE),n.stencilFunc(n.ALWAYS,i,4294967295),n.clearStencil(r),e.render(this.scene,this.camera,t,this.clear),e.render(this.scene,this.camera,s,this.clear),n.colorMask(!0,!0,!0,!0),n.depthMask(!0),n.stencilFunc(n.EQUAL,1,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP)}},THREE.ClearMaskPass=function(){this.enabled=!0},THREE.ClearMaskPass.prototype={render:function(e,s,t,a){var n=e.context;n.disable(n.STENCIL_TEST)}};
},{}],166:[function(require,module,exports){
THREE.RenderPass=function(e,r,l,a,o){this.scene=e,this.camera=r,this.overrideMaterial=l,this.clearColor=a,this.clearAlpha=void 0!==o?o:1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},THREE.RenderPass.prototype={render:function(e,r,l,a){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.render(this.scene,this.camera,l,this.clear),this.clearColor&&e.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}};
},{}],167:[function(require,module,exports){
THREE.ShaderPass=function(e,r){this.textureID=void 0!==r?r:"tDiffuse",this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({defines:e.defines||{},uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},THREE.ShaderPass.prototype={render:function(e,r,t,s){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=t),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,r,this.clear)}};
},{}],168:[function(require,module,exports){
THREE.CSS3DObject=function(e){THREE.Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(e){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})},THREE.CSS3DObject.prototype=Object.create(THREE.Object3D.prototype),THREE.CSS3DObject.prototype.constructor=THREE.CSS3DObject,THREE.CSS3DSprite=function(e){THREE.CSS3DObject.call(this,e)},THREE.CSS3DSprite.prototype=Object.create(THREE.CSS3DObject.prototype),THREE.CSS3DSprite.prototype.constructor=THREE.CSS3DSprite,THREE.CSS3DRenderer=function(){console.log("THREE.CSS3DRenderer",THREE.REVISION);var e,t,r,s,o=new THREE.Matrix4,n={camera:{fov:0,style:""},objects:{}},l=document.createElement("div");l.style.overflow="hidden",l.style.WebkitTransformStyle="preserve-3d",l.style.MozTransformStyle="preserve-3d",l.style.oTransformStyle="preserve-3d",l.style.transformStyle="preserve-3d",this.domElement=l;var a=document.createElement("div");a.style.WebkitTransformStyle="preserve-3d",a.style.MozTransformStyle="preserve-3d",a.style.oTransformStyle="preserve-3d",a.style.transformStyle="preserve-3d",l.appendChild(a),this.setClearColor=function(){},this.setSize=function(o,n){e=o,t=n,r=e/2,s=t/2,l.style.width=o+"px",l.style.height=n+"px",a.style.width=o+"px",a.style.height=n+"px"};var i=function(e){return Math.abs(e)<1e-6?0:e},c=function(e){var t=e.elements;return"matrix3d("+i(t[0])+","+i(-t[1])+","+i(t[2])+","+i(t[3])+","+i(t[4])+","+i(-t[5])+","+i(t[6])+","+i(t[7])+","+i(t[8])+","+i(-t[9])+","+i(t[10])+","+i(t[11])+","+i(t[12])+","+i(-t[13])+","+i(t[14])+","+i(t[15])+")"},p=function(e){var t=e.elements;return"translate3d(-50%,-50%,0) matrix3d("+i(t[0])+","+i(t[1])+","+i(t[2])+","+i(t[3])+","+i(-t[4])+","+i(-t[5])+","+i(-t[6])+","+i(-t[7])+","+i(t[8])+","+i(t[9])+","+i(t[10])+","+i(t[11])+","+i(t[12])+","+i(t[13])+","+i(t[14])+","+i(t[15])+")"},d=function(e,t){if(e instanceof THREE.CSS3DObject){var r;e instanceof THREE.CSS3DSprite?(o.copy(t.matrixWorldInverse),o.transpose(),o.copyPosition(e.matrixWorld),o.scale(e.scale),o.elements[3]=0,o.elements[7]=0,o.elements[11]=0,o.elements[15]=1,r=p(o)):r=p(e.matrixWorld);var s=e.element,l=n.objects[e.id];(void 0===l||l!==r)&&(s.style.WebkitTransform=r,s.style.MozTransform=r,s.style.oTransform=r,s.style.transform=r,n.objects[e.id]=r),s.parentNode!==a&&a.appendChild(s)}for(var i=0,c=e.children.length;c>i;i++)d(e.children[i],t)};this.render=function(e,o){var i=.5/Math.tan(THREE.Math.degToRad(.5*o.fov))*t;n.camera.fov!==i&&(l.style.WebkitPerspective=i+"px",l.style.MozPerspective=i+"px",l.style.oPerspective=i+"px",l.style.perspective=i+"px",n.camera.fov=i),e.updateMatrixWorld(),void 0===o.parent&&o.updateMatrixWorld(),o.matrixWorldInverse.getInverse(o.matrixWorld);var p="translate3d(0,0,"+i+"px)"+c(o.matrixWorldInverse)+" translate3d("+r+"px,"+s+"px, 0)";n.camera.style!==p&&(a.style.WebkitTransform=p,a.style.MozTransform=p,a.style.oTransform=p,a.style.transform=p,n.camera.style=p),d(e,o)}};
},{}],169:[function(require,module,exports){
THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null},THREE.Projector=function(){function e(){if(c===x){var e=new THREE.RenderableObject;return d.push(e),x++,c++,e}return d[c++]}function t(){if(p===y){var e=new THREE.RenderableVertex;return T.push(e),y++,p++,e}return T[p++]}function r(){if(u===w){var e=new THREE.RenderableFace;return H.push(e),w++,u++,e}return H[u++]}function i(){if(v===b){var e=new THREE.RenderableLine;return g.push(e),b++,v++,e}return g[v++]}function o(){if(m===S){var e=new THREE.RenderableSprite;return M.push(e),S++,m++,e}return M[m++]}function n(e,t){return e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}function a(e,t){var r=0,i=1,o=e.z+e.w,n=t.z+t.w,a=-e.z+e.w,s=-t.z+t.w;return o>=0&&n>=0&&a>=0&&s>=0?!0:0>o&&0>n||0>a&&0>s?!1:(0>o?r=Math.max(r,o/(o-n)):0>n&&(i=Math.min(i,o/(o-n))),0>a?r=Math.max(r,a/(a-s)):0>s&&(i=Math.min(i,a/(a-s))),r>i?!1:(e.lerp(t,r),t.lerp(e,1-i),!0))}var s,c,l,p,E,u,h,v,f,m,R,d=[],x=0,T=[],y=0,H=[],w=0,g=[],b=0,M=[],S=0,z={objects:[],lights:[],elements:[]},V=new THREE.Vector3,j=new THREE.Vector4,L=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),C=new THREE.Box3,k=new Array(3),N=(new Array(4),new THREE.Matrix4),W=new THREE.Matrix4,B=new THREE.Matrix4,F=new THREE.Matrix3,P=new THREE.Frustum,I=new THREE.Vector4,O=new THREE.Vector4;this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var D=function(){var e=[],o=[],n=null,a=null,s=new THREE.Matrix3,c=function(t){n=t,a=n.material,s.getNormalMatrix(n.matrixWorld),e.length=0,o.length=0},p=function(e){var t=e.position,r=e.positionWorld,i=e.positionScreen;r.copy(t).applyMatrix4(R),i.copy(r).applyMatrix4(W);var o=1/i.w;i.x*=o,i.y*=o,i.z*=o,e.visible=i.x>=-1&&i.x<=1&&i.y>=-1&&i.y<=1&&i.z>=-1&&i.z<=1},u=function(e,r,i){l=t(),l.position.set(e,r,i),p(l)},v=function(t,r,i){e.push(t,r,i)},f=function(e,t){o.push(e,t)},m=function(e,t,r){return e.visible===!0||t.visible===!0||r.visible===!0?!0:(k[0]=e.positionScreen,k[1]=t.positionScreen,k[2]=r.positionScreen,L.isIntersectionBox(C.setFromPoints(k)))},d=function(e,t,r){return(r.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(r.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0},x=function(e,t){var r=T[e],o=T[t];h=i(),h.id=n.id,h.v1.copy(r),h.v2.copy(o),h.z=(r.positionScreen.z+o.positionScreen.z)/2,h.material=n.material,z.elements.push(h)},y=function(t,i,c){var l=T[t],p=T[i],u=T[c];if(m(l,p,u)!==!1&&(a.side===THREE.DoubleSide||d(l,p,u)===!0)){E=r(),E.id=n.id,E.v1.copy(l),E.v2.copy(p),E.v3.copy(u),E.z=(l.positionScreen.z+p.positionScreen.z+u.positionScreen.z)/3;for(var h=0;3>h;h++){var v=3*arguments[h],f=E.vertexNormalsModel[h];f.set(e[v],e[v+1],e[v+2]),f.applyMatrix3(s).normalize();var R=2*arguments[h],x=E.uvs[h];x.set(o[R],o[R+1])}E.vertexNormalsLength=3,E.material=n.material,z.elements.push(E)}};return{setObject:c,projectVertex:p,checkTriangleVisibility:m,checkBackfaceCulling:d,pushVertex:u,pushNormal:v,pushUv:f,pushLine:x,pushTriangle:y}},G=new D;this.projectScene=function(l,d,x,y){u=0,v=0,m=0,z.elements.length=0,l.autoUpdate===!0&&l.updateMatrixWorld(),void 0===d.parent&&d.updateMatrixWorld(),N.copy(d.matrixWorldInverse.getInverse(d.matrixWorld)),W.multiplyMatrices(d.projectionMatrix,N),P.setFromMatrix(W),c=0,z.objects.length=0,z.lights.length=0,l.traverseVisible(function(t){if(t instanceof THREE.Light)z.lights.push(t);else if(t instanceof THREE.Mesh||t instanceof THREE.Line||t instanceof THREE.Sprite){if(t.material.visible===!1)return;(t.frustumCulled===!1||P.intersectsObject(t)===!0)&&(s=e(),s.id=t.id,s.object=t,V.setFromMatrixPosition(t.matrixWorld),V.applyProjection(W),s.z=V.z,z.objects.push(s))}}),x===!0&&z.objects.sort(n);for(var H=0,w=z.objects.length;w>H;H++){var g=z.objects[H].object,b=g.geometry;if(G.setObject(g),R=g.matrixWorld,p=0,g instanceof THREE.Mesh){if(b instanceof THREE.BufferGeometry){var M=b.attributes,S=b.offsets;if(void 0===M.position)continue;for(var L=M.position.array,C=0,k=L.length;k>C;C+=3)G.pushVertex(L[C],L[C+1],L[C+2]);if(void 0!==M.normal)for(var D=M.normal.array,C=0,k=D.length;k>C;C+=3)G.pushNormal(D[C],D[C+1],D[C+2]);if(void 0!==M.uv)for(var U=M.uv.array,C=0,k=U.length;k>C;C+=2)G.pushUv(U[C],U[C+1]);if(void 0!==M.index){var A=M.index.array;if(S.length>0)for(var H=0;H<S.length;H++)for(var q=S[H],J=q.index,C=q.start,k=q.start+q.count;k>C;C+=3)G.pushTriangle(A[C]+J,A[C+1]+J,A[C+2]+J);else for(var C=0,k=A.length;k>C;C+=3)G.pushTriangle(A[C],A[C+1],A[C+2])}else for(var C=0,k=L.length/3;k>C;C+=3)G.pushTriangle(C,C+1,C+2)}else if(b instanceof THREE.Geometry){var K=b.vertices,Q=b.faces,X=b.faceVertexUvs[0];F.getNormalMatrix(R);for(var Y=g.material,Z=Y instanceof THREE.MeshFaceMaterial,$=Z===!0?g.material:null,_=0,ee=K.length;ee>_;_++){var te=K[_];if(V.copy(te),Y.morphTargets===!0)for(var re=b.morphTargets,ie=g.morphTargetInfluences,oe=0,ne=re.length;ne>oe;oe++){var ae=ie[oe];if(0!==ae){var se=re[oe],ce=se.vertices[_];V.x+=(ce.x-te.x)*ae,V.y+=(ce.y-te.y)*ae,V.z+=(ce.z-te.z)*ae}}G.pushVertex(V.x,V.y,V.z)}for(var le=0,pe=Q.length;pe>le;le++){var Ee=Q[le],Y=Z===!0?$.materials[Ee.materialIndex]:g.material;if(void 0!==Y){var ue=Y.side,he=T[Ee.a],ve=T[Ee.b],fe=T[Ee.c];if(G.checkTriangleVisibility(he,ve,fe)!==!1){var me=G.checkBackfaceCulling(he,ve,fe);if(ue!==THREE.DoubleSide){if(ue===THREE.FrontSide&&me===!1)continue;if(ue===THREE.BackSide&&me===!0)continue}E=r(),E.id=g.id,E.v1.copy(he),E.v2.copy(ve),E.v3.copy(fe),E.normalModel.copy(Ee.normal),me!==!1||ue!==THREE.BackSide&&ue!==THREE.DoubleSide||E.normalModel.negate(),E.normalModel.applyMatrix3(F).normalize();for(var Re=Ee.vertexNormals,de=0,xe=Math.min(Re.length,3);xe>de;de++){var Te=E.vertexNormalsModel[de];Te.copy(Re[de]),me!==!1||ue!==THREE.BackSide&&ue!==THREE.DoubleSide||Te.negate(),Te.applyMatrix3(F).normalize()}E.vertexNormalsLength=Re.length;var ye=X[le];if(void 0!==ye)for(var He=0;3>He;He++)E.uvs[He].copy(ye[He]);E.color=Ee.color,E.material=Y,E.z=(he.positionScreen.z+ve.positionScreen.z+fe.positionScreen.z)/3,z.elements.push(E)}}}}}else if(g instanceof THREE.Line){if(b instanceof THREE.BufferGeometry){var M=b.attributes;if(void 0!==M.position){for(var L=M.position.array,C=0,k=L.length;k>C;C+=3)G.pushVertex(L[C],L[C+1],L[C+2]);if(void 0!==M.index)for(var A=M.index.array,C=0,k=A.length;k>C;C+=2)G.pushLine(A[C],A[C+1]);else for(var we=g.mode===THREE.LinePieces?2:1,C=0,k=L.length/3-1;k>C;C+=we)G.pushLine(C,C+1)}}else if(b instanceof THREE.Geometry){B.multiplyMatrices(W,R);var K=g.geometry.vertices;if(0===K.length)continue;he=t(),he.positionScreen.copy(K[0]).applyMatrix4(B);for(var we=g.mode===THREE.LinePieces?2:1,_=1,ee=K.length;ee>_;_++)he=t(),he.positionScreen.copy(K[_]).applyMatrix4(B),(_+1)%we>0||(ve=T[p-2],I.copy(he.positionScreen),O.copy(ve.positionScreen),a(I,O)===!0&&(I.multiplyScalar(1/I.w),O.multiplyScalar(1/O.w),h=i(),h.id=g.id,h.v1.positionScreen.copy(I),h.v2.positionScreen.copy(O),h.z=Math.max(I.z,O.z),h.material=g.material,g.material.vertexColors===THREE.VertexColors&&(h.vertexColors[0].copy(g.geometry.colors[_]),h.vertexColors[1].copy(g.geometry.colors[_-1])),z.elements.push(h)))}}else if(g instanceof THREE.Sprite){j.set(R.elements[12],R.elements[13],R.elements[14],1),j.applyMatrix4(W);var ge=1/j.w;j.z*=ge,j.z>=-1&&j.z<=1&&(f=o(),f.id=g.id,f.x=j.x*ge,f.y=j.y*ge,f.z=j.z,f.object=g,f.rotation=g.rotation,f.scale.x=g.scale.x*Math.abs(f.x-(j.x+d.projectionMatrix.elements[0])/(j.w+d.projectionMatrix.elements[12])),f.scale.y=g.scale.y*Math.abs(f.y-(j.y+d.projectionMatrix.elements[5])/(j.w+d.projectionMatrix.elements[13])),f.material=g.material,z.elements.push(f))}}return y===!0&&z.elements.sort(n),z}};
},{}],170:[function(require,module,exports){
THREE.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")};
},{}],171:[function(require,module,exports){
THREE.DigitalGlitch={uniforms:{tDiffuse:{type:"t",value:null},tDisp:{type:"t",value:null},byp:{type:"i",value:0},amount:{type:"f",value:.08},angle:{type:"f",value:.02},seed:{type:"f",value:.02},seed_x:{type:"f",value:.02},seed_y:{type:"f",value:.02},distortion_x:{type:"f",value:.5},distortion_y:{type:"f",value:.6},col_s:{type:"f",value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int byp;","uniform sampler2D tDiffuse;","uniform sampler2D tDisp;","uniform float amount;","uniform float angle;","uniform float seed;","uniform float seed_x;","uniform float seed_y;","uniform float distortion_x;","uniform float distortion_y;","uniform float col_s;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(byp<1) {","vec2 p = vUv;","float xs = floor(gl_FragCoord.x / 0.5);","float ys = floor(gl_FragCoord.y / 0.5);","vec4 normal = texture2D (tDisp, p*seed*seed);","if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {","if(seed_x>0.){","p.y = 1. - (p.y + distortion_y);","}","else {","p.y = distortion_y;","}","}","if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {","if(seed_y>0.){","p.x=distortion_x;","}","else {","p.x = 1. - (p.x + distortion_x);","}","}","p.x+=normal.x*seed_x*(seed/5.);","p.y+=normal.y*seed_y*(seed/5.);","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, p + offset);","vec4 cga = texture2D(tDiffuse, p);","vec4 cb = texture2D(tDiffuse, p - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);","gl_FragColor = gl_FragColor+ snow;","}","else {","gl_FragColor=texture2D (tDiffuse, vUv);","}","}"].join("\n")};
},{}],172:[function(require,module,exports){
THREE.VerticalTiltShiftShader={uniforms:{tDiffuse:{type:"t",value:null},v:{type:"f",value:1/512},r:{type:"f",value:.35}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float vv = v * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")};
},{}],173:[function(require,module,exports){
THREE.VignetteShader={uniforms:{tDiffuse:{type:"t",value:null},offset:{type:"f",value:1},darkness:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n")};
},{}],174:[function(require,module,exports){
!function(){function t(t,e,i){return t.call.apply(t.bind,arguments)}function e(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function i(n,o,s){return i=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?t:e,i.apply(null,arguments)}function n(t,e){this.C=t,this.q=e||t,this.D=this.q.document}function o(t,e,i){t=t.D.getElementsByTagName(e)[0],t||(t=document.documentElement),t&&t.lastChild&&t.insertBefore(i,t.lastChild)}function s(t,e,i){e=e||[],i=i||[];for(var n=t.className.split(/\s+/),o=0;o<e.length;o+=1){for(var s=!1,r=0;r<n.length;r+=1)if(e[o]===n[r]){s=!0;break}s||n.push(e[o])}for(e=[],o=0;o<n.length;o+=1){for(s=!1,r=0;r<i.length;r+=1)if(n[o]===i[r]){s=!0;break}s||e.push(n[o])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function r(t,e){for(var i=t.className.split(/\s+/),n=0,o=i.length;o>n;n++)if(i[n]==e)return!0;return!1}function a(t){if("string"==typeof t.ca)return t.ca;var e=t.q.location.protocol;return"about:"==e&&(e=t.C.location.protocol),"https:"==e?"https:":"http:"}function h(t,e){var i=t.createElement("link",{rel:"stylesheet",href:e,media:"all"}),n=!1;i.onload=function(){n||(n=!0)},i.onerror=function(){n||(n=!0)},o(t,"head",i)}function l(t,e,i,n){var o=t.D.getElementsByTagName("head")[0];if(o){var s=t.createElement("script",{src:e}),r=!1;return s.onload=s.onreadystatechange=function(){r||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(r=!0,i&&i(null),s.onload=s.onreadystatechange=null,"HEAD"==s.parentNode.tagName&&o.removeChild(s))},o.appendChild(s),setTimeout(function(){r||(r=!0,i&&i(Error("Script load timeout")))},n||5e3),s}return null}function f(t){this.ba=t||"-"}function u(t,e){this.U=t,this.M=4,this.G="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.G=i[1],this.M=parseInt(i[2],10))}function c(t){return t.G+t.M}function p(t){var e=4,i="n",n=null;return t&&((n=t.match(/(normal|oblique|italic)/i))&&n[1]&&(i=n[1].substr(0,1).toLowerCase()),(n=t.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?e=7:/[1-9]00/.test(n[1])&&(e=parseInt(n[1].substr(0,1),10)))),i+e}function d(t,e){this.a=t,this.j=t.q.document.documentElement,this.I=e,this.f="wf",this.e=new f("-"),this.Y=!1!==e.events,this.v=!1!==e.classes}function g(t){t.v&&s(t.j,[t.e.d(t.f,"loading")]),v(t,"loading")}function m(t){if(t.v){var e=r(t.j,t.e.d(t.f,"active")),i=[],n=[t.e.d(t.f,"loading")];e||i.push(t.e.d(t.f,"inactive")),s(t.j,i,n)}v(t,"inactive")}function v(t,e,i){t.Y&&t.I[e]&&(i?t.I[e](i.getName(),c(i)):t.I[e]())}function y(){this.u={}}function w(t,e,i){var n,o=[];for(n in e)if(e.hasOwnProperty(n)){var s=t.u[n];s&&o.push(s(e[n],i))}return o}function b(t,e){this.a=t,this.A=e,this.g=this.a.createElement("span",{"aria-hidden":"true"},this.A)}function x(t){o(t.a,"body",t.g)}function k(t){var e;e=[];for(var i=t.U.split(/,\s*/),n=0;n<i.length;n++){var o=i[n].replace(/['"]/g,"");-1==o.indexOf(" ")?e.push(o):e.push("'"+o+"'")}return e=e.join(","),i="normal","o"===t.G?i="oblique":"i"===t.G&&(i="italic"),"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+e+";"+("font-style:"+i+";font-weight:"+(t.M+"00")+";")}function N(t,e,i,n,o,s,r){this.N=t,this.aa=e,this.a=i,this.h=n,this.A=r||"BESbswy",this.p={},this.L=o||3e3,this.S=s||null,this.w=this.o=this.m=null,this.m=new b(this.a,this.A),this.o=new b(this.a,this.A),this.w=new b(this.a,this.A),t=new u("serif",c(this.h)),t=k(t),this.m.g.style.cssText=t,t=new u("sans-serif",c(this.h)),t=k(t),this.o.g.style.cssText=t,t=new u("monospace",c(this.h)),t=k(t),this.w.g.style.cssText=t,x(this.m),x(this.o),x(this.w)}function _(){if(null===K){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);K=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return K}function j(t,e,i){for(var n in G)if(G.hasOwnProperty(n)&&e===t.p[G[n]]&&i===t.p[G[n]])return!0;return!1}function T(t){var e,i=t.m.g.offsetWidth,n=t.o.g.offsetWidth;(e=i===t.p.serif&&n===t.p["sans-serif"])||(e=_()&&j(t,i,n)),e?$()-t.da>=t.L?_()&&j(t,i,n)&&(null===t.S||t.S.hasOwnProperty(t.h.getName()))?S(t,t.N):S(t,t.aa):C(t):S(t,t.N)}function C(t){setTimeout(i(function(){T(this)},t),50)}function S(t,e){t.m.remove(),t.o.remove(),t.w.remove(),e(t.h)}function A(t,e,i){this.a=t,this.s=e,this.J=0,this.W=this.R=!1,this.L=i}function E(t){0==--t.J&&t.R&&(t.W?(t=t.s,t.v&&s(t.j,[t.e.d(t.f,"active")],[t.e.d(t.f,"loading"),t.e.d(t.f,"inactive")]),v(t,"active")):m(t.s))}function W(t){this.C=t,this.t=new y,this.T=0,this.O=this.P=!0}function I(t,e,n,o,r){var a=0==--t.T;(t.O||t.P)&&setTimeout(function(){var t=r||null,h=o||null||{};if(0===n.length&&a)m(e.s);else{e.J+=n.length,a&&(e.R=a);var l,f=[];for(l=0;l<n.length;l++){var u=n[l],p=h[u.getName()],d=e.s,g=u;d.v&&s(d.j,[d.e.d(d.f,g.getName(),c(g).toString(),"loading")]),v(d,"fontloading",g),d=null,d=new N(i(e.Z,e),i(e.$,e),e.a,u,e.L,t,p),f.push(d)}for(l=0;l<f.length;l++)f[l].start()}},0)}function B(t,e,i){var n=[],o=i.timeout;g(e);var n=w(t.t,i,t.a),s=new A(t.a,e,o);for(t.T=n.length,e=0,i=n.length;i>e;e++)n[e].load(function(e,i,n){I(t,s,e,i,n)})}function q(t,e,i){this.H=t?t:e+M,this.k=[],this.K=[],this.X=i||""}function F(t){this.k=t,this.V=[],this.F={}}function O(t,e){this.a=t,this.c=e}function L(t,e){this.a=t,this.c=e,this.Q=[]}function D(t,e){this.a=t,this.c=e}function P(t,e){this.a=t,this.c=e}function H(t,e){this.a=t,this.c=e}var $=Date.now||function(){return+new Date};n.prototype.createElement=function(t,e,i){if(t=this.D.createElement(t),e)for(var n in e)e.hasOwnProperty(n)&&("style"==n?t.style.cssText=e[n]:t.setAttribute(n,e[n]));return i&&t.appendChild(this.D.createTextNode(i)),t},f.prototype.d=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.ba)},u.prototype.getName=function(){return this.U},b.prototype.remove=function(){var t=this.g;t.parentNode&&t.parentNode.removeChild(t)};var G={ga:"serif",fa:"sans-serif",ea:"monospace"},K=null;N.prototype.start=function(){this.p.serif=this.m.g.offsetWidth,this.p["sans-serif"]=this.o.g.offsetWidth,this.p.monospace=this.w.g.offsetWidth,this.da=$();var t=new u(this.h.getName()+",serif",c(this.h)),t=k(t);this.m.g.style.cssText=t,t=new u(this.h.getName()+",sans-serif",c(this.h)),t=k(t),this.o.g.style.cssText=t,T(this)},A.prototype.Z=function(t){var e=this.s;e.v&&s(e.j,[e.e.d(e.f,t.getName(),c(t).toString(),"active")],[e.e.d(e.f,t.getName(),c(t).toString(),"loading"),e.e.d(e.f,t.getName(),c(t).toString(),"inactive")]),v(e,"fontactive",t),this.W=!0,E(this)},A.prototype.$=function(t){var e=this.s;if(e.v){var i=r(e.j,e.e.d(e.f,t.getName(),c(t).toString(),"active")),n=[],o=[e.e.d(e.f,t.getName(),c(t).toString(),"loading")];i||n.push(e.e.d(e.f,t.getName(),c(t).toString(),"inactive")),s(e.j,n,o)}v(e,"fontinactive",t),E(this)},W.prototype.load=function(t){this.a=new n(this.C,t.context||this.C),this.P=!1!==t.events,this.O=!1!==t.classes,B(this,new d(this.a,t),t)};var M="//fonts.googleapis.com/css";q.prototype.d=function(){if(0==this.k.length)throw Error("No fonts to load!");if(-1!=this.H.indexOf("kit="))return this.H;for(var t=this.k.length,e=[],i=0;t>i;i++)e.push(this.k[i].replace(/ /g,"+"));return t=this.H+"?family="+e.join("%7C"),0<this.K.length&&(t+="&subset="+this.K.join(",")),0<this.X.length&&(t+="&text="+encodeURIComponent(this.X)),t};var R={latin:"BESbswy",cyrillic:"&#1081;&#1103;&#1046;",greek:"&#945;&#946;&#931;",khmer:"&#x1780;&#x1781;&#x1782;",Hanuman:"&#x1780;&#x1781;&#x1782;"},U={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},J={i:"i",italic:"i",n:"n",normal:"n"},Q=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;F.prototype.parse=function(){for(var t=this.k.length,e=0;t>e;e++){var i=this.k[e].split(":"),n=i[0].replace(/\+/g," "),o=["n4"];if(2<=i.length){var s,r=i[1];if(s=[],r)for(var r=r.split(","),a=r.length,h=0;a>h;h++){var l;if(l=r[h],l.match(/^[\w-]+$/))if(l=Q.exec(l.toLowerCase()),null==l)l="";else{var f;if(f=l[1],null==f||""==f)f="4";else{var c=U[f];f=c?c:isNaN(f)?"4":f.substr(0,1)}l=l[2],l=[null==l||""==l?"n":J[l],f].join("")}else l="";l&&s.push(l)}0<s.length&&(o=s),3==i.length&&(i=i[2],s=[],i=i?i.split(","):s,0<i.length&&(i=R[i[0]])&&(this.F[n]=i))}for(this.F[n]||(i=R[n])&&(this.F[n]=i),i=0;i<o.length;i+=1)this.V.push(new u(n,o[i]))}};var V={Arimo:!0,Cousine:!0,Tinos:!0};O.prototype.load=function(t){for(var e=this.a,i=new q(this.c.api,a(e),this.c.text),n=this.c.families,o=n.length,s=0;o>s;s++){var r=n[s].split(":");3==r.length&&i.K.push(r.pop());var l="";2==r.length&&""!=r[1]&&(l=":"),i.k.push(r.join(l))}n=new F(n),n.parse(),h(e,i.d()),t(n.V,n.F,V)},L.prototype.B=function(t){var e=this.a;return a(this.a)+(this.c.api||"//f.fontdeck.com/s/css/js/")+(e.q.location.hostname||e.C.location.hostname)+"/"+t+".js"},L.prototype.load=function(t){var e=this.c.id,i=this.a.q,n=this;e?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[e]=function(e,i){for(var o=0,s=i.fonts.length;s>o;++o){var r=i.fonts[o];n.Q.push(new u(r.name,p("font-weight:"+r.weight+";font-style:"+r.style)))}t(n.Q)},l(this.a,this.B(e),function(e){e&&t([])})):t([])},D.prototype.B=function(t){return(this.c.api||"https://use.typekit.net")+"/"+t+".js"},D.prototype.load=function(t){var e=this.c.id,i=this.a.q;e?l(this.a,this.B(e),function(e){if(e)t([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){e=i.Typekit.config.fn;for(var n=[],o=0;o<e.length;o+=2)for(var s=e[o],r=e[o+1],a=0;a<r.length;a++)n.push(new u(s,r[a]));try{i.Typekit.load({events:!1,classes:!1})}catch(h){}t(n)}},2e3):t([])},P.prototype.B=function(t,e){var i=a(this.a),n=(this.c.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return i+"//"+n+"/"+t+".js"+(e?"?v="+e:"")},P.prototype.load=function(t){var e=this.c.projectId,i=this.c.version;if(e){var n=this.a.q;l(this.a,this.B(e,i),function(i){if(i)t([]);else if(n["__mti_fntLst"+e]){i=n["__mti_fntLst"+e]();var o=[];if(i)for(var s=0;s<i.length;s++)o.push(new u(i[s].fontfamily));t(o)}else t([])}).id="__MonotypeAPIScript__"+e}else t([])},H.prototype.load=function(t){var e,i,n=this.c.urls||[],o=this.c.families||[],s=this.c.testStrings||{};for(e=0,i=n.length;i>e;e++)h(this.a,n[e]);for(n=[],e=0,i=o.length;i>e;e++){var r=o[e].split(":");if(r[1])for(var a=r[1].split(","),l=0;l<a.length;l+=1)n.push(new u(r[0],a[l]));else n.push(new u(r[0]))}t(n,s)};var X=new W(window);X.t.u.custom=function(t,e){return new H(e,t)},X.t.u.fontdeck=function(t,e){return new L(e,t)},X.t.u.monotype=function(t,e){return new P(e,t)},X.t.u.typekit=function(t,e){return new D(e,t)},X.t.u.google=function(t,e){return new O(e,t)};var Y={load:i(X.load,X)};"function"==typeof define&&define.amd?define(function(){return Y}):"undefined"!=typeof module&&module.exports?module.exports=Y:(window.WebFont=Y,window.WebFontConfig&&X.load(window.WebFontConfig))}();
},{}],175:[function(require,module,exports){
var namespaceString="Army";window[namespaceString]=window[namespaceString]||{},module.exports=window[namespaceString];
},{}],176:[function(require,module,exports){
var CDN_PATH="http://storage.googleapis.com/cryptaris/",paths={CDN:CDN_PATH,VIDEOS:CDN_PATH+"videos/",IMGS:CDN_PATH+"imgs/",IMGS_STANDARD:CDN_PATH+"imgs/standard/",MODELS:CDN_PATH+"models/",INTEL_SWEEP:CDN_PATH+"data/intel-sweep/"};module.exports=paths;
},{}],177:[function(require,module,exports){
var BarrelBlurShader={uniforms:{tDiffuse:{type:"t",value:null},amount:{type:"f",value:.5},time:{type:"f",value:0}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float amount;","uniform float time;","varying vec2 vUv;","const int num_iter = 16;","const float reci_num_iter_f = 1.0 / float(num_iter);","const float gamma = 2.2;","const float MAX_DIST_PX = 200.0;","vec2 barrelDistortion( vec2 p, vec2 amt )","{","    p = 2.0*p-1.0;","    //float BarrelPower = 1.125;","    const float maxBarrelPower = 3.0;","    float theta  = atan(p.y, p.x);","    float radius = length(p);","    radius = pow(radius, 1.0 + maxBarrelPower * amt.x);","    p.x = radius * cos(theta);","    p.y = radius * sin(theta);","    return 0.5 * ( p + 1.0 );","}","float sat( float t )","{","	return clamp( t, 0.0, 1.0 );","}","float linterp( float t ) {","	return sat( 1.0 - abs( 2.0*t - 1.0 ) );","}","float remap( float t, float a, float b ) {","	return sat( (t - a) / (b - a) );","}","vec3 spectrum_offset( float t ) {","	vec3 ret;","	float lo = step(t,0.5);","	float hi = 1.0-lo;","	float w = linterp( remap( t, 1.0/6.0, 5.0/6.0 ) );","	ret = vec3(lo,1.0,hi) * vec3(1.0-w, w, 1.0-w);","","	return pow( ret, vec3(1.0/2.2) );","}","float nrand( vec2 n )","{","	return fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453);","}","vec3 lin2srgb( vec3 c )","{","    return pow( c, vec3(gamma) );","}","vec3 srgb2lin( vec3 c )","{","    return pow( c, vec3(1.0/gamma));","}","void main() {","vec2 uv = vUv;","vec2 max_distort = vec2(amount);","vec2 oversiz = barrelDistortion( vec2(1,1), max_distort );","uv = 2.0 * uv - 1.0;","uv = uv / (oversiz*oversiz);","uv = 0.5 * uv + 0.5;","vec3 sumcol = vec3(0.0);","vec3 sumw = vec3(0.0);","float rnd = nrand( uv + fract(time) );","for ( int i=0; i<num_iter;++i ){","float t = (float(i)+rnd) * reci_num_iter_f;","vec3 w = spectrum_offset( t );","sumw += w;","sumcol += w * srgb2lin(texture2D( tDiffuse, barrelDistortion(uv, max_distort*t ) ).rgb);","}","sumcol.rgb /= sumw;","vec3 outcol = lin2srgb(sumcol.rgb);","outcol += rnd/255.0;","gl_FragColor = vec4( outcol, 1.0);","}"].join("\n")};module.exports=BarrelBlurShader;
},{}],178:[function(require,module,exports){
var ColorifyShader={uniforms:{tDiffuse:{type:"t",value:null},color:{type:"c",value:new THREE.Color(16777215)},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","gl_FragColor = vec4( mix(texel.xyz, v * color, opacity), 1.0 );","}"].join("\n")};module.exports=ColorifyShader;
},{}],179:[function(require,module,exports){
DotShader={uniforms:{opacity:{type:"f",value:.5},texture:{type:"t"},size:{type:"f",value:15},time:{type:"f",value:0}},attributes:{alphaPos:{type:"f",value:[]}},vertexShader:["uniform float size;","attribute float alphaPos;","varying float vAlphaPos;","void main() {","vAlphaPos = alphaPos;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = size * ( 300.0 / length( mvPosition.xyz ) );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform float time;","uniform sampler2D texture;","varying float vAlphaPos;","void main() {","float alpha = sin(vAlphaPos + time)/2.0 + 0.5 + 0.2;","gl_FragColor = texture2D( texture, gl_PointCoord );","gl_FragColor.a *= alpha * opacity;","}"].join("\n")},module.exports=DotShader;
},{}],180:[function(require,module,exports){
THREE.FilmShader={uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},nIntensity:{type:"f",value:.5},sIntensity:{type:"f",value:.05},sCount:{type:"f",value:4096},grayscale:{type:"i",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","float x = vUv.x * vUv.y * time *  1000.0;","x = mod( x, 13.0 ) * mod( x, 123.0 );","float dx = mod( x, 0.01 );","vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};
},{}],181:[function(require,module,exports){
var GlitchPassAlt=function(a){void 0===THREE.DigitalGlitch&&console.error("GlitchPassAlt relies on THREE.DigitalGlitch");var e=THREE.DigitalGlitch;this.uniforms=THREE.UniformsUtils.clone(e.uniforms),void 0===a&&(a=64),this.uniforms.tDisp.value=this.generateHeightmap(a),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.enabled=!0,this.renderToScreen=!1,this.needsSwap=!0,this.scalar=1,this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new THREE.Scene,this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)};GlitchPassAlt.prototype={render:function(a,e,t,r){this.uniforms.tDiffuse.value=t,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.enabled?(this.uniforms.amount.value=Math.random()/THREE.Math.randInt(30,90)*this.scalar,this.uniforms.angle.value=THREE.Math.randFloat(-Math.PI,Math.PI)*this.scalar,this.uniforms.seed_x.value=THREE.Math.randFloat(-1,1)*this.scalar,this.uniforms.seed_y.value=THREE.Math.randFloat(-1,1)*this.scalar,this.uniforms.distortion_x.value=THREE.Math.randFloat(0,1)*this.scalar,this.uniforms.distortion_y.value=THREE.Math.randFloat(0,1)*this.scalar):this.uniforms.amount.value=0,this.quad.material=this.material,this.renderToScreen?a.render(this.scene,this.camera):a.render(this.scene,this.camera,e,!1)},generateHeightmap:function(a){var e=new Float32Array(a*a*3);console.log(a);for(var t=a*a,r=0;t>r;r++){var i=THREE.Math.randFloat(0,1);e[3*r+0]=i,e[3*r+1]=i,e[3*r+2]=i}var s=new THREE.DataTexture(e,a,a,THREE.RGBFormat,THREE.FloatType);return s.minFilter=THREE.NearestFilter,s.magFilter=THREE.NearestFilter,s.needsUpdate=!0,s.flipY=!1,s}},module.exports=GlitchPassAlt;
},{}],182:[function(require,module,exports){
var GlowShader={uniforms:{tDiffuse:{type:"t",value:null},amount:{type:"f",value:.5},size:{type:"f",value:4},darkness:{type:"f",value:.1},resolution:{type:"v2",value:new THREE.Vector2(800,600)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float size;","uniform float amount;","uniform vec2 resolution;","uniform float darkness;","varying vec2 vUv;","void main() {","float h = size / resolution.x;","float v = size / resolution.y;","vec4 sum = vec4( 0.0 );","sum += (texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) )- darkness) * 0.051 ;","sum += (texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) )- darkness) * 0.0918;","sum += (texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) )- darkness) * 0.12245;","sum += (texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) )- darkness) * 0.1531;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y ) )- darkness) * 0.1633;","sum += (texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) )- darkness) * 0.1531;","sum += (texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) )- darkness) * 0.12245;","sum += (texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) )- darkness) * 0.0918;","sum += (texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) )- darkness) * 0.051;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) )- darkness) * 0.051;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) )- darkness) * 0.0918;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) )- darkness) * 0.12245;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) )- darkness) * 0.1531;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y ) )- darkness) * 0.1633;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) )- darkness) * 0.1531;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) )- darkness) * 0.12245;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) )- darkness) * 0.0918;","sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) )- darkness) * 0.051;","vec4 base = texture2D( tDiffuse, vUv );","gl_FragColor = base + max(sum,0.0) * amount;","}"].join("\n")};module.exports=GlowShader;
},{}],183:[function(require,module,exports){
var GrainShader={uniforms:{tDiffuse:{type:"t",value:null},intensity:{type:"f",value:.0175}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float intensity;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","vec4 val = texture2D(tDiffuse, vUv);","float r = rand(vUv);","val += r < 0.5 ? (r * intensity) : (-r * intensity);","gl_FragColor = val;","}"].join("\n")};module.exports=GrainShader;
},{}],184:[function(require,module,exports){
var LinesShader={uniforms:{tDiffuse:{type:"t",value:null},lineStrength:{type:"f",value:10},lineSize:{type:"f",value:10},lineTilt:{type:"f",value:10}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float lineStrength;","uniform float lineSize;","uniform float lineTilt;","varying vec2 vUv;","void main() {","vec4 col = texture2D(tDiffuse, vUv);","col += sin(vUv.x*lineSize*(1.0-lineTilt)+vUv.y*lineSize*lineTilt)*lineStrength;","gl_FragColor = col;","}"].join("\n")};module.exports=LinesShader;
},{}],185:[function(require,module,exports){
var VerticalTiltShiftShader={uniforms:{tDiffuse:{type:"t",value:null},v:{type:"f",value:1/512},r:{type:"f",value:.35}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","uniform float r;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","float vv = v * abs( r - vUv.y );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")};module.exports=VerticalTiltShiftShader;
},{}],186:[function(require,module,exports){
var VignetteShader={uniforms:{tDiffuse:{type:"t",value:null},offset:{type:"f",value:1},darkness:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n")};module.exports=VignetteShader;
},{}],187:[function(require,module,exports){
module.exports="uniform sampler2D tDiffuse;\n\nuniform float size;\nuniform float amount;\nuniform vec2 resolution;\nuniform float darkness;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n	float h = size / resolution.x;\n	float v = size / resolution.y;\n\n	vec4 sum = vec4( 0.0 );\n\n	//H Blur\n	sum += (texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) )- darkness) * 0.051 ;\n	sum += (texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) )- darkness) * 0.0918;\n	sum += (texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) )- darkness) * 0.12245;\n	sum += (texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) )- darkness) * 0.1531;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y ) )- darkness) * 0.1633;\n	sum += (texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) )- darkness) * 0.1531;\n	sum += (texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) )- darkness) * 0.12245;\n	sum += (texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) )- darkness) * 0.0918;\n	sum += (texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) )- darkness) * 0.051;\n\n	//V Blur\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) )- darkness) * 0.051;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) )- darkness) * 0.0918;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) )- darkness) * 0.12245;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) )- darkness) * 0.1531;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y ) )- darkness) * 0.1633;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) )- darkness) * 0.1531;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) )- darkness) * 0.12245;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) )- darkness) * 0.0918;\n	sum += (texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) )- darkness) * 0.051;\n\n	//get original pixel color\n	vec4 base = texture2D( tDiffuse, vUv );\n\n	//Additive Blend\n	gl_FragColor = base + max(sum,0.0) * amount;\n}\n";
},{}],188:[function(require,module,exports){
var GlowShader={uniforms:{tDiffuse:{type:"t",value:null},amount:{type:"f",value:.5},size:{type:"f",value:4},darkness:{type:"f",value:.1},resolution:{type:"v2",value:new THREE.Vector2(800,600)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:require("./glow-frag.glsl")};module.exports=GlowShader;
},{"./glow-frag.glsl":187}],189:[function(require,module,exports){
var Promise=require("lie"),imgPath="/assets/imgs/DO-NOT-OPTIMIZE-5mb.jpg",imgSize=4995374;module.exports={test:function(){return new Promise(function(e,i){var n,o,t=new Image;t.onload=function(){o=(new Date).getTime();var i=(o-n)/1e3,t=8*imgSize,r=(t/i).toFixed(2),a=(r/1024).toFixed(2),m=(a/1024).toFixed(2);e({bps:r,kbps:a,mbps:m})},t.onerror=function(e,n){i("Invalid image, or error downloading")},n=(new Date).getTime();var r="?nnn="+n;t.src=imgPath+r})["catch"](function(e){console.log(e)})}};
},{"lie":10}],190:[function(require,module,exports){
require("shared/classList");var features=require("./features"),bandwidth=require("./bandwidth"),Promise=require("lie"),uaParser=new(require("ua-parser-js")),Client=function(){this.features=features,this.browser=uaParser.getBrowser(),this.device=uaParser.getDevice(),this.os=uaParser.getOS(),this.cpu=uaParser.getCPU(),this.engine=uaParser.getEngine(),this._uaParser=uaParser};Client.prototype.testBandwidth=function(){return new Promise(function(e,i){bandwidth.test().then(e)})["catch"](function(e){console.log(e)})},Client.prototype.determineExperience=function(){var e=this;return new Promise(function(i,t){var r="flagship";if(features.webgl){var n="iPad"===e.device.model&&window.devicePixelRatio<2,a="iPhone"===e.device.model&&screen.height<480;"iOS"===e.os.name&&(a||n)&&(r="standard");var s=e.os.version.split("."),o=parseFloat(s[0]+"."+s[1]);"Android"===e.os.name&&4.2>=o&&(r="standard")}else r="standard";var d="tablet"===e.device.type&&features.webgl===!1;(!features.canvas||d)&&(r="fallback"),"Edge"===e.browser.name&&-1===navigator.appVersion.indexOf("Trident")&&(r="standard"),this.experience=r,i(r)})["catch"](function(e){console.log(e)})};var client=new Client;void 0===client.device.type&&"Android"===client.os.name&&(client.device.type="mobile"),("dev"===window.env||null!==window.location.search.match("debug"))&&(window._client=client),module.exports=client;
},{"./bandwidth":189,"./features":191,"lie":10,"shared/classList":154,"ua-parser-js":23}],191:[function(require,module,exports){
var features={_tests:{},addTest:function(t,e){this._tests[t]=e,this.runTest(t)},runTests:function(){var t=this;_.keys(this._tests).forEach(function(e){t.runTest(e)})},runTest:function(t){var e=this._tests[t]();this[t]=e;var n=t;e===!1&&(n="no-"+n),document.documentElement.classList.add(n)}};features.addTest("touch",function(){var t="ontouchstart"in document.documentElement;return t}),features.addTest("webgl",function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(e){return!1}}),features.addTest("canvas",function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}),features.addTest("localstorage",function(){var t="modernizr";try{return window.localStorage.setItem(t,t),window.localStorage.removeItem(t),!0}catch(e){return!1}}),features.runTests(),module.exports=features;
},{}],192:[function(require,module,exports){
"use strict";var CursorManager={locked:!1,style:"auto",setCursor:function(s,r){if(!this.locked&&this.style!==r){s=s||document.body;var e;switch(r){case"pointer":e="cursor-pointer";break;case"move":e="cursor-move";break;case"grab":e="cursor-grab";break;case"grabbing":e="cursor-grabbing"}this.style=r,this.removeAllClasses(s),e&&$(s).addClass(e)}},resetCursor:function(s){this.locked||(s=s||document.body,this.removeAllClasses(s),this.setCursor(s,"auto"))},lock:function(s){s=s||!1,this.locked=s},removeAllClasses:function(s){s=s||document.body,$(s).removeClass("cursor-auto").removeClass("cursor-grab").removeClass("cursor-grabbing").removeClass("cursor-move").removeClass("cursor-pointer")},dispose:function(s){this.removeAllClasses(s)}};module.exports=CursorManager;
},{}],193:[function(require,module,exports){
"use strict";var generalUtils={normalize:function(t,n,r){return(t-n)/(r-n)},lerp:function(t,n,r){return(r-n)*t+n},map:function(t,n,r,e,i){return this.lerp(this.normalize(t,n,r),e,i)},clamp:function(t,n,r){return Math.min(Math.max(t,Math.min(n,r)),Math.max(n,r))},distance:function(t,n){var r=n.x-t.x,e=n.y-t.y;return Math.sqrt(r*r+e*e)},distanceXY:function(t,n,r,e){var i=r-t,o=e-n;return Math.sqrt(i*i+o*o)},circleCollision:function(t,n){return this.distance(t,n)<=t.radius+n.radius},circlePointCollision:function(t,n,r){return this.distanceXY(t,n,r.x,r.y)<r.radius},pointInRect:function(t,n,r){return this.inRange(t,r.x,r.x+r.width)&&this.inRange(n,r.y,r.y+r.height)},inRange:function(t,n,r){return t>=Math.min(n,r)&&t<=Math.max(n,r)},rangeIntersect:function(t,n,r,e){return Math.max(t,n)>=Math.min(r,e)&&Math.min(t,n)<=Math.max(r,e)},rectIntersect:function(t,n){return this.rangeIntersect(t.x,t.x+t.width,n.x,n.x+n.width)&&this.rangeIntersect(t.y,t.y+t.height,n.y,n.y+n.height)},degreesToRads:function(t){return t/180*Math.PI},radsToDegrees:function(t){return 180*t/Math.PI},angleBetweenPoints:function(t,n){return Math.atan2(n.y-t.y,n.x-t.x)},randomRange:function(t,n){return t+Math.random()*(n-t)},randomInt:function(t,n){return Math.floor(t+Math.random()*(n-t+1))},roundToPlaces:function(t,n){var r=Math.pow(10,n);return Math.round(t*r)/r},roundNearest:function(t,n){return Math.round(t/n)*n},quadraticBezier:function(t,n,r,e,i){return i=i||{},i.x=Math.pow(1-e,2)*t.x+2*(1-e)*e*n.x+e*e*r.x,i.y=Math.pow(1-e,2)*t.y+2*(1-e)*e*n.y+e*e*r.y,i},cubicBezier:function(t,n,r,e,i,o){return o=o||{},o.x=Math.pow(1-i,3)*t.x+3*Math.pow(1-i,2)*i*n.x+3*(1-i)*i*i*r.x+i*i*i*e.x,o.y=Math.pow(1-i,3)*t.y+3*Math.pow(1-i,2)*i*n.y+3*(1-i)*i*i*r.y+i*i*i*e.y,o},multicurve:function(t,n){var r,e,i,o;n.moveTo(t[0].x,t[0].y);for(var a=1;a<t.length-2;a+=1)r=t[a],e=t[a+1],i=(r.x+e.x)/2,o=(r.y+e.y)/2,n.quadraticCurveTo(r.x,r.y,i,o);r=t[t.length-2],e=t[t.length-1],n.quadraticCurveTo(r.x,r.y,e.x,e.y)},pointOnSphere:function(t,n,r){return{x:t*Math.cos(n)*Math.sin(r),y:t*Math.sin(n)*Math.sin(r),z:t*Math.cos(r)}},getPointsOnSphere:function(t){for(var n,r=[],e=0;t>e;e++)n=this.pointOnSphere(1,Math.random()*Math.PI*2,Math.random()*Math.PI*2),r.push({x:n.x,y:n.y,z:n.z});return r},getPointsOnSphereEvenly:function(t){for(var n,r,e,i,o,a=[],u=Math.PI*(3-Math.sqrt(5)),c=2/t,h=0;t>h;h++)r=h*c-1+c/2,i=Math.sqrt(1-r*r),o=h*u,n=Math.cos(o)*i,e=Math.sin(o)*i,a.push({x:n,y:r,z:e});return a},clone:function(t){return JSON.parse(JSON.stringify(t))},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},shuffleArray:function(t){for(var n,r,e=t.length;0!==e;)r=Math.floor(Math.random()*e),e-=1,n=t[e],t[e]=t[r],t[r]=n;return t},thinOutArray:function(t,n){for(var r=[],e=t.length,i=0;e>i;i+=n)r.push(t[i]);return r},randomItemFromArray:function(t){return t[Math.random()*t.length|0]},arrayRestrictedToRangeZ:function(t,n,r){for(var e=[],i=t.length,o=0;i>o;o++)this.inRange(t[o].z,n,r)&&e.push(t[o]);return e},extractKeyFromArray:function(t,n){for(var r=[],e=0;e<t.length;e++)r.push(t[e][n]);return r},repeat:function(t,n,r,e,i){i=i||0;var o=0,a=function(){setTimeout(function(){t(n),o++,r>o&&a()},e)};setTimeout(function(){a()},i)},isOpera:function(){return!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0},isFirefox:function(){return"undefined"!=typeof InstallTrigger},isSafari:function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0},isChrome:function(){return!!window.chrome&&!this.isOpera()},isIE:function(){return!!document.documentMode},isMac:function(){return navigator.platform.toLowerCase().indexOf("mac")>-1},isWindows:function(){return navigator.platform.toLowerCase().indexOf("win")>-1},hasWebGL:function(){if(window.WebGLRenderingContext){for(var t=document.createElement("canvas"),n=["webgl","experimental-webgl","moz-webgl","webkit-3d"],r=!1,e=0;4>e;e++)try{if(r=t.getContext(n[e]),r&&"function"==typeof r.getParameter)return!0}catch(i){}return!1}return!1},getVideoType:function(t){return-1!==t.indexOf(".mp4")?"video/mp4":-1!==t.indexOf(".webm")?"video/webm":-1!==t.indexOf(".ogg")?"video/ogg":void 0},dispatchEvent:function(t,n){n=n||null;var r;this.isIE()?(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!0,!1,n),document.dispatchEvent(r)):(r=new CustomEvent(t,{detail:n}),document.dispatchEvent(r))},setCursor:function(t,n){n=n||document.body,n.style.cursor!==t&&(n.style.cursor=t)}};module.exports=generalUtils;
},{}],194:[function(require,module,exports){
"use strict";var pixiUtils={scale:1,createLabel:function(i,e,n,t,l,r,s){n=n||16777215,t=t||12,l=l||1,r=r||0,s=s||0,t*=this.scale;var o=new PIXI.Text(i,{font:t+"px "+e,fill:n});return o.alpha=l,o.position.set(r,s),o},createRect:function(i,e,n,t,l,r,s){var o=new PIXI.Graphics;return t&&o.lineStyle(n,t,l),r&&o.beginFill(r,s),o.drawRect(0,0,i*this.scale,e*this.scale),r&&o.endFill(),o},createCircle:function(i,e,n,t,l,r){var s=new PIXI.Graphics;return n&&s.lineStyle(e,n,t),l&&s.beginFill(l,r),s.drawCircle(0,0,i*this.scale),l&&s.endFill(),s},createArc:function(i,e,n,t,l,r,s,o){var a=new PIXI.Graphics;return l&&a.lineStyle(t,l,r),s&&a.beginFill(s,o),a.arc(0,0,i*this.scale,e,n),s&&a.endFill(),a},drawArc:function(i,e,n,t,l,r,s,o,a){i.clear(),r&&i.lineStyle(l,r,s),o&&i.beginFill(o,a),i.arc(0,0,e*this.scale,n,t),o&&i.endFill()},setPositions:function(i,e,n){for(var t=0;t<i.length;t++)i[t].position.set(e,n)},roundPosition:function(i){i.position.set(Math.round(i.position.x),Math.round(i.position.y))},roundPositions:function(i){for(var e=0;e<i.length;e++)this.roundPosition(i[e])}};module.exports=pixiUtils;
},{}],195:[function(require,module,exports){
module.exports=function(n,r){var t={};r&&r.args&&(t=r.args);var u=function(r){if(r)for(var u=0;u<r.length;u++)t[n[0].o[u]]=r[u]},f=function(n){var r=[];if(n)for(var u=0;u<n.length;u++)t[n[u]]?r.push(t[n[u]]):r.push(null);return r},o=function(){u(arguments),n.shift(),n.length?a():r.completed(t)},a=function(){var r=f(n[0].i);r.push(o),n[0].fn.apply(this,r)};a()};
},{}],196:[function(require,module,exports){
var storage={getItem:function(t){var e;try{e=window.localStorage.getItem(t)}catch(o){}return e},setItem:function(t,e){try{window.localStorage.setItem(t,e)}catch(o){}},removeItem:function(t){try{window.localStorage.removeItem(t)}catch(e){}},clear:function(){try{window.localStorage.clear()}catch(t){}}};window._storage=storage,module.exports=storage;
},{}],197:[function(require,module,exports){
"use strict";var threeUtils={axisUp:new THREE.Vector3(0,1,0),axisDown:new THREE.Vector3(0,-1,0),axisLeft:new THREE.Vector3(-1,0,0),axisRight:new THREE.Vector3(1,0,0),axisForward:new THREE.Vector3(0,0,1),axisBackward:new THREE.Vector3(0,0,-1),degreesToRads:function(e){return e/180*Math.PI},radsToDegrees:function(e){return 180*e/Math.PI},createPlane:function(e,t,r){return new THREE.Mesh(new THREE.PlaneBufferGeometry(e||1,t||1),new THREE.MeshBasicMaterial({color:r||16777215}))},randomRange:function(e,t){return e+Math.random()*(t-e)},rotateAroundWorldAxis:function(e,t,r){var n=new THREE.Matrix4;n.makeRotationAxis(t.normalize(),r),n.multiply(e.matrix),e.matrix=n,e.rotation.setFromRotationMatrix(e.matrix)},setScale:function(e,t){e.scale.set(t,t,t)},disposeOfMesh:function(e){e&&(e.parent&&e.parent.remove(e),e.geometry&&e.geometry.dispose(),e.material&&(e.material.map&&e.material.map.dispose(),e.material.dispose()))},disposeOfChildren:function(e){if(e)for(;e.length>0;)this.disposeOfMesh(e[0])},removeAllChildren:function(e){for(;e.children.length>0;)e.remove(e.children[0])},moveTowards:function(e,t,r){e.position.x+=(t.x-e.position.x)*r,e.position.y+=(t.y-e.position.y)*r,e.position.z+=(t.z-e.position.z)*r},moveVectorTowards:function(e,t,r){e.x+=(t.x-e.x)*r,e.y+=(t.y-e.y)*r,e.z+=(t.z-e.z)*r},rotateTowards:function(e,t,r){e.rotation.x+=(t.x-e.rotation.x)*r,e.rotation.y+=(t.y-e.rotation.y)*r,e.rotation.z+=(t.z-e.rotation.z)*r},updateCameraMatrices:function(e){e.updateMatrix(),e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld)},meshIsInView:function(e,t,r){return r=r||new THREE.Frustum,this.updateCameraMatrices(t),e.updateMatrix(),e.updateMatrixWorld(),r.setFromMatrix((new THREE.Matrix4).multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse)),r.intersectsObject(e)},getMouseIntersections:function(e,t,r,n,o){this.updateCameraMatrices(t),o=o||new THREE.Vector3,o.copy(e).unproject(t),r.ray.set(t.position,o.sub(t.position).normalize());var i=r.intersectObjects(n);return i.length>0?i[0]:null},objectWorldPositionToScreen:function(e,t){this.updateCameraMatrices(t),e.updateMatrixWorld();var r=window.innerWidth,n=window.innerHeight,o=r/2,i=n/2,a=(new THREE.Vector3).setFromMatrixPosition(e.matrixWorld);return a.project(t),{x:a.x*o+o|0,y:-(a.y*i)+i|0}},objectWorldPositionToScreenAlt:function(e,t){this.updateCameraMatrices(t),e.updateMatrixWorld();var r=window.innerWidth,n=window.innerHeight,o=(new THREE.Vector3).setFromMatrixPosition(e.matrixWorld),i=new THREE.Matrix4;return i.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),o.applyMatrix4(i),{x:(o.x+1)*r/2|0,y:(-o.y+1)*n/2|0}},worldToScreen:function(e,t){this.updateCameraMatrices(t);var r=window.innerWidth,n=window.innerHeight,o=r/2,i=n/2,a=(new THREE.Vector3).copy(e);return a.project(t),{x:a.x*o+o|0,y:-(a.y*i)+i|0}},screenToWorld:function(e,t){this.updateCameraMatrices(t);var r=e.x/window.innerWidth*2-1,n=2*-(e.y/window.innerHeight)+1,o=new THREE.Vector3(r,n,.5);o.unproject(t);var i=o.sub(t.position).normalize(),a=-t.position.z/i.z;return t.position.clone().add(i.multiplyScalar(a))},screenToWorldAtZ:function(e,t,r){var n,o=e.x/window.innerWidth*2-1,i=2*-(e.y/window.innerHeight)+1,a=new THREE.Plane(new THREE.Vector3(0,0,1),t),s=new THREE.Vector3(o,i,.5),c=new THREE.Raycaster;return c.pickingRay(s,r),n=c.ray.intersectPlane(a)},getMouseWorldPos:function(e,t){var r=new THREE.Vector3(e.x,e.y,.5).unproject(t),n=r.sub(t.position).normalize(),o=-t.position.z/n.z;return t.position.clone().add(n.multiplyScalar(o))},getMouseWorldPosAtZ:function(e,t,r){var n=new THREE.Plane(new THREE.Vector3(0,0,1),r),o=new THREE.Vector3(e.x,e.y,.5),i=new THREE.Raycaster;i.pickingRay(o,t);var a=i.ray.intersectPlane(n);return a},getEdges:function(e){var t,r=[0,0],n={},o=["a","b","c"],i=Math.cos(THREE.Math.degToRad(1)),a=function(e,t){return e-t};e.geometry instanceof THREE.BufferGeometry?(t=new THREE.Geometry,t.fromBufferGeometry(e.geometry)):t=e.geometry.clone(),t.mergeVertices(),t.computeFaceNormals();for(var s,c=t.vertices,u=t.faces,d=e.geometry.faces,f=0,l=u.length;l>f;f++)for(var E=u[f],p=0;3>p;p++)r[0]=E[o[p]],r[1]=E[o[(p+1)%3]],r.sort(a),s=r.toString(),void 0===n[s]?n[s]={vert1:r[0],vert2:r[1],face1:f,face2:void 0}:n[s].face2=f;var m=[];for(s in n){var h=n[s];(void 0===h.face2||u[h.face1].normal.dot(u[h.face2].normal)<=i)&&m.push({vertex1:c[h.vert1],vertex2:c[h.vert2],face1:d[h.face1],face2:d[h.face2],faceIndex1:h.face1,faceIndex2:h.face2})}return m},addFragmentFogInjections:function(e){for(var t=e.split("\n"),r=t.length,n=0;r>n;n++)"/*#FOG_INJECTION_1#*/"===t[n]?t[n]=THREE.ShaderChunk.fog_pars_fragment:"/*#FOG_INJECTION_2#*/"===t[n]&&(t[n]=THREE.ShaderChunk.fog_fragment);return t.join("\n")},pointOnSphere:function(e,t,r){return{x:e*Math.cos(t)*Math.sin(r),y:e*Math.sin(t)*Math.sin(r),z:e*Math.cos(r)}},getPointsOnSphere:function(e){for(var t,r=[],n=0;e>n;n++)t=this.pointOnSphere(1,Math.random()*Math.PI*2,Math.random()*Math.PI*2),r.push(new THREE.Vector3(t.x,t.y,t.z));return r},getPointsWithinSphere:function(e,t){for(var r,n=[],o=0;e>o;o++)r=this.pointOnSphere(Math.random()*t,Math.random()*Math.PI*2,Math.random()*Math.PI*2),n.push(new THREE.Vector3(r.x,r.y,r.z));return n},getPointsOnSphereEvenly:function(e){for(var t,r,n,o,i,a=[],s=Math.PI*(3-Math.sqrt(5)),c=2/e,u=0;e>u;u++)r=u*c-1+c/2,o=Math.sqrt(1-r*r),i=u*s,t=Math.cos(i)*o,n=Math.sin(i)*o,a.push(new THREE.Vector3(t,r,n));return a},getRandomVector3:function(e,t){return new THREE.Vector3(this.randomRange(e,t),this.randomRange(e,t),this.randomRange(e,t))},addRandomVector3:function(e,t,r){return this.getRandomVector3(t,r).add(e)},rotationInDegrees:function(e){var t=180/Math.PI;return new THREE.Euler(e.x*t,e.y*t,e.z*t,e.order)},loadJSONGeometry:function(e,t){var r,n,o=new THREE.JSONLoader,i=e.length,a=0,s={},c=[],u=function(){r=void 0!==e[a].file?e[a].file:e[a],n=void 0!==e[a].id?e[a].id:null,o.load(r,function(e){n&&(s[n]=e),c.push({geometry:e,id:n}),a++,a===i?"function"==typeof t&&t(c,s):u()})};u()},loadTextures:function(e,t){var r,n,o=e.length,i=0,a={},s=[],c=function(){r=void 0!==e[i].file?e[i].file:e[i],n=void 0!==e[i].id?e[i].id:null,THREE.ImageUtils.loadTexture(r,void 0,function(e){n&&(a[n]=e),s.push({texture:e,id:n}),i++,i===o?"function"==typeof t&&t(s,a):c()})};c()},setTextureWrapping:function(e,t){for(var r=0;r<e.length;r++)e[r].wrapS=e[r].wrapT=t,e[r].needsUpdate=!0},setTextureMipmapping:function(e,t){for(var r=0;r<e.length;r++)e[r].generateMipmaps=t,e[r].needsUpdate=!0},setTextureMinMagFilters:function(e,t,r){for(var n=0;n<e.length;n++)t&&(e[n].minFilter=t),r&&(e[n].magFilter=r),e[n].needsUpdate=!0},injectShaderCode:function(e,t,r){if("[object Array]"===Object.prototype.toString.call(r)){for(var n="",o=0;o<r.length;o++)n+=r[o]+"\n";return e.replace(t,n)}return e.replace(t,r)},logVector:function(e){console.log(e.x,e.y,e.z)},logProgramInfo:function(e,t){for(var r={attributes:[],uniforms:[],attributeCount:0,uniformCount:0},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),o=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i={35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT"},a=0;n>a;a++){var s=e.getActiveUniform(t,a);s.typeName=i[s.type],r.uniforms.push(s),r.uniformCount+=s.size}for(a=0;o>a;a++){var c=e.getActiveAttrib(t,a);c.typeName=i[c.type],r.attributes.push(c),r.attributeCount+=c.size}console.log(r)}};module.exports=threeUtils;
},{}],198:[function(require,module,exports){
"use strict";var UITransitionManager=function(n){n=n||!1;var t,e=function(){t=[]},i=function(n){arguments.length>1?_.each(arguments,function(n){t.push(n),v(n)}):(t.push(n),v(n))},c=function(n){var e=t.indexOf(n);-1!==e&&t.splice(e,1)},a=function(){t.length=0},o=function(n){n.renderable=!1},s=function(n){n.renderable=!0},f=function(t){n?t.css("opacity",0):t.css("visibility","hidden")},l=function(t){n?t.css("opacity",1):t.css("visibility","visible")},r=function(t){n?t.style.opacity=0:t.style.visibility="hidden"},u=function(t){n?t.style.opacity=1:t.style.visibility="visible"},v=function(n){n instanceof Array?_.each(n,function(n){n instanceof PIXI.DisplayObject?o(n):n instanceof $?f(n):n instanceof HTMLElement&&r(n)}):n instanceof PIXI.DisplayObject?o(n):n instanceof $?f(n):n instanceof HTMLElement&&r(n)},y=function(n){n instanceof Array?_.each(n,function(n){n instanceof PIXI.DisplayObject?s(n):n instanceof $?l(n):n instanceof HTMLElement&&u(n)}):n instanceof PIXI.DisplayObject?s(n):n instanceof $?l(n):n instanceof HTMLElement&&u(n)},I=function(n,t){var e,i=0,c=5,a=function(){clearInterval(e),"function"==typeof t&&t()};e=n instanceof Array?setInterval(function(){_.each(n,function(n){i%2===0?y(n):v(n)}),i++,i===c&&a()},35):setInterval(function(){i%2===0?y(n):v(n),i++,i===c&&a()},35)},h=function(n,t){var e,i=0,c=5,a=function(){clearInterval(e),"function"==typeof t&&t()};e=n instanceof Array?setInterval(function(){_.each(n,function(n){i%2===0?v(n):y(n)}),i++,i===c&&a()},35):setInterval(function(){i%2===0?v(n):y(n),i++,i===c&&a()},35)},p=function(n,e){n=n||50;var i=0,c=setInterval(function(){I(t[i],i===t.length-1?e:null),i++,i===t.length&&clearInterval(c)},n)},b=function(n,e,i){n=n||50,e&&t.reverse();var c=0,a=setInterval(function(){h(t[c],c===t.length-1?i:null),c++,c===t.length&&clearInterval(a)},n)},d=function(){t=null};return e(),{add:i,remove:c,removeAll:a,transitionIn:p,transitionOut:b,dispose:d}};module.exports=UITransitionManager;
},{}],199:[function(require,module,exports){
var util={padInt:function(t,r){for(var n=""+Math.floor(r);n.length<t;)n="0"+n;return n},getDistance:function(t,r,n,a){var e=t-n,o=r-a;return Math.sqrt(e*e+o*o)}};module.exports=util;
},{}]},{},[1]);
